{"version":3,"sources":["../../lib/dist/components/ImportForm.js","../../lib/dist/components/data/seq2.js","../../lib/dist/components/TreeCanvas.js","../../lib/dist/components/MSACanvas.js","../../lib/dist/components/Ruler.js","../../lib/dist/components/TreeRuler.js","../../lib/dist/util.js","../../lib/dist/colorSchemes.js","../../lib/dist/components/SettingsDlg.js","../../lib/dist/components/AboutDlg.js","../../lib/dist/components/DetailsDlg.js","../../lib/dist/components/Header.js","../../lib/dist/components/MSAView.js","../../lib/dist/parsers/ClustalMSA.js","../../lib/dist/parseNewick.js","../../lib/dist/parsers/StockholmMSA.js","../../lib/dist/parsers/FastaMSA.js","../../lib/dist/components/Annotations.js","../../lib/dist/model.js","model.ts","ProteinPanel.js","App.tsx","reportWebVitals.ts","index.tsx"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","Li","_a","onClick","children","_jsx","Link","href","Typography","observer","model","_b","useState","msaFile","setMsaFile","_c","treeFile","setTreeFile","error","_jsxs","Container","style","width","padding","color","Grid","container","spacing","justify","alignItems","item","FileSelector","location","setLocation","Button","setMSAFilehandle","setTreeFilehandle","variant","disabled","uri","setData","msa","tree","transaction","radius","randomColor","Math","floor","random","TreeBlock","offsetY","ref","useRef","collapseBranchMenuRef","toggleNodeMenuRef","clickRef","collapsedClickMap","setCollapsedClickMap","_d","nameClickMap","setNameClickMap","_e","collapseBranchMenu","setCollapseBranchMenu","_f","toggleNodeMenu","setToggleNodeMenu","hierarchy","rowHeight","scrollY","treeWidth","showBranchLen","collapsed","margin","labelsAlignRight","noTree","blockSize","drawNodeBubbles","drawTree","treeAreaWidth","structures","hoverCollapsedClickMap","event","x","nativeEvent","offsetX","y","current","clickCtx","getContext","data","getImageData","entry","hoverNameClickMap","handleCloseBranchMenu","undefined","handleCloseToggleMenu","useEffect","ctx","tempCollapsedClickMap","tempNameClickMap","forEach","context","resetTransform","clearRect","translate","left","font","replace","max","links","source","target","sy","sx","ty","tx","y1","min","y2","beginPath","moveTo","lineTo","stroke","descendants","node","val","id","name","strokeStyle","fillStyle","includes","arc","PI","fill","col","fillRect","textAlign","setLineDash","leaves","len","yp","xp","measureText","height","hasStructure","width_1","fillText","_Fragment","position","top","Menu","anchorEl","transitionDuration","keepMounted","open","Boolean","onClose","MenuItem","dense","toggleCollapsed","map","selectedStructures","find","removeStructureFromSelection","structure","pdb","JSON","stringify","addStructureToSelection","copy","onMouseMove","cursor","data2","display","TreeCanvas","scheduled","deltaY","prevY","blocksY","mouseDragging","setMouseDragging","curr","addEventListener","onWheel","removeEventListener","origEvent","normalizeWheel","pixelY","requestAnimationFrame","doScrollY","preventDefault","cleanup","globalMouseMove","distanceY","clientY","window","globalMouseUp","onMouseDown","draggable","dataset","resizer","button","onMouseUp","onMouseLeave","overflow","block","MSABlock","MSA","colWidth","bgColor","columns","scrollX","colorScheme","mouseCol","theme","useTheme","colorContrast","useMemo","mouseoverRef","b","yStart","yEnd","ceil","xStart","xEnd","visibleLeaves","slice","str","letter","toUpperCase","contrast","getBoundingClientRect","mouseX","clientX","mouseY","setMousePos","zIndex","pointerEvents","MSACanvas","msaFilehandle","msaAreaWidth","blocks2d","deltaX","prevX","pixelX","doScrollX","currX","currY","distanceX","bx","by","CircularProgress","makeTicks","start","end","bpPerPx","emitMajor","emitMinor","gridPitch","scale","minMajorPitchPx","minMinorPitchPx","minMajorPitchBp","abs","majorMagnitude","parseInt","Number","toExponential","split","majorPitch","pow","majorPitchPx","minorPitch","chooseGridPitch","minBase","maxBase","iterPitch","index","ticks","base","push","type","mathPower","num","String","substr","useStyles","makeStyles","majorTickLabel","fontSize","majorTick","minorTick","RulerBlock","reversed","major","minor","classes","tick","x1","x2","strokeWidth","className","filter","textAnchor","Ruler","blocksX","TreeRuler","transform","obj","cb","fromEntries","entries","generateNodeIds","parent","depth","branchset","clustal","G","P","S","T","H","K","R","F","W","Y","I","L","M","V","lesk","A","C","N","Q","D","E","maeditor","flower","rainbow_dna","U","clustalx_protein","clustalx_dna","jalview_buried","B","X","Z","jalview_hydrophobicity","jalview_prophelix","jalview_propstrand","jalview_propturn","jalview_taylor","jalview_zappo","cinema","Color","hex","rowHeightInit","colWidthInit","treeWidthInit","colorSchemeName","setRowHeight","setColWidth","setTreeWidth","isNaN","rowHeightError","colWidthError","treeWidthError","Dialog","DialogTitle","DialogContent","FormControlLabel","control","Checkbox","checked","onChange","toggleBranchLen","label","toggleBgColor","toggleNodeBubbles","toggleDrawTree","toggleLabelsAlignRight","TextField","value","select","setColorSchemeName","keys","colorSchemes","option","LicenseDialog","AboutDialog","dlgOpen","setDlgOpen","version","alignmentDetails","Attributes","attributes","InfoArea","mouseOverRowName","marginLeft","Header","settingsDialogVisible","setSettingsDialogVisible","aboutDialogVisible","setAboutDialogVisible","detailsDialogVisible","setDetailsDialogVisible","currentAlignment","alignmentNames","IconButton","setScrollY","setScrollX","setCurrentAlignment","FolderOpenIcon","SettingsIcon","AssignmentIcon","SettingsDialog","DetailsDialog","Select","native","flex","HelpIcon","Track","track","TrackLabel","ReactComponent","canvas","ResizeHandle","cropMouseDown","setCropMouseDown","listener_1","setTreeAreaWidth","movementX","listener2_1","document","background","done","initialized","tracks","ImportForm","ClustalMSA","text","parse","getMSA","getRow","alns","aln","seq","getWidth","getDetails","header","getNames","getStructures","defineProperty","get","enumerable","configurable","getTree","consensus","seqConsensus","trim","customColorScheme","ancestors","tokens","token","subtree","pop","parseFloat","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","StockholmMSA","res","Stockholm","parseAll","seqdata","gf","DE","General","Accessions","gs","AC","Dbxref","DR","getSeqCoords","pdbRegex","ent","dr","exec","match","toLowerCase","chain","startPos","endPos","reduce","a","rest","NH","parseNewick","gc","seq_cons","SS_cons","secondaryStructureConsensus","FastaMSA","re","line","AnnotationBlock","modelColorScheme","AnnotationTrack","__awaiter","thisArg","_arguments","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","then","__generator","body","f","g","_","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","setBrLength","d","y0","k","maxLength","getRoot","sum","sort","ascending","clamp","StructureModel","types","identifier","string","number","range","maybe","snapshotProcessor","compose","BaseViewModel","ElementId","literal","optional","mouseRow","array","treeFilehandle","FileLocation","actions","self","setTree","setMSA","volatile","elt","r","remove","toggleStructureSelection","clearSelectedStructures","setError","console","row","cast","openLocation","readFile","afterCreate","_this","addDisposer","autorun","e_1","e_2","views","oldBlocksX","oldBlocksY","oldValX","oldValY","size","ret","flat","palette","getContrastText","sniff","startsWith","blanks","rowNames","getMouseOverResidue","rowName","key","pdbEntry","strs","counter","j","rows","root","cluster","totalHeight","separation","clust","numColumns","setMouseoveredColumn","file","inverseStructures","postProcessor","App","msaview","MSAModel","nglSelection","setNGLSelection","sel","DatasourceRegistry","add","StaticDatasource","ProteinPanel","setType","setRes","annotation","setAnnotation","stage","setStage","isMouseHovering","setMouseHovering","stageElementRef","useCallback","element","currentStage","Stage","dispose","handleResize","all","selection","loadFile","signals","hovered","pickingProxy","atom","bond","closestBondAtom","resno","chainname","picker","removeAllRepresentations","addRepresentation","sele","autoView","annots","removeAnnotation","rn","residueStore","count","rp","getResidueProxy","ap","getAtomProxy","atomOffset","addAnnotation","positionToVector3","qualifiedName","viewer","requestRender","clearSelection","onMouseEnter","URLSearchParams","search","mymodel","AppGlobal","create","setWidth","innerWidth","onSnapshot","throttle","snap","url","URL","searchParams","set","history","replaceState","toString","border","MSAView","MainApp","createJBrowseTheme","ThemeProvider","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.a2737b96.chunk.js","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { Button, Container, Grid, Typography, Link } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { transaction } from 'mobx';\nimport { FileSelector } from '@jbrowse/core/ui';\nimport { smallTree, smallMSA, smallMSAOnly } from './data/seq2';\nvar Li = function (_a) {\n    var onClick = _a.onClick, children = _a.children;\n    return (_jsx(Link, __assign({ onClick: onClick, href: \"#\" }, { children: _jsx(Typography, { children: children }, void 0) }), void 0));\n};\nexport default observer(function (_a) {\n    var model = _a.model;\n    var _b = useState(), msaFile = _b[0], setMsaFile = _b[1];\n    var _c = useState(), treeFile = _c[0], setTreeFile = _c[1];\n    var error = model.error;\n    return (_jsxs(Container, { children: [_jsxs(\"div\", __assign({ style: { width: '50%' } }, { children: [error ? (_jsx(\"div\", __assign({ style: { padding: 20 } }, { children: _jsxs(Typography, __assign({ color: \"error\" }, { children: [\"Error: \", \"\" + error] }), void 0) }), void 0)) : null,\n                    _jsx(Typography, { children: \"Open an MSA file (stockholm or clustal format) and/or a tree file (newick format).\" }, void 0),\n                    _jsx(Typography, __assign({ color: \"error\" }, { children: \"Note: you can open up just an MSA or just a tree, both are not required. Some MSA files e.g. stockholm format have an embedded tree also and this is fine, and opening a separate tree file is not required.\" }), void 0)] }), void 0),\n            _jsxs(Grid, __assign({ container: true, spacing: 10, justify: \"center\", alignItems: \"center\" }, { children: [_jsxs(Grid, __assign({ item: true }, { children: [_jsx(Typography, { children: \"MSA file or URL\" }, void 0),\n                            _jsx(FileSelector, { location: msaFile, setLocation: setMsaFile }, void 0),\n                            _jsx(Typography, { children: \"Tree file or URL\" }, void 0),\n                            _jsx(FileSelector, { location: treeFile, setLocation: setTreeFile }, void 0)] }), void 0),\n                    _jsx(Grid, __assign({ item: true }, { children: _jsx(Button, __assign({ onClick: function () {\n                                if (msaFile) {\n                                    model.setMSAFilehandle(msaFile);\n                                }\n                                if (treeFile) {\n                                    model.setTreeFilehandle(treeFile);\n                                }\n                            }, variant: \"contained\", color: \"primary\", disabled: !msaFile && !treeFile }, { children: \"Open\" }), void 0) }), void 0),\n                    _jsxs(Grid, __assign({ item: true }, { children: [_jsx(Typography, { children: \"Examples\" }, void 0),\n                            _jsxs(\"ul\", { children: [_jsx(\"li\", { children: _jsx(Li, __assign({ onClick: function () {\n                                                model.setTreeFilehandle({\n                                                    uri: 'https://jbrowse.org/genomes/newick_trees/sarscov2phylo.pub.ft.nh',\n                                                });\n                                            } }, { children: \"230k COVID-19 samples (tree only)\" }), void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsx(Li, __assign({ onClick: function () {\n                                                model.setData({ msa: smallMSA, tree: smallTree });\n                                            } }, { children: \"Small protein MSA+tree\" }), void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsx(Li, __assign({ onClick: function () {\n                                                model.setData({ msa: smallMSAOnly });\n                                            } }, { children: \"Small MSA only\" }), void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsx(Li, __assign({ onClick: function () {\n                                                model.setMSAFilehandle({\n                                                    uri: 'https://ihh.github.io/abrowse/build/pfam-cov2.stock',\n                                                });\n                                            } }, { children: \"PFAM SARS-CoV2 multi-stockholm\" }), void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsx(Li, __assign({ onClick: function () {\n                                                model.setMSAFilehandle({\n                                                    uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/Lysine.stock',\n                                                });\n                                            } }, { children: \"Lysine stockholm file\" }), void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsx(Li, __assign({ onClick: function () {\n                                                model.setMSAFilehandle({\n                                                    uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/PF01601_full.txt',\n                                                });\n                                            } }, { children: \"PF01601 stockholm file (SARS-CoV2 spike protein)\" }), void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsx(Li, __assign({ onClick: function () {\n                                                model.setMSAFilehandle({\n                                                    uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/europe_covid.fa',\n                                                });\n                                            } }, { children: \"Europe COVID full genomes (LR883044.1 and 199 other sequences)\" }), void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsx(Li, __assign({ onClick: function () {\n                                                transaction(function () {\n                                                    model.setMSAFilehandle({\n                                                        uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/rhv_test-only.aligned_with_mafft_auto.fa',\n                                                    });\n                                                    model.setTreeFilehandle({\n                                                        uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/rhv_test-only.aligned_with_mafft_auto.nh',\n                                                    });\n                                                });\n                                            } }, { children: \"MAFFT+VeryFastTree(17.9k samples)\" }), void 0) }, void 0)] }, void 0)] }), void 0)] }), void 0)] }, void 0));\n});\n","export var smallMSA = \"CLUSTAL O(1.2.3) multiple sequence alignment\\nUniProt/Swiss-Prot|P26898|IL2RA_SHEEP      MEPSLLMWRFFVFIVVPGCVTEACHDDPPSLRNA----------MFKVLRYE----VGTM\\nUniProt/Swiss-Prot|P01590|IL2RA_MOUSE      MEPRLLMLGFLSLTIVPSCRAELCLYDPPEVPNA----------TFKALSYK----NGTI\\nUniProt/Swiss-Prot|P41690|IL2RA_FELCA      MEPSLLLWGILTFVVVHGHVTELCDENPPDIQHA----------TFKALTYK----TGTM\\nUniProt/Swiss-Prot|P01589|IL2RA_HUMAN      MDSYLLMWGLLTFIMVPGCQAELCDDDPPEIPHA----------TFKAMAYK----EGTM\\nUniProt/Swiss-Prot|Q5MNY4|IL2RA_MACMU      MDPYLLMWGLLTFITVPGCQAELCDDDPPKITHA----------TFKAVAYK----EGTM\\nUniProt/Swiss-Prot|Q95118|IL2RG_BOVIN      -----------------------------------LLMWGLLT-----------------\\nUniProt/Swiss-Prot|P40321|IL2RG_CANFA      MLKPPLPLRSLLFLQLSLLGVGLNSTVPMPNGNEDIT------PDFFLTATPSETLSVSS\\nUniProt/Swiss-Prot|P26896|IL2RB_RAT        MATVDLSWRLPLYILLLLLATT--------------------------------WVSAAV\\nUniProt/Swiss-Prot|Q8BZM1|GLMN_MOUSE       PLPLRSLLFLQLPLLGVGLNP------------------PLPLRSLLFLQLPLLGVGLNP\\nUniProt/Swiss-Prot|P36835|IL2_CAPHI        -----------LLGVGLNPKFLTP------------------------------------\\nUniProt/Swiss-Prot|Q7JFM4|IL2_AOTVO        MLKPPLPLRSLLFLQLPLLGVGLNPKFLTPSGNEDIGGKPGTGGDFFLTSTPAGTLDVST\\nUniProt/Swiss-Prot|Q29416|IL2_CANFA        --------------LFLQLSLLG-------------------------------------\\n\";\nexport var smallMSAOnly = \"CLUSTAL O(1.2.4) multiple sequence alignment\\n\\n\\nsp|P69905|HBA_HUMAN       MVLSPADKTNVKAAWGKVGAHAGEYGAEALERMFLSFPTTKTYFPHFDLSHGSAQVKGHG\\t60\\nsp|P01942|HBA_MOUSE       MVLSGEDKSNIKAAWGKIGGHGAEYGAEALERMFASFPTTKTYFPHFDVSHGSAQVKGHG\\t60\\nsp|P13786|HBAZ_CAPHI      MSLTRTERTIILSLWSKISTQADVIGTETLERLFSCYPQAKTYFPHFDLHSGSAQLRAHG\\t60\\n                          * *:  ::: : : *.*:. :.   *:*:***:* .:* :********:  ****::.**\\n\\nsp|P69905|HBA_HUMAN       KKVADALTNAVAHVDDMPNALSALSDLHAHKLRVDPVNFKLLSHCLLVTLAAHLPAEFTP\\t120\\nsp|P01942|HBA_MOUSE       KKVADALASAAGHLDDLPGALSALSDLHAHKLRVDPVNFKLLSHCLLVTLASHHPADFTP\\t120\\nsp|P13786|HBAZ_CAPHI      SKVVAAVGDAVKSIDNVTSALSKLSELHAYVLRVDPVNFKFLSHCLLVTLASHFPADFTA\\t120\\n                          .**. *: .*.  :*:: .*** **:***: *********:**********:* **:**\\n\\nsp|P69905|HBA_HUMAN       AVHASLDKFLASVSTVLTSKYR\\t142\\nsp|P01942|HBA_MOUSE       AVHASLDKFLASVSTVLTSKYR\\t142\\nsp|P13786|HBAZ_CAPHI      DAHAAWDKFLSIVSGVLTEKYR\\t142\\n                           .**: ****: ** ***.***\";\nexport var smallTree = '(((UniProt/Swiss-Prot|P26898|IL2RA_SHEEP:0.24036,(UniProt/Swiss-Prot|P41690|IL2RA_FELCA:0.17737,(UniProt/Swiss-Prot|P01589|IL2RA_HUMAN:0.03906,UniProt/Swiss-Prot|Q5MNY4|IL2RA_MACMU:0.03787):0.13033):0.04964):0.02189,UniProt/Swiss-Prot|P01590|IL2RA_MOUSE:0.23072):0.06814,(((UniProt/Swiss-Prot|Q95118|IL2RG_BOVIN:0.09600,UniProt/Swiss-Prot|P40321|IL2RG_CANFA:0.09845):0.25333,UniProt/Swiss-Prot|Q29416|IL2_CANFA:-0.35055):0.10231,(UniProt/Swiss-Prot|P26896|IL2RB_RAT:0.33631,UniProt/Swiss-Prot|Q7JFM4|IL2_AOTVO:-0.33631):0.10166):0.01607,(UniProt/Swiss-Prot|Q8BZM1|GLMN_MOUSE:0.32378,UniProt/Swiss-Prot|P36835|IL2_CAPHI:-0.32378):0.09999)';\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { useEffect, useRef, useState } from 'react';\nimport { Menu, MenuItem } from '@material-ui/core';\nimport normalizeWheel from 'normalize-wheel';\nimport { observer } from 'mobx-react';\nimport copy from 'copy-to-clipboard';\nvar extendBounds = 5;\nvar radius = 3.5;\nvar d = radius * 2;\nfunction randomColor() {\n    return [\n        Math.floor(Math.random() * 255),\n        Math.floor(Math.random() * 255),\n        Math.floor(Math.random() * 255),\n    ];\n}\nvar padding = 600;\nvar TreeBlock = observer(function (_a) {\n    var _b;\n    var model = _a.model, offsetY = _a.offsetY;\n    var ref = useRef(null);\n    var collapseBranchMenuRef = useRef(null);\n    var toggleNodeMenuRef = useRef(null);\n    var clickRef = useRef(null);\n    var _c = useState({}), collapsedClickMap = _c[0], setCollapsedClickMap = _c[1];\n    var _d = useState({}), nameClickMap = _d[0], setNameClickMap = _d[1];\n    var _e = useState(), collapseBranchMenu = _e[0], setCollapseBranchMenu = _e[1];\n    var _f = useState(), toggleNodeMenu = _f[0], setToggleNodeMenu = _f[1];\n    var hierarchy = model.hierarchy, rowHeight = model.rowHeight, scrollY = model.scrollY, treeWidth = model.treeWidth, showBranchLen = model.showBranchLen, collapsed = model.collapsed, margin = model.margin, labelsAlignRight = model.labelsAlignRight, noTree = model.noTree, blockSize = model.blockSize, drawNodeBubbles = model.drawNodeBubbles, drawTree = model.drawTree, treeAreaWidth = model.treeAreaWidth, structures = model.structures;\n    useEffect(function () {\n        if (!ref.current || !clickRef.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        var clickCtx = clickRef.current.getContext('2d');\n        if (!ctx || !clickCtx) {\n            return;\n        }\n        var tempCollapsedClickMap = {};\n        var tempNameClickMap = {};\n        [ctx, clickCtx].forEach(function (context) {\n            context.resetTransform();\n            context.clearRect(0, 0, treeWidth + padding, blockSize);\n            context.translate(margin.left, -offsetY);\n        });\n        var font = ctx.font;\n        ctx.font = font.replace(/\\d+px/, Math.max(8, rowHeight - 8) + \"px\");\n        if (!noTree && drawTree) {\n            hierarchy.links().forEach(function (_a) {\n                var source = _a.source, target = _a.target;\n                var y = showBranchLen ? 'len' : 'y';\n                //@ts-ignore\n                var _b = source, sy = _b.x, _c = y, sx = _b[_c];\n                //@ts-ignore\n                var _d = target, ty = _d.x, _e = y, tx = _d[_e];\n                var y1 = Math.min(sy, ty);\n                var y2 = Math.max(sy, ty);\n                //1d line intersection to check if line crosses block at all, this\n                //is an optimization that allows us to skip drawing most tree links\n                //outside the block\n                if (offsetY + blockSize >= y1 && y2 >= offsetY) {\n                    ctx.beginPath();\n                    ctx.moveTo(sx, sy);\n                    ctx.lineTo(sx, ty);\n                    ctx.lineTo(tx, ty);\n                    ctx.stroke();\n                }\n            });\n            if (drawNodeBubbles) {\n                hierarchy.descendants().forEach(function (node) {\n                    var val = showBranchLen ? 'len' : 'y';\n                    var _a = node, \n                    //@ts-ignore\n                    y = _a.x, \n                    //@ts-ignore\n                    _b = val, \n                    //@ts-ignore\n                    x = _a[_b], data = _a.data;\n                    var _c = data.id, id = _c === void 0 ? '' : _c, _d = data.name, name = _d === void 0 ? '' : _d;\n                    if (y > offsetY - extendBounds &&\n                        y < offsetY + blockSize + extendBounds) {\n                        ctx.strokeStyle = 'black';\n                        ctx.fillStyle = collapsed.includes(id) ? 'black' : 'white';\n                        ctx.beginPath();\n                        ctx.arc(x, y, radius, 0, 2 * Math.PI);\n                        ctx.fill();\n                        ctx.stroke();\n                        var col = randomColor();\n                        tempCollapsedClickMap[\"\" + col] = { id: id, name: name };\n                        clickCtx.fillStyle = \"rgb(\" + col + \")\";\n                        clickCtx.fillRect(x - radius, y - radius, d, d);\n                    }\n                });\n            }\n        }\n        if (rowHeight >= 10) {\n            if (labelsAlignRight) {\n                ctx.textAlign = 'right';\n                ctx.setLineDash([1, 3]);\n            }\n            else {\n                ctx.textAlign = 'start';\n            }\n            hierarchy.leaves().forEach(function (node) {\n                var \n                //@ts-ignore\n                y = node.x, \n                //@ts-ignore\n                x = node.y, name = node.data.name, \n                //@ts-ignore\n                len = node.len;\n                if (y > offsetY - extendBounds &&\n                    y < offsetY + blockSize + extendBounds) {\n                    //note: +rowHeight/4 matches with -rowHeight/4 in msa\n                    var yp = y + rowHeight / 4;\n                    var xp = showBranchLen ? len : x;\n                    var col = randomColor();\n                    tempNameClickMap[\"\" + col] = { id: name, name: name };\n                    clickCtx.fillStyle = \"rgb(\" + col + \")\";\n                    var width = ctx.measureText(name).width;\n                    var height = ctx.measureText('M').width; // use an 'em' for height\n                    var hasStructure = structures[name];\n                    ctx.fillStyle = hasStructure ? 'blue' : 'black';\n                    if (!drawTree && !labelsAlignRight) {\n                        ctx.fillText(name, 0, yp);\n                        if (hasStructure) {\n                            clickCtx.fillRect(0, yp - height, width, height);\n                        }\n                    }\n                    else if (labelsAlignRight) {\n                        if (drawTree) {\n                            var width_1 = ctx.measureText(name).width;\n                            ctx.moveTo(xp + radius + 2, y);\n                            ctx.lineTo(treeAreaWidth - margin.left * 2 - width_1 - 2, y);\n                            ctx.stroke();\n                        }\n                        ctx.fillText(name, treeAreaWidth - margin.left * 2, yp);\n                        if (hasStructure) {\n                            clickCtx.fillRect(treeAreaWidth - 30 - width, yp - height, width, height);\n                        }\n                    }\n                    else {\n                        ctx.fillText(name, xp + d, yp);\n                        if (hasStructure) {\n                            clickCtx.fillRect(xp + d, yp - height, width, height);\n                        }\n                    }\n                }\n            });\n            ctx.setLineDash([]);\n        }\n        setCollapsedClickMap(tempCollapsedClickMap);\n        setNameClickMap(tempNameClickMap);\n    }, [\n        collapsed,\n        rowHeight,\n        margin.left,\n        hierarchy,\n        offsetY,\n        treeWidth,\n        showBranchLen,\n        noTree,\n        blockSize,\n        drawNodeBubbles,\n        drawTree,\n        labelsAlignRight,\n        treeAreaWidth,\n        structures,\n    ]);\n    function hoverCollapsedClickMap(event) {\n        var x = event.nativeEvent.offsetX;\n        var y = event.nativeEvent.offsetY;\n        if (!clickRef.current) {\n            return;\n        }\n        var clickCtx = clickRef.current.getContext('2d');\n        if (!clickCtx) {\n            return;\n        }\n        var data = clickCtx.getImageData(x, y, 1, 1).data;\n        var entry = collapsedClickMap[\"\" + [data[0], data[1], data[2]]];\n        if (!entry) {\n            return;\n        }\n        return __assign(__assign({}, entry), { x: x, y: y });\n    }\n    function hoverNameClickMap(event) {\n        var x = event.nativeEvent.offsetX;\n        var y = event.nativeEvent.offsetY;\n        if (!clickRef.current) {\n            return;\n        }\n        var clickCtx = clickRef.current.getContext('2d');\n        if (!clickCtx) {\n            return;\n        }\n        var data = clickCtx.getImageData(x, y, 1, 1).data;\n        var entry = nameClickMap[\"\" + [data[0], data[1], data[2]]];\n        if (!entry) {\n            return;\n        }\n        return __assign(__assign({}, entry), { x: x, y: y });\n    }\n    function handleCloseBranchMenu() {\n        setCollapseBranchMenu(undefined);\n    }\n    function handleCloseToggleMenu() {\n        setToggleNodeMenu(undefined);\n    }\n    return (_jsxs(_Fragment, { children: [_jsx(\"div\", { ref: collapseBranchMenuRef, style: {\n                    position: 'absolute',\n                    left: (collapseBranchMenu === null || collapseBranchMenu === void 0 ? void 0 : collapseBranchMenu.x) || 0,\n                    top: scrollY + offsetY + ((collapseBranchMenu === null || collapseBranchMenu === void 0 ? void 0 : collapseBranchMenu.y) || 0),\n                } }, void 0),\n            _jsx(\"div\", { ref: toggleNodeMenuRef, style: {\n                    position: 'absolute',\n                    left: (toggleNodeMenu === null || toggleNodeMenu === void 0 ? void 0 : toggleNodeMenu.x) || 0,\n                    top: scrollY + offsetY + ((toggleNodeMenu === null || toggleNodeMenu === void 0 ? void 0 : toggleNodeMenu.y) || 0),\n                } }, void 0),\n            (collapseBranchMenu === null || collapseBranchMenu === void 0 ? void 0 : collapseBranchMenu.id) ? (_jsxs(Menu, __assign({ anchorEl: collapseBranchMenuRef.current, transitionDuration: 0, keepMounted: true, open: Boolean(collapseBranchMenuRef.current), onClose: handleCloseBranchMenu }, { children: [_jsx(MenuItem, __assign({ dense: true, disabled: true }, { children: collapseBranchMenu.name }), void 0),\n                    _jsx(MenuItem, __assign({ dense: true, onClick: function () {\n                            model.toggleCollapsed(collapseBranchMenu.id);\n                            handleCloseBranchMenu();\n                        } }, { children: model.collapsed.includes(collapseBranchMenu.id)\n                            ? 'Expand'\n                            : 'Collapse' }), void 0)] }), void 0)) : null,\n            (toggleNodeMenu === null || toggleNodeMenu === void 0 ? void 0 : toggleNodeMenu.id) ? (_jsxs(Menu, __assign({ anchorEl: toggleNodeMenuRef.current, transitionDuration: 0, keepMounted: true, open: Boolean(toggleNodeMenuRef.current), onClose: handleCloseToggleMenu }, { children: [(_b = structures[toggleNodeMenu.id]) === null || _b === void 0 ? void 0 : _b.map(function (entry) {\n                        var found = model.selectedStructures.find(function (node) { return node.id === toggleNodeMenu.id; });\n                        return !found ? (_jsxs(MenuItem, __assign({ dense: true, onClick: function () {\n                                model.addStructureToSelection({\n                                    structure: entry,\n                                    id: toggleNodeMenu.id,\n                                });\n                                handleCloseToggleMenu();\n                            } }, { children: [\"Add \", entry.pdb, \" selection\"] }), JSON.stringify(entry))) : (_jsxs(MenuItem, __assign({ dense: true, onClick: function () {\n                                model.removeStructureFromSelection({\n                                    structure: entry,\n                                    id: toggleNodeMenu.id,\n                                });\n                                handleCloseToggleMenu();\n                            } }, { children: [\"Remove \", entry.pdb, \" selection\"] }), JSON.stringify(entry)));\n                    }),\n                    _jsx(MenuItem, __assign({ dense: true, onClick: function () {\n                            copy(toggleNodeMenu.id);\n                            handleCloseToggleMenu();\n                        } }, { children: \"Copy name to clipboard\" }), void 0)] }), void 0)) : null,\n            _jsx(\"canvas\", { width: treeWidth + padding, height: blockSize, style: {\n                    width: treeWidth + padding,\n                    height: blockSize,\n                    top: scrollY + offsetY,\n                    left: 0,\n                    position: 'absolute',\n                }, onMouseMove: function (event) {\n                    if (!ref.current) {\n                        return;\n                    }\n                    if (hoverCollapsedClickMap(event) || hoverNameClickMap(event)) {\n                        ref.current.style.cursor = 'pointer';\n                    }\n                    else {\n                        ref.current.style.cursor = 'default';\n                    }\n                }, onClick: function (event) {\n                    var data = hoverCollapsedClickMap(event);\n                    if (data === null || data === void 0 ? void 0 : data.id) {\n                        setCollapseBranchMenu(data);\n                    }\n                    var data2 = hoverNameClickMap(event);\n                    if (data2 === null || data2 === void 0 ? void 0 : data2.id) {\n                        setToggleNodeMenu(data2);\n                    }\n                }, ref: ref }, void 0),\n            _jsx(\"canvas\", { style: { display: 'none' }, width: treeWidth + padding, height: blockSize, ref: clickRef }, void 0)] }, void 0));\n});\nvar TreeCanvas = observer(function (_a) {\n    var model = _a.model;\n    var ref = useRef(null);\n    var scheduled = useRef(false);\n    var deltaY = useRef(0);\n    var prevY = useRef(0);\n    var treeWidth = model.treeWidth, height = model.height, blocksY = model.blocksY;\n    var _b = useState(false), mouseDragging = _b[0], setMouseDragging = _b[1];\n    useEffect(function () {\n        var curr = ref.current;\n        if (!curr) {\n            return;\n        }\n        function onWheel(origEvent) {\n            var event = normalizeWheel(origEvent);\n            deltaY.current += event.pixelY;\n            if (!scheduled.current) {\n                scheduled.current = true;\n                requestAnimationFrame(function () {\n                    model.doScrollY(-deltaY.current);\n                    deltaY.current = 0;\n                    scheduled.current = false;\n                });\n            }\n            origEvent.preventDefault();\n        }\n        curr.addEventListener('wheel', onWheel);\n        return function () {\n            curr.removeEventListener('wheel', onWheel);\n        };\n    }, [model]);\n    useEffect(function () {\n        var cleanup = function () { };\n        function globalMouseMove(event) {\n            event.preventDefault();\n            var currY = event.clientY;\n            var distanceY = currY - prevY.current;\n            if (distanceY) {\n                // use rAF to make it so multiple event handlers aren't fired per-frame\n                // see https://calendar.perfplanet.com/2013/the-runtime-performance-checklist/\n                if (!scheduled.current) {\n                    scheduled.current = true;\n                    window.requestAnimationFrame(function () {\n                        model.doScrollY(distanceY);\n                        scheduled.current = false;\n                        prevY.current = event.clientY;\n                    });\n                }\n            }\n        }\n        function globalMouseUp() {\n            prevY.current = 0;\n            if (mouseDragging) {\n                setMouseDragging(false);\n            }\n        }\n        if (mouseDragging) {\n            window.addEventListener('mousemove', globalMouseMove, true);\n            window.addEventListener('mouseup', globalMouseUp, true);\n            cleanup = function () {\n                window.removeEventListener('mousemove', globalMouseMove, true);\n                window.removeEventListener('mouseup', globalMouseUp, true);\n            };\n        }\n        return cleanup;\n    }, [model, mouseDragging]);\n    function mouseDown(event) {\n        // check if clicking a draggable element or a resize handle\n        var target = event.target;\n        if (target.draggable || target.dataset.resizer) {\n            return;\n        }\n        // otherwise do click and drag scroll\n        if (event.button === 0) {\n            prevY.current = event.clientY;\n            setMouseDragging(true);\n        }\n    }\n    // this local mouseup is used in addition to the global because sometimes\n    // the global add/remove are not called in time, resulting in issue #533\n    function mouseUp(event) {\n        event.preventDefault();\n        setMouseDragging(false);\n    }\n    function mouseLeave(event) {\n        event.preventDefault();\n    }\n    return (_jsx(\"div\", __assign({ ref: ref, onMouseDown: mouseDown, onMouseUp: mouseUp, onMouseLeave: mouseLeave, style: {\n            height: height,\n            position: 'relative',\n            overflow: 'hidden',\n            width: treeWidth + padding,\n        } }, { children: blocksY.map(function (block) { return (_jsx(TreeBlock, { model: model, offsetY: block }, block)); }) }), void 0));\n});\nexport default TreeCanvas;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useEffect, useState, useRef, useMemo } from 'react';\nimport { Typography, CircularProgress, useTheme } from '@material-ui/core';\nimport normalizeWheel from 'normalize-wheel';\nimport { observer } from 'mobx-react';\nvar MSABlock = observer(function (_a) {\n    var model = _a.model, offsetX = _a.offsetX, offsetY = _a.offsetY;\n    var MSA = model.MSA, colWidth = model.colWidth, bgColor = model.bgColor, columns = model.columns, rowHeight = model.rowHeight, scrollY = model.scrollY, scrollX = model.scrollX, hierarchy = model.hierarchy, colorScheme = model.colorScheme, blockSize = model.blockSize, mouseCol = model.mouseCol;\n    var theme = useTheme();\n    var colorContrast = useMemo(function () { return model.colorContrast(theme); }, [\n        model,\n        theme,\n    ]);\n    var ref = useRef(null);\n    var mouseoverRef = useRef(null);\n    useEffect(function () {\n        if (!ref.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        ctx.resetTransform();\n        ctx.clearRect(0, 0, blockSize, blockSize);\n        ctx.translate(-offsetX, rowHeight / 2 - offsetY);\n        ctx.textAlign = 'center';\n        ctx.font = ctx.font.replace(/\\d+px/, Math.max(8, rowHeight - 12) + \"px\");\n        var leaves = hierarchy.leaves();\n        var b = blockSize;\n        // slice vertical rows, e.g. tree leaves, avoid negative slice\n        var yStart = Math.max(0, Math.floor((offsetY - rowHeight) / rowHeight));\n        var yEnd = Math.max(0, Math.ceil((offsetY + b + rowHeight) / rowHeight));\n        // slice horizontal visible letters, avoid negative slice\n        var xStart = Math.max(0, Math.floor(offsetX / colWidth));\n        var xEnd = Math.max(0, Math.ceil((offsetX + b) / colWidth));\n        var visibleLeaves = leaves.slice(yStart, yEnd);\n        visibleLeaves.forEach(function (node) {\n            var _a;\n            var \n            //@ts-ignore\n            y = node.x, name = node.data.name;\n            var str = (_a = columns[name]) === null || _a === void 0 ? void 0 : _a.slice(xStart, xEnd);\n            for (var i = 0; i < (str === null || str === void 0 ? void 0 : str.length); i++) {\n                var letter = str[i];\n                var color = colorScheme[letter.toUpperCase()];\n                if (bgColor) {\n                    var x = i * colWidth + offsetX - (offsetX % colWidth);\n                    ctx.fillStyle = color || 'white';\n                    ctx.fillRect(x, y - rowHeight, colWidth, rowHeight);\n                }\n            }\n        });\n        if (rowHeight >= 10 && colWidth >= rowHeight / 2) {\n            visibleLeaves.forEach(function (node) {\n                var _a;\n                var \n                //@ts-ignore\n                y = node.x, name = node.data.name;\n                var str = (_a = columns[name]) === null || _a === void 0 ? void 0 : _a.slice(xStart, xEnd);\n                for (var i = 0; i < (str === null || str === void 0 ? void 0 : str.length); i++) {\n                    var letter = str[i];\n                    var color = colorScheme[letter.toUpperCase()];\n                    var contrast = colorContrast[letter.toUpperCase()] || 'black';\n                    var x = i * colWidth + offsetX - (offsetX % colWidth);\n                    //note: -rowHeight/4 matches +rowHeight/4 in tree\n                    ctx.fillStyle = bgColor ? contrast : color || 'black';\n                    ctx.fillText(letter, Math.floor(x + colWidth / 2), Math.floor(y - rowHeight / 4));\n                }\n            });\n        }\n    }, [\n        MSA,\n        columns,\n        colorScheme,\n        colorContrast,\n        bgColor,\n        rowHeight,\n        colWidth,\n        hierarchy,\n        offsetX,\n        offsetY,\n        blockSize,\n    ]);\n    useEffect(function () {\n        if (!mouseoverRef.current) {\n            return;\n        }\n        var ctx = mouseoverRef.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        ctx.resetTransform();\n        ctx.clearRect(0, 0, blockSize, blockSize);\n        ctx.translate(-offsetX, -offsetY);\n        if (mouseCol &&\n            mouseCol > offsetX / colWidth &&\n            mouseCol < (offsetX + blockSize) / colWidth) {\n            var x = (mouseCol - 1) * colWidth;\n            ctx.fillStyle = 'rgba(100,100,100,0.5)';\n            ctx.fillRect(x, offsetY, colWidth, offsetY + blockSize);\n        }\n    }, [mouseCol, blockSize, colWidth, offsetX, offsetY, rowHeight]);\n    return (_jsxs(\"div\", __assign({ style: { position: 'relative' } }, { children: [_jsx(\"canvas\", { ref: ref, onMouseMove: function (event) {\n                    if (!ref.current) {\n                        return;\n                    }\n                    var _a = ref.current.getBoundingClientRect(), left = _a.left, top = _a.top;\n                    var mouseX = event.clientX - left;\n                    var mouseY = event.clientY - top;\n                    model.setMousePos(Math.floor((mouseX + offsetX) / colWidth) + 1, Math.floor((mouseY + offsetY) / rowHeight));\n                }, onMouseLeave: function () { return model.setMousePos(); }, width: blockSize, height: blockSize, style: {\n                    position: 'absolute',\n                    top: scrollY + offsetY,\n                    left: scrollX + offsetX,\n                    width: blockSize,\n                    height: blockSize,\n                } }, void 0),\n            _jsx(\"canvas\", { ref: mouseoverRef, width: blockSize, height: blockSize, style: {\n                    position: 'absolute',\n                    top: scrollY + offsetY,\n                    left: scrollX + offsetX,\n                    width: blockSize,\n                    height: blockSize,\n                    zIndex: 1000,\n                    pointerEvents: 'none',\n                } }, void 0)] }), void 0));\n});\nvar MSACanvas = observer(function (_a) {\n    var model = _a.model;\n    var MSA = model.MSA, msaFilehandle = model.msaFilehandle, height = model.height, msaAreaWidth = model.msaAreaWidth, blocks2d = model.blocks2d;\n    var ref = useRef(null);\n    // wheel\n    var scheduled = useRef(false);\n    var deltaX = useRef(0);\n    var deltaY = useRef(0);\n    // mouse click-and-drag scrolling\n    var prevX = useRef(0);\n    var prevY = useRef(0);\n    var _b = useState(false), mouseDragging = _b[0], setMouseDragging = _b[1];\n    useEffect(function () {\n        var curr = ref.current;\n        if (!curr) {\n            return;\n        }\n        function onWheel(origEvent) {\n            var event = normalizeWheel(origEvent);\n            deltaX.current += event.pixelX;\n            deltaY.current += event.pixelY;\n            if (!scheduled.current) {\n                scheduled.current = true;\n                requestAnimationFrame(function () {\n                    model.doScrollX(-deltaX.current);\n                    model.doScrollY(-deltaY.current);\n                    deltaX.current = 0;\n                    deltaY.current = 0;\n                    scheduled.current = false;\n                });\n            }\n            origEvent.preventDefault();\n        }\n        curr.addEventListener('wheel', onWheel);\n        return function () {\n            curr.removeEventListener('wheel', onWheel);\n        };\n    }, [model]);\n    function mouseDown(event) {\n        // check if clicking a draggable element or a resize handle\n        var target = event.target;\n        if (target.draggable || target.dataset.resizer) {\n            return;\n        }\n        // otherwise do click and drag scroll\n        if (event.button === 0) {\n            prevX.current = event.clientX;\n            prevY.current = event.clientY;\n            setMouseDragging(true);\n        }\n    }\n    // this local mouseup is used in addition to the global because sometimes\n    // the global add/remove are not called in time, resulting in issue #533\n    function mouseUp(event) {\n        event.preventDefault();\n        setMouseDragging(false);\n    }\n    function mouseLeave(event) {\n        event.preventDefault();\n    }\n    useEffect(function () {\n        var cleanup = function () { };\n        function globalMouseMove(event) {\n            event.preventDefault();\n            var currX = event.clientX;\n            var currY = event.clientY;\n            var distanceX = currX - prevX.current;\n            var distanceY = currY - prevY.current;\n            if (distanceX || distanceY) {\n                // use rAF to make it so multiple event handlers aren't fired per-frame\n                // see https://calendar.perfplanet.com/2013/the-runtime-performance-checklist/\n                if (!scheduled.current) {\n                    scheduled.current = true;\n                    window.requestAnimationFrame(function () {\n                        model.doScrollX(distanceX);\n                        model.doScrollY(distanceY);\n                        scheduled.current = false;\n                        prevX.current = event.clientX;\n                        prevY.current = event.clientY;\n                    });\n                }\n            }\n        }\n        function globalMouseUp() {\n            prevX.current = 0;\n            if (mouseDragging) {\n                setMouseDragging(false);\n            }\n        }\n        if (mouseDragging) {\n            window.addEventListener('mousemove', globalMouseMove, true);\n            window.addEventListener('mouseup', globalMouseUp, true);\n            cleanup = function () {\n                window.removeEventListener('mousemove', globalMouseMove, true);\n                window.removeEventListener('mouseup', globalMouseUp, true);\n            };\n        }\n        return cleanup;\n    }, [model, mouseDragging]);\n    return (_jsx(\"div\", __assign({ ref: ref, onMouseDown: mouseDown, onMouseUp: mouseUp, onMouseLeave: mouseLeave, style: {\n            position: 'relative',\n            height: height,\n            width: msaAreaWidth,\n            overflow: 'hidden',\n        } }, { children: !MSA && !msaFilehandle ? null : !MSA ? (_jsxs(\"div\", __assign({ style: { position: 'absolute', left: '50%', top: '50%' } }, { children: [_jsx(CircularProgress, {}, void 0),\n                _jsx(Typography, { children: \"Loading...\" }, void 0)] }), void 0)) : (blocks2d.map(function (_a) {\n            var bx = _a[0], by = _a[1];\n            return (_jsx(MSABlock, { model: model, offsetX: bx, offsetY: by }, bx + \"_\" + by));\n        })) }), void 0));\n});\nexport default MSACanvas;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { makeStyles } from '@material-ui/core';\nimport { observer } from 'mobx-react';\n/**\n * Given a scale ( bp/px ) and minimum distances (px) between major and minor\n * gridlines, return an object like `{ majorPitch: bp, minorPitch: bp }` giving\n * the gridline pitches to use.\n */\nexport function chooseGridPitch(scale, minMajorPitchPx, minMinorPitchPx) {\n    scale = Math.abs(scale);\n    var minMajorPitchBp = minMajorPitchPx * scale;\n    var majorMagnitude = parseInt(Number(minMajorPitchBp).toExponential().split(/e/i)[1], 10);\n    var majorPitch = Math.pow(10, majorMagnitude);\n    while (majorPitch < minMajorPitchBp) {\n        majorPitch *= 2;\n        if (majorPitch >= minMajorPitchBp) {\n            break;\n        }\n        majorPitch *= 2.5;\n    }\n    majorPitch = Math.max(majorPitch, 5);\n    var majorPitchPx = majorPitch / scale;\n    var minorPitch = 0;\n    if (!(majorPitch % 10) && majorPitchPx / 10 >= minMinorPitchPx) {\n        minorPitch = majorPitch / 10;\n    }\n    else if (!(majorPitch % 5) && majorPitchPx / 5 >= minMinorPitchPx) {\n        minorPitch = majorPitch / 5;\n    }\n    else if (!(majorPitch % 2) && majorPitchPx / 2 >= minMinorPitchPx) {\n        minorPitch = majorPitch / 2;\n    }\n    return { majorPitch: majorPitch, minorPitch: minorPitch };\n}\nexport function makeTicks(start, end, bpPerPx, emitMajor, emitMinor) {\n    var _a;\n    if (emitMajor === void 0) { emitMajor = true; }\n    if (emitMinor === void 0) { emitMinor = true; }\n    var gridPitch = chooseGridPitch(bpPerPx, 60, 15);\n    var minBase = start;\n    var maxBase = end;\n    if (minBase === null || maxBase === null) {\n        return [];\n    }\n    if (bpPerPx < 0) {\n        _a = [maxBase, minBase], minBase = _a[0], maxBase = _a[1];\n    }\n    // add 20px additional on the right and left to allow us to draw the ends\n    // of labels that lie a little outside our region\n    minBase -= Math.abs(20 * bpPerPx);\n    maxBase += Math.abs(20 * bpPerPx) + 1;\n    var iterPitch = gridPitch.minorPitch || gridPitch.majorPitch;\n    var index = 0;\n    var ticks = [];\n    for (var base = Math.ceil(minBase / iterPitch) * iterPitch; base < maxBase; base += iterPitch) {\n        if (emitMinor && base % (gridPitch.majorPitch * 2)) {\n            ticks.push({ type: 'minor', base: base - 1, index: index });\n            index += 1;\n        }\n        else if (emitMajor && !(base % (gridPitch.majorPitch * 2))) {\n            ticks.push({ type: 'major', base: base - 1, index: index });\n            index += 1;\n        }\n    }\n    return ticks;\n}\nfunction mathPower(num) {\n    if (num < 999) {\n        return String(num);\n    }\n    return mathPower(~~(num / 1000)) + \",\" + (\"00\" + ~~(num % 1000)).substr(-3, 3);\n}\nvar useStyles = makeStyles(function ( /* theme */) { return ({\n    majorTickLabel: {\n        fontSize: '11px',\n        // fill: theme.palette.text.primary,\n    },\n    majorTick: {\n        stroke: '#555',\n        // stroke: theme.palette.text.secondary,\n    },\n    minorTick: {\n        stroke: '#999',\n        // stroke: theme.palette.text.hint,\n    },\n}); });\nfunction RulerBlock(_a) {\n    var start = _a.start, end = _a.end, bpPerPx = _a.bpPerPx, reversed = _a.reversed, major = _a.major, minor = _a.minor;\n    var classes = useStyles();\n    var ticks = makeTicks(start, end, bpPerPx, major, minor);\n    return (_jsxs(_Fragment, { children: [ticks.map(function (tick) {\n                var x = (reversed ? end - tick.base : tick.base - start) / bpPerPx;\n                return (_jsx(\"line\", { x1: x, x2: x, y1: 11, y2: tick.type === 'major' ? 11 + 6 : 11 + 4, strokeWidth: 1, stroke: tick.type === 'major' ? '#555' : '#999', className: tick.type === 'major' ? classes.majorTick : classes.minorTick, \"data-bp\": tick.base }, tick.base));\n            }),\n            ticks\n                .filter(function (tick) { return tick.type === 'major'; })\n                .map(function (tick) {\n                var x = (reversed ? end - tick.base : tick.base - start) / bpPerPx;\n                return (_jsx(\"text\", __assign({ x: x, y: 10, textAnchor: \"middle\", style: { fontSize: '11px' }, className: classes.majorTickLabel }, { children: mathPower(tick.base + 1) }), \"label-\" + tick.base));\n            })] }, void 0));\n}\nvar Ruler = observer(function (_a) {\n    var model = _a.model;\n    var MSA = model.MSA, colWidth = model.colWidth, msaAreaWidth = model.msaAreaWidth, scrollX = model.scrollX, blocksX = model.blocksX, blockSize = model.blockSize;\n    var offsetX = blocksX[0];\n    return !MSA ? null : (_jsx(\"div\", __assign({ style: {\n            position: 'relative',\n            width: msaAreaWidth,\n            overflow: 'hidden',\n            height: 20,\n        } }, { children: _jsx(\"svg\", __assign({ style: {\n                width: blocksX.length * blockSize,\n                position: 'absolute',\n                left: scrollX + offsetX,\n            } }, { children: _jsx(RulerBlock, { start: offsetX / colWidth, end: offsetX / colWidth + (blockSize * blocksX.length) / colWidth, bpPerPx: 1 / colWidth }, offsetX) }), void 0) }), void 0));\n});\nexport default Ruler;\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { observer } from 'mobx-react';\nvar TreeRuler = observer(function (_a) {\n    var model = _a.model;\n    var treeWidth = model.treeWidth;\n    return _jsx(\"div\", { style: { width: treeWidth } }, void 0);\n});\nexport default TreeRuler;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nexport function transform(obj, cb) {\n    return Object.fromEntries(Object.entries(obj).map(cb));\n}\nexport function generateNodeIds(tree, parent, depth) {\n    var _a;\n    if (parent === void 0) { parent = 'node'; }\n    if (depth === void 0) { depth = 0; }\n    var id = parent + \"-\" + depth;\n    return __assign(__assign({}, tree), { id: id, branchset: (_a = tree.branchset) === null || _a === void 0 ? void 0 : _a.map(function (b, i) {\n            return generateNodeIds(b, id + '-' + i, depth + 1);\n        }) });\n}\n","import Color from 'color';\nimport { transform } from './util';\nvar colorSchemes = {\n    clustal: {\n        G: 'orange',\n        P: 'orange',\n        S: 'orange',\n        T: 'orange',\n        H: 'red',\n        K: 'red',\n        R: 'red',\n        F: 'blue',\n        W: 'blue',\n        Y: 'blue',\n        I: 'green',\n        L: 'green',\n        M: 'green',\n        V: 'green',\n    },\n    lesk: {\n        G: 'orange',\n        A: 'orange',\n        S: 'orange',\n        T: 'orange',\n        C: 'green',\n        V: 'green',\n        I: 'green',\n        L: 'green',\n        P: 'green',\n        F: 'green',\n        Y: 'green',\n        M: 'green',\n        W: 'green',\n        N: 'magenta',\n        Q: 'magenta',\n        H: 'magenta',\n        D: 'red',\n        E: 'red',\n        K: 'blue',\n        R: 'blue',\n    },\n    maeditor: {\n        A: 'lightgreen',\n        G: 'lightgreen',\n        C: 'green',\n        D: 'darkgreen',\n        E: 'darkgreen',\n        N: 'darkgreen',\n        Q: 'darkgreen',\n        I: 'blue',\n        L: 'blue',\n        M: 'blue',\n        V: 'blue',\n        F: '#c8a2c8',\n        W: '#c8a2c8',\n        Y: '#c8a2c8',\n        H: 'darkblue',\n        K: 'orange',\n        R: 'orange',\n        P: 'pink',\n        S: 'red',\n        T: 'red',\n    },\n    //https://github.com/biotite-dev/biotite/blob/8c460972f8ab904312f130dfb80f3efc8c9bd7c5/src/biotite/sequence/graphics/color_schemes/flower.json\n    flower: {\n        A: '#b18a51',\n        C: '#ff5701',\n        D: '#01a578',\n        E: '#2da0a1',\n        F: '#fa559d',\n        G: '#b1c23c',\n        H: '#0194f9',\n        I: '#f27663',\n        K: '#7fc3d7',\n        L: '#df6e75',\n        M: '#fe9daf',\n        N: '#0bcec6',\n        P: '#4fa32a',\n        Q: '#7295ae',\n        R: '#83bff1',\n        S: '#b4bd9b',\n        T: '#d2b576',\n        V: '#fd997b',\n        W: '#ff2ded',\n        Y: '#c96ecf',\n    },\n    rainbow_dna: {\n        A: '#3737f5',\n        C: '#37f537',\n        G: '#f5f537',\n        T: '#f53737',\n        U: '#f53737',\n    },\n    //https://github.com/biotite-dev/biotite/blob/8c460972f8ab904312f130dfb80f3efc8c9bd7c5/src/biotite/sequence/graphics/color_schemes/clustalx_protein.json\n    clustalx_protein: {\n        A: '#197fe5',\n        C: '#e57f7f',\n        D: '#cc4ccc',\n        E: '#cc4ccc',\n        F: '#197fe5',\n        G: '#e5994c',\n        H: '#19b2b2',\n        I: '#197fe5',\n        K: '#e53319',\n        L: '#197fe5',\n        M: '#197fe5',\n        N: '#19cc19',\n        P: '#cccc00',\n        Q: '#19cc19',\n        R: '#e53319',\n        S: '#19cc19',\n        T: '#19cc19',\n        V: '#197fe5',\n        W: '#197fe5',\n        Y: '#19b2b2',\n    },\n    clustalx_dna: {\n        A: '#e53319',\n        C: '#197fe5',\n        G: '#e5994c',\n        T: '#19cc19',\n        U: '#19cc19',\n    },\n    jalview_buried: {\n        A: '#00a35c',\n        R: '#00fc03',\n        N: '#00eb14',\n        D: '#00eb14',\n        C: '#0000ff',\n        Q: '#00f10e',\n        E: '#00f10e',\n        G: '#009d62',\n        H: '#00d52a',\n        I: '#0054ab',\n        L: '#007b84',\n        K: '#00ff00',\n        M: '#009768',\n        F: '#008778',\n        P: '#00e01f',\n        S: '#00d52a',\n        T: '#00db24',\n        W: '#00a857',\n        Y: '#00e619',\n        V: '#005fa0',\n        B: '#00eb14',\n        X: '#00b649',\n        Z: '#00f10e',\n    },\n    jalview_hydrophobicity: {\n        A: '#ad0052',\n        R: '#0000ff',\n        N: '#0c00f3',\n        D: '#0c00f3',\n        C: '#c2003d',\n        Q: '#0c00f3',\n        E: '#0c00f3',\n        G: '#6a0095',\n        H: '#1500ea',\n        I: '#ff0000',\n        L: '#ea0015',\n        K: '#0000ff',\n        M: '#b0004f',\n        F: '#cb0034',\n        P: '#4600b9',\n        S: '#5e00a1',\n        T: '#61009e',\n        W: '#5b00a4',\n        Y: '#4f00b0',\n        V: '#f60009',\n        B: '#0c00f3',\n        X: '#680097',\n        Z: '#0c00f3',\n    },\n    jalview_prophelix: {\n        A: '#e718e7',\n        R: '#6f906f',\n        N: '#1be41b',\n        D: '#778877',\n        C: '#23dc23',\n        Q: '#926d92',\n        E: '#ff00ff',\n        G: '#00ff00',\n        H: '#758a75',\n        I: '#8a758a',\n        L: '#ae51ae',\n        K: '#a05fa0',\n        M: '#ef10ef',\n        F: '#986798',\n        P: '#00ff00',\n        S: '#36c936',\n        T: '#47b847',\n        W: '#8a758a',\n        Y: '#21de21',\n        V: '#857a85',\n        B: '#49b649',\n        X: '#758a75',\n        Z: '#c936c9',\n    },\n    jalview_propstrand: {\n        A: '#5858a7',\n        R: '#6b6b94',\n        N: '#64649b',\n        D: '#2121de',\n        C: '#9d9d62',\n        Q: '#8c8c73',\n        E: '#0000ff',\n        G: '#4949b6',\n        H: '#60609f',\n        I: '#ecec13',\n        L: '#b2b24d',\n        K: '#4747b8',\n        M: '#82827d',\n        F: '#c2c23d',\n        P: '#2323dc',\n        S: '#4949b6',\n        T: '#9d9d62',\n        W: '#c0c03f',\n        Y: '#d3d32c',\n        V: '#ffff00',\n        B: '#4343bc',\n        X: '#797986',\n        Z: '#4747b8',\n    },\n    jalview_propturn: {\n        A: '#2cd3d3',\n        R: '#708f8f',\n        N: '#ff0000',\n        D: '#e81717',\n        C: '#a85757',\n        Q: '#3fc0c0',\n        E: '#778888',\n        G: '#ff0000',\n        H: '#708f8f',\n        I: '#00ffff',\n        L: '#1ce3e3',\n        K: '#7e8181',\n        M: '#1ee1e1',\n        F: '#1ee1e1',\n        P: '#f60909',\n        S: '#e11e1e',\n        T: '#738c8c',\n        W: '#738c8c',\n        Y: '#9d6262',\n        V: '#07f8f8',\n        B: '#f30c0c',\n        X: '#7c8383',\n        Z: '#5ba4a4',\n    },\n    jalview_taylor: {\n        A: '#ccff00',\n        R: '#0000ff',\n        N: '#cc00ff',\n        D: '#ff0000',\n        C: '#ffff00',\n        Q: '#ff00cc',\n        E: '#ff0066',\n        G: '#ff9900',\n        H: '#0066ff',\n        I: '#66ff00',\n        L: '#33ff00',\n        K: '#6600ff',\n        M: '#00ff00',\n        F: '#00ff66',\n        P: '#ffcc00',\n        S: '#ff3300',\n        T: '#ff6600',\n        W: '#00ccff',\n        Y: '#00ffcc',\n        V: '#99ff00',\n    },\n    jalview_zappo: {\n        A: '#ffafaf',\n        R: '#6464ff',\n        N: '#00ff00',\n        D: '#ff0000',\n        C: '#ffff00',\n        Q: '#00ff00',\n        E: '#ff0000',\n        G: '#ff00ff',\n        H: '#6464ff',\n        I: '#ffafaf',\n        L: '#ffafaf',\n        K: '#6464ff',\n        M: '#ffafaf',\n        F: '#ffc800',\n        P: '#ff00ff',\n        S: '#00ff00',\n        T: '#00ff00',\n        W: '#ffc800',\n        Y: '#ffc800',\n        V: '#ffafaf',\n    },\n    cinema: {\n        H: 'blue',\n        K: 'blue',\n        R: 'blue',\n        D: 'red',\n        E: 'red',\n        S: 'green',\n        T: 'green',\n        N: 'green',\n        Q: 'green',\n        A: 'white',\n        V: 'white',\n        L: 'white',\n        I: 'white',\n        M: 'white',\n        F: 'magenta',\n        W: 'magenta',\n        Y: 'magenta',\n        P: 'brown',\n        G: 'brown',\n        C: 'yellow',\n        B: 'gray',\n        Z: 'gray',\n        X: 'gray',\n        '-': 'gray',\n        '.': 'gray',\n    },\n};\n// turn all supplied colors to hex colors which getContrastText from mui\n// requires\nexport default transform(colorSchemes, function (_a) {\n    var key = _a[0], val = _a[1];\n    return [\n        key,\n        transform(val, function (_a) {\n            var letter = _a[0], color = _a[1];\n            return [letter, Color(color).hex()];\n        }),\n    ];\n});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { observer } from 'mobx-react';\nimport { Button, Checkbox, Dialog, DialogTitle, DialogContent, FormControlLabel, MenuItem, TextField, } from '@material-ui/core';\nimport colorSchemes from '../colorSchemes';\nexport default observer(function (_a) {\n    var model = _a.model, onClose = _a.onClose, open = _a.open;\n    var rowHeightInit = model.rowHeight, colWidthInit = model.colWidth, treeWidthInit = model.treeWidth, colorSchemeName = model.colorSchemeName, noTree = model.noTree;\n    var _b = useState('' + rowHeightInit), rowHeight = _b[0], setRowHeight = _b[1];\n    var _c = useState('' + colWidthInit), colWidth = _c[0], setColWidth = _c[1];\n    var _d = useState('' + treeWidthInit), treeWidth = _d[0], setTreeWidth = _d[1];\n    function error(n) {\n        return Number.isNaN(+n) || +n < 0;\n    }\n    var rowHeightError = error(rowHeight);\n    var colWidthError = error(colWidth);\n    var treeWidthError = error(treeWidth);\n    return (_jsxs(Dialog, __assign({ onClose: function () { return onClose(); }, open: open }, { children: [_jsx(DialogTitle, { children: \"Settings\" }, void 0),\n            _jsxs(DialogContent, { children: [_jsx(FormControlLabel, { control: _jsx(Checkbox, { checked: model.showBranchLen, onChange: function () { return model.toggleBranchLen(); } }, void 0), label: \"Show branch length\" }, void 0),\n                    _jsx(FormControlLabel, { control: _jsx(Checkbox, { checked: model.bgColor, onChange: function () { return model.toggleBgColor(); } }, void 0), label: \"Color background\" }, void 0),\n                    _jsx(FormControlLabel, { control: _jsx(Checkbox, { checked: model.drawNodeBubbles, onChange: function () { return model.toggleNodeBubbles(); } }, void 0), label: \"Draw node bubbles\" }, void 0),\n                    _jsx(FormControlLabel, { control: _jsx(Checkbox, { checked: model.drawTree, onChange: function () { return model.toggleDrawTree(); } }, void 0), label: \"Draw tree (if available)\" }, void 0),\n                    _jsx(FormControlLabel, { control: _jsx(Checkbox, { checked: model.labelsAlignRight, onChange: function () { return model.toggleLabelsAlignRight(); } }, void 0), label: \"Labels align right (note: labels may draw over tree, but can adjust tree width or tree area width in UI)\" }, void 0),\n                    _jsx(TextField, { label: \"Row height (px)\", value: rowHeight, error: rowHeightError, onChange: function (event) { return setRowHeight(event.target.value); } }, void 0),\n                    _jsx(TextField, { label: \"Column width (px)\", value: colWidth, error: colWidthError, onChange: function (event) { return setColWidth(event.target.value); } }, void 0),\n                    _jsx(\"br\", {}, void 0),\n                    !noTree ? (_jsx(TextField, { label: \"Tree width (px)\", value: treeWidth, error: treeWidthError, onChange: function (event) { return setTreeWidth(event.target.value); } }, void 0)) : null,\n                    _jsx(\"br\", {}, void 0),\n                    _jsx(TextField, __assign({ select: true, label: \"Color scheme\", value: colorSchemeName, onChange: function (event) { return model.setColorSchemeName(event.target.value); } }, { children: Object.keys(colorSchemes).map(function (option) { return (_jsx(MenuItem, __assign({ value: option }, { children: option }), option)); }) }), void 0),\n                    _jsx(\"br\", {}, void 0),\n                    _jsx(\"br\", {}, void 0),\n                    _jsx(\"br\", {}, void 0),\n                    _jsx(Button, __assign({ disabled: rowHeightError || colWidthError || treeWidthError, onClick: function () {\n                            model.setRowHeight(+rowHeight);\n                            model.setColWidth(+colWidth);\n                            if (!noTree) {\n                                model.setTreeWidth(+treeWidth);\n                            }\n                            onClose();\n                        }, variant: \"contained\", color: \"primary\" }, { children: \"Submit\" }), void 0)] }, void 0)] }), void 0));\n});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { Dialog, DialogTitle, DialogContent, Typography, Link, } from '@material-ui/core';\nimport { version } from './package.json';\nfunction LicenseDialog(_a) {\n    var onClose = _a.onClose, open = _a.open;\n    return (_jsxs(Dialog, __assign({ onClose: function () { return onClose(); }, open: open }, { children: [_jsx(DialogTitle, { children: \"Biotite License\" }, void 0),\n            _jsx(DialogContent, { children: _jsx(\"pre\", __assign({ style: { height: 100, overflow: 'auto' } }, { children: \"\\nCopyright 2017 - 2020, The Biotite contributors\\nAll rights reserved.\\n\\nRedistribution and use in source and binary forms, with or without modification,\\nare permitted provided that the following conditions are met:\\n\\n1. Redistributions of source code must retain the above copyright notice, this\\nlist of conditions and the following disclaimer.\\n\\n2. Redistributions in binary form must reproduce the above copyright notice,\\nthis list of conditions and the following disclaimer in the documentation and/or\\nother materials provided with the distribution.\\n\\n3. Neither the name of the copyright holder nor the names of its contributors\\nmay be used to endorse or promote products derived from this software without\\nspecific prior written permission.\\n\\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \\\"AS IS\\\" AND\\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\\n        \" }), void 0) }, void 0)] }), void 0));\n}\nexport default function AboutDialog(_a) {\n    var onClose = _a.onClose, open = _a.open;\n    var _b = useState(false), dlgOpen = _b[0], setDlgOpen = _b[1];\n    return (_jsxs(_Fragment, { children: [_jsx(LicenseDialog, { onClose: function () { return setDlgOpen(false); }, open: dlgOpen }, void 0),\n            _jsxs(Dialog, __assign({ onClose: function () { return onClose(); }, open: open }, { children: [_jsx(DialogTitle, { children: \"About this plugin\" }, void 0),\n                    _jsxs(DialogContent, { children: [_jsxs(Typography, { children: [\"JBrowse 2 MSAView plugin \", version, \" (\", _jsx(Link, __assign({ href: \"https://github.com/gmod/jbrowse-plugin-msaview\" }, { children: \"Github\" }), void 0), \")\"] }, void 0),\n                            _jsxs(\"ul\", { children: [_jsx(\"li\", { children: _jsxs(Typography, { children: [\"We use some color schemes from the\", ' ',\n                                                _jsx(Link, __assign({ href: \"https://github.com/biotite-dev/biotite\" }, { children: \"biotite\" }), void 0), ' ', \"project, and their license is reproduced\", ' ',\n                                                _jsx(Link, __assign({ onClick: function () { return setDlgOpen(true); } }, { children: \"here\" }), void 0)] }, void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsxs(Typography, { children: [\"See this page for some information on jalview colorings\", ' ',\n                                                _jsx(Link, __assign({ href: \"https://www.jalview.org/help/html/colourSchemes/\" }, { children: \"here\" }), void 0)] }, void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsxs(Typography, { children: [\"See this page for some info on the clustal, cinema, maeditor, and lesk color schemes\", ' ',\n                                                _jsx(Link, __assign({ href: \"http://www.bioinformatics.nl/~berndb/aacolour.html\" }, { children: \"here\" }), void 0)] }, void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsxs(Typography, { children: [\"See this paper about the flower color scheme\", ' ',\n                                                _jsx(Link, __assign({ href: \"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7245768/\" }, { children: \"here\" }), void 0)] }, void 0) }, void 0)] }, void 0)] }, void 0)] }), void 0)] }, void 0));\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Dialog, DialogTitle, DialogContent } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { Attributes } from '@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail';\nexport default observer(function (_a) {\n    var model = _a.model, onClose = _a.onClose, open = _a.open;\n    var alignmentDetails = model.alignmentDetails;\n    return (_jsxs(Dialog, __assign({ onClose: function () { return onClose(); }, open: open }, { children: [_jsx(DialogTitle, { children: \"Metadata\" }, void 0),\n            _jsx(DialogContent, { children: _jsx(Attributes, { attributes: alignmentDetails }, void 0) }, void 0)] }), void 0));\n});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsxs as _jsxs, jsx as _jsx, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { IconButton, Select, Typography } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport SettingsDialog from './SettingsDlg';\nimport AboutDialog from './AboutDlg';\nimport DetailsDialog from './DetailsDlg';\n//icons\nimport FolderOpenIcon from '@material-ui/icons/FolderOpen';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport HelpIcon from '@material-ui/icons/Help';\nimport AssignmentIcon from '@material-ui/icons/Assignment';\nvar InfoArea = observer(function (_a) {\n    var model = _a.model;\n    var mouseOverRowName = model.mouseOverRowName, mouseCol = model.mouseCol;\n    return (_jsxs(_Fragment, { children: [_jsxs(Typography, __assign({ display: \"inline\" }, { children: [\"Row name: \", mouseOverRowName] }), void 0),\n            _jsx(\"span\", { style: { marginLeft: 10 } }, void 0),\n            _jsxs(Typography, __assign({ display: \"inline\" }, { children: [\"Position: \", mouseCol] }), void 0)] }, void 0));\n});\nvar Header = observer(function (_a) {\n    var model = _a.model;\n    var _b = useState(false), settingsDialogVisible = _b[0], setSettingsDialogVisible = _b[1];\n    var _c = useState(false), aboutDialogVisible = _c[0], setAboutDialogVisible = _c[1];\n    var _d = useState(false), detailsDialogVisible = _d[0], setDetailsDialogVisible = _d[1];\n    var currentAlignment = model.currentAlignment, alignmentNames = model.alignmentNames;\n    return (_jsxs(\"div\", __assign({ style: { display: 'flex' } }, { children: [_jsx(IconButton, __assign({ onClick: function () {\n                    model.setData({ tree: '', msa: '' });\n                    model.setTreeFilehandle(undefined);\n                    model.setMSAFilehandle(undefined);\n                    model.setScrollY(0);\n                    model.setScrollX(0);\n                    model.setCurrentAlignment(0);\n                } }, { children: _jsx(FolderOpenIcon, {}, void 0) }), void 0),\n            _jsx(IconButton, __assign({ onClick: function () {\n                    setSettingsDialogVisible(true);\n                } }, { children: _jsx(SettingsIcon, {}, void 0) }), void 0),\n            _jsx(IconButton, __assign({ onClick: function () {\n                    setDetailsDialogVisible(true);\n                } }, { children: _jsx(AssignmentIcon, {}, void 0) }), void 0),\n            settingsDialogVisible ? (_jsx(SettingsDialog, { open: true, model: model, onClose: function () { return setSettingsDialogVisible(false); } }, void 0)) : null,\n            aboutDialogVisible ? (_jsx(AboutDialog, { open: true, onClose: function () { return setAboutDialogVisible(false); } }, void 0)) : null,\n            detailsDialogVisible ? (_jsx(DetailsDialog, { open: true, model: model, onClose: function () { return setDetailsDialogVisible(false); } }, void 0)) : null,\n            alignmentNames.length > 0 ? (_jsx(Select, __assign({ native: true, value: currentAlignment, onChange: function (event) {\n                    model.setCurrentAlignment(+event.target.value);\n                    model.setScrollX(0);\n                    model.setScrollY(0);\n                } }, { children: alignmentNames.map(function (option, index) { return (_jsx(\"option\", __assign({ value: index }, { children: option }), option + '-' + index)); }) }), void 0)) : null,\n            _jsx(InfoArea, { model: model }, void 0),\n            _jsx(\"div\", { style: { flex: 1 } }, void 0),\n            _jsx(IconButton, __assign({ onClick: function () {\n                    setAboutDialogVisible(true);\n                } }, { children: _jsx(HelpIcon, {}, void 0) }), void 0)] }), void 0));\n});\nexport default Header;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useRef, useState, useEffect } from 'react';\nimport { observer } from 'mobx-react';\nimport { Typography } from '@material-ui/core';\nimport ImportForm from './ImportForm';\nimport TreeCanvas from './TreeCanvas';\nimport MSACanvas from './MSACanvas';\nimport Ruler from './Ruler';\nimport TreeRuler from './TreeRuler';\nimport Header from './Header';\nvar resizeHandleWidth = 5;\nvar Track = observer(function (_a) {\n    var model = _a.model, track = _a.track;\n    var rowHeight = model.rowHeight, treeAreaWidth = model.treeAreaWidth;\n    return (_jsxs(\"div\", __assign({ style: { display: 'flex', height: rowHeight } }, { children: [_jsx(\"div\", __assign({ style: { overflow: 'hidden', width: treeAreaWidth } }, { children: _jsx(TrackLabel, { model: model, name: track.name }, void 0) }), void 0),\n            _jsx(\"div\", { style: { width: resizeHandleWidth } }, void 0),\n            _jsx(track.ReactComponent, __assign({ model: model }, track), void 0)] }), track.id));\n});\nvar TrackLabel = observer(function (_a) {\n    var name = _a.name, model = _a.model;\n    var ref = useRef(null);\n    var rowHeight = model.rowHeight, treeAreaWidth = model.treeAreaWidth;\n    var width = treeAreaWidth;\n    useEffect(function () {\n        var canvas = ref.current;\n        if (!canvas)\n            return;\n        var ctx = canvas.getContext('2d');\n        if (!ctx)\n            return;\n        ctx.resetTransform();\n        ctx.clearRect(0, 0, treeAreaWidth, rowHeight);\n        ctx.textAlign = 'right';\n        ctx.font = ctx.font.replace(/\\d+px/, Math.max(8, rowHeight - 7) + \"px\");\n        ctx.fillStyle = 'black';\n        ctx.fillText(name, width - 20, rowHeight - rowHeight / 8);\n    }, [name, width, treeAreaWidth, rowHeight]);\n    return (_jsx(\"canvas\", { ref: ref, width: width, height: rowHeight, style: {\n            width: width,\n            height: rowHeight,\n            position: 'relative',\n            overflow: 'hidden',\n        } }, void 0));\n});\nvar ResizeHandle = observer(function (_a) {\n    var model = _a.model;\n    var _b = useState(false), cropMouseDown = _b[0], setCropMouseDown = _b[1];\n    // this has the effect of just \"cropping\" the tree area\n    useEffect(function () {\n        if (cropMouseDown) {\n            var listener_1 = function (event) {\n                model.setTreeAreaWidth(model.treeAreaWidth + event.movementX);\n            };\n            var listener2_1 = function () { return setCropMouseDown(false); };\n            document.addEventListener('mousemove', listener_1);\n            document.addEventListener('mouseup', listener2_1);\n            return function () {\n                document.removeEventListener('mousemove', listener_1);\n                document.removeEventListener('mouseup', listener2_1);\n            };\n        }\n        return function () { };\n    }, [cropMouseDown, model]);\n    return (_jsx(\"div\", { children: _jsx(\"div\", { onMouseDown: function () { return setCropMouseDown(true); }, style: {\n                cursor: 'ew-resize',\n                height: '100%',\n                width: resizeHandleWidth,\n                background: \"rgba(200,200,200)\",\n                position: 'relative',\n            } }, void 0) }, void 0));\n});\nexport default observer(function (_a) {\n    var model = _a.model;\n    var done = model.done, initialized = model.initialized, treeAreaWidth = model.treeAreaWidth, height = model.height, tracks = model.tracks;\n    return !initialized ? (_jsx(ImportForm, { model: model }, void 0)) : !done ? (_jsx(Typography, __assign({ variant: \"h4\" }, { children: \"Loading...\" }), void 0)) : (_jsxs(\"div\", __assign({ style: { height: height, overflow: 'hidden' } }, { children: [_jsx(Header, { model: model }, void 0),\n            _jsxs(\"div\", { children: [_jsxs(\"div\", __assign({ style: { display: 'flex', height: 20 } }, { children: [_jsx(\"div\", __assign({ style: { overflow: 'hidden', width: treeAreaWidth } }, { children: _jsx(TreeRuler, { model: model }, void 0) }), void 0),\n                            _jsx(\"div\", { style: { width: resizeHandleWidth } }, void 0),\n                            _jsx(Ruler, { model: model }, void 0)] }), void 0),\n                    tracks === null || tracks === void 0 ? void 0 : tracks.map(function (track) {\n                        return _jsx(Track, { model: model, track: track }, track.id);\n                    }),\n                    _jsxs(\"div\", __assign({ style: { display: 'flex' } }, { children: [_jsx(\"div\", __assign({ style: { overflow: 'hidden', width: treeAreaWidth } }, { children: _jsx(TreeCanvas, { model: model }, void 0) }), void 0),\n                            _jsx(ResizeHandle, { model: model }, void 0),\n                            _jsx(MSACanvas, { model: model }, void 0)] }), void 0)] }, void 0)] }), void 0));\n});\n","import { parse } from 'clustal-js';\nvar ClustalMSA = /** @class */ (function () {\n    function ClustalMSA(text) {\n        this.MSA = parse(text);\n    }\n    ClustalMSA.prototype.getMSA = function () {\n        return this.MSA;\n    };\n    ClustalMSA.prototype.getRow = function (name) {\n        var _a;\n        return (_a = this.MSA.alns.find(function (aln) { return aln.id === name; })) === null || _a === void 0 ? void 0 : _a.seq.split('');\n    };\n    ClustalMSA.prototype.getWidth = function () {\n        return this.MSA.alns[0].seq.length;\n    };\n    ClustalMSA.prototype.getDetails = function () {\n        return this.MSA.header;\n    };\n    ClustalMSA.prototype.getNames = function () {\n        return this.MSA.alns.map(function (aln) { return aln.id; });\n    };\n    ClustalMSA.prototype.getStructures = function () {\n        return {};\n    };\n    Object.defineProperty(ClustalMSA.prototype, \"alignmentNames\", {\n        get: function () {\n            return [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ClustalMSA.prototype.getTree = function () {\n        return {\n            id: 'root',\n            noTree: true,\n            branchset: this.getNames().map(function (name) { return ({ id: name, name: name }); }),\n        };\n    };\n    Object.defineProperty(ClustalMSA.prototype, \"seqConsensus\", {\n        get: function () {\n            return this.MSA.consensus;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ClustalMSA.prototype, \"secondaryStructureConsensus\", {\n        get: function () {\n            return undefined;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ClustalMSA.prototype, \"tracks\", {\n        get: function () {\n            var _a;\n            return ((_a = this.seqConsensus) === null || _a === void 0 ? void 0 : _a.trim())\n                ? [\n                    {\n                        id: 'seqConsensus',\n                        name: 'Sequence consensus',\n                        data: this.seqConsensus,\n                        customColorScheme: {\n                            '*': 'white',\n                            ':': 'grey',\n                            '.': 'darkgrey',\n                            ' ': 'black',\n                        },\n                    },\n                ]\n                : [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ClustalMSA;\n}());\nexport default ClustalMSA;\n","/**\n * Newick format parser in JavaScript.\n *\n * Copyright (c) Jason Davies 2010.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n * Example tree (from http://en.wikipedia.org/wiki/Newick_format):\n *\n * +--0.1--A\n * F-----0.2-----B            +-------0.3----C\n * +------------------0.5-----E\n *                            +---------0.4------D\n *\n * Newick format:\n * (A:0.1,B:0.2,(C:0.3,D:0.4)E:0.5)F;\n *\n * Converted to JSON:\n * {\n *   name: \"F\",\n *   branchset: [\n *     {name: \"A\", length: 0.1},\n *     {name: \"B\", length: 0.2},\n *     {\n *       name: \"E\",\n *       length: 0.5,\n *       branchset: [\n *         {name: \"C\", length: 0.3},\n *         {name: \"D\", length: 0.4}\n *       ]\n *     }\n *   ]\n * }\n *\n * Converted to JSON, but with no names or lengths:\n * {\n *   branchset: [\n *     {}, {}, {\n *       branchset: [{}, {}]\n *     }\n *   ]\n * }\n */\nexport default function parse(s) {\n    var ancestors = [];\n    var tree = {};\n    var tokens = s.split(/\\s*(;|\\(|\\)|,|:)\\s*/);\n    for (var i = 0; i < tokens.length; i++) {\n        var token = tokens[i];\n        var subtree = {};\n        switch (token) {\n            case '(': // new branchset\n                tree.branchset = [subtree];\n                ancestors.push(tree);\n                tree = subtree;\n                break;\n            case ',': // another branch\n                ancestors[ancestors.length - 1].branchset.push(subtree);\n                tree = subtree;\n                break;\n            case ')': // optional name next\n                tree = ancestors.pop();\n                break;\n            case ':': // optional length next\n                break;\n            default: {\n                var x = tokens[i - 1];\n                if (x === ')' || x === '(' || x === ',') {\n                    tree.name = token;\n                }\n                else if (x === ':') {\n                    tree.length = parseFloat(token);\n                }\n            }\n        }\n    }\n    return tree;\n}\n","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport Stockholm from 'stockholm-js';\nimport parseNewick from '../parseNewick';\nimport { generateNodeIds } from '../util';\nvar StockholmMSA = /** @class */ (function () {\n    function StockholmMSA(text, currentAlignment) {\n        var res = Stockholm.parseAll(text);\n        this.data = res;\n        this.MSA = res[currentAlignment];\n    }\n    StockholmMSA.prototype.getMSA = function () {\n        return this.MSA;\n    };\n    StockholmMSA.prototype.getRow = function (name) {\n        var _a, _b;\n        return (_b = (_a = this.MSA) === null || _a === void 0 ? void 0 : _a.seqdata[name]) === null || _b === void 0 ? void 0 : _b.split('');\n    };\n    StockholmMSA.prototype.getWidth = function () {\n        var _a;\n        var name = Object.keys((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.seqdata)[0];\n        return this.getRow(name).length;\n    };\n    Object.defineProperty(StockholmMSA.prototype, \"alignmentNames\", {\n        get: function () {\n            return this.data.map(function (aln, index) { var _a; return ((_a = aln.gf.DE) === null || _a === void 0 ? void 0 : _a[0]) || \"Alignment \" + (index + 1); });\n        },\n        enumerable: false,\n        configurable: true\n    });\n    StockholmMSA.prototype.getDetails = function () {\n        var _a, _b;\n        return {\n            General: this.MSA.gf,\n            Accessions: (_a = this.MSA.gs) === null || _a === void 0 ? void 0 : _a.AC,\n            Dbxref: (_b = this.MSA.gs) === null || _b === void 0 ? void 0 : _b.DR,\n        };\n    };\n    StockholmMSA.prototype.getNames = function () {\n        return Object.keys(this.MSA.seqdata);\n    };\n    StockholmMSA.prototype.getSeqCoords = function () { };\n    StockholmMSA.prototype.getStructures = function () {\n        var _a;\n        var pdbRegex = /PDB; +(\\S+) +(\\S); ([0-9]+)-([0-9]+)/;\n        var ent = this.MSA;\n        return Object.entries(((_a = ent.gs) === null || _a === void 0 ? void 0 : _a.DR) || {})\n            .map(function (_a) {\n            var id = _a[0], dr = _a[1];\n            return [id, pdbRegex.exec(dr)];\n        })\n            .filter(function (item) { return !!item[1]; })\n            .map(function (_a) {\n            var id = _a[0], match = _a[1];\n            var pdb = match[1].toLowerCase();\n            var chain = match[2];\n            var startPos = +match[3];\n            var endPos = +match[4];\n            return { id: id, pdb: pdb, chain: chain, startPos: startPos, endPos: endPos };\n        })\n            .reduce(function (a, b) {\n            var id = b.id, rest = __rest(b, [\"id\"]);\n            if (!a[id]) {\n                a[id] = [];\n            }\n            a[id].push(rest);\n            return a;\n        }, {});\n    };\n    StockholmMSA.prototype.getTree = function () {\n        var _a, _b, _c;\n        var tree = (_c = (_b = (_a = this.MSA) === null || _a === void 0 ? void 0 : _a.gf) === null || _b === void 0 ? void 0 : _b.NH) === null || _c === void 0 ? void 0 : _c[0];\n        return tree\n            ? generateNodeIds(parseNewick(tree))\n            : {\n                id: 'root',\n                noTree: true,\n                branchset: this.getNames().map(function (name) { return ({\n                    id: name,\n                    name: name,\n                }); }),\n            };\n    };\n    Object.defineProperty(StockholmMSA.prototype, \"seqConsensus\", {\n        get: function () {\n            var _a;\n            return (_a = this.MSA.gc) === null || _a === void 0 ? void 0 : _a.seq_cons;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(StockholmMSA.prototype, \"secondaryStructureConsensus\", {\n        get: function () {\n            var _a;\n            return (_a = this.MSA.gc) === null || _a === void 0 ? void 0 : _a.SS_cons;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(StockholmMSA.prototype, \"tracks\", {\n        get: function () {\n            return [\n                {\n                    id: 'seqConsensus',\n                    name: 'Sequence consensus',\n                    data: this.seqConsensus,\n                    customColorScheme: {},\n                },\n                {\n                    id: 'secondaryStruct',\n                    name: 'Secondary-structure',\n                    data: this.secondaryStructureConsensus,\n                    customColorScheme: {\n                        '>': 'pink',\n                        '<': 'lightblue',\n                    },\n                },\n            ];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return StockholmMSA;\n}());\nexport default StockholmMSA;\n","var FastaMSA = /** @class */ (function () {\n    function FastaMSA(text) {\n        var seq = {};\n        var name = '';\n        var re = /^>(\\S+)/;\n        text.split('\\n').forEach(function (line) {\n            var match = re.exec(line);\n            if (match) {\n                seq[(name = match[1])] = '';\n            }\n            else if (name) {\n                seq[name] = seq[name] + line.replace(/[ \\t]/g, '');\n            }\n        });\n        this.MSA = { seqdata: seq };\n    }\n    FastaMSA.prototype.getMSA = function () {\n        return this.MSA;\n    };\n    FastaMSA.prototype.getNames = function () {\n        return Object.keys(this.MSA.seqdata);\n    };\n    FastaMSA.prototype.getRow = function (name) {\n        var _a, _b;\n        return (_b = (_a = this.MSA) === null || _a === void 0 ? void 0 : _a.seqdata[name]) === null || _b === void 0 ? void 0 : _b.split('');\n    };\n    FastaMSA.prototype.getWidth = function () {\n        var _a;\n        var name = Object.keys((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.seqdata)[0];\n        return this.getRow(name).length;\n    };\n    FastaMSA.prototype.getStructures = function () {\n        return {};\n    };\n    Object.defineProperty(FastaMSA.prototype, \"alignmentNames\", {\n        get: function () {\n            return [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    FastaMSA.prototype.getDetails = function () {\n        return {};\n    };\n    FastaMSA.prototype.getTree = function () {\n        return {\n            id: 'root',\n            noTree: true,\n            branchset: this.getNames().map(function (name) { return ({\n                id: name,\n                name: name,\n            }); }),\n        };\n    };\n    Object.defineProperty(FastaMSA.prototype, \"seqConsensus\", {\n        get: function () {\n            return undefined;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FastaMSA.prototype, \"secondaryStructureConsensus\", {\n        get: function () {\n            return undefined;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FastaMSA.prototype, \"tracks\", {\n        get: function () {\n            return [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return FastaMSA;\n}());\nexport default FastaMSA;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useRef, useMemo, useEffect } from 'react';\nimport { useTheme } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nvar AnnotationBlock = observer(function (_a) {\n    var data = _a.data, model = _a.model, offsetX = _a.offsetX, customColorScheme = _a.customColorScheme;\n    var blockSize = model.blockSize, scrollX = model.scrollX, bgColor = model.bgColor, modelColorScheme = model.colorScheme, colWidth = model.colWidth, rowHeight = model.rowHeight;\n    var colorScheme = customColorScheme || modelColorScheme;\n    var theme = useTheme();\n    var ref = useRef(null);\n    var colorContrast = useMemo(function () { return model.colorContrast(theme); }, [\n        model,\n        theme,\n    ]);\n    useEffect(function () {\n        if (!ref.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        // this logic is very similar to MSACanvas\n        ctx.resetTransform();\n        ctx.clearRect(0, 0, blockSize, rowHeight);\n        ctx.translate(-offsetX, 0);\n        ctx.textAlign = 'center';\n        ctx.font = ctx.font.replace(/\\d+px/, Math.max(8, rowHeight - 12) + \"px\");\n        var b = blockSize;\n        var xStart = Math.max(0, Math.floor(offsetX / colWidth));\n        var xEnd = Math.max(0, Math.ceil((offsetX + b) / colWidth));\n        var str = data === null || data === void 0 ? void 0 : data.slice(xStart, xEnd);\n        for (var i = 0; str && i < str.length; i++) {\n            var letter = str[i];\n            var color = colorScheme[letter.toUpperCase()];\n            if (bgColor) {\n                var x = i * colWidth + offsetX - (offsetX % colWidth);\n                ctx.fillStyle = color || 'white';\n                ctx.fillRect(x, 0, colWidth, rowHeight);\n                if (rowHeight >= 10 && colWidth >= rowHeight / 2) {\n                    ctx.fillStyle = colorContrast[letter.toUpperCase()] || 'black';\n                    ctx.fillText(letter, x + colWidth / 2, rowHeight / 2);\n                }\n            }\n        }\n    }, [\n        bgColor,\n        blockSize,\n        colWidth,\n        rowHeight,\n        offsetX,\n        data,\n        colorScheme,\n        colorContrast,\n    ]);\n    return (_jsx(\"canvas\", { ref: ref, height: rowHeight, width: blockSize, style: {\n            position: 'absolute',\n            left: scrollX + offsetX,\n            width: blockSize,\n            height: rowHeight,\n        } }, void 0));\n});\nvar AnnotationTrack = observer(function (_a) {\n    var data = _a.data, model = _a.model, customColorScheme = _a.customColorScheme;\n    var blocksX = model.blocksX, msaAreaWidth = model.msaAreaWidth, rowHeight = model.rowHeight;\n    return (_jsx(\"div\", __assign({ style: {\n            position: 'relative',\n            height: rowHeight,\n            width: msaAreaWidth,\n            overflow: 'hidden',\n        } }, { children: blocksX.map(function (bx) { return (_jsx(AnnotationBlock, { customColorScheme: customColorScheme, data: data, model: model, offsetX: bx }, bx)); }) }), void 0));\n});\nexport default AnnotationTrack;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { cast, types, addDisposer } from 'mobx-state-tree';\nimport { hierarchy, cluster } from 'd3-hierarchy';\nimport { ascending, max } from 'd3-array';\nimport { FileLocation, ElementId } from '@jbrowse/core/util/types/mst';\nimport { openLocation } from '@jbrowse/core/util/io';\nimport { autorun } from 'mobx';\nimport Color from 'color';\nimport BaseViewModel from '@jbrowse/core/pluggableElementTypes/models/BaseViewModel';\nimport Stockholm from 'stockholm-js';\nimport ClustalMSA from './parsers/ClustalMSA';\nimport StockholmMSA from './parsers/StockholmMSA';\nimport FastaMSA from './parsers/FastaMSA';\nimport parseNewick from './parseNewick';\nimport colorSchemes from './colorSchemes';\nimport { generateNodeIds, transform } from './util';\nimport AnnotationTrack from './components/Annotations';\nfunction setBrLength(d, y0, k) {\n    //@ts-ignore\n    d.len = (y0 += Math.max(d.data.length || 0, 0)) * k;\n    if (d.children) {\n        d.children.forEach(function (d) {\n            setBrLength(d, y0, k);\n        });\n    }\n}\nfunction maxLength(d) {\n    return (d.data.length || 1) + (d.children ? max(d.children, maxLength) : 0);\n}\n// note: we don't use this.root because it won't update in response to changes\n// in realWidth/totalHeight here otherwise, needs to generate a new object\nfunction getRoot(tree) {\n    return hierarchy(tree, function (d) { return d.branchset; })\n        .sum(function (d) { return (d.branchset ? 0 : 1); })\n        .sort(function (a, b) { return ascending(a.data.length || 1, b.data.length || 1); });\n}\nfunction filter(tree, collapsed) {\n    var branchset = tree.branchset, rest = __rest(tree, [\"branchset\"]);\n    if (collapsed.includes(tree.id)) {\n        return rest;\n    }\n    else if (branchset) {\n        return __assign(__assign({}, rest), { branchset: branchset.map(function (b) { return filter(b, collapsed); }) });\n    }\n    else {\n        return tree;\n    }\n}\nfunction clamp(min, num, max) {\n    return Math.min(Math.max(num, min), max);\n}\nvar StructureModel = types.model({\n    id: types.identifier,\n    structure: types.model({\n        pdb: types.string,\n        startPos: types.number,\n        endPos: types.number,\n    }),\n    range: types.maybe(types.string),\n});\nvar model = types.snapshotProcessor(types\n    .compose(BaseViewModel, types\n    .model('MsaView', {\n    id: ElementId,\n    type: types.literal('MsaView'),\n    height: types.optional(types.number, 550),\n    treeAreaWidth: types.optional(types.number, 400),\n    treeWidth: types.optional(types.number, 300),\n    rowHeight: 20,\n    scrollY: 0,\n    scrollX: 0,\n    blockSize: 1000,\n    mouseRow: types.maybe(types.number),\n    mouseCol: types.maybe(types.number),\n    selectedStructures: types.array(StructureModel),\n    labelsAlignRight: false,\n    colWidth: 16,\n    showBranchLen: true,\n    bgColor: true,\n    drawTree: true,\n    drawNodeBubbles: true,\n    colorSchemeName: 'maeditor',\n    treeFilehandle: types.maybe(FileLocation),\n    msaFilehandle: types.maybe(FileLocation),\n    currentAlignment: 0,\n    collapsed: types.array(types.string),\n    data: types.optional(types\n        .model({\n        tree: types.maybe(types.string),\n        msa: types.maybe(types.string),\n    })\n        .actions(function (self) { return ({\n        setTree: function (tree) {\n            self.tree = tree;\n        },\n        setMSA: function (msa) {\n            self.msa = msa;\n        },\n    }); }), { tree: '', msa: '' }),\n})\n    .volatile(function () { return ({\n    error: undefined,\n    margin: { left: 20, top: 20 },\n}); }))\n    .actions(function (self) { return ({\n    addStructureToSelection: function (elt) {\n        self.selectedStructures.push(elt);\n    },\n    removeStructureFromSelection: function (elt) {\n        var r = self.selectedStructures.find(function (node) { return node.id === elt.id; });\n        if (r) {\n            self.selectedStructures.remove(r);\n        }\n    },\n    toggleStructureSelection: function (elt) {\n        var r = self.selectedStructures.find(function (node) { return node.id === elt.id; });\n        if (r) {\n            self.selectedStructures.remove(r);\n        }\n        else {\n            self.selectedStructures.push(elt);\n        }\n    },\n    clearSelectedStructures: function () {\n        //@ts-ignore\n        self.selectedStructures = [];\n    },\n    setError: function (error) {\n        console.error(error);\n        self.error = error;\n    },\n    setMousePos: function (col, row) {\n        self.mouseCol = col;\n        self.mouseRow = row;\n    },\n    setRowHeight: function (n) {\n        self.rowHeight = n;\n    },\n    setColWidth: function (n) {\n        self.colWidth = n;\n    },\n    setColorSchemeName: function (name) {\n        self.colorSchemeName = name;\n    },\n    setScrollY: function (n) {\n        self.scrollY = n;\n    },\n    setScrollX: function (n) {\n        self.scrollX = n;\n    },\n    setTreeAreaWidth: function (n) {\n        self.treeAreaWidth = n;\n    },\n    setTreeWidth: function (n) {\n        self.treeWidth = n;\n    },\n    setCurrentAlignment: function (n) {\n        self.currentAlignment = n;\n    },\n    toggleLabelsAlignRight: function () {\n        self.labelsAlignRight = !self.labelsAlignRight;\n    },\n    toggleDrawTree: function () {\n        self.drawTree = !self.drawTree;\n    },\n    toggleCollapsed: function (node) {\n        if (self.collapsed.includes(node)) {\n            self.collapsed.remove(node);\n        }\n        else {\n            self.collapsed.push(node);\n        }\n    },\n    toggleBranchLen: function () {\n        self.showBranchLen = !self.showBranchLen;\n    },\n    toggleBgColor: function () {\n        self.bgColor = !self.bgColor;\n    },\n    toggleNodeBubbles: function () {\n        self.drawNodeBubbles = !self.drawNodeBubbles;\n    },\n    setData: function (data) {\n        self.data = cast(data);\n    },\n    setMSAFilehandle: function (msaFilehandle) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                self.error = undefined;\n                self.msaFilehandle = msaFilehandle;\n                return [2 /*return*/];\n            });\n        });\n    },\n    setTreeFilehandle: function (treeFilehandle) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        self.error = undefined;\n                        if (!(treeFilehandle && 'blobId' in treeFilehandle)) return [3 /*break*/, 2];\n                        _a = this.setTree;\n                        return [4 /*yield*/, openLocation(treeFilehandle).readFile('utf8')];\n                    case 1:\n                        _a.apply(this, [(_b.sent())]);\n                        return [3 /*break*/, 3];\n                    case 2:\n                        self.treeFilehandle = treeFilehandle;\n                        _b.label = 3;\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    },\n    setMSA: function (result) {\n        self.data.setMSA(result);\n    },\n    setTree: function (result) {\n        self.data.setTree(result);\n    },\n    afterCreate: function () {\n        var _this = this;\n        addDisposer(self, autorun(function () { return __awaiter(_this, void 0, void 0, function () {\n            var treeFilehandle, _a, e_1;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        treeFilehandle = self.treeFilehandle;\n                        if (!treeFilehandle) return [3 /*break*/, 4];\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 3, , 4]);\n                        _a = this.setTree;\n                        return [4 /*yield*/, openLocation(treeFilehandle).readFile('utf8')];\n                    case 2:\n                        _a.apply(this, [(_b.sent())]);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _b.sent();\n                        this.setError(e_1);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); }));\n        addDisposer(self, autorun(function () { return __awaiter(_this, void 0, void 0, function () {\n            var msaFilehandle, _a, e_2;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        msaFilehandle = self.msaFilehandle;\n                        if (!msaFilehandle) return [3 /*break*/, 4];\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 3, , 4]);\n                        _a = this.setMSA;\n                        return [4 /*yield*/, openLocation(msaFilehandle).readFile('utf8')];\n                    case 2:\n                        _a.apply(this, [(_b.sent())]);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_2 = _b.sent();\n                        this.setError(e_2);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); }));\n    },\n}); })\n    .views(function (self) {\n    var oldBlocksX = [];\n    var oldBlocksY = [];\n    var oldValX = 0;\n    var oldValY = 0;\n    return {\n        get initialized() {\n            return ((self.data.msa ||\n                self.data.tree ||\n                self.msaFilehandle ||\n                self.treeFilehandle) &&\n                !self.error);\n        },\n        get blocksX() {\n            var scrollX = self.scrollX, size = self.blockSize, colWidth = self.colWidth;\n            var ret = -(size * Math.floor(scrollX / size)) - size;\n            var b = [];\n            for (var i = ret; i < ret + size * 3; i += size) {\n                if (i + size > 0) {\n                    b.push(i);\n                }\n            }\n            if (JSON.stringify(b) !== JSON.stringify(oldBlocksX) ||\n                colWidth !== oldValX) {\n                oldBlocksX = b;\n                oldValX = colWidth;\n            }\n            return oldBlocksX;\n        },\n        get blocksY() {\n            var scrollY = self.scrollY, size = self.blockSize, rowHeight = self.rowHeight;\n            var ret = -(size * Math.floor(scrollY / size)) - 2 * size;\n            var b = [];\n            for (var i = ret; i < ret + size * 3; i += size) {\n                if (i + size > 0) {\n                    b.push(i);\n                }\n            }\n            if (JSON.stringify(b) !== JSON.stringify(oldBlocksY) ||\n                rowHeight !== oldValY) {\n                oldBlocksY = b;\n                oldValY = rowHeight;\n            }\n            return oldBlocksY;\n        },\n    };\n})\n    .views(function (self) { return ({\n    get blocks2d() {\n        return self.blocksY\n            .map(function (by) { return self.blocksX.map(function (bx) { return [bx, by]; }); })\n            .flat();\n    },\n    get done() {\n        return self.initialized && (self.data.msa || self.data.tree);\n    },\n    get colorScheme() {\n        return colorSchemes[self.colorSchemeName];\n    },\n    colorContrast: function (theme) {\n        return transform(this.colorScheme, function (_a) {\n            var letter = _a[0], color = _a[1];\n            return [\n                letter,\n                theme.palette.getContrastText(Color(color).hex()),\n            ];\n        });\n    },\n    get alignmentDetails() {\n        var _a;\n        return ((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getDetails()) || {};\n    },\n    get currentAlignmentName() {\n        return this.alignmentNames[self.currentAlignment];\n    },\n    get alignmentNames() {\n        var _a;\n        return ((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.alignmentNames) || [];\n    },\n    get noTree() {\n        return !!this.tree.noTree;\n    },\n    get menuItems() {\n        return [];\n    },\n    get MSA() {\n        var text = self.data.msa;\n        if (text) {\n            if (Stockholm.sniff(text)) {\n                return new StockholmMSA(text, self.currentAlignment);\n            }\n            else if (text.startsWith('>')) {\n                return new FastaMSA(text);\n            }\n            else {\n                return new ClustalMSA(text);\n            }\n        }\n        return null;\n    },\n    get numColumns() {\n        var _a;\n        return (((((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getWidth()) || 0) - this.blanks.length) * self.colWidth);\n    },\n    get tree() {\n        var _a;\n        var tree = self.data.tree, collapsed = self.collapsed;\n        var t = tree\n            ? generateNodeIds(parseNewick(tree))\n            : (_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getTree();\n        return t ? filter(t, collapsed) : { noTree: true };\n    },\n    get rowNames() {\n        return this.hierarchy\n            .leaves()\n            .map(function (node) { return node.data.name; });\n    },\n    get mouseOverRowName() {\n        return self.mouseRow !== undefined\n            ? this.rowNames[self.mouseRow]\n            : undefined;\n    },\n    getMouseOverResidue: function (rowName) {\n        return this.columns[rowName];\n    },\n    get root() {\n        return getRoot(this.tree);\n    },\n    get structures() {\n        var _a;\n        return ((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getStructures()) || {};\n    },\n    get inverseStructures() {\n        return Object.fromEntries(Object.entries(this.structures)\n            .map(function (_a) {\n            var key = _a[0], val = _a[1];\n            return val.map(function (pdbEntry) { return [\n                pdbEntry.pdb,\n                {\n                    id: key,\n                },\n            ]; });\n        })\n            .flat());\n    },\n    get msaAreaWidth() {\n        //@ts-ignore\n        return self.width - self.treeAreaWidth;\n    },\n    get blanks() {\n        var _this = this;\n        var _a;\n        var blanks = [];\n        var strs = this.hierarchy\n            .leaves()\n            .map(function (_a) {\n            var _b;\n            var data = _a.data;\n            return (_b = _this.MSA) === null || _b === void 0 ? void 0 : _b.getRow(data.name);\n        })\n            .filter(function (item) { return !!item; });\n        for (var i = 0; i < ((_a = strs[0]) === null || _a === void 0 ? void 0 : _a.length); i++) {\n            var counter = 0;\n            for (var j = 0; j < strs.length; j++) {\n                if (strs[j][i] === '-') {\n                    counter++;\n                }\n            }\n            if (counter === strs.length) {\n                blanks.push(i);\n            }\n        }\n        return blanks;\n    },\n    get columns() {\n        var _this = this;\n        var rows = this.hierarchy\n            .leaves()\n            .map(function (_a) {\n            var _b;\n            var data = _a.data;\n            return [data.name, (_b = _this.MSA) === null || _b === void 0 ? void 0 : _b.getRow(data.name)];\n        })\n            .filter(function (f) { return !!f[1]; });\n        var strs = rows.map(function (row) { return row[1]; });\n        var ret = [];\n        for (var i = 0; i < strs.length; i++) {\n            var s = '';\n            var b = 0;\n            for (var j = 0; j < strs[i].length; j++) {\n                if (j === this.blanks[b]) {\n                    b++;\n                }\n                else {\n                    s += strs[i][j];\n                }\n            }\n            ret.push(s);\n        }\n        return Object.fromEntries(rows.map(function (row, index) { return [row[0], ret[index]]; }));\n    },\n    // generates a new tree that is clustered with x,y positions\n    get hierarchy() {\n        var root = getRoot(this.tree);\n        var clust = cluster()\n            .size([this.totalHeight, self.treeWidth])\n            .separation(function () { return 1; });\n        clust(root);\n        setBrLength(root, (root.data.length = 0), self.treeWidth / maxLength(root));\n        return root;\n    },\n    get totalHeight() {\n        return this.root.leaves().length * self.rowHeight;\n    },\n}); })\n    .actions(function (self) { return ({\n    doScrollY: function (deltaY) {\n        self.scrollY = clamp(-self.totalHeight + 10, self.scrollY + deltaY, 0);\n    },\n    doScrollX: function (deltaX) {\n        self.scrollX = clamp(-self.numColumns + (self.msaAreaWidth - 100), self.scrollX + deltaX, 0);\n    },\n    setMouseoveredColumn: function (n, chain, file) {\n        var _a;\n        var j = 0;\n        var i = 0;\n        var id = (self.inverseStructures[file.slice(0, -4)] || {}).id;\n        var row = (_a = self.MSA) === null || _a === void 0 ? void 0 : _a.getRow(id);\n        if (row) {\n            for (i = 0; i < row.length && j < n; i++) {\n                if (row[i] !== '-') {\n                    j++;\n                }\n            }\n            self.mouseCol = j + 1;\n        }\n        else {\n            self.mouseCol = undefined;\n        }\n    },\n}); })\n    .views(function (self) { return ({\n    get secondaryStructureConsensus() {\n        var _a;\n        return (_a = self.MSA) === null || _a === void 0 ? void 0 : _a.secondaryStructureConsensus;\n    },\n    get seqConsensus() {\n        var _a;\n        return (_a = self.MSA) === null || _a === void 0 ? void 0 : _a.seqConsensus;\n    },\n    get tracks() {\n        var _a;\n        return (((_a = self.MSA) === null || _a === void 0 ? void 0 : _a.tracks.map(function (track) { return (__assign(__assign({}, track), { ReactComponent: AnnotationTrack })); })) || []);\n    },\n}); }), {\n    postProcessor: function (result) {\n        var _a = result.data, tree = _a.tree, msa = _a.msa, rest = __rest(result, [\"data\"]);\n        return __assign({ data: __assign(__assign({}, (!result.treeFilehandle && { tree: tree })), (!result.msaFilehandle && { msa: msa })) }, rest);\n    },\n});\nexport default model;\n","import { MSAModel } from \"react-msaview\";\nimport { types, Instance } from \"mobx-state-tree\";\n\nconst App = types\n  .model({\n    msaview: MSAModel,\n    nglSelection: types.optional(types.string, \"\"),\n  })\n  .actions((self) => ({\n    setNGLSelection(sel: any) {\n      self.nglSelection = sel;\n    },\n  }));\n\nexport default App;\nexport type AppModel = Instance<typeof App>;\n","import React, { useCallback, useState, useEffect } from \"react\";\nimport { observer } from \"mobx-react\";\nimport { Button, Select, MenuItem, TextField } from \"@material-ui/core\";\nimport { Stage, StaticDatasource, DatasourceRegistry } from \"ngl\";\n\nDatasourceRegistry.add(\n  \"data\",\n  new StaticDatasource(\"https://files.rcsb.org/download/\")\n);\n\nexport const ProteinPanel = observer(({ model }) => {\n  const [type, setType] = useState(\"cartoon\");\n  const [res, setRes] = useState([]);\n  const [annotation, setAnnotation] = useState();\n  const [stage, setStage] = useState();\n  const [isMouseHovering, setMouseHovering] = useState(false);\n  const { msaview, nglSelection } = model;\n  const { selectedStructures, mouseCol } = msaview;\n\n  const stageElementRef = useCallback((element) => {\n    if (element) {\n      const currentStage = new Stage(element);\n      setStage(currentStage);\n    }\n  }, []);\n\n  useEffect(() => {\n    return () => {\n      if (stage) {\n        stage.dispose();\n      }\n    };\n  }, [stage]);\n\n  useEffect(() => {\n    if (!selectedStructures.length || !stage) {\n      return;\n    }\n    (async () => {\n      // Handle window resizing\n      window.addEventListener(\"resize\", () => {\n        stage.handleResize();\n      });\n\n      const res = await Promise.all(\n        selectedStructures.map((selection) => {\n          return stage.loadFile(`data://${selection.structure.pdb}.pdb`);\n        })\n      );\n      setRes(res);\n\n      stage.signals.hovered.add((pickingProxy) => {\n        if (pickingProxy && (pickingProxy.atom || pickingProxy.bond)) {\n          const atom = pickingProxy.atom || pickingProxy.closestBondAtom;\n          msaview.setMouseoveredColumn(\n            atom.resno - selectedStructures[0].structure.startPos,\n            atom.chainname,\n            pickingProxy.picker.structure.name\n          );\n        }\n      });\n    })();\n  }, [JSON.stringify(selectedStructures), stage]);\n\n  useEffect(() => {\n    if (stage) {\n      res.forEach((elt) => {\n        elt.removeAllRepresentations();\n        elt.addRepresentation(type, { sele: nglSelection });\n      });\n      stage.autoView();\n    }\n  }, [type, res, stage, nglSelection]);\n\n  useEffect(() => {\n    if (!isMouseHovering) {\n      const annots = [];\n      res.forEach((elt, index) => {\n        if (annotation) {\n          elt.removeAnnotation(annotation[index]);\n        }\n        if (mouseCol !== undefined) {\n          const { startPos } = selectedStructures[0].structure;\n\n          let k;\n          const rn = elt.structure.residueStore.count;\n          const rp = elt.structure.getResidueProxy();\n          for (let i = 0; i < rn; ++i) {\n            rp.index = i;\n            if (rp.resno === mouseCol + startPos - 1) {\n              k = rp;\n              break;\n            }\n          }\n\n          if (k) {\n            const ap = elt.structure.getAtomProxy();\n            ap.index = k.atomOffset;\n\n            annots.push(\n              elt.addAnnotation(ap.positionToVector3(), k.qualifiedName())\n            );\n          }\n        }\n        stage.viewer.requestRender();\n      });\n      setAnnotation(annots);\n    }\n  }, [model, mouseCol, isMouseHovering]);\n\n  return selectedStructures.length ? (\n    <div style={{ padding: 20 }}>\n      <div style={{ display: \"flex\", alignItems: \"center\" }}>\n        <Button onClick={() => msaview.clearSelection()} variant=\"contained\">\n          Clear\n        </Button>\n\n        <div style={{ width: 20 }} />\n        <Select value={type} onChange={(event) => setType(event.target.value)}>\n          <MenuItem value={\"cartoon\"}>cartoon</MenuItem>\n          <MenuItem value={\"ball+stick\"}>ball+stick</MenuItem>\n        </Select>\n        <div style={{ width: 20 }} />\n        <TextField\n          variant=\"outlined\"\n          label=\"Selection\"\n          value={nglSelection}\n          onChange={(event) => model.setNGLSelection(event.target.value)}\n        />\n      </div>\n\n      <div\n        ref={stageElementRef}\n        style={{ width: 600, height: 400 }}\n        onMouseEnter={() => setMouseHovering(true)}\n        onMouseLeave={() => setMouseHovering(false)}\n      />\n    </div>\n  ) : null;\n});\n","import React from \"react\";\nimport { observer } from \"mobx-react\";\nimport { onSnapshot } from \"mobx-state-tree\";\nimport { MSAView } from \"react-msaview\";\nimport { createJBrowseTheme } from \"@jbrowse/core/ui/theme\";\nimport { ThemeProvider } from \"@material-ui/core/styles\";\nimport { throttle } from \"lodash\";\nimport AppGlobal, { AppModel } from \"./model\";\n\nimport { ProteinPanel } from \"./ProteinPanel\";\n\nconst urlParams = new URLSearchParams(window.location.search);\nconst val = urlParams.get(\"data\");\n\nconst mymodel = AppGlobal.create(\n  val ? JSON.parse(val) : { msaview: { type: \"MsaView\" } }\n);\n\nmymodel.msaview.setWidth(window.innerWidth);\n\nonSnapshot(\n  mymodel,\n  throttle((snap) => {\n    const url = new URL(window.document.URL);\n    url.searchParams.set(\"data\", JSON.stringify(snap));\n    window.history.replaceState(null, \"\", url.toString());\n  }, 500)\n);\n\n// Handle window resizing\nwindow.addEventListener(\"resize\", () => {\n  mymodel.msaview.setWidth(window.innerWidth);\n});\n\nconst App = observer(({ model }: { model: AppModel }) => {\n  const { msaview } = model;\n  return (\n    <div>\n      <div style={{ border: \"1px solid black\", margin: 20 }}>\n        <MSAView model={msaview} />\n      </div>\n      <ProteinPanel model={model} />\n    </div>\n  );\n});\n\nconst MainApp = () => {\n  const theme = createJBrowseTheme();\n  return (\n    <ThemeProvider theme={theme}>\n      <App model={mymodel} />\n    </ThemeProvider>\n  );\n};\n\nexport default MainApp;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}