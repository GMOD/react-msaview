(this.webpackJsonpapp2=this.webpackJsonpapp2||[]).push([[0],{453:function(e){e.exports=JSON.parse('{"a":"1.2.4"}')},478:function(e,t,n){},529:function(e,t){},738:function(e,t){},740:function(e,t){},751:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),i=n(20),a=n.n(i),c=(n(478),n(15)),s=n(9),l=n(4),u=n(128),d=n(789),f=n(785),h=n(788),v=n(81),b=n(8),j=n(149),p=function(){return(p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},m=function(e){var t=e.onClick,n=e.model,r=e.children;return Object(l.jsx)("li",{children:Object(l.jsx)(d.a,p({onClick:function(){n.setError(void 0),t()},href:"#"},{children:Object(l.jsx)(u.a,{children:r},void 0)}),void 0)},void 0)},g=Object(c.observer)((function(e){var t=e.model,n=Object(r.useState)(),o=n[0],i=n[1],a=Object(r.useState)(),c=a[0],s=a[1],d=t.error;return Object(l.jsxs)(f.a,{children:[Object(l.jsxs)("div",p({style:{width:"50%"}},{children:[d?Object(l.jsx)("div",p({style:{padding:20}},{children:Object(l.jsxs)(u.a,p({color:"error"},{children:["Error: ",""+d]}),void 0)}),void 0):null,Object(l.jsx)(u.a,{children:"Open an MSA file (stockholm or clustal format) and/or a tree file (newick format)."},void 0),Object(l.jsx)(u.a,p({color:"error"},{children:"Note: you can open up just an MSA or just a tree, both are not required. Some MSA files e.g. stockholm format have an embedded tree also and this is fine, and opening a separate tree file is not required."}),void 0)]}),void 0),Object(l.jsxs)(h.a,p({container:!0,spacing:10,justify:"center",alignItems:"center"},{children:[Object(l.jsxs)(h.a,p({item:!0},{children:[Object(l.jsx)(u.a,{children:"MSA file or URL"},void 0),Object(l.jsx)(j.FileSelector,{location:o,setLocation:i},void 0),Object(l.jsx)(u.a,{children:"Tree file or URL"},void 0),Object(l.jsx)(j.FileSelector,{location:c,setLocation:s},void 0)]}),void 0),Object(l.jsx)(h.a,p({item:!0},{children:Object(l.jsx)(v.a,p({onClick:function(){t.setError(void 0),o&&t.setMSAFilehandle(o),c&&t.setTreeFilehandle(c)},variant:"contained",color:"primary",disabled:!o&&!c},{children:"Open"}),void 0)}),void 0),Object(l.jsxs)(h.a,p({item:!0},{children:[Object(l.jsx)(u.a,{children:"Examples"},void 0),Object(l.jsxs)("ul",{children:[Object(l.jsx)(m,p({model:t,onClick:function(){t.setTreeFilehandle({uri:"https://jbrowse.org/genomes/newick_trees/sarscov2phylo.pub.ft.nh"})}},{children:"230k COVID-19 samples (tree only)"}),void 0),Object(l.jsx)(m,p({model:t,onClick:function(){t.setData({msa:"CLUSTAL O(1.2.3) multiple sequence alignment\nUniProt/Swiss-Prot|P26898|IL2RA_SHEEP      MEPSLLMWRFFVFIVVPGCVTEACHDDPPSLRNA----------MFKVLRYE----VGTM\nUniProt/Swiss-Prot|P01590|IL2RA_MOUSE      MEPRLLMLGFLSLTIVPSCRAELCLYDPPEVPNA----------TFKALSYK----NGTI\nUniProt/Swiss-Prot|P41690|IL2RA_FELCA      MEPSLLLWGILTFVVVHGHVTELCDENPPDIQHA----------TFKALTYK----TGTM\nUniProt/Swiss-Prot|P01589|IL2RA_HUMAN      MDSYLLMWGLLTFIMVPGCQAELCDDDPPEIPHA----------TFKAMAYK----EGTM\nUniProt/Swiss-Prot|Q5MNY4|IL2RA_MACMU      MDPYLLMWGLLTFITVPGCQAELCDDDPPKITHA----------TFKAVAYK----EGTM\nUniProt/Swiss-Prot|Q95118|IL2RG_BOVIN      -----------------------------------LLMWGLLT-----------------\nUniProt/Swiss-Prot|P40321|IL2RG_CANFA      MLKPPLPLRSLLFLQLSLLGVGLNSTVPMPNGNEDIT------PDFFLTATPSETLSVSS\nUniProt/Swiss-Prot|P26896|IL2RB_RAT        MATVDLSWRLPLYILLLLLATT--------------------------------WVSAAV\nUniProt/Swiss-Prot|Q8BZM1|GLMN_MOUSE       PLPLRSLLFLQLPLLGVGLNP------------------PLPLRSLLFLQLPLLGVGLNP\nUniProt/Swiss-Prot|P36835|IL2_CAPHI        -----------LLGVGLNPKFLTP------------------------------------\nUniProt/Swiss-Prot|Q7JFM4|IL2_AOTVO        MLKPPLPLRSLLFLQLPLLGVGLNPKFLTPSGNEDIGGKPGTGGDFFLTSTPAGTLDVST\nUniProt/Swiss-Prot|Q29416|IL2_CANFA        --------------LFLQLSLLG-------------------------------------\n",tree:"(((UniProt/Swiss-Prot|P26898|IL2RA_SHEEP:0.24036,(UniProt/Swiss-Prot|P41690|IL2RA_FELCA:0.17737,(UniProt/Swiss-Prot|P01589|IL2RA_HUMAN:0.03906,UniProt/Swiss-Prot|Q5MNY4|IL2RA_MACMU:0.03787):0.13033):0.04964):0.02189,UniProt/Swiss-Prot|P01590|IL2RA_MOUSE:0.23072):0.06814,(((UniProt/Swiss-Prot|Q95118|IL2RG_BOVIN:0.09600,UniProt/Swiss-Prot|P40321|IL2RG_CANFA:0.09845):0.25333,UniProt/Swiss-Prot|Q29416|IL2_CANFA:-0.35055):0.10231,(UniProt/Swiss-Prot|P26896|IL2RB_RAT:0.33631,UniProt/Swiss-Prot|Q7JFM4|IL2_AOTVO:-0.33631):0.10166):0.01607,(UniProt/Swiss-Prot|Q8BZM1|GLMN_MOUSE:0.32378,UniProt/Swiss-Prot|P36835|IL2_CAPHI:-0.32378):0.09999)"})}},{children:"Small protein MSA+tree"}),void 0),Object(l.jsx)(m,p({model:t,onClick:function(){t.setData({msa:"CLUSTAL O(1.2.4) multiple sequence alignment\n\n\nsp|P69905|HBA_HUMAN       MVLSPADKTNVKAAWGKVGAHAGEYGAEALERMFLSFPTTKTYFPHFDLSHGSAQVKGHG\t60\nsp|P01942|HBA_MOUSE       MVLSGEDKSNIKAAWGKIGGHGAEYGAEALERMFASFPTTKTYFPHFDVSHGSAQVKGHG\t60\nsp|P13786|HBAZ_CAPHI      MSLTRTERTIILSLWSKISTQADVIGTETLERLFSCYPQAKTYFPHFDLHSGSAQLRAHG\t60\n                          * *:  ::: : : *.*:. :.   *:*:***:* .:* :********:  ****::.**\n\nsp|P69905|HBA_HUMAN       KKVADALTNAVAHVDDMPNALSALSDLHAHKLRVDPVNFKLLSHCLLVTLAAHLPAEFTP\t120\nsp|P01942|HBA_MOUSE       KKVADALASAAGHLDDLPGALSALSDLHAHKLRVDPVNFKLLSHCLLVTLASHHPADFTP\t120\nsp|P13786|HBAZ_CAPHI      SKVVAAVGDAVKSIDNVTSALSKLSELHAYVLRVDPVNFKFLSHCLLVTLASHFPADFTA\t120\n                          .**. *: .*.  :*:: .*** **:***: *********:**********:* **:**\n\nsp|P69905|HBA_HUMAN       AVHASLDKFLASVSTVLTSKYR\t142\nsp|P01942|HBA_MOUSE       AVHASLDKFLASVSTVLTSKYR\t142\nsp|P13786|HBAZ_CAPHI      DAHAAWDKFLSIVSGVLTEKYR\t142\n                           .**: ****: ** ***.***"})}},{children:"Small MSA only"}),void 0),Object(l.jsx)(m,p({model:t,onClick:function(){t.setMSAFilehandle({uri:"https://ihh.github.io/abrowse/build/pfam-cov2.stock"})}},{children:"PFAM SARS-CoV2 multi-stockholm"}),void 0),Object(l.jsx)(m,p({model:t,onClick:function(){t.setMSAFilehandle({uri:"https://jbrowse.org/genomes/multiple_sequence_alignments/Lysine.stock"})}},{children:"Lysine stockholm file"}),void 0),Object(l.jsx)(m,p({model:t,onClick:function(){t.setMSAFilehandle({uri:"https://jbrowse.org/genomes/multiple_sequence_alignments/PF01601_full.txt"})}},{children:"PF01601 stockholm file (SARS-CoV2 spike protein)"}),void 0),Object(l.jsx)(m,p({model:t,onClick:function(){t.setMSAFilehandle({uri:"https://jbrowse.org/genomes/multiple_sequence_alignments/europe_covid.fa"})}},{children:"Europe COVID full genomes (LR883044.1 and 199 other sequences)"}),void 0),Object(l.jsx)(m,p({model:t,onClick:function(){Object(b.transaction)((function(){t.setMSAFilehandle({uri:"https://jbrowse.org/genomes/multiple_sequence_alignments/rhv_test-only.aligned_with_mafft_auto.fa"}),t.setTreeFilehandle({uri:"https://jbrowse.org/genomes/multiple_sequence_alignments/rhv_test-only.aligned_with_mafft_auto.nh"})}))}},{children:"MAFFT+VeryFastTree(17.9k samples)"}),void 0)]},void 0)]}),void 0)]}),void 0)]},void 0)})),O=n(371),x=n(10),S=n(292),y=n(767),w=n(203),A=n.n(w),L=function(){return(L=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},P=Object(O.a)((function(e){return{rubberband:{height:"100%",background:e.palette.tertiary?Object(x.a)(e.palette.tertiary.main,.7):Object(x.a)(e.palette.primary.main,.7),position:"absolute",zIndex:10,textAlign:"center",overflow:"hidden"},rubberbandControl:{cursor:"crosshair",width:"100%",minHeight:8},rubberbandText:{color:e.palette.tertiary?e.palette.tertiary.contrastText:e.palette.primary.contrastText},popover:{mouseEvents:"none",cursor:"crosshair"},paper:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},guide:{pointerEvents:"none",height:"100%",width:1,position:"absolute",zIndex:10}}})),C=Object(c.observer)((function(e){var t=e.model,n=e.coordX,r=t.treeAreaWidth,o=P();return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(S.a,L({open:!0,placement:"top",title:""+(t.pxToBp(n)+1),arrow:!0},{children:Object(l.jsx)("div",{style:{left:n+r,position:"absolute",height:1}},void 0)}),void 0),Object(l.jsx)("div",{className:o.guide,style:{left:n+r,background:"red"}},void 0)]},void 0)}));var T=Object(c.observer)((function(e){var t=e.model,n=e.ControlComponent,o=void 0===n?Object(l.jsx)("div",{},void 0):n,i=t.treeAreaWidth,a=Object(r.useState)(),c=a[0],s=a[1],d=Object(r.useState)(),f=d[0],h=d[1],v=Object(r.useState)(),b=v[0],p=v[1],m=Object(r.useState)(),g=m[0],O=m[1],x=Object(r.useRef)(null),S=Object(r.useRef)(null),w=P(),T=void 0!==c&&void 0===b;function M(e){e.preventDefault(),e.stopPropagation();var t=e.clientX-e.target.getBoundingClientRect().left;s(t),h(t)}function R(e){var t=e.target;O(e.clientX-t.getBoundingClientRect().left)}function E(){O(void 0),t.clearAnnotPos()}function k(){p(void 0),s(void 0),h(void 0)}if(Object(r.useEffect)((function(){function e(e){if(x.current&&T){var t=e.clientX-x.current.getBoundingClientRect().left;h(t)}}function t(e){if(void 0!==c&&x.current){var t=e.clientX,n=e.clientY,r=t-x.current.getBoundingClientRect().left;p({offsetX:r,clientX:t,clientY:n}),O(void 0)}}return T?(window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),function(){window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}):function(){}}),[c,T,b]),Object(r.useEffect)((function(){!T&&void 0!==f&&void 0!==c&&Math.abs(f-c)<=3&&k()}),[T,f,c,t.colWidth]),void 0===c)return Object(l.jsxs)(l.Fragment,{children:[void 0!==g?Object(l.jsx)(C,{model:t,coordX:g},void 0):null,Object(l.jsx)("div",L({"data-testid":"rubberband_controls",className:w.rubberbandControl,role:"presentation",ref:x,onMouseDown:M,onMouseOut:E,onMouseMove:R},{children:o}),void 0)]},void 0);var N=b?b.offsetX:f||0,D=N<c?N:c,F=Math.abs(N-c),I=t.pxToBp(D),H=t.pxToBp(D+F),Y=Math.ceil(F/t.colWidth),V=[{label:"Create annotation",icon:A.a,onClick:function(){t.setOffsets(I,H),k()}}];return Object(l.jsxs)(l.Fragment,{children:[S.current?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(y.a,L({className:w.popover,classes:{paper:w.paper},open:!0,anchorEl:S.current,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"right"},keepMounted:!0,disableRestoreFocus:!0},{children:Object(l.jsx)(u.a,{children:I+1},void 0)}),void 0),Object(l.jsx)(y.a,L({className:w.popover,classes:{paper:w.paper},open:!0,anchorEl:S.current,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,disableRestoreFocus:!0},{children:Object(l.jsx)(u.a,{children:H+1},void 0)}),void 0)]},void 0):null,Object(l.jsx)("div",L({ref:S,className:w.rubberband,style:{left:D+i,width:F}},{children:Object(l.jsxs)(u.a,L({variant:"h6",className:w.rubberbandText},{children:[Y.toLocaleString("en-US")," bp"]}),void 0)}),void 0),Object(l.jsx)("div",L({"data-testid":"rubberband_controls",className:w.rubberbandControl,role:"presentation",ref:x,onMouseDown:M,onMouseOut:E,onMouseMove:R},{children:o}),void 0),b?Object(l.jsx)(j.Menu,{anchorReference:"anchorPosition",anchorPosition:{left:b.clientX,top:b.clientY},onMenuItemClick:function(e,t){t(),k()},open:Boolean(b),onClose:k,menuItems:V},void 0):null]},void 0)})),M=n(447),R=n(76),E=n(125),k=n.n(E),N=n(204),D=n.n(N),F=n(374),I=n(378),H=n(376),Y=n(205),V=function(){return(V=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},W=Object(c.observer)((function(e){var t=e.info,n=e.onClose;return Object(l.jsxs)(F.a,V({onClose:function(){return n()},open:!0},{children:[Object(l.jsx)(I.a,{children:"Metadata"},void 0),Object(l.jsx)(H.a,{children:Object(l.jsx)(Y.Attributes,{attributes:t},void 0)},void 0)]}),void 0)})),G=function(){return(G=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},X=3.5,U=600,B=Object(c.observer)((function(e){var t,n,r=e.node,o=e.onClose,i=e.model,a=i.structures,c=r?i.getRowDetails(r.name):void 0;return Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)(M.a,G({anchorReference:"anchorPosition",anchorPosition:{top:r.y,left:r.x},transitionDuration:0,keepMounted:!0,open:Boolean(r),onClose:o},{children:[Object(l.jsx)(R.a,G({dense:!0,disabled:!0},{children:r.name}),void 0),Object(l.jsx)(R.a,G({dense:!0,onClick:function(){i.setDialogComponent(W,{info:i.getRowDetails(r.name)}),o()}},{children:"More info..."}),void 0),null===(t=a[r.name])||void 0===t?void 0:t.map((function(e){return i.selectedStructures.find((function(e){return e.id===r.name}))?Object(l.jsxs)(R.a,G({dense:!0,onClick:function(){i.removeStructureFromSelection({structure:e,id:r.name}),o()}},{children:["Remove PDB from selection (",e.pdb,")"]}),JSON.stringify(e)):Object(l.jsxs)(R.a,G({dense:!0,onClick:function(){i.addStructureToSelection({structure:e,id:r.name}),o()}},{children:["Add PDB to selection (",e.pdb,")"]}),JSON.stringify(e))})),null===(n=c.accession)||void 0===n?void 0:n.map((function(e){return Object(l.jsxs)(R.a,G({dense:!0,onClick:function(){i.addUniprotTrack({name:c.name,accession:e}),o()}},{children:["Open UniProt track (",e,")"]}),e)}))]}),void 0)},void 0)})),_=Object(c.observer)((function(e){var t=e.node,n=e.model,r=e.onClose;return Object(l.jsxs)(M.a,G({anchorReference:"anchorPosition",anchorPosition:{left:t.x,top:t.y},transitionDuration:0,keepMounted:!0,open:Boolean(t),onClose:r},{children:[Object(l.jsx)(R.a,G({dense:!0,disabled:!0},{children:t.name}),void 0),Object(l.jsx)(R.a,G({dense:!0,onClick:function(){n.toggleCollapsed(t.id),r()}},{children:n.collapsed.includes(t.id)?"Expand this node":"Collapse this node"}),void 0),Object(l.jsx)(R.a,G({dense:!0,onClick:function(){n.showOnly===t.id?n.setShowOnly(void 0):n.setShowOnly(t.id),r()}},{children:n.showOnly===t.id?"Disable show only this node":"Show only this node"}),void 0)]}),void 0)})),K=Object(c.observer)((function(e){var t=e.model,n=e.offsetY,o=Object(r.useRef)(null),i=Object(r.useRef)(new D.a),a=Object(r.useRef)(null),c=Object(r.useState)(),s=c[0],u=c[1],d=Object(r.useState)(),f=d[0],h=d[1],v=Object(r.useState)(),b=v[0],j=v[1],p=t.hierarchy,m=t.rowHeight,g=t.scrollY,O=t.treeWidth,x=t.showBranchLen,S=t.collapsed,y=t.margin,w=t.labelsAlignRight,A=t.noTree,L=t.blockSize,P=t.drawNodeBubbles,C=t.drawTree,T=t.treeAreaWidth,M=t.structures,R=t.highResScaleFactor;function E(e){var t=e.nativeEvent.offsetX-y.left,r=e.nativeEvent.offsetY,o=i.current.search({minX:t,maxX:t+1,minY:r+n,maxY:r+1+n})[0];return o&&o.branch?G(G({},o),{x:e.clientX,y:e.clientY}):void 0}function k(e){var t=e.nativeEvent.offsetX-y.left,r=e.nativeEvent.offsetY,o=i.current.search({minX:t,maxX:t+1,minY:r+n,maxY:r+1+n})[0];return o&&!o.branch?G(G({},o),{x:e.clientX,y:e.clientY}):void 0}return Object(r.useEffect)((function(){if(i.current.clear(),o.current){var e=o.current.getContext("2d");if(e){e.resetTransform(),e.scale(R,R),e.clearRect(0,0,O+U,L),e.translate(y.left,-n);var t=e.font;e.font=t.replace(/\d+px/,Math.max(8,m-8)+"px"),!A&&C&&(p.links().forEach((function(t){var r=t.source,o=t.target,i=x?"len":"y",a=r,c=a.x,s=a[i],l=o,u=l.x,d=l[i],f=Math.min(c,u),h=Math.max(c,u);n+L>=f&&h>=n&&(e.beginPath(),e.moveTo(s,c),e.lineTo(s,u),e.lineTo(d,u),e.stroke())})),P&&p.descendants().forEach((function(t){var r=x?"len":"y",o=t,a=o.x,c=o[r],s=o.data,l=s.id,u=void 0===l?"":l,d=s.name,f=void 0===d?"":d;a>n-5&&a<n+L+5&&(e.strokeStyle="black",e.fillStyle=S.includes(u)?"black":"white",e.beginPath(),e.arc(c,a,X,0,2*Math.PI),e.fill(),e.stroke(),i.current.insert({minX:c-X,maxX:c-X+7,minY:a-X,maxY:a-X+7,branch:!0,id:u,name:f}))}))),m>=10&&(w?(e.textAlign="right",e.setLineDash([1,3])):e.textAlign="start",p.leaves().forEach((function(t){var r=t.x,o=t.y,a=t.data,c=a.name,s=a.id,l=t.len;if(r>n-5&&r<n+L+5){var u=r+m/4,d=x?l:o,f=e.measureText(c).width,h=e.measureText("M").width,v=M[c];if(e.fillStyle=v?"blue":"black",C||w)if(w){var b=T-2-y.left;if(C&&!A){var j=e.measureText(c).width;e.moveTo(d+X+2,r),e.lineTo(b-2-j,r),e.stroke()}e.fillText(c,b,u),i.current.insert({minX:T-y.left-f,maxX:T-y.left,minY:u-h,maxY:u,name:c,id:s})}else e.fillText(c,d+7,u),i.current.insert({minX:d+7,maxX:d+7+f,minY:u-h,maxY:u,name:c,id:s});else e.fillText(c,0,u),i.current.insert({minX:0,maxX:f,minY:u-h,maxY:u,name:c,id:s})}})),e.setLineDash([]))}}}),[S,m,y.left,p,n,O,x,A,L,P,C,w,T,M]),Object(r.useEffect)((function(){var e=a.current;if(e){var t=e.getContext("2d");if(t&&(t.resetTransform(),t.clearRect(0,0,O+U,L),t.translate(y.left,-n),b)){var r=b.minX,o=b.maxX,i=b.minY,c=b.maxY;t.fillStyle="rgba(0,0,0,0.1)",t.fillRect(r,i,o-r,c-i)}}}),[b,y.left,n,L,O]),Object(l.jsxs)(l.Fragment,{children:[(null===s||void 0===s?void 0:s.id)?Object(l.jsx)(_,{node:s,model:t,onClose:function(){return u(void 0)}},void 0):null,(null===f||void 0===f?void 0:f.id)?Object(l.jsx)(B,{node:f,model:t,onClose:function(){return h(void 0)}},void 0):null,Object(l.jsx)("canvas",{width:(O+U)*R,height:L*R,style:{width:O+U,height:L,top:g+n,left:0,position:"absolute"},onMouseMove:function(e){if(o.current){var t=k(e)||E(e);o.current.style.cursor=t?"pointer":"default",j(k(e))}},onClick:function(e){var t=e.clientX,n=e.clientY,r=E(e);(null===r||void 0===r?void 0:r.id)&&u(G(G({},r),{x:t,y:n}));var o=k(e);(null===o||void 0===o?void 0:o.id)&&h(G(G({},o),{x:t,y:n}))},ref:o},void 0),Object(l.jsx)("canvas",{style:{width:O+U,height:L,top:g+n,left:0,position:"absolute",pointerEvents:"none",zIndex:100},width:O+U,height:L,ref:a},void 0)]},void 0)})),q=Object(c.observer)((function(e){var t=e.model,n=Object(r.useRef)(null),o=Object(r.useRef)(!1),i=Object(r.useRef)(0),a=Object(r.useRef)(0),c=t.treeWidth,s=t.height,u=t.blocksY,d=Object(r.useState)(!1),f=d[0],h=d[1];return Object(r.useEffect)((function(){var e=n.current;if(e)return e.addEventListener("wheel",r),function(){e.removeEventListener("wheel",r)};function r(e){var n=k()(e);i.current+=n.pixelY,o.current||(o.current=!0,requestAnimationFrame((function(){t.doScrollY(-i.current),i.current=0,o.current=!1}))),e.preventDefault()}}),[t]),Object(r.useEffect)((function(){var e=function(){};function n(e){e.preventDefault();var n=e.clientY-a.current;n&&(o.current||(o.current=!0,window.requestAnimationFrame((function(){t.doScrollY(n),o.current=!1,a.current=e.clientY}))))}function r(){a.current=0,f&&h(!1)}return f&&(window.addEventListener("mousemove",n,!0),window.addEventListener("mouseup",r,!0),e=function(){window.removeEventListener("mousemove",n,!0),window.removeEventListener("mouseup",r,!0)}),e}),[t,f]),Object(l.jsx)("div",G({ref:n,onMouseDown:function(e){var t=e.target;t.draggable||t.dataset.resizer||0===e.button&&(a.current=e.clientY,h(!0))},onMouseUp:function(e){e.preventDefault(),h(!1)},onMouseLeave:function(e){e.preventDefault()},style:{height:s,position:"relative",overflow:"hidden",width:c+U}},{children:u.map((function(e){return Object(l.jsx)(K,{model:t,offsetY:e},e)}))}),void 0)})),z=n(21),Q=n(756),J=n(148),Z=n.n(J),$=function(){return($=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function ee(e,t){return Object.fromEntries(Object.entries(e).map(t))}function te(e,t,n){var r;void 0===t&&(t="node"),void 0===n&&(n=0);var o=t+"-"+n;return $($({},e),{id:o,branchset:(null===(r=e.branchset)||void 0===r?void 0:r.map((function(e,t){return te(e,o+"-"+t,n+1)})))||[]})}function ne(e,t){return ee(e,(function(e){var n=e[0],r=e[1];return[n,t.palette.getContrastText(Z()(r).hex())]}))}var re=function(){return(re=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},oe=Object(c.observer)((function(e){var t=e.model,n=e.offsetX,o=e.offsetY,i=t.MSA,a=t.colWidth,c=t.bgColor,s=t.columns,u=t.rowHeight,d=t.scrollY,f=t.scrollX,h=t.hierarchy,v=t.colorScheme,b=t.blockSize,j=t.highResScaleFactor,p=Object(z.a)(),m=Object(r.useMemo)((function(){return ne(v,p)}),[v,p]),g=Object(r.useRef)(null);return Object(r.useEffect)((function(){if(g.current){var e=g.current.getContext("2d");if(e){e.resetTransform(),e.scale(j,j),e.clearRect(0,0,b,b),e.translate(-n,u/2-o),e.textAlign="center",e.font=e.font.replace(/\d+px/,Math.max(8,u-8)+"px");var t=h.leaves(),r=b,i=Math.max(0,Math.floor((o-u)/u)),l=Math.max(0,Math.ceil((o+r+u)/u)),d=Math.max(0,Math.floor(n/a)),f=Math.max(0,Math.ceil((n+r)/a)),p=t.slice(i,l);p.forEach((function(t){for(var r,o=t.x,i=t.data.name,l=null===(r=s[i])||void 0===r?void 0:r.slice(d,f),h=0;h<(null===l||void 0===l?void 0:l.length);h++){var b=l[h],j=v[b.toUpperCase()];if(c){var p=h*a+n-n%a;e.fillStyle=j||"white",e.fillRect(p,o-u,a,u)}}})),u>=10&&a>=u/2&&p.forEach((function(t){for(var r,o=t.x,i=t.data.name,l=null===(r=s[i])||void 0===r?void 0:r.slice(d,f),h=0;h<(null===l||void 0===l?void 0:l.length);h++){var b=l[h],j=v[b.toUpperCase()],p=m[b.toUpperCase()]||"black",g=h*a+n-n%a;e.fillStyle=c?p:j||"black",e.fillText(b,g+a/2,o-u/4)}}))}}}),[i,j,s,v,m,c,u,a,h,n,o,b]),Object(l.jsx)("canvas",{ref:g,onMouseMove:function(e){if(g.current){var r=g.current.getBoundingClientRect(),i=r.left,c=r.top,s=e.clientX-i,l=e.clientY-c;t.setMousePos(Math.floor((s+n)/a)+1,Math.floor((l+o)/u))}},onMouseLeave:function(){return t.setMousePos()},width:b*j,height:b*j,style:{position:"absolute",top:d+o,left:f+n,width:b,height:b}},void 0)})),ie=Object(c.observer)((function(e){var t=e.model,n=t.MSA,o=t.msaFilehandle,i=t.height,a=t.msaAreaWidth,c=t.blocks2d,s=Object(r.useRef)(null),d=Object(r.useRef)(!1),f=Object(r.useRef)(0),h=Object(r.useRef)(0),v=Object(r.useRef)(0),b=Object(r.useRef)(0),j=Object(r.useState)(!1),p=j[0],m=j[1];return Object(r.useEffect)((function(){var e=s.current;if(e)return e.addEventListener("wheel",n),function(){e.removeEventListener("wheel",n)};function n(e){var n=k()(e);f.current+=n.pixelX,h.current+=n.pixelY,d.current||(d.current=!0,requestAnimationFrame((function(){t.doScrollX(-f.current),t.doScrollY(-h.current),f.current=0,h.current=0,d.current=!1}))),e.preventDefault()}}),[t]),Object(r.useEffect)((function(){var e=function(){};function n(e){e.preventDefault();var n=e.clientX,r=e.clientY,o=n-v.current,i=r-b.current;(o||i)&&(d.current||(d.current=!0,window.requestAnimationFrame((function(){t.doScrollX(o),t.doScrollY(i),d.current=!1,v.current=e.clientX,b.current=e.clientY}))))}function r(){v.current=0,p&&m(!1)}return p&&(window.addEventListener("mousemove",n,!0),window.addEventListener("mouseup",r,!0),e=function(){window.removeEventListener("mousemove",n,!0),window.removeEventListener("mouseup",r,!0)}),e}),[t,p]),Object(l.jsx)("div",re({ref:s,onMouseDown:function(e){var t=e.target;t.draggable||t.dataset.resizer||0===e.button&&(v.current=e.clientX,b.current=e.clientY,m(!0))},onMouseUp:function(e){e.preventDefault(),m(!1)},onMouseLeave:function(e){e.preventDefault()},style:{position:"relative",height:i,width:a,overflow:"hidden"}},{children:n||o?n?c.map((function(e){var n=e[0],r=e[1];return Object(l.jsx)(oe,{model:t,offsetX:n,offsetY:r},n+"_"+r)})):Object(l.jsxs)("div",re({style:{position:"absolute",left:"50%",top:"50%"}},{children:[Object(l.jsx)(Q.a,{},void 0),Object(l.jsx)(u.a,{children:"Loading..."},void 0)]}),void 0):null}),void 0)})),ae=function(){return(ae=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function ce(e,t,n,r,o){var i;void 0===r&&(r=!0),void 0===o&&(o=!0);var a=function(e,t,n){for(var r=t*(e=Math.abs(e)),o=parseInt(Number(r).toExponential().split(/e/i)[1],10),i=Math.pow(10,o);i<r&&!((i*=2)>=r);)i*=2.5;var a=(i=Math.max(i,5))/e,c=0;return!(i%10)&&a/10>=n?c=i/10:!(i%5)&&a/5>=n?c=i/5:!(i%2)&&a/2>=n&&(c=i/2),{majorPitch:i,minorPitch:c}}(n,60,15),c=e,s=t;if(null===c||null===s)return[];n<0&&(c=(i=[s,c])[0],s=i[1]),c-=Math.abs(20*n),s+=Math.abs(20*n)+1;for(var l=a.minorPitch||a.majorPitch,u=0,d=[],f=Math.ceil(c/l)*l;f<s;f+=l)o&&f%(2*a.majorPitch)?(d.push({type:"minor",base:f-1,index:u}),u+=1):!r||f%(2*a.majorPitch)||(d.push({type:"major",base:f-1,index:u}),u+=1);return d}function se(e){return e<999?String(e):se(~~(e/1e3))+","+("00"+~~(e%1e3)).substr(-3,3)}var le=Object(O.a)((function(){return{majorTickLabel:{fontSize:"11px"},majorTick:{stroke:"#555"},minorTick:{stroke:"#999"}}}));function ue(e){var t=e.start,n=e.end,r=e.bpPerPx,o=e.reversed,i=e.major,a=e.minor,c=le(),s=ce(t,n,r,i,a);return Object(l.jsxs)(l.Fragment,{children:[s.map((function(e){var i=(o?n-e.base:e.base-t)/r;return Object(l.jsx)("line",{x1:i,x2:i,y1:11,y2:"major"===e.type?17:15,strokeWidth:1,stroke:"major"===e.type?"#555":"#999",className:"major"===e.type?c.majorTick:c.minorTick,"data-bp":e.base},e.base)})),s.filter((function(e){return"major"===e.type})).map((function(e){var i=(o?n-e.base:e.base-t)/r;return Object(l.jsx)("text",ae({x:i,y:10,textAnchor:"middle",style:{fontSize:"11px"},className:c.majorTickLabel},{children:se(e.base+1)}),"label-"+e.base)}))]},void 0)}var de=Object(c.observer)((function(e){var t=e.model,n=t.MSA,o=t.colWidth,i=t.msaAreaWidth,a=t.resizeHandleWidth,c=t.scrollX,s=t.blocksX,u=t.blockSize,d=Object(r.useRef)(null),f=s[0];return n?Object(l.jsx)("div",ae({ref:d,style:{position:"relative",width:i,cursor:"crosshair",overflow:"hidden",height:20,background:"#ccc"}},{children:Object(l.jsx)("svg",ae({style:{width:s.length*u,position:"absolute",left:c+f+a,pointerEvents:"none"}},{children:Object(l.jsx)(ue,{start:f/o,end:f/o+u*s.length/o,bpPerPx:1/o},f)}),void 0)}),void 0):null})),fe=Object(c.observer)((function(e){var t=e.model.treeWidth;return Object(l.jsx)("div",{style:{width:t}},void 0)})),he=n(87),ve=n(156),be=n(761),je=n(467),pe=n(291),me=n(375),ge=ee({clustal:{G:"orange",P:"orange",S:"orange",T:"orange",H:"red",K:"red",R:"red",F:"blue",W:"blue",Y:"blue",I:"green",L:"green",M:"green",V:"green"},lesk:{G:"orange",A:"orange",S:"orange",T:"orange",C:"green",V:"green",I:"green",L:"green",P:"green",F:"green",Y:"green",M:"green",W:"green",N:"magenta",Q:"magenta",H:"magenta",D:"red",E:"red",K:"blue",R:"blue"},maeditor:{A:"lightgreen",G:"lightgreen",C:"green",D:"darkgreen",E:"darkgreen",N:"darkgreen",Q:"darkgreen",I:"blue",L:"blue",M:"blue",V:"blue",F:"#c8a2c8",W:"#c8a2c8",Y:"#c8a2c8",H:"darkblue",K:"orange",R:"orange",P:"pink",S:"red",T:"red"},flower:{A:"#b18a51",C:"#ff5701",D:"#01a578",E:"#2da0a1",F:"#fa559d",G:"#b1c23c",H:"#0194f9",I:"#f27663",K:"#7fc3d7",L:"#df6e75",M:"#fe9daf",N:"#0bcec6",P:"#4fa32a",Q:"#7295ae",R:"#83bff1",S:"#b4bd9b",T:"#d2b576",V:"#fd997b",W:"#ff2ded",Y:"#c96ecf"},rainbow_dna:{A:"#3737f5",C:"#37f537",G:"#f5f537",T:"#f53737",U:"#f53737"},clustalx_protein:{A:"#197fe5",C:"#e57f7f",D:"#cc4ccc",E:"#cc4ccc",F:"#197fe5",G:"#e5994c",H:"#19b2b2",I:"#197fe5",K:"#e53319",L:"#197fe5",M:"#197fe5",N:"#19cc19",P:"#cccc00",Q:"#19cc19",R:"#e53319",S:"#19cc19",T:"#19cc19",V:"#197fe5",W:"#197fe5",Y:"#19b2b2"},clustalx_dna:{A:"#e53319",C:"#197fe5",G:"#e5994c",T:"#19cc19",U:"#19cc19"},jalview_buried:{A:"#00a35c",R:"#00fc03",N:"#00eb14",D:"#00eb14",C:"#0000ff",Q:"#00f10e",E:"#00f10e",G:"#009d62",H:"#00d52a",I:"#0054ab",L:"#007b84",K:"#00ff00",M:"#009768",F:"#008778",P:"#00e01f",S:"#00d52a",T:"#00db24",W:"#00a857",Y:"#00e619",V:"#005fa0",B:"#00eb14",X:"#00b649",Z:"#00f10e"},jalview_hydrophobicity:{A:"#ad0052",R:"#0000ff",N:"#0c00f3",D:"#0c00f3",C:"#c2003d",Q:"#0c00f3",E:"#0c00f3",G:"#6a0095",H:"#1500ea",I:"#ff0000",L:"#ea0015",K:"#0000ff",M:"#b0004f",F:"#cb0034",P:"#4600b9",S:"#5e00a1",T:"#61009e",W:"#5b00a4",Y:"#4f00b0",V:"#f60009",B:"#0c00f3",X:"#680097",Z:"#0c00f3"},jalview_prophelix:{A:"#e718e7",R:"#6f906f",N:"#1be41b",D:"#778877",C:"#23dc23",Q:"#926d92",E:"#ff00ff",G:"#00ff00",H:"#758a75",I:"#8a758a",L:"#ae51ae",K:"#a05fa0",M:"#ef10ef",F:"#986798",P:"#00ff00",S:"#36c936",T:"#47b847",W:"#8a758a",Y:"#21de21",V:"#857a85",B:"#49b649",X:"#758a75",Z:"#c936c9"},jalview_propstrand:{A:"#5858a7",R:"#6b6b94",N:"#64649b",D:"#2121de",C:"#9d9d62",Q:"#8c8c73",E:"#0000ff",G:"#4949b6",H:"#60609f",I:"#ecec13",L:"#b2b24d",K:"#4747b8",M:"#82827d",F:"#c2c23d",P:"#2323dc",S:"#4949b6",T:"#9d9d62",W:"#c0c03f",Y:"#d3d32c",V:"#ffff00",B:"#4343bc",X:"#797986",Z:"#4747b8"},jalview_propturn:{A:"#2cd3d3",R:"#708f8f",N:"#ff0000",D:"#e81717",C:"#a85757",Q:"#3fc0c0",E:"#778888",G:"#ff0000",H:"#708f8f",I:"#00ffff",L:"#1ce3e3",K:"#7e8181",M:"#1ee1e1",F:"#1ee1e1",P:"#f60909",S:"#e11e1e",T:"#738c8c",W:"#738c8c",Y:"#9d6262",V:"#07f8f8",B:"#f30c0c",X:"#7c8383",Z:"#5ba4a4"},jalview_taylor:{A:"#ccff00",R:"#0000ff",N:"#cc00ff",D:"#ff0000",C:"#ffff00",Q:"#ff00cc",E:"#ff0066",G:"#ff9900",H:"#0066ff",I:"#66ff00",L:"#33ff00",K:"#6600ff",M:"#00ff00",F:"#00ff66",P:"#ffcc00",S:"#ff3300",T:"#ff6600",W:"#00ccff",Y:"#00ffcc",V:"#99ff00"},jalview_zappo:{A:"#ffafaf",R:"#6464ff",N:"#00ff00",D:"#ff0000",C:"#ffff00",Q:"#00ff00",E:"#ff0000",G:"#ff00ff",H:"#6464ff",I:"#ffafaf",L:"#ffafaf",K:"#6464ff",M:"#ffafaf",F:"#ffc800",P:"#ff00ff",S:"#00ff00",T:"#00ff00",W:"#ffc800",Y:"#ffc800",V:"#ffafaf"},cinema:{H:"blue",K:"blue",R:"blue",D:"red",E:"red",S:"green",T:"green",N:"green",Q:"green",A:"white",V:"white",L:"white",I:"white",M:"white",F:"magenta",W:"magenta",Y:"magenta",P:"brown",G:"brown",C:"yellow",B:"gray",Z:"gray",X:"gray","-":"gray",".":"gray"}},(function(e){return[e[0],ee(e[1],(function(e){var t=e[0],n=e[1];return[t,Z()(n).hex()]}))]})),Oe=function(){return(Oe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},xe=Object(c.observer)((function(e){var t=e.model,n=e.onClose,o=e.open,i=t.rowHeight,a=t.colWidth,c=t.treeWidth,s=t.colorSchemeName,u=t.noTree,d=Object(r.useState)(""+i),f=d[0],h=d[1],b=Object(r.useState)(""+a),j=b[0],p=b[1],m=Object(r.useState)(""+c),g=m[0],O=m[1];function x(e){return Number.isNaN(+e)||+e<0}var S=x(f),y=x(j),w=x(g);return Object(l.jsxs)(F.a,Oe({onClose:function(){return n()},open:o},{children:[Object(l.jsx)(I.a,{children:"Settings"},void 0),Object(l.jsxs)(H.a,{children:[Object(l.jsx)(be.a,{control:Object(l.jsx)(je.a,{checked:t.showBranchLen,onChange:function(){return t.toggleBranchLen()}},void 0),label:"Show branch length"},void 0),Object(l.jsx)(be.a,{control:Object(l.jsx)(je.a,{checked:t.bgColor,onChange:function(){return t.toggleBgColor()}},void 0),label:"Color background"},void 0),Object(l.jsx)(be.a,{control:Object(l.jsx)(je.a,{checked:t.drawNodeBubbles,onChange:function(){return t.toggleNodeBubbles()}},void 0),label:"Draw node bubbles"},void 0),Object(l.jsx)(be.a,{control:Object(l.jsx)(je.a,{checked:t.drawTree,onChange:function(){return t.toggleDrawTree()}},void 0),label:"Draw tree (if available)"},void 0),Object(l.jsx)(be.a,{control:Object(l.jsx)(je.a,{checked:t.labelsAlignRight,onChange:function(){return t.toggleLabelsAlignRight()}},void 0),label:"Labels align right (note: labels may draw over tree, but can adjust tree width or tree area width in UI)"},void 0),Object(l.jsx)(pe.a,{label:"Row height (px)",value:f,error:S,onChange:function(e){return h(e.target.value)}},void 0),Object(l.jsx)(pe.a,{label:"Column width (px)",value:j,error:y,onChange:function(e){return p(e.target.value)}},void 0),Object(l.jsx)("br",{},void 0),u?null:Object(l.jsx)(pe.a,{label:"Tree width (px)",value:g,error:w,onChange:function(e){return O(e.target.value)}},void 0),Object(l.jsx)("br",{},void 0),Object(l.jsx)(pe.a,Oe({select:!0,label:"Color scheme",value:s,onChange:function(e){return t.setColorSchemeName(e.target.value)}},{children:Object.keys(ge).map((function(e){return Object(l.jsx)(R.a,Oe({value:e},{children:e}),e)}))}),void 0),Object(l.jsx)(me.a,{children:Object(l.jsx)(v.a,Oe({disabled:S||y||w,onClick:function(){t.setRowHeight(+f),t.setColWidth(+j),u||t.setTreeWidth(+g),n()},variant:"contained",color:"primary"},{children:"Submit"}),void 0)},void 0)]},void 0)]}),void 0)})),Se=n(453),ye=function(){return(ye=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function we(e){var t=e.onClose,n=e.open;return Object(l.jsxs)(F.a,ye({onClose:function(){return t()},open:n},{children:[Object(l.jsx)(I.a,{children:"Biotite License"},void 0),Object(l.jsx)(H.a,{children:Object(l.jsx)("pre",ye({style:{height:100,overflow:"auto"}},{children:'\nCopyright 2017 - 2020, The Biotite contributors\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without modification,\nare permitted provided that the following conditions are met:\n\n1. Redistributions of source code must retain the above copyright notice, this\nlist of conditions and the following disclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright notice,\nthis list of conditions and the following disclaimer in the documentation and/or\nother materials provided with the distribution.\n\n3. Neither the name of the copyright holder nor the names of its contributors\nmay be used to endorse or promote products derived from this software without\nspecific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n        '}),void 0)},void 0)]}),void 0)}function Ae(e){var t=e.onClose,n=e.open,o=Object(r.useState)(!1),i=o[0],a=o[1];return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(we,{onClose:function(){return a(!1)},open:i},void 0),Object(l.jsxs)(F.a,ye({onClose:function(){return t()},open:n},{children:[Object(l.jsx)(I.a,{children:"About this plugin"},void 0),Object(l.jsxs)(H.a,{children:[Object(l.jsxs)(u.a,{children:["JBrowse 2 MSAView plugin ",Se.a," (",Object(l.jsx)(d.a,ye({href:"https://github.com/gmod/jbrowse-plugin-msaview"},{children:"Github"}),void 0),")"]},void 0),Object(l.jsxs)("ul",{children:[Object(l.jsx)("li",{children:Object(l.jsxs)(u.a,{children:["We use some color schemes from the"," ",Object(l.jsx)(d.a,ye({href:"https://github.com/biotite-dev/biotite"},{children:"biotite"}),void 0)," ","project, and their license is reproduced"," ",Object(l.jsx)(d.a,ye({onClick:function(){return a(!0)}},{children:"here"}),void 0)]},void 0)},void 0),Object(l.jsx)("li",{children:Object(l.jsxs)(u.a,{children:["See this page for some information on jalview colorings"," ",Object(l.jsx)(d.a,ye({href:"https://www.jalview.org/help/html/colourSchemes/"},{children:"here"}),void 0)]},void 0)},void 0),Object(l.jsx)("li",{children:Object(l.jsxs)(u.a,{children:["See this page for some info on the clustal, cinema, maeditor, and lesk color schemes"," ",Object(l.jsx)(d.a,ye({href:"http://www.bioinformatics.nl/~berndb/aacolour.html"},{children:"here"}),void 0)]},void 0)},void 0),Object(l.jsx)("li",{children:Object(l.jsxs)(u.a,{children:["See this paper about the flower color scheme"," ",Object(l.jsx)(d.a,ye({href:"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7245768/"},{children:"here"}),void 0)]},void 0)},void 0)]},void 0)]},void 0)]}),void 0)]},void 0)}var Le=function(){return(Le=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Pe=Object(c.observer)((function(e){var t=e.model,n=e.onClose,r=e.open,o=t.alignmentDetails;return Object(l.jsxs)(F.a,Le({onClose:function(){return n()},open:r},{children:[Object(l.jsx)(I.a,{children:"Metadata"},void 0),Object(l.jsx)(H.a,{children:Object(l.jsx)(Y.Attributes,{attributes:o},void 0)},void 0)]}),void 0)})),Ce=n(787),Te=function(){return(Te=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Me=Object(c.observer)((function(e){var t=e.model,n=e.onClose,r=e.open,o=t.tracks;return Object(l.jsxs)(F.a,Te({onClose:function(){return n()},open:r},{children:[Object(l.jsx)(I.a,{children:"Add track"},void 0),Object(l.jsxs)(H.a,{children:[Object(l.jsx)(u.a,{children:"Open relevant per-alignment tracks e.g. protein domains"},void 0),Object(l.jsx)(Ce.a,{children:o.map((function(e){return Object(l.jsx)(be.a,{control:Object(l.jsx)(je.a,{checked:!t.turnedOffTracks.has(e.model.id),onChange:function(){t.toggleTrack(e.model.id)}},void 0),label:e.model.name},e.model.id)}))},void 0),Object(l.jsx)(me.a,{children:Object(l.jsx)(v.a,Te({onClick:function(){return n()},variant:"contained",color:"primary"},{children:"Close"}),void 0)},void 0)]},void 0)]}),void 0)})),Re=n(454),Ee=n.n(Re),ke=n(455),Ne=n.n(ke),De=n(457),Fe=n.n(De),Ie=n(456),He=n.n(Ie),Ye=function(){return(Ye=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ve=Object(c.observer)((function(e){var t=e.model,n=t.mouseOverRowName,r=t.mouseCol;return Object(l.jsxs)("div",{children:[Object(l.jsxs)(u.a,Ye({display:"inline"},{children:["Row name: ",n]}),void 0),Object(l.jsx)("span",{style:{marginLeft:10}},void 0),Object(l.jsxs)(u.a,Ye({display:"inline"},{children:["Position: ",r]}),void 0)]},void 0)})),We=Object(c.observer)((function(e){var t=e.model,n=Object(r.useState)(!1),o=n[0],i=n[1],a=Object(r.useState)(!1),c=a[0],s=a[1],u=Object(r.useState)(!1),d=u[0],f=u[1],h=Object(r.useState)(!1),v=h[0],b=h[1],j=t.currentAlignment,p=t.alignmentNames;return Object(l.jsxs)("div",Ye({style:{display:"flex"}},{children:[Object(l.jsx)(he.a,Ye({onClick:function(){t.setData({tree:"",msa:""}),t.setTreeFilehandle(void 0),t.setMSAFilehandle(void 0),t.setScrollY(0),t.setScrollX(0),t.setCurrentAlignment(0)}},{children:Object(l.jsx)(Ee.a,{},void 0)}),void 0),Object(l.jsx)(he.a,Ye({onClick:function(){return i(!0)}},{children:Object(l.jsx)(Ne.a,{},void 0)}),void 0),Object(l.jsx)(he.a,Ye({onClick:function(){return f(!0)}},{children:Object(l.jsx)(A.a,{},void 0)}),void 0),Object(l.jsx)(he.a,Ye({onClick:function(){return b(!0)}},{children:Object(l.jsx)(He.a,{},void 0)}),void 0),o?Object(l.jsx)(xe,{open:!0,model:t,onClose:function(){return i(!1)}},void 0):null,c?Object(l.jsx)(Ae,{open:!0,onClose:function(){return s(!1)}},void 0):null,d?Object(l.jsx)(Pe,{open:!0,model:t,onClose:function(){return f(!1)}},void 0):null,v?Object(l.jsx)(Me,{open:!0,model:t,onClose:function(){return b(!1)}},void 0):null,p.length>0?Object(l.jsx)(ve.a,Ye({native:!0,value:j,onChange:function(e){t.setCurrentAlignment(+e.target.value),t.setScrollX(0),t.setScrollY(0)}},{children:p.map((function(e,t){return Object(l.jsx)("option",Ye({value:t},{children:e}),e+"-"+t)}))}),void 0):null,Object(l.jsx)(Ve,{model:t},void 0),Object(l.jsx)("div",{style:{flex:1}},void 0),Object(l.jsx)(he.a,Ye({onClick:function(){return s(!0)}},{children:Object(l.jsx)(Fe.a,{},void 0)}),void 0)]}),void 0)})),Ge=n(282),Xe=n.n(Ge),Ue=n(283),Be=n.n(Ue),_e=function(){return(_e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ke=Object(O.a)((function(e){return{textArea:{padding:e.spacing(2),overflow:"auto",background:"#ddd",wordBreak:"break-word"}}})),qe=Object(c.observer)((function(e){var t=e.model,n=e.onClose,o=Object(r.useState)("Copy to clipboard"),i=o[0],a=o[1],c=Ke();return Object(l.jsxs)(F.a,_e({open:!0,onClose:n,fullWidth:!0,maxWidth:"lg"},{children:[Object(l.jsxs)(I.a,{children:["Track info - ",t.name]},void 0),Object(l.jsxs)(H.a,{children:[Object(l.jsx)(v.a,_e({variant:"contained",color:"primary",onClick:function(){Be()(t.data),a("Copied!"),setTimeout((function(){a("Copy to clipboard")}),300)}},{children:i}),void 0),Object(l.jsx)("pre",_e({className:c.textArea},{children:t.data}),void 0)]},void 0),Object(l.jsx)(me.a,{children:Object(l.jsx)(v.a,_e({variant:"contained",onClick:n,color:"secondary"},{children:"Close"}),void 0)},void 0)]}),void 0)})),ze=function(){return(ze=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Qe=Object(O.a)((function(){return{button:{padding:0}}})),Je=Object(c.observer)((function(e){var t=e.model,n=e.track,o=Object(r.useState)(),i=o[0],a=o[1],c=Object(r.useState)(!1),s=c[0],u=c[1],d=t.rowHeight,f=t.treeAreaWidth,h=n.height,v=n.model.name,b=Qe(),j=Math.max(8,d-8);return Object(l.jsxs)("div",ze({style:{width:f,height:h,flexShrink:0,textAlign:"right",fontSize:j}},{children:[v,Object(l.jsx)(he.a,ze({className:b.button,style:{width:j,height:j},onClick:function(e){a(e.target)}},{children:Object(l.jsx)(Xe.a,{},void 0)}),void 0),i?Object(l.jsxs)(M.a,ze({anchorEl:i,transitionDuration:0,open:!0,onClose:function(){a(void 0)}},{children:[Object(l.jsx)(R.a,ze({dense:!0,onClick:function(){t.toggleTrack(n.model.id),a(void 0)}},{children:"Close"}),void 0),Object(l.jsx)(R.a,ze({dense:!0,onClick:function(){u(!0),a(void 0)}},{children:"Get info"}),void 0)]}),void 0):null,s?Object(l.jsx)(qe,{model:n.model,onClose:function(){return u(!1)}},void 0):null]}),void 0)})),Ze=Object(c.observer)((function(e){var t=e.model,n=e.track,o=t.resizeHandleWidth,i=n.model.height,a=Object(r.useRef)(null),c=Object(r.useRef)(!1),s=Object(r.useRef)(0);return Object(r.useEffect)((function(){var e=a.current;if(e)return e.addEventListener("wheel",n),function(){e.removeEventListener("wheel",n)};function n(e){var n=k()(e);s.current+=n.pixelX,c.current||(c.current=!0,requestAnimationFrame((function(){t.doScrollX(-s.current),s.current=0,c.current=!1}))),e.preventDefault()}}),[t]),Object(l.jsxs)("div",ze({style:{display:"flex",height:i}},{children:[Object(l.jsx)(Je,{model:t,track:n},void 0),Object(l.jsx)("div",{style:{width:o,flexShrink:0}},void 0),Object(l.jsx)("div",ze({ref:a},{children:Object(l.jsx)(n.ReactComponent,{model:t,track:n},void 0)}),void 0)]}),n.id)})),$e=function(){return($e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},et=function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e},tt=Object(c.observer)((function(e){var t=e.name,n=e.value,r=e.setValue,o=e.setName;return Object(l.jsxs)("div",{children:[Object(l.jsx)(pe.a,{value:t,onChange:function(e){return o(e.target.value)},label:"Key"},void 0),Object(l.jsx)(pe.a,{value:n,onChange:function(e){return r(e.target.value)},label:"Value"},void 0)]},void 0)})),nt=Object(c.observer)((function(e){var t=e.onClose,n=e.data,o=e.model,i=n.left,a=n.right,c=Object(r.useState)([["Name",""]]),s=c[0],d=c[1];return Object(l.jsxs)(F.a,$e({onClose:function(){return t()},open:!0},{children:[Object(l.jsx)(I.a,{children:"Create new region annotation"},void 0),Object(l.jsxs)(H.a,{children:[Object(l.jsxs)(u.a,{children:["Do you want to add an annotation to the MSA at ",i,"..",a," (real position ",o.getRealPos(i),"..",o.getRealPos(a),")"]},void 0),s.map((function(e,t){var n=e[0],r=e[1];return Object(l.jsx)(tt,{name:n,value:r,setValue:function(e){var n=et([],s);n[t][1]=e,d(n)},setName:function(e){var n=et([],s);n[t][0]=e,d(n)}},t)})),Object(l.jsx)(v.a,$e({onClick:function(){d(et(et([],s),[["",""]]))}},{children:"Add row"}),void 0),Object(l.jsxs)(me.a,{children:[Object(l.jsx)(v.a,$e({onClick:function(){o.addRelativeAnnotation(i,a,function(e){var t={};return e.forEach((function(e){var n=e[0],r=e[1];t[n]||(t[n]=[]),t[n].push(r)})),t}(s)),t()},variant:"contained",color:"primary"},{children:"Submit"}),void 0),Object(l.jsx)(v.a,$e({variant:"contained",color:"secondary",onClick:function(){return t()}},{children:"Cancel"}),void 0)]},void 0)]},void 0)]}),void 0)})),rt=Object(c.observer)((function(e){var t=e.model,n=t.resizeHandleWidth,o=Object(r.useState)(!1),i=o[0],a=o[1],c=Object(r.useRef)(!1),s=Object(r.useRef)(0);return Object(r.useEffect)((function(){function e(e){e.preventDefault();var n=e.clientX;if(0===s.current)s.current=e.clientX;else{var r=n-s.current;r&&(c.current||(c.current=!0,window.requestAnimationFrame((function(){t.setTreeAreaWidth(t.treeAreaWidth+r),c.current=!1,s.current=e.clientX}))))}}function n(){s.current=0,i&&a(!1)}return i?(document.addEventListener("mousemove",e,!0),document.addEventListener("mouseup",n,!0),function(){document.removeEventListener("mousemove",e,!0),document.removeEventListener("mouseup",n,!0)}):function(){}}),[i,t]),Object(l.jsx)("div",{children:Object(l.jsx)("div",{onMouseDown:function(){return a(!0)},style:{cursor:"ew-resize",height:"100%",width:n,background:"rgba(200,200,200)",position:"relative"}},void 0)},void 0)})),ot=Object(c.observer)((function(e){var t=e.model,n=t.resizeHandleWidth,o=Object(r.useState)(!1),i=o[0],a=o[1],c=Object(r.useRef)(!1),s=Object(r.useRef)(0);return Object(r.useEffect)((function(){function e(e){e.preventDefault();var n=e.clientY;if(0===s.current)s.current=e.clientY;else{var r=n-s.current;r&&(c.current||(c.current=!0,window.requestAnimationFrame((function(){t.setHeight(t.height+r),c.current=!1,s.current=e.clientY}))))}}function n(){s.current=0,i&&a(!1)}return i?(document.addEventListener("mousemove",e,!0),document.addEventListener("mouseup",n,!0),function(){document.removeEventListener("mousemove",e,!0),document.removeEventListener("mouseup",n,!0)}):function(){}}),[i,t]),Object(l.jsx)("div",{children:Object(l.jsx)("div",{onMouseDown:function(){return a(!0)},style:{cursor:"ns-resize",width:"100%",height:n,background:"rgba(200,200,200)",position:"relative"}},void 0)},void 0)})),it=function(){return(it=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},at=Object(c.observer)((function(e){var t=e.model,n=Object(r.useRef)(null),o=t.height,i=t.width,a=t.treeAreaWidth,c=t.resizeHandleWidth,s=t.scrollX,u=t.mouseCol,d=t.colWidth;return Object(r.useEffect)((function(){if(n.current){var e=n.current.getContext("2d");if(e&&(e.resetTransform(),e.clearRect(0,0,i,o),void 0!==u)){var t=(u-1)*d+s+a+c;e.fillStyle="rgba(100,100,100,0.5)",e.fillRect(t,0,d,o)}}}),[u,d,s,o,c,a,i]),Object(l.jsx)("canvas",{ref:n,width:i,height:o,style:{position:"absolute",top:0,left:0,width:i,height:o,zIndex:1e3,pointerEvents:"none"}},void 0)})),ct=Object(c.observer)((function(e){var t=e.model,n=t.done,r=t.initialized,o=t.treeAreaWidth,i=t.height,a=(t.resizeHandleWidth,t.turnedOnTracks);return Object(l.jsxs)("div",{children:[r?n?Object(l.jsxs)("div",{children:[Object(l.jsxs)("div",it({style:{height:i,overflow:"hidden"}},{children:[Object(l.jsx)(We,{model:t},void 0),Object(l.jsx)("div",{children:Object(l.jsxs)("div",it({style:{position:"relative"}},{children:[Object(l.jsxs)("div",it({style:{display:"flex"}},{children:[Object(l.jsx)("div",it({style:{flexShrink:0,width:o}},{children:Object(l.jsx)(fe,{model:t},void 0)}),void 0),Object(l.jsx)(T,{model:t,ControlComponent:Object(l.jsx)(de,{model:t},void 0)},void 0)]}),void 0),null===a||void 0===a?void 0:a.map((function(e){return Object(l.jsx)(Ze,{model:t,track:e},e.model.id)})),Object(l.jsxs)("div",it({style:{display:"flex"}},{children:[Object(l.jsx)("div",it({style:{flexShrink:0,width:o}},{children:Object(l.jsx)(q,{model:t},void 0)}),void 0),Object(l.jsx)(rt,{model:t},void 0),Object(l.jsx)(ie,{model:t},void 0),Object(l.jsx)(at,{model:t},void 0)]}),void 0)]}),void 0)},void 0)]}),void 0),Object(l.jsx)(ot,{model:t},void 0)]},void 0):Object(l.jsx)(u.a,it({variant:"h4"},{children:"Loading..."}),void 0):Object(l.jsx)(g,{model:t},void 0),t.DialogComponent?Object(l.jsx)(t.DialogComponent,it({},t.DialogProps||{},{onClose:function(){t.setDialogComponent(void 0,void 0)}}),void 0):null,t.annotPos?Object(l.jsx)(nt,{data:t.annotPos,model:t,onClose:function(){return t.clearAnnotPos()}},void 0):null]},void 0)})),st=n(798),lt=n(797),ut=n(795),dt=n(796),ft=n(97),ht=n(211),vt=n(458),bt=n.n(vt),jt=n(206),pt=n.n(jt),mt=n(459),gt=function(){function e(e){this.MSA=Object(mt.parse)(e)}return e.prototype.getMSA=function(){return this.MSA},e.prototype.getRow=function(e){var t;return null===(t=this.MSA.alns.find((function(t){return t.id===e})))||void 0===t?void 0:t.seq.split("")},e.prototype.getWidth=function(){return this.MSA.alns[0].seq.length},e.prototype.getDetails=function(){return this.MSA.header},e.prototype.getNames=function(){return this.MSA.alns.map((function(e){return e.id}))},e.prototype.getStructures=function(){return{}},Object.defineProperty(e.prototype,"alignmentNames",{get:function(){return[]},enumerable:!1,configurable:!0}),e.prototype.getTree=function(){return{id:"root",noTree:!0,branchset:this.getNames().map((function(e){return{id:e,name:e}}))}},Object.defineProperty(e.prototype,"seqConsensus",{get:function(){return this.MSA.consensus},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"secondaryStructureConsensus",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tracks",{get:function(){var e;return(null===(e=this.seqConsensus)||void 0===e?void 0:e.trim())?[{id:"seqConsensus",name:"Sequence consensus",data:this.seqConsensus,customColorScheme:{"*":"white",":":"grey",".":"darkgrey"," ":"black"}}]:[]},enumerable:!1,configurable:!0}),e}();function Ot(e){for(var t=[],n={},r=e.split(/\s*(;|\(|\)|,|:)\s*/),o=0;o<r.length;o++){var i=r[o],a={};switch(i){case"(":n.branchset=[a],t.push(n),n=a;break;case",":t[t.length-1].branchset.push(a),n=a;break;case")":n=t.pop();break;case":":break;default:var c=r[o-1];")"===c||"("===c||","===c?n.name=i:":"===c&&(n.length=parseFloat(i))}}return n}var xt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},St=function(){function e(e,t){var n=pt.a.parseAll(e);this.data=n,this.MSA=n[t]}return e.prototype.getMSA=function(){return this.MSA},e.prototype.getRow=function(e){var t,n;return null===(n=null===(t=this.MSA)||void 0===t?void 0:t.seqdata[e])||void 0===n?void 0:n.split("")},e.prototype.getWidth=function(){var e,t=Object.keys(null===(e=this.MSA)||void 0===e?void 0:e.seqdata)[0];return this.getRow(t).length},Object.defineProperty(e.prototype,"alignmentNames",{get:function(){return this.data.map((function(e,t){var n;return(null===(n=e.gf.DE)||void 0===n?void 0:n[0])||"Alignment "+(t+1)}))},enumerable:!1,configurable:!0}),e.prototype.getDetails=function(){var e,t;return{General:this.MSA.gf,Accessions:null===(e=this.MSA.gs)||void 0===e?void 0:e.AC,Dbxref:null===(t=this.MSA.gs)||void 0===t?void 0:t.DR}},e.prototype.getRowDetails=function(e){var t,n;return{name:e,accession:null===(t=this.MSA.gs)||void 0===t?void 0:t.AC[e],dbxref:null===(n=this.MSA.gs)||void 0===n?void 0:n.DR[e]}},e.prototype.getNames=function(){return Object.keys(this.MSA.seqdata)},e.prototype.getSeqCoords=function(){},e.prototype.getStructures=function(){var e,t=/PDB; +(\S+) +(\S); ([0-9]+)-([0-9]+)/,n=this.MSA;return Object.entries((null===(e=n.gs)||void 0===e?void 0:e.DR)||{}).map((function(e){var n=e[0],r=e[1];return[n,t.exec(r)]})).filter((function(e){return!!e[1]})).map((function(e){var t=e[0],n=e[1];return{id:t,pdb:n[1].toLowerCase(),chain:n[2],startPos:+n[3],endPos:+n[4]}})).reduce((function(e,t){var n=t.id,r=xt(t,["id"]);return e[n]||(e[n]=[]),e[n].push(r),e}),{})},e.prototype.getTree=function(){var e,t,n,r=null===(n=null===(t=null===(e=this.MSA)||void 0===e?void 0:e.gf)||void 0===t?void 0:t.NH)||void 0===n?void 0:n[0];return r?te(Ot(r)):{id:"root",noTree:!0,branchset:this.getNames().map((function(e){return{id:e,name:e}}))}},Object.defineProperty(e.prototype,"seqConsensus",{get:function(){var e;return null===(e=this.MSA.gc)||void 0===e?void 0:e.seq_cons},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"secondaryStructureConsensus",{get:function(){var e;return null===(e=this.MSA.gc)||void 0===e?void 0:e.SS_cons},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tracks",{get:function(){return[{id:"seqConsensus",name:"Sequence consensus",data:this.seqConsensus,customColorScheme:{}},{id:"secondaryStruct",name:"Secondary-structure",data:this.secondaryStructureConsensus,customColorScheme:{">":"pink","<":"lightblue"}}]},enumerable:!1,configurable:!0}),e}(),yt=function(){function e(e){var t={},n="",r=/^>(\S+)/;e.split("\n").forEach((function(e){var o=r.exec(e);o?t[n=o[1]]="":n&&(t[n]=t[n]+e.replace(/[ \t]/g,""))})),this.MSA={seqdata:t}}return e.prototype.getMSA=function(){return this.MSA},e.prototype.getNames=function(){return Object.keys(this.MSA.seqdata)},e.prototype.getRow=function(e){var t,n;return null===(n=null===(t=this.MSA)||void 0===t?void 0:t.seqdata[e])||void 0===n?void 0:n.split("")},e.prototype.getWidth=function(){var e,t=Object.keys(null===(e=this.MSA)||void 0===e?void 0:e.seqdata)[0];return this.getRow(t).length},e.prototype.getStructures=function(){return{}},Object.defineProperty(e.prototype,"alignmentNames",{get:function(){return[]},enumerable:!1,configurable:!0}),e.prototype.getDetails=function(){return{}},e.prototype.getTree=function(){return{id:"root",noTree:!0,branchset:this.getNames().map((function(e){return{id:e,name:e}}))}},Object.defineProperty(e.prototype,"seqConsensus",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"secondaryStructureConsensus",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tracks",{get:function(){return[]},enumerable:!1,configurable:!0}),e}(),wt=n(460),At=n.n(wt),Lt=function(){return(Lt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Pt=Object(c.observer)((function(e){var t=e.track,n=e.model,o=e.offsetX,i=n.blockSize,a=n.scrollX,c=n.bgColor,s=n.colorScheme,u=n.colWidth,d=n.rowHeight,f=n.highResScaleFactor,h=t.model,v=h.customColorScheme,b=h.data,j=v||s,p=Object(z.a)(),m=Object(r.useRef)(null),g=Object(r.useMemo)((function(){return ne(j,p)}),[j,p]);return Object(r.useEffect)((function(){if(m.current){var e=m.current.getContext("2d");if(e){e.resetTransform(),e.scale(f,f),e.clearRect(0,0,i,d),e.translate(-o,0),e.textAlign="center",e.font=e.font.replace(/\d+px/,Math.max(8,d-8)+"px");for(var t=Math.max(0,Math.floor(o/u)),n=Math.max(0,Math.ceil((o+i)/u)),r=null===b||void 0===b?void 0:b.slice(t,n),a=0;r&&a<r.length;a++){var s=r[a],l=j[s.toUpperCase()];if(c){var h=a*u+o-o%u;e.fillStyle=l||"white",e.fillRect(h,0,u,d),d>=10&&u>=d/2&&(e.fillStyle=g[s.toUpperCase()]||"black",e.fillText(s,h+u/2,d/2+1))}}}}}),[c,i,u,d,o,g,j,f,b]),Object(l.jsx)("canvas",{ref:m,height:d*f,width:i*f,style:{position:"absolute",left:a+o,width:i,height:d}},void 0)})),Ct=Object(c.observer)((function(e){var t=e.track,n=e.model,r=n.blocksX,o=n.msaAreaWidth,i=n.rowHeight;return Object(l.jsx)("div",Lt({style:{position:"relative",height:i,width:o,overflow:"hidden"}},{children:r.map((function(e){return Object(l.jsx)(Pt,{track:t,model:n,offsetX:e},e)}))}),void 0)})),Tt=function(){function e(e){var t=(void 0===e?{}:e).maxHeight,n=void 0===t?1e4:t;this.maxHeightReached=!1,this.rbush=new D.a,this.rectangles=new Map,this.maxHeight=Math.ceil(n),this.pTotalHeight=0}return e.prototype.addRect=function(e,t,n,r,o){var i=this.rectangles.get(e);if(i)return i.minY;for(var a=0;this.rbush.collides({minX:t,minY:a,maxX:n,maxY:a+r})&&a<=this.maxHeight;)a+=1;var c={minX:t,minY:a,maxX:n,maxY:a+r,id:e,data:o};return this.rbush.insert(c),this.rectangles.set(e,c),this.pTotalHeight=Math.max(this.pTotalHeight,a),a},Object.defineProperty(e.prototype,"totalHeight",{get:function(){return this.pTotalHeight},enumerable:!1,configurable:!0}),e}(),Mt=function(){return(Mt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Rt=Object(c.observer)((function(e){var t=e.track,n=e.model,o=e.offsetX,i=n.blockSize,a=n.colWidth,c=n.blanks,u=n.rowHeight,d=n.highResScaleFactor,f=n.scrollX,h=t.model,v=h.height,b=h.features,j=h.associatedRowName,p=Object(r.useMemo)((function(){var e=new Tt;return null===b||void 0===b||b.forEach((function(t,r){var o=t.start,i=t.end;if(j){var a=n.bpToPx(j,o-1),c=n.bpToPx(j,i);e.addRect(""+r,a,c,u,t)}else e.addRect(""+r,o,i,u,t)})),e}),[u,Object(s.isStateTreeNode)(b)?Object(s.getSnapshot)(b):b,j,n,c]),m=Object(r.useRef)(null),g=Object(r.useRef)(null),O=Object(r.useRef)(null);return Object(r.useEffect)((function(){if(m.current){var e=m.current.getContext("2d");if(e){e.resetTransform(),e.scale(d,d),e.clearRect(0,0,i,v),e.translate(-o,0),e.textAlign="center",e.font=e.font.replace(/\d+px/,Math.max(8,u-8)+"px");var t=Math.max(0,Math.floor(o/a));e.fillStyle="goldenrod",p.rectangles.forEach((function(n){var r=n.minX,i=n.maxX,c=n.minY,s=n.maxY,l=(r-t)*a+o-o%a,u=(i-t)*a+o-o%a;u-l>0&&e.fillRect(l,c,u-l,(s-c)/2)}))}}}),[j,i,a,p.rectangles,n,u,v,o,d,b,c]),Object(r.useEffect)((function(){if(g.current){var e=g.current.getContext("2d");e&&(e.resetTransform(),e.scale(d,d),e.clearRect(0,0,i,v),e.translate(-o,0),e.textAlign="center",e.font=e.font.replace(/\d+px/,Math.max(8,u-8)+"px"),e.fillStyle="black",e.textAlign="left",p.rectangles.forEach((function(t){var n,r,o,i,c=t.minX,s=t.maxX,l=t.maxY,u=t.minY,d=t.data,h=c*a,v=s*a;if(v-h>0){var b=null===(r=null===(n=d.attributes)||void 0===n?void 0:n.Note)||void 0===r?void 0:r[0],j=null===(i=null===(o=d.attributes)||void 0===o?void 0:o.Name)||void 0===i?void 0:i[0],p=d.type;e.fillText([p,j,b].filter((function(e){return!!e})).join(" - "),Math.max(Math.min(-f,v),h),u+(l-u))}})))}}),[i,a,f,d,v,p.rectangles,o,b,n,u,c]),b?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("canvas",{ref:m,height:v*d,width:i*d,style:{position:"absolute",left:f+o,width:i,height:v}},void 0),Object(l.jsx)("canvas",{ref:g,height:v*d,width:i*d,style:{position:"absolute",left:f+o,width:i,height:v}},void 0),Object(l.jsx)("canvas",{ref:O,height:v*d,width:i*d,style:{position:"absolute",left:f+o,width:i,height:v}},void 0)]},void 0):null})),Et=Object(c.observer)((function(e){var t=e.model,n=e.track,r=t.blocksX,o=t.msaAreaWidth,i=n.model.height;return Object(l.jsx)("div",Mt({style:{position:"relative",height:i,width:o,overflow:"hidden"}},{children:r.map((function(e){return Object(l.jsx)(Rt,{track:n,model:t,offsetX:e},e)}))}),void 0)})),kt=function(){return(kt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Nt=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function c(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},Dt=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},Ft=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},It=function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e};function Ht(e,t){for(var n="",r=0,o=0;o<t.length;o++)o===e[r]?r++:n+=t[o];return n}function Yt(e,t,n){var r;e.len=(t+=Math.max(e.data.length||0,0))*n,null===(r=e.children)||void 0===r||r.forEach((function(e){Yt(e,t,n)}))}function Vt(e){return(e.data.length||1)+(e.children?Object(ut.a)(e.children,Vt):0)}function Wt(e){e.children&&(e._children=e.children,e._children.forEach(Wt),e.children=null)}function Gt(e,t,n){return Math.min(Math.max(t,e),n)}var Xt=s.types.model({id:s.types.identifier,structure:s.types.model({pdb:s.types.string,startPos:s.types.number,endPos:s.types.number}),range:s.types.maybe(s.types.string)}),Ut=s.types.model({id:s.types.string,accession:s.types.string,name:s.types.string,associatedRowName:s.types.string,height:s.types.optional(s.types.number,100)}).volatile((function(){return{error:void 0,data:void 0}})).actions((function(e){return{setError:function(t){e.error=t},setData:function(t){e.data=t}}})).actions((function(e){return{afterCreate:function(){var t=this;Object(s.addDisposer)(e,Object(b.autorun)((function(){return Nt(t,void 0,void 0,(function(){var t,n,r,o,i;return Dt(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),t=e.accession,n="https://www.uniprot.org/uniprot/"+t+".gff",[4,fetch(n)];case 1:if(!(r=a.sent()).ok)throw new Error("HTTP "+r.status+" "+r.statusText+" fetching "+n);return[4,r.text()];case 2:return o=a.sent(),e.setData(o),[3,4];case 3:return i=a.sent(),e.setError(i),[3,4];case 4:return[2]}}))}))})))}}})).views((function(e){return{get loading(){return!e.data},get features(){return At.a.parseStringSync(e.data).map((function(e){return e[0]}))}}})),Bt=s.types.model("MsaView",{id:ft.ElementId,type:s.types.literal("MsaView"),height:s.types.optional(s.types.number,550),treeAreaWidth:s.types.optional(s.types.number,400),treeWidth:s.types.optional(s.types.number,300),rowHeight:20,scrollY:0,scrollX:0,resizeHandleWidth:5,blockSize:1e3,mouseRow:s.types.maybe(s.types.number),mouseCol:s.types.maybe(s.types.number),selectedStructures:s.types.array(Xt),labelsAlignRight:!1,colWidth:16,showBranchLen:!0,bgColor:!0,drawTree:!0,drawNodeBubbles:!0,highResScaleFactor:2,colorSchemeName:"maeditor",treeFilehandle:s.types.maybe(ft.FileLocation),msaFilehandle:s.types.maybe(ft.FileLocation),currentAlignment:0,collapsed:s.types.array(s.types.string),showOnly:s.types.maybe(s.types.string),boxTracks:s.types.array(Ut),turnedOffTracks:s.types.map(s.types.boolean),annotatedRegions:s.types.array(s.types.model({start:s.types.number,end:s.types.number,attributes:s.types.frozen()})),data:s.types.optional(s.types.model({tree:s.types.maybe(s.types.string),msa:s.types.maybe(s.types.string)}).actions((function(e){return{setTree:function(t){e.tree=t},setMSA:function(t){e.msa=t}}})),{tree:"",msa:""})}).volatile((function(){return{error:void 0,margin:{left:20,top:20},DialogComponent:void 0,DialogProps:void 0,annotPos:void 0}})).actions((function(e){return{setDialogComponent:function(t,n){e.DialogComponent=t,e.DialogProps=n},setHeight:function(t){e.height=t},addStructureToSelection:function(t){e.selectedStructures.push(t)},removeStructureFromSelection:function(t){var n=e.selectedStructures.find((function(e){return e.id===t.id}));n&&e.selectedStructures.remove(n)},toggleStructureSelection:function(t){var n=e.selectedStructures.find((function(e){return e.id===t.id}));n?e.selectedStructures.remove(n):e.selectedStructures.push(t)},clearSelectedStructures:function(){e.selectedStructures=[]},setError:function(t){console.error(t),e.error=t},setMousePos:function(t,n){e.mouseCol=t,e.mouseRow=n},setRowHeight:function(t){e.rowHeight=t},setColWidth:function(t){e.colWidth=t},setColorSchemeName:function(t){e.colorSchemeName=t},setScrollY:function(t){e.scrollY=t},setScrollX:function(t){e.scrollX=t},setTreeAreaWidth:function(t){e.treeAreaWidth=t},setTreeWidth:function(t){e.treeWidth=t},setCurrentAlignment:function(t){e.currentAlignment=t},toggleLabelsAlignRight:function(){e.labelsAlignRight=!e.labelsAlignRight},toggleDrawTree:function(){e.drawTree=!e.drawTree},toggleCollapsed:function(t){e.collapsed.includes(t)?e.collapsed.remove(t):e.collapsed.push(t)},setShowOnly:function(t){e.showOnly=t},toggleBranchLen:function(){e.showBranchLen=!e.showBranchLen},toggleBgColor:function(){e.bgColor=!e.bgColor},toggleNodeBubbles:function(){e.drawNodeBubbles=!e.drawNodeBubbles},setData:function(t){e.data=Object(s.cast)(t)},setMSAFilehandle:function(t){return Nt(this,void 0,void 0,(function(){return Dt(this,(function(n){return e.msaFilehandle=t,[2]}))}))},setTreeFilehandle:function(t){return Nt(this,void 0,void 0,(function(){var n;return Dt(this,(function(r){switch(r.label){case 0:return t&&"blobId"in t?[4,Object(ht.openLocation)(t).readFile("utf8")]:[3,2];case 1:return n=r.sent(),this.setTree(n),[3,3];case 2:e.treeFilehandle=t,r.label=3;case 3:return[2]}}))}))},setMSA:function(t){e.data.setMSA(t)},setTree:function(t){e.data.setTree(t)},afterCreate:function(){var t=this;Object(s.addDisposer)(e,Object(b.autorun)((function(){return Nt(t,void 0,void 0,(function(){var t,n,r;return Dt(this,(function(o){switch(o.label){case 0:if(!(t=e.treeFilehandle))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),n=this.setTree,[4,Object(ht.openLocation)(t).readFile("utf8")];case 2:return n.apply(this,[o.sent()]),[3,4];case 3:return r=o.sent(),this.setError(r),[3,4];case 4:return[2]}}))}))}))),Object(s.addDisposer)(e,Object(b.autorun)((function(){return Nt(t,void 0,void 0,(function(){var t,n,r;return Dt(this,(function(o){switch(o.label){case 0:if(!(t=e.msaFilehandle))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),n=this.setMSA,[4,Object(ht.openLocation)(t).readFile("utf8")];case 2:return n.apply(this,[o.sent()]),[3,4];case 3:return r=o.sent(),this.setError(r),[3,4];case 4:return[2]}}))}))})))}}})).views((function(e){var t=[],n=[],r=0,o=0;return{get initialized(){return(e.data.msa||e.data.tree||e.msaFilehandle||e.treeFilehandle)&&!e.error},get blocksX(){for(var n=e.scrollX,o=e.blockSize,i=e.colWidth,a=-o*Math.floor(n/o)-o,c=[],s=a;s<a+3*o;s+=o)s+o>0&&c.push(s);return JSON.stringify(c)===JSON.stringify(t)&&i===r||(t=c,r=i),t},get blocksY(){for(var t=e.scrollY,r=e.blockSize,i=e.rowHeight,a=-r*Math.floor(t/r)-2*r,c=[],s=a;s<a+3*r;s+=r)s+r>0&&c.push(s);return JSON.stringify(c)===JSON.stringify(n)&&i===o||(n=c,o=i),n}}})).views((function(e){return{get blocks2d(){return e.blocksY.map((function(t){return e.blocksX.map((function(e){return[e,t]}))})).flat()},get done(){return e.initialized&&(e.data.msa||e.data.tree)},get colorScheme(){return ge[e.colorSchemeName]},get alignmentDetails(){var e;return(null===(e=this.MSA)||void 0===e?void 0:e.getDetails())||{}},getRowDetails:function(e){var t,n=null===(t=this.MSA)||void 0===t?void 0:t.getRowDetails(e),r=e.match(/\S+\/(\d+)-(\d+)/);return kt(kt({},n),r&&{range:{start:+r[1],end:+r[2]}})},get currentAlignmentName(){return this.alignmentNames[e.currentAlignment]},get alignmentNames(){var e;return(null===(e=this.MSA)||void 0===e?void 0:e.alignmentNames)||[]},get noTree(){return!!this.tree.noTree},get menuItems(){return[]},get MSA(){var t=e.data.msa;return t?pt.a.sniff(t)?new St(t,e.currentAlignment):t.startsWith(">")?new yt(t):new gt(t):null},get numColumns(){var t;return(((null===(t=this.MSA)||void 0===t?void 0:t.getWidth())||0)-this.blanks.length)*e.colWidth},get tree(){var t;return e.data.tree?te(Ot(e.data.tree)):(null===(t=this.MSA)||void 0===t?void 0:t.getTree())||{noTree:!0}},get rowNames(){return this.hierarchy.leaves().map((function(e){return e.data.name}))},get mouseOverRowName(){return void 0!==e.mouseRow?this.rowNames[e.mouseRow]:void 0},getMouseOverResidue:function(e){return this.columns[e]},get root(){var t=Object(st.a)(this.tree,(function(e){return e.branchset})).sum((function(e){return e.branchset?0:1})).sort((function(e,t){return Object(dt.a)(e.data.length||1,t.data.length||1)}));if(e.showOnly){var n=t.find((function(t){return t.data.id===e.showOnly}));n&&(t=n)}return e.collapsed.length&&e.collapsed.map((function(e){return t.find((function(t){return t.data.id===e}))})).filter((function(e){return!!e})).map((function(e){return Wt(e)})),t},get structures(){var e;return(null===(e=this.MSA)||void 0===e?void 0:e.getStructures())||{}},get inverseStructures(){var e=Object.entries(this.structures).map((function(e){var t=e[0];return e[1].map((function(e){return[e.pdb,{id:t}]}))})).flat();return Object.fromEntries(e)},get msaAreaWidth(){return e.width-e.treeAreaWidth},get blanks(){for(var e,t=this,n=[],r=this.hierarchy.leaves().map((function(e){var n,r=e.data;return null===(n=t.MSA)||void 0===n?void 0:n.getRow(r.name)})).filter((function(e){return!!e})),o=0;o<(null===(e=r[0])||void 0===e?void 0:e.length);o++){for(var i=0,a=0;a<r.length;a++)"-"===r[a][o]&&i++;i===r.length&&n.push(o)}return n},get rows(){var e=this;return this.hierarchy.leaves().map((function(t){var n,r=t.data;return[r.name,null===(n=e.MSA)||void 0===n?void 0:n.getRow(r.name)]})).filter((function(e){return!!e[1]}))},get columns(){var e=this.rows,t=this.columns2d;return Object.fromEntries(e.map((function(e,n){return[e[0],t[n]]})))},get columns2d(){for(var e=this.rows.map((function(e){return e[1]})),t=[],n=0;n<e.length;n++)t.push(Ht(this.blanks,e[n]));return t},get hierarchy(){var t=this.root;return Object(lt.a)().size([this.totalHeight,e.treeWidth]).separation((function(){return 1}))(t),Yt(t,t.data.length=0,e.treeWidth/Vt(t)),t},get totalHeight(){return this.root.leaves().length*e.rowHeight}}})).actions((function(e){return{addUniprotTrack:function(t){e.boxTracks.find((function(e){return e.name===t.name}))?e.turnedOffTracks.has(t.name)&&this.toggleTrack(t.name):e.boxTracks.push(kt(kt({},t),{id:t.name,associatedRowName:t.name}))},doScrollY:function(t){e.scrollY=Gt(10-e.totalHeight,e.scrollY+t,0)},doScrollX:function(t){e.scrollX=Gt(-e.numColumns+(e.msaAreaWidth-100),e.scrollX+t,0)},setMouseoveredColumn:function(t,n,r){var o,i=0,a=0,c=(e.inverseStructures[r.slice(0,-4)]||{}).id,s=null===(o=e.MSA)||void 0===o?void 0:o.getRow(c);if(s){for(a=0;a<s.length&&i<t;a++)"-"!==s[a]&&i++;e.mouseCol=i+1}else e.mouseCol=void 0},toggleTrack:function(t){e.turnedOffTracks.has(t)?e.turnedOffTracks.delete(t):e.turnedOffTracks.set(t,!0)}}})).views((function(e){return{get secondaryStructureConsensus(){var t;return null===(t=e.MSA)||void 0===t?void 0:t.secondaryStructureConsensus},get seqConsensus(){var t;return null===(t=e.MSA)||void 0===t?void 0:t.seqConsensus},get conservation(){var t=e.columns2d;if(t.length)for(var n=0;n<t[0].length;n++)for(var r=[],o=0;o<t.length;o++)r.push(t[o][n]);return["a"]},get tracks(){var t=e.blanks,n=e.MSA?e.MSA.tracks.map((function(n){var r=n.data;return{model:kt(kt({},n),{data:r?Ht(t,r):void 0,height:e.rowHeight}),ReactComponent:Ct}})):[],r=e.boxTracks.filter((function(t){return!!e.rows.find((function(e){return e[0]===t.name}))})).map((function(e){return{model:e,ReactComponent:Et}})),o=e.annotatedRegions.length>0?[{model:{features:e.annotatedRegions,height:100,id:"annotations",name:"User-created annotations",data:e.annotatedRegions.map((function(e){var t,n=e.attributes?null===(t=Object.entries(e.attributes))||void 0===t?void 0:t.map((function(e){return e[0]+"="+e[1].join(",")})).join(";"):".";return["MSA_refcoord",".",".",e.start,e.end,".",".",".",n].join("\t")})).join("\n")},ReactComponent:Et}]:[];return It(It(It([],n),r),o)},get turnedOnTracks(){return this.tracks.filter((function(t){return!e.turnedOffTracks.has(t.model.id)}))},pxToBp:function(t){return Math.floor((t-e.scrollX)/e.colWidth)},bpToPx:function(t,n){var r,o=e.rowNames,i=e.rows,a=e.blanks,c=i[o.indexOf(t)][1],s=n-((null===(r=e.getRowDetails(t).range)||void 0===r?void 0:r.start)||0);if(s<0)return 0;for(var l=0,u=0;u<c.length&&("-"===c[u]||l++!==s);u++);for(var d=0,f=0;f<c.length;f++)-1!==a.indexOf(f)&&f<u+1&&d++;return u-d}}})).actions((function(e){return{addRelativeAnnotation:function(t,n,r){e.annotatedRegions.push({start:this.getRealPos(t),end:this.getRealPos(n),attributes:r})},getRealPos:function(t){for(var n=0,r=0,o=0;r<t;r++,n++)for(;n===e.blanks[o];)o++,n++;return n},setOffsets:function(t,n){e.annotPos={left:t,right:n}},clearAnnotPos:function(){e.annotPos=void 0}}})),_t=s.types.snapshotProcessor(s.types.compose(bt.a,Bt),{postProcessor:function(e){var t=e.data,n=t.tree,r=t.msa,o=Ft(e,["data"]);return kt({data:kt(kt({},!e.treeFilehandle&&{tree:n}),!e.msaFilehandle&&{msa:r})},o)}}),Kt=n(281),qt=n(783),zt=n(461),Qt=s.types.model({msaview:_t,nglSelection:s.types.optional(s.types.string,"")}).actions((function(e){return{setNGLSelection:function(t){e.nglSelection=t}}})),Jt=n(54),Zt=n.n(Jt),$t=n(462),en=n(14),tn=n(212);tn.a.add("data",new tn.c("https://files.rcsb.org/download/"));var nn=Object(c.observer)((function(e){var t=e.model,n=Object(r.useState)("cartoon"),o=Object(en.a)(n,2),i=o[0],a=o[1],c=Object(r.useState)([]),s=Object(en.a)(c,2),u=s[0],d=s[1],f=Object(r.useState)(),h=Object(en.a)(f,2),b=h[0],j=h[1],p=Object(r.useState)(),m=Object(en.a)(p,2),g=m[0],O=m[1],x=Object(r.useState)(!1),S=Object(en.a)(x,2),y=S[0],w=S[1],A=t.msaview,L=t.nglSelection,P=A.selectedStructures,C=A.mouseCol,T=Object(r.useCallback)((function(e){if(e){var t=new tn.b(e);O(t)}}),[]);return Object(r.useEffect)((function(){return function(){g&&g.dispose()}}),[g]),Object(r.useEffect)((function(){P.length&&g&&Object($t.a)(Zt.a.mark((function e(){var t;return Zt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.addEventListener("resize",(function(){g.handleResize()})),e.next=3,Promise.all(P.map((function(e){return g.loadFile("data://".concat(e.structure.pdb,".pdb"))})));case 3:t=e.sent,d(t),g.signals.hovered.add((function(e){if(e&&(e.atom||e.bond)){var t=e.atom||e.closestBondAtom;A.setMouseoveredColumn(t.resno-P[0].structure.startPos,t.chainname,e.picker.structure.name)}}));case 6:case"end":return e.stop()}}),e)})))()}),[JSON.stringify(P),g]),Object(r.useEffect)((function(){g&&(u.forEach((function(e){e.removeAllRepresentations(),e.addRepresentation(i,{sele:L})})),g.autoView())}),[i,u,g,L]),Object(r.useEffect)((function(){if(!y){var e=[];u.forEach((function(t,n){if(b&&t.removeAnnotation(b[n]),void 0!==C){for(var r,o=P[0].structure.startPos,i=t.structure.residueStore.count,a=t.structure.getResidueProxy(),c=0;c<i;++c)if(a.index=c,a.resno===C+o-1){r=a;break}if(r){var s=t.structure.getAtomProxy();s.index=r.atomOffset,e.push(t.addAnnotation(s.positionToVector3(),r.qualifiedName()))}}g.viewer.requestRender()})),j(e)}}),[t,C,y]),P.length?Object(l.jsxs)("div",{style:{padding:20},children:[Object(l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(l.jsx)(v.a,{onClick:function(){return A.clearSelection()},variant:"contained",children:"Clear"}),Object(l.jsx)("div",{style:{width:20}}),Object(l.jsxs)(ve.a,{value:i,onChange:function(e){return a(e.target.value)},children:[Object(l.jsx)(R.a,{value:"cartoon",children:"cartoon"}),Object(l.jsx)(R.a,{value:"ball+stick",children:"ball+stick"})]}),Object(l.jsx)("div",{style:{width:20}}),Object(l.jsx)(pe.a,{variant:"outlined",label:"Selection",value:L,onChange:function(e){return t.setNGLSelection(e.target.value)}})]}),Object(l.jsx)("div",{ref:T,style:{width:600,height:400},onMouseEnter:function(){return w(!0)},onMouseLeave:function(){return w(!1)}})]}):null})),rn=new URLSearchParams(window.location.search).get("data"),on=Qt.create(rn?JSON.parse(rn):{msaview:{type:"MsaView"}});on.msaview.setWidth(window.innerWidth),Object(s.onSnapshot)(on,Object(zt.throttle)((function(e){var t=new URL(window.document.URL);t.searchParams.set("data",JSON.stringify(e)),window.history.replaceState(null,"",t.toString())}),500)),window.addEventListener("resize",(function(){on.msaview.setWidth(window.innerWidth)}));var an=Object(c.observer)((function(e){var t=e.model,n=t.msaview;return Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{style:{border:"1px solid black",margin:20},children:Object(l.jsx)(ct,{model:n})}),Object(l.jsx)(nn,{model:t})]})})),cn=function(){var e=Object(Kt.createJBrowseTheme)();return Object(l.jsx)(qt.a,{theme:e,children:Object(l.jsx)(an,{model:on})})},sn=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,803)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),i(e),a(e)}))};a.a.render(Object(l.jsx)(o.a.StrictMode,{children:Object(l.jsx)(cn,{})}),document.getElementById("root")),sn()}},[[751,1,2]]]);
//# sourceMappingURL=main.a2d97358.chunk.js.map