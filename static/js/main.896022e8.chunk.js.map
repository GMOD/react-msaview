{"version":3,"sources":["../../lib/dist/components/ImportForm.js","../../lib/dist/components/data/seq2.js","../../lib/dist/components/Rubberband.js","../../lib/dist/components/MoreInfoDlg.js","../../lib/dist/components/TreeCanvas.js","../../lib/dist/util.js","../../lib/dist/colorSchemes.js","../../lib/dist/components/MSACanvas.js","../../lib/dist/components/Ruler.js","../../lib/dist/components/TreeRuler.js","../../lib/dist/components/SettingsDlg.js","../../lib/dist/components/AboutDlg.js","../../lib/dist/components/DetailsDlg.js","../../lib/dist/components/TracklistDlg.js","../../lib/dist/components/Header.js","../../lib/dist/components/TrackInfoDlg.js","../../lib/dist/components/Track.js","../../lib/dist/components/AnnotationDlg.js","../../lib/dist/components/ResizeHandles.js","../../lib/dist/components/MSAView.js","../../lib/dist/parsers/ClustalMSA.js","../../lib/dist/parseNewick.js","../../lib/dist/parsers/StockholmMSA.js","../../lib/dist/parsers/FastaMSA.js","../../lib/dist/components/TextTrack.js","../../lib/dist/layout.js","../../lib/dist/components/BoxTrack.js","../../lib/dist/model.js","model.ts","ProteinPanel.js","App.tsx","reportWebVitals.ts","index.tsx"],"names":["ListItem","_a","onClick","model","children","React","createElement","Link","event","setError","undefined","preventDefault","href","Typography","observer","_b","useState","msaFile","setMsaFile","_c","treeFile","setTreeFile","error","Container","style","width","padding","color","concat","Grid","container","spacing","justifyContent","alignItems","item","FileSelector","location","setLocation","Button","setMSAFilehandle","setTreeFilehandle","variant","disabled","uri","locationType","setData","msa","tree","transaction","useStyles","makeStyles","theme","rubberband","height","background","palette","tertiary","alpha","main","primary","position","zIndex","textAlign","overflow","rubberbandControl","cursor","minHeight","rubberbandText","contrastText","popover","mouseEvents","paper","paddingLeft","paddingRight","guide","pointerEvents","VerticalGuide","coordX","treeAreaWidth","classes","Fragment","Tooltip","open","placement","title","pxToBp","arrow","left","className","ControlComponent","startX","setStartX","_d","currentX","setCurrentX","_e","anchorPosition","setAnchorPosition","_f","guideX","setGuideX","controlsRef","useRef","rubberbandRef","mouseDragging","mouseDown","stopPropagation","relativeX","clientX","target","getBoundingClientRect","mouseMove","mouseOut","clearAnnotPos","handleClose","useEffect","globalMouseMove","current","globalMouseUp","clientY","offsetX","window","addEventListener","removeEventListener","Math","abs","colWidth","role","ref","onMouseDown","onMouseOut","onMouseMove","right","leftBpOffset","rightBpOffset","numOfBpSelected","ceil","menuItems","label","icon","AssignmentIcon","setOffsets","Popover","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","keepMounted","disableRestoreFocus","toLocaleString","Menu","anchorReference","top","onMenuItemClick","_","callback","Boolean","onClose","info","Dialog","DialogTitle","DialogContent","Attributes","attributes","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","radius","TreeMenu","node","structures","nodeDetails","getRowDetails","name","y","x","transitionDuration","MenuItem","dense","setDialogComponent","MoreInfoDlg","map","entry","selectedStructures","find","id","key","JSON","stringify","removeStructureFromSelection","structure","pdb","addStructureToSelection","accession","addUniprotTrack","TreeBranchMenu","toggleCollapsed","collapsed","includes","showOnly","setShowOnly","TreeBlock","offsetY","clickMap","RBush","mouseoverRef","branchMenu","setBranchMenu","toggleNodeMenu","setToggleNodeMenu","hoverElt","setHoverElt","hierarchy","rowHeight","scrollY","treeWidth","showBranchLen","margin","labelsAlignRight","noTree","blockSize","drawNodeBubbles","drawTree","highResScaleFactor","hoverBranchClickMap","nativeEvent","search","minX","maxX","minY","maxY","branch","hoverNameClickMap","clear","ctx","getContext","resetTransform","scale","clearRect","translate","font","replace","max","links","forEach","source","sy","sx","ty","tx","y1","min","y2","beginPath","moveTo","lineTo","stroke","descendants","val","data","strokeStyle","fillStyle","arc","PI","fill","insert","setLineDash","leaves","len","yp","xp","measureText","hasStructure","offset","width_1","fillText","canvas","fillRect","ret","data2","TreeCanvas","scheduled","deltaY","prevY","blocksY","setMouseDragging","curr","onWheel","origEvent","normalizeWheel","pixelY","requestAnimationFrame","doScrollY","cleanup","distanceY","draggable","dataset","resizer","button","onMouseUp","onMouseLeave","block","transform","obj","cb","fromEntries","entries","generateNodeIds","parent","depth","branchset","b","colorContrast","colorScheme","letter","getContrastText","Color","hex","clustal","G","P","S","T","H","K","R","F","W","Y","I","L","M","V","lesk","A","C","N","Q","D","E","maeditor","percent_identity_dynamic","flower","rainbow_dna","U","clustalx_protein","clustalx_protein_dynamic","clustalx_dna","jalview_buried","B","X","Z","jalview_hydrophobicity","jalview_prophelix","jalview_propstrand","jalview_propturn","jalview_taylor","jalview_zappo","cinema","getClustalXColor","stats","row","col","total","values","reduce","a","l","columns","_g","_h","_j","_k","_l","_m","_o","_p","_q","_r","_s","_t","_u","_v","WLVIMAFCHP","KR","QE","getPercentIdentityColor","ent","proportion","thresh","MSABlock","MSA","bgColor","scrollX","colorSchemeName","colStats","useTheme","contrastScheme","useMemo","yStart","floor","yEnd","xStart","xEnd","visibleLeaves","slice","str","toUpperCase","contrast","mouseX","mouseY","setMousePos","MSACanvas","msaFilehandle","msaAreaWidth","blocks2d","deltaX","prevX","pixelX","doScrollX","currX","currY","distanceX","bx","by","CircularProgress","makeTicks","start","end","bpPerPx","emitMajor","emitMinor","gridPitch","minMajorPitchPx","minMinorPitchPx","minMajorPitchBp","majorMagnitude","parseInt","Number","toExponential","split","majorPitch","pow","majorPitchPx","minorPitch","chooseGridPitch","minBase","maxBase","iterPitch","index","ticks","base","push","type","mathPower","num","String","substr","majorTickLabel","fontSize","majorTick","minorTick","RulerBlock","reversed","major","minor","tick","x1","x2","strokeWidth","filter","textAnchor","Ruler","resizeHandleWidth","blocksX","TreeRuler","rowHeightInit","colWidthInit","treeWidthInit","setRowHeight","setColWidth","setTreeWidth","isNaN","rowHeightError","colWidthError","treeWidthError","FormControlLabel","control","Checkbox","checked","onChange","toggleBranchLen","toggleBgColor","toggleNodeBubbles","toggleDrawTree","toggleLabelsAlignRight","TextField","value","select","setColorSchemeName","keys","colorSchemes","option","DialogActions","LicenseDialog","AboutDialog","dlgOpen","setDlgOpen","version","alignmentDetails","tracks","FormGroup","track","turnedOffTracks","has","toggleTrack","InfoArea","mouseOverRowName","mouseCol","display","marginLeft","Header","settingsDialogVisible","setSettingsDialogVisible","aboutDialogVisible","setAboutDialogVisible","detailsDialogVisible","setDetailsDialogVisible","tracklistDialogVisible","setTracklistDialogVisible","currentAlignment","alignmentNames","IconButton","setScrollY","setScrollX","setCurrentAlignment","FolderOpenIcon","SettingsIcon","ListIcon","SettingsDialog","DetailsDialog","TracklistDialog","Select","native","flex","HelpIcon","textArea","wordBreak","TrackInfoDialog","setLabel","fullWidth","maxWidth","copy","setTimeout","TrackLabel","setAnchorEl","trackInfoDlgOpen","setTrackInfoDlgOpen","trackLabelHeight","flexShrink","ArrowDropDownIcon","Track","ReactComponent","__spreadArray","to","from","pack","ar","Array","Row","setValue","setName","onDelete","DeleteIcon","blanks","r","rows","setRows","getPos","newValue","newRows","newName","splice","addAnnotation","specialFromEntries","VerticalResizeHandle","distance_1","setTreeAreaWidth","document","HorizontalResizeHandle","distance_2","setHeight","MouseoverCanvas","done","initialized","turnedOnTracks","Rubberband","ImportForm","DialogComponent","DialogProps","annotPos","AnnotationDialog","ClustalMSA","text","parse","getMSA","getRow","alns","aln","seq","getWidth","getDetails","header","getNames","getStructures","defineProperty","get","enumerable","configurable","getTree","consensus","seqConsensus","trim","customColorScheme","ancestors","tokens","token","subtree","pop","parseFloat","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","StockholmMSA","res","Stockholm","parseAll","seqdata","gf","DE","General","Accessions","gs","AC","Dbxref","DR","rowName","dbxref","getSeqCoords","pdbRegex","dr","exec","match","toLowerCase","chain","startPos","endPos","rest","NH","parseNewick","gc","seq_cons","SS_cons","secondaryStructureConsensus","FastaMSA","re","line","AnnotationBlock","modelColorScheme","AnnotationTrack","Layout","maxHeight","maxHeightReached","rbush","rectangles","Map","pTotalHeight","addRect","existingRecord","currHeight","collides","record","set","features","associatedRowName","feats","isStateTreeNode","getSnapshot","layout","temp","feature","rowSpecificBpToPx","globalBpToPx","labelRef","note","Note","name_1","Name","f","join","__awaiter","thisArg","_arguments","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","then","__generator","body","g","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","skipBlanks","arg","j","setBrLength","d","y0","k","maxLength","collapse","_children","clamp","StructureModel","types","identifier","string","number","range","maybe","UniprotTrack","optional","volatile","actions","self","afterCreate","_this","addDisposer","autorun","url","response","e_1","fetch","ok","Error","status","statusText","views","loading","startsWith","seq_id","score","strand","phase","col9","decodeURIComponent","MSAModel","ElementId","literal","mouseRow","array","treeFilehandle","FileLocation","boxTracks","boolean","annotatedRegions","frozen","setTree","setMSA","dlg","props","elt","remove","toggleStructureSelection","clearSelectedStructures","console","cast","openLocation","readFile","e_2","e_3","oldBlocksX","oldBlocksY","oldValX","oldValY","size","flat","details","matches","currentAlignmentName","sniff","numColumns","rowNames","getMouseOverResidue","root","hier","sum","sort","ascending","collapsedId","inverseStructures","pdbEntry","strs","counter","cols","columns2d","m","cluster","totalHeight","separation","clust","setMouseoveredColumn","file","delete","conservation","adapterTracks","TextTrack","BoxTrack","annotationTracks","region","attrs","coord","count","relativePxToBp","pos","snapshotProcessor","compose","BaseViewModel","postProcessor","App","msaview","nglSelection","setNGLSelection","sel","DatasourceRegistry","add","StaticDatasource","ProteinPanel","annotations","setType","setRes","stage","setStage","isMouseHovering","setMouseHovering","stageElementRef","useCallback","element","currentStage","Stage","dispose","handleResize","all","selection","loadFile","signals","hovered","pickingProxy","atom","bond","closestBondAtom","resno","chainname","picker","removeAllRepresentations","addRepresentation","sele","autoView","removeAnnotation","rn","residueStore","rp","getResidueProxy","getOffset","ap","getAtomProxy","atomOffset","positionToVector3","qualifiedName","viewer","requestRender","onMouseEnter","URLSearchParams","mymodel","AppGlobal","create","setWidth","innerWidth","onSnapshot","throttle","snap","URL","searchParams","history","replaceState","toString","border","MSAView","MainApp","createJBrowseTheme","ThemeProvider","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"wWAMIA,EAAW,SAAUC,GACrB,IAAIC,EAAUD,EAAGC,QAASC,EAAQF,EAAGE,MAAOC,EAAWH,EAAGG,SAC1D,OAAQC,IAAMC,cAAc,KAAM,KAC9BD,IAAMC,cAAcC,IAAM,CAAEL,QAAS,SAAUM,GACvCL,EAAMM,cAASC,GACfF,EAAMG,iBACNT,KACDU,KAAM,KACTP,IAAMC,cAAcO,IAAY,KAAMT,MAEnCU,sBAAS,SAAUb,GAC9B,IAAIE,EAAQF,EAAGE,MACXY,EAAKC,qBAAYC,EAAUF,EAAG,GAAIG,EAAaH,EAAG,GAClDI,EAAKH,qBAAYI,EAAWD,EAAG,GAAIE,EAAcF,EAAG,GACpDG,EAAQnB,EAAMmB,MAClB,OAAQjB,IAAMC,cAAciB,IAAW,KACnClB,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAEC,MAAO,QACzCH,EAASjB,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAEE,QAAS,KACpDrB,IAAMC,cAAcO,IAAY,CAAEc,MAAO,SACrC,UAAW,GAAGC,OAAON,KAAY,KACzCjB,IAAMC,cAAcO,IAAY,KAAM,sFACtCR,IAAMC,cAAcO,IAAY,CAAEc,MAAO,SAAW,iNACxDtB,IAAMC,cAAcuB,IAAM,CAAEC,WAAW,EAAMC,QAAS,GAAIC,eAAgB,SAAUC,WAAY,UAC5F5B,IAAMC,cAAcuB,IAAM,CAAEK,MAAM,GAC9B7B,IAAMC,cAAcO,IAAY,KAAM,mBACtCR,IAAMC,cAAc6B,eAAc,CAAEC,SAAUnB,EAASoB,YAAanB,IACpEb,IAAMC,cAAcO,IAAY,KAAM,oBACtCR,IAAMC,cAAc6B,eAAc,CAAEC,SAAUhB,EAAUiB,YAAahB,KACzEhB,IAAMC,cAAcuB,IAAM,CAAEK,MAAM,GAC9B7B,IAAMC,cAAcgC,IAAQ,CAAEpC,QAAS,WAC/BC,EAAMM,cAASC,GACXO,GACAd,EAAMoC,iBAAiBtB,GAEvBG,GACAjB,EAAMqC,kBAAkBpB,IAE7BqB,QAAS,YAAad,MAAO,UAAWe,UAAWzB,IAAYG,GAAY,SACtFf,IAAMC,cAAcuB,IAAM,CAAEK,MAAM,GAC9B7B,IAAMC,cAAcO,IAAY,KAAM,YACtCR,IAAMC,cAAc,KAAM,KACtBD,IAAMC,cAAcN,EAAU,CAAEG,MAAOA,EAAOD,QAAS,WAC/CC,EAAMqC,kBAAkB,CACpBG,IAAK,mEACLC,aAAc,kBAEjB,qCACTvC,IAAMC,cAAcN,EAAU,CAAEG,MAAOA,EAAOD,QAAS,WAC/CC,EAAM0C,QAAQ,CAAEC,ICtDtB,6xCDsDqCC,KCpDpC,ooBDqDM,0BACT1C,IAAMC,cAAcN,EAAU,CAAEG,MAAOA,EAAOD,QAAS,WAC/CC,EAAM0C,QAAQ,CAAEC,ICxDlB,4+BDyDG,kBACTzC,IAAMC,cAAcN,EAAU,CAAEG,MAAOA,EAAOD,QAAS,WAC/CC,EAAMoC,iBAAiB,CACnBI,IAAK,sDACLC,aAAc,kBAEjB,kCACTvC,IAAMC,cAAcN,EAAU,CAAEG,MAAOA,EAAOD,QAAS,WAC/CC,EAAMoC,iBAAiB,CACnBI,IAAK,wEACLC,aAAc,kBAEjB,yBACTvC,IAAMC,cAAcN,EAAU,CAAEG,MAAOA,EAAOD,QAAS,WAC/CC,EAAMoC,iBAAiB,CACnBI,IAAK,4EACLC,aAAc,kBAEjB,oDACTvC,IAAMC,cAAcN,EAAU,CAAEG,MAAOA,EAAOD,QAAS,WAC/CC,EAAMoC,iBAAiB,CACnBI,IAAK,2EACLC,aAAc,kBAEjB,kEACTvC,IAAMC,cAAcN,EAAU,CAAEG,MAAOA,EAAOD,QAAS,WAC/C8C,uBAAY,WACR7C,EAAMoC,iBAAiB,CACnBI,IAAK,oGACLC,aAAc,gBAElBzC,EAAMqC,kBAAkB,CACpBG,IAAK,oGACLC,aAAc,qBAGrB,4C,qDEvFzBK,EAAYC,aAAW,SAAUC,GAIjC,MAAO,CACHC,WAAY,CACRC,OAAQ,OACRC,WANSH,EAAMI,QAAQC,SACzBC,YAAMN,EAAMI,QAAQC,SAASE,KAAM,IACnCD,YAAMN,EAAMI,QAAQI,QAAQD,KAAM,IAKhCE,SAAU,WACVC,OAAQ,GACRC,UAAW,SACXC,SAAU,UAEdC,kBAAmB,CACfC,OAAQ,YACRxC,MAAO,OACPyC,UAAW,GAEfC,eAAgB,CACZxC,MAAOwB,EAAMI,QAAQC,SACfL,EAAMI,QAAQC,SAASY,aACvBjB,EAAMI,QAAQI,QAAQS,cAEhCC,QAAS,CACLC,YAAa,OACbL,OAAQ,aAEZM,MAAO,CACHC,YAAarB,EAAMpB,QAAQ,GAC3B0C,aAActB,EAAMpB,QAAQ,IAEhC2C,MAAO,CACHC,cAAe,OACftB,OAAQ,OACR5B,MAAO,EACPmC,SAAU,WACVC,OAAQ,QAIhBe,EAAgB9D,oBAAS,SAAUb,GACnC,IAAIE,EAAQF,EAAGE,MAAO0E,EAAS5E,EAAG4E,OAC9BC,EAAgB3E,EAAM2E,cACtBC,EAAU9B,IACd,OAAQ5C,IAAMC,cAAcD,IAAM2E,SAAU,KACxC3E,IAAMC,cAAc2E,IAAS,CAAEC,MAAM,EAAMC,UAAW,MAAOC,MAAO,GAAGxD,OAAOzB,EAAMkF,OAAOR,GAAU,GAAIS,OAAO,GAC5GjF,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAC5B+D,KAAMV,EAASC,EACflB,SAAU,WACVP,OAAQ,MAEpBhD,IAAMC,cAAc,MAAO,CAAEkF,UAAWT,EAAQL,MAAOlD,MAAO,CACtD+D,KAAMV,EAASC,EACfxB,WAAY,aAuIbxC,0BApIf,SAAoBb,GAChB,IAAIE,EAAQF,EAAGE,MAAOY,EAAKd,EAAGwF,iBAAkBA,OAA0B,IAAP1E,EAAgBV,IAAMC,cAAc,MAAO,MAAQS,EAClH+D,EAAgB3E,EAAM2E,cACtB3D,EAAKH,qBAAY0E,EAASvE,EAAG,GAAIwE,EAAYxE,EAAG,GAChDyE,EAAK5E,qBAAY6E,EAAWD,EAAG,GAAIE,EAAcF,EAAG,GAGpDG,EAAK/E,qBAAYgF,EAAiBD,EAAG,GAAIE,EAAoBF,EAAG,GAChEG,EAAKlF,qBAAYmF,EAASD,EAAG,GAAIE,EAAYF,EAAG,GAChDG,EAAcC,iBAAO,MACrBC,EAAgBD,iBAAO,MACvBvB,EAAU9B,IACVuD,OAA2B9F,IAAXgF,QAA2ChF,IAAnBsF,EAyC5C,SAASS,EAAUjG,GACfA,EAAMG,iBACNH,EAAMkG,kBACN,IAAIC,EAAYnG,EAAMoG,QAClBpG,EAAMqG,OAAOC,wBAAwBvB,KACzCI,EAAUgB,GACVb,EAAYa,GAEhB,SAASI,EAAUvG,GACf,IAAIqG,EAASrG,EAAMqG,OACnBT,EAAU5F,EAAMoG,QAAUC,EAAOC,wBAAwBvB,MAE7D,SAASyB,IACLZ,OAAU1F,GACVP,EAAM8G,gBAEV,SAASC,IACLjB,OAAkBvF,GAClBiF,OAAUjF,GACVoF,OAAYpF,GAOhB,GAlEAyG,qBAAU,WACN,SAASC,EAAgB5G,GACrB,GAAI6F,EAAYgB,SAAWb,EAAe,CACtC,IAAIG,EAAYnG,EAAMoG,QAAUP,EAAYgB,QAAQP,wBAAwBvB,KAC5EO,EAAYa,IAGpB,SAASW,EAAc9G,GACnB,QAAeE,IAAXgF,GAAwBW,EAAYgB,QAAS,CAC7C,IAAIT,EAAUpG,EAAMoG,QAASW,EAAU/G,EAAM+G,QAEzCC,EAAUZ,EADJP,EAAYgB,QACMP,wBAAwBvB,KAGpDU,EAAkB,CACduB,QAASA,EACTZ,QAASA,EACTW,QAASA,IAEbnB,OAAU1F,IAGlB,OAAI8F,GACAiB,OAAOC,iBAAiB,YAAaN,GACrCK,OAAOC,iBAAiB,UAAWJ,GAC5B,WACHG,OAAOE,oBAAoB,YAAaP,GACxCK,OAAOE,oBAAoB,UAAWL,KAGvC,eACR,CAAC5B,EAAQc,EAAeR,IAC3BmB,qBAAU,YACDX,QACY9F,IAAbmF,QACWnF,IAAXgF,GACAkC,KAAKC,IAAIhC,EAAWH,IAAW,GAC/BwB,MAEL,CAACV,EAAeX,EAAUH,EAAQvF,EAAM2H,gBA2B5BpH,IAAXgF,EACA,OAAQrF,IAAMC,cAAcD,IAAM2E,SAAU,UAC7BtE,IAAXyF,EAAwB9F,IAAMC,cAAcsE,EAAe,CAAEzE,MAAOA,EAAO0E,OAAQsB,IAAa,KAChG9F,IAAMC,cAAc,MAAO,CAAE,cAAe,sBAAuBkF,UAAWT,EAAQf,kBAAmB+D,KAAM,eAAgBC,IAAK3B,EAAa4B,YAAaxB,EAAWyB,WAAYlB,EAAUmB,YAAapB,GAAatB,IAEjO,IAAI2C,EAAQpC,EAAiBA,EAAewB,QAAU3B,GAAY,EAC9DN,EAAO6C,EAAQ1C,EAAS0C,EAAQ1C,EAChCjE,EAAQmG,KAAKC,IAAIO,EAAQ1C,GACzB2C,EAAelI,EAAMkF,OAAOE,GAC5B+C,EAAgBnI,EAAMkF,OAAOE,EAAO9D,GACpC8G,EAAkBX,KAAKY,KAAK/G,EAAQtB,EAAM2H,UAC1CW,EAAY,CACZ,CACIC,MAAO,oBACPC,KAAMC,IACN1I,QAAS,WACLC,EAAM0I,WAAWR,EAAcC,GAC/BpB,OAIZ,OAAQ7G,IAAMC,cAAcD,IAAM2E,SAAU,KACxCuB,EAAcc,QAAWhH,IAAMC,cAAcD,IAAM2E,SAAU,KACzD3E,IAAMC,cAAcwI,IAAS,CAAEtD,UAAWT,EAAQV,QAASU,QAAS,CAC5DR,MAAOQ,EAAQR,OAChBW,MAAM,EAAM6D,SAAUxC,EAAcc,QAAS2B,aAAc,CAC1DC,SAAU,MACVC,WAAY,QACbC,gBAAiB,CAChBF,SAAU,SACVC,WAAY,SACbE,aAAa,EAAMC,qBAAqB,GAC3ChJ,IAAMC,cAAcO,IAAY,KAAMwH,EAAe,IACzDhI,IAAMC,cAAcwI,IAAS,CAAEtD,UAAWT,EAAQV,QAASU,QAAS,CAC5DR,MAAOQ,EAAQR,OAChBW,MAAM,EAAM6D,SAAUxC,EAAcc,QAAS2B,aAAc,CAC1DC,SAAU,MACVC,WAAY,SACbC,gBAAiB,CAChBF,SAAU,SACVC,WAAY,QACbE,aAAa,EAAMC,qBAAqB,GAC3ChJ,IAAMC,cAAcO,IAAY,KAAMyH,EAAgB,KAAQ,KACtEjI,IAAMC,cAAc,MAAO,CAAE0H,IAAKzB,EAAef,UAAWT,EAAQ3B,WAAY5B,MAAO,CAAE+D,KAAMA,EAAOT,EAAerD,MAAOA,IACxHpB,IAAMC,cAAcO,IAAY,CAAE4B,QAAS,KAAM+C,UAAWT,EAAQZ,gBAChEoE,EAAgBe,eAAe,SAC/B,QACRjJ,IAAMC,cAAc,MAAO,CAAE,cAAe,sBAAuBkF,UAAWT,EAAQf,kBAAmB+D,KAAM,eAAgBC,IAAK3B,EAAa4B,YAAaxB,EAAWyB,WAAYlB,EAAUmB,YAAapB,GAAatB,GACzNO,EAAkB3F,IAAMC,cAAciJ,OAAM,CAAEC,gBAAiB,iBAAkBxD,eAAgB,CACzFT,KAAMS,EAAeY,QACrB6C,IAAKzD,EAAeuB,SACrBmC,gBAvDX,SAA6BC,EAAGC,GAC5BA,IACA1C,KAqD6ChC,KAAM2E,QAAQ7D,GAAiB8D,QAAS5C,EAAauB,UAAWA,IAAgB,S,yFC7LtH3H,sBAAS,SAAUb,GAC9B,IAAI8J,EAAO9J,EAAG8J,KAAMD,EAAU7J,EAAG6J,QACjC,OAAQzJ,IAAMC,cAAc0J,IAAQ,CAAEF,QAAS,WAAc,OAAOA,KAAc5E,MAAM,GACpF7E,IAAMC,cAAc2J,IAAa,KAAM,YACvC5J,IAAMC,cAAc4J,IAAe,KAC/B7J,IAAMC,cAAc6J,aAAY,CAAEC,WAAYL,SCTtDM,EAAsC,WAStC,OARAA,EAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,GAEJH,EAASa,MAAMC,KAAMP,YAS5BQ,EAAS,IAET1J,EAAU,IACV2J,EAAWvK,oBAAS,SAAUb,GAC9B,IAAIc,EAAII,EACJmK,EAAOrL,EAAGqL,KAAMxB,EAAU7J,EAAG6J,QAAS3J,EAAQF,EAAGE,MACjDoL,EAAapL,EAAMoL,WACnBC,EAAcF,EAAOnL,EAAMsL,cAAcH,EAAKI,WAAQhL,EAC1D,OAAQL,IAAMC,cAAcD,IAAM2E,SAAU,KACxC3E,IAAMC,cAAciJ,IAAM,CAAEC,gBAAiB,iBAAkBxD,eAAgB,CACvEyD,IAAK6B,EAAKK,EACVpG,KAAM+F,EAAKM,GACZC,mBAAoB,EAAGzC,aAAa,EAAMlE,KAAM2E,QAAQyB,GAAOxB,QAASA,GAC3EzJ,IAAMC,cAAcwL,IAAU,CAAEC,OAAO,EAAMrJ,UAAU,GAAQ4I,EAAKI,MACpErL,IAAMC,cAAcwL,IAAU,CAAEC,OAAO,EAAM7L,QAAS,WAC9CC,EAAM6L,mBAAmBC,EAAa,CAClClC,KAAM5J,EAAMsL,cAAcH,EAAKI,QAEnC5B,MACC,gBAAkD,QAAhC/I,EAAKwK,EAAWD,EAAKI,aAA0B,IAAP3K,OAAgB,EACnFA,EAAGmL,KAAI,SAAUC,GACb,OAAQhM,EAAMiM,mBAAmBC,MAAK,SAAU1B,GAAK,OAAOA,EAAE2B,KAAOhB,EAAKI,QAS7DrL,IAAMC,cAAcwL,IAAU,CAAES,IAAKC,KAAKC,UAAUN,GAAQJ,OAAO,EAAM7L,QAAS,WACvFC,EAAMuM,6BAA6B,CAC/BC,UAAWR,EACXG,GAAIhB,EAAKI,OAEb5B,MAEJ,8BACAqC,EAAMS,IACN,KAlBkFvM,IAAMC,cAAcwL,IAAU,CAAES,IAAKC,KAAKC,UAAUN,GAAQJ,OAAO,EAAM7L,QAAS,WAChKC,EAAM0M,wBAAwB,CAC1BF,UAAWR,EACXG,GAAIhB,EAAKI,OAEb5B,MAEJ,yBACAqC,EAAMS,IACN,QAU6B,QAAhCzL,EAAKqK,EAAYsB,iBAA8B,IAAP3L,OAAgB,EAC7DA,EAAG+K,KAAI,SAAUY,GAAa,OAAQzM,IAAMC,cAAcwL,IAAU,CAAEC,OAAO,EAAMQ,IAAKO,EAAW5M,QAAS,WACpGC,EAAM4M,gBAAgB,CAAErB,KAAMF,EAAYE,KAAMoB,UAAWA,IAC3DhD,MAEJ,uBACAgD,EACA,aAEZE,EAAiBlM,oBAAS,SAAUb,GACpC,IAAIqL,EAAOrL,EAAGqL,KAAMnL,EAAQF,EAAGE,MAAO2J,EAAU7J,EAAG6J,QACnD,OAAQzJ,IAAMC,cAAciJ,IAAM,CAAEC,gBAAiB,iBAAkBxD,eAAgB,CAC/ET,KAAM+F,EAAKM,EACXnC,IAAK6B,EAAKK,GACXE,mBAAoB,EAAGzC,aAAa,EAAMlE,KAAM2E,QAAQyB,GAAOxB,QAASA,GAC3EzJ,IAAMC,cAAcwL,IAAU,CAAEC,OAAO,EAAMrJ,UAAU,GAAQ4I,EAAKI,MACpErL,IAAMC,cAAcwL,IAAU,CAAEC,OAAO,EAAM7L,QAAS,WAC9CC,EAAM8M,gBAAgB3B,EAAKgB,IAC3BxC,MACC3J,EAAM+M,UAAUC,SAAS7B,EAAKgB,IACjC,mBACA,sBACNjM,IAAMC,cAAcwL,IAAU,CAAEC,OAAO,EAAM7L,QAAS,WAC9CC,EAAMiN,WAAa9B,EAAKgB,GAClBnM,EAAMkN,iBAAY3M,GAClBP,EAAMkN,YAAY/B,EAAKgB,IAC7BxC,MACC3J,EAAMiN,WAAa9B,EAAKgB,GAC3B,8BACA,2BAEVgB,EAAYxM,oBAAS,SAAUb,GAC/B,IAAIE,EAAQF,EAAGE,MAAOoN,EAAUtN,EAAGsN,QAC/BvF,EAAM1B,iBAAO,MACbkH,EAAWlH,iBAAO,IAAImH,KACtBC,EAAepH,iBAAO,MACtBvF,EAAKC,qBAAY2M,EAAa5M,EAAG,GAAI6M,EAAgB7M,EAAG,GACxDI,EAAKH,qBAAY6M,EAAiB1M,EAAG,GAAI2M,EAAoB3M,EAAG,GAChEyE,EAAK5E,qBAAY+M,EAAWnI,EAAG,GAAIoI,EAAcpI,EAAG,GACpDqI,EAAY9N,EAAM8N,UAAWC,EAAY/N,EAAM+N,UAAWC,EAAUhO,EAAMgO,QAASC,EAAYjO,EAAMiO,UAAWC,EAAgBlO,EAAMkO,cAAenB,EAAY/M,EAAM+M,UAAWoB,EAASnO,EAAMmO,OAAQC,EAAmBpO,EAAMoO,iBAAkBC,EAASrO,EAAMqO,OAAQC,EAAYtO,EAAMsO,UAAWC,EAAkBvO,EAAMuO,gBAAiBC,EAAWxO,EAAMwO,SAAU7J,EAAgB3E,EAAM2E,cAAeyG,EAAapL,EAAMoL,WAAYqD,EAAqBzO,EAAMyO,mBA8K/c,SAASC,EAAoBrO,GACzB,IAAIoL,EAAIpL,EAAMsO,YAAYtH,QAAU8G,EAAO/I,KACvCoG,EAAInL,EAAMsO,YAAYvB,QACtBpB,EAAQqB,EAASnG,QAAQ0H,OAAO,CAChCC,KAAMpD,EACNqD,KAAMrD,EAAI,EACVsD,KAAMvD,EAAI4B,EACV4B,KAAMxD,EAAI,EAAI4B,IACf,GACH,OAAOpB,GAASA,EAAMiD,OAChB/E,EAASA,EAAS,GAAI8B,GAAQ,CAAEP,EAAGpL,EAAMoG,QAAS+E,EAAGnL,EAAM+G,eAAa7G,EAElF,SAAS2O,EAAkB7O,GACvB,IAAIoL,EAAIpL,EAAMsO,YAAYtH,QAAU8G,EAAO/I,KACvCoG,EAAInL,EAAMsO,YAAYvB,QACtBpB,EAAQqB,EAASnG,QAAQ0H,OAAO,CAChCC,KAAMpD,EACNqD,KAAMrD,EAAI,EACVsD,KAAMvD,EAAI4B,EACV4B,KAAMxD,EAAI,EAAI4B,IACf,GACH,OAAOpB,IAAUA,EAAMiD,OACjB/E,EAASA,EAAS,GAAI8B,GAAQ,CAAEP,EAAGpL,EAAMoG,QAAS+E,EAAGnL,EAAM+G,eAAa7G,EAElF,OArMAyG,qBAAU,WAEN,GADAqG,EAASnG,QAAQiI,QACZtH,EAAIX,QAAT,CAGA,IAAIkI,EAAMvH,EAAIX,QAAQmI,WAAW,MACjC,GAAKD,EAAL,CAGAA,EAAIE,iBACJF,EAAIG,MAAMd,EAAoBA,GAC9BW,EAAII,UAAU,EAAG,EAAGvB,EAAY1M,EAAS+M,GACzCc,EAAIK,UAAUtB,EAAO/I,MAAOgI,GAC5B,IAAIsC,EAAON,EAAIM,KACfN,EAAIM,KAAOA,EAAKC,QAAQ,QAAS,GAAGlO,OAAOgG,KAAKmI,IAAI,EAAG7B,EAAY,GAAI,QAClEM,GAAUG,IACXV,EAAU+B,QAAQC,SAAQ,SAAUhQ,GAChC,IAAIiQ,EAASjQ,EAAGiQ,OAAQrJ,EAAS5G,EAAG4G,OAChC8E,EAAI0C,EAAgB,MAAQ,IAE5BtN,EAAKmP,EAAQC,EAAKpP,EAAG6K,EAAWwE,EAAKrP,EAAR4K,GAE7B/F,EAAKiB,EAAQwJ,EAAKzK,EAAGgG,EAAW0E,EAAK1K,EAAR+F,GAC7B4E,EAAK3I,KAAK4I,IAAIL,EAAIE,GAClBI,EAAK7I,KAAKmI,IAAII,EAAIE,GAIlB9C,EAAUkB,GAAa8B,GAAME,GAAMlD,IACnCgC,EAAImB,YACJnB,EAAIoB,OAAOP,EAAID,GACfZ,EAAIqB,OAAOR,EAAIC,GACfd,EAAIqB,OAAON,EAAID,GACfd,EAAIsB,aAGRnC,GACAT,EAAU6C,cAAcb,SAAQ,SAAU3E,GACtC,IAAIyF,EAAM1C,EAAgB,MAAQ,IAC9BpO,EAAKqL,EAETK,EAAI1L,EAAG2L,EAIPA,EAAI3L,EAFC8Q,GAEOC,EAAO/Q,EAAG+Q,KAClB7P,EAAK6P,EAAK1E,GAAIA,OAAY,IAAPnL,EAAgB,GAAKA,EAAIyE,EAAKoL,EAAKtF,KAAMA,OAAc,IAAP9F,EAAgB,GAAKA,EACxF+F,EAAI4B,EAhIT,GAiIK5B,EAAI4B,EAAUkB,EAjInB,IAkIKc,EAAI0B,YAAc,QAClB1B,EAAI2B,UAAYhE,EAAUC,SAASb,GAAM,QAAU,QACnDiD,EAAImB,YACJnB,EAAI4B,IAAIvF,EAAGD,EAAGP,EAAQ,EAAG,EAAIxD,KAAKwJ,IAClC7B,EAAI8B,OACJ9B,EAAIsB,SACJrD,EAASnG,QAAQiK,OAAO,CACpBtC,KAAMpD,EAAIR,EACV6D,KAAMrD,EAAIR,EAxI9BA,EAyIoB8D,KAAMvD,EAAIP,EACV+D,KAAMxD,EAAIP,EA1I9BA,EA2IoBgE,QAAQ,EACR9C,GAAIA,EACJZ,KAAMA,SAMtBwC,GAAa,KACTK,GACAgB,EAAIzL,UAAY,QAChByL,EAAIgC,YAAY,CAAC,EAAG,KAGpBhC,EAAIzL,UAAY,QAEpBmK,EAAUuD,SAASvB,SAAQ,SAAU3E,GACjC,IAEAK,EAAIL,EAAKM,EAETA,EAAIN,EAAKK,EAAG1L,EAAKqL,EAAK0F,KAAMtF,EAAOzL,EAAGyL,KAAMY,EAAKrM,EAAGqM,GAEpDmF,EAAMnG,EAAKmG,IACX,GAAI9F,EAAI4B,EArKL,GAsKC5B,EAAI4B,EAAUkB,EAtKf,EAsKyC,CAExC,IAAIiD,EAAK/F,EAAIuC,EAAY,EACrByD,EAAKtD,EAAgBoD,EAAM7F,EAC3BnK,EAAQ8N,EAAIqC,YAAYlG,GAAMjK,MAC9B4B,EAASkM,EAAIqC,YAAY,KAAKnQ,MAC9BoQ,EAAetG,EAAWG,GAE9B,GADA6D,EAAI2B,UAAYW,EAAe,OAAS,QACnClD,GAAaJ,EAWb,GAAIA,EAAkB,CACvB,IACIuD,EAAShN,EADM,EACyBwJ,EAAO/I,KACnD,GAAIoJ,IAAaH,EAAQ,CACrB,IAAIuD,EAAUxC,EAAIqC,YAAYlG,GAAMjK,MACpC8N,EAAIoB,OAAOgB,EAAKvG,EAAS,EAAGO,GAC5B4D,EAAIqB,OAAOkB,EALI,EAKoBC,EAASpG,GAC5C4D,EAAIsB,SAERtB,EAAIyC,SAAStG,EAAMoG,EAAQJ,GAC3BlE,EAASnG,QAAQiK,OAAO,CACpBtC,KAAMlK,EAAgBwJ,EAAO/I,KAAO9D,EACpCwN,KAAMnK,EAAgBwJ,EAAO/I,KAC7B2J,KAAMwC,EAAKrO,EACX8L,KAAMuC,EACNhG,KAAMA,EACNY,GAAIA,SAIRiD,EAAIyC,SAAStG,EAAMiG,EA3MnCvG,EA2M2CsG,GAC3BlE,EAASnG,QAAQiK,OAAO,CACpBtC,KAAM2C,EA7M1BvG,EA8MoB6D,KAAM0C,EA9M1BvG,EA8MmC3J,EACfyN,KAAMwC,EAAKrO,EACX8L,KAAMuC,EACNhG,KAAMA,EACNY,GAAIA,SArCRiD,EAAIyC,SAAStG,EAAM,EAAGgG,GACtBlE,EAASnG,QAAQiK,OAAO,CACpBtC,KAAM,EACNC,KAAMxN,EACNyN,KAAMwC,EAAKrO,EACX8L,KAAMuC,EACNhG,KAAMA,EACNY,GAAIA,QAmCpBiD,EAAIgC,YAAY,SAErB,CACCrE,EACAgB,EACAI,EAAO/I,KACP0I,EACAV,EACAa,EACAC,EACAG,EACAC,EACAC,EACAC,EACAJ,EACAzJ,EACAyG,EACAqD,IAEJzH,qBAAU,WACN,IAAI8K,EAASvE,EAAarG,QAC1B,GAAK4K,EAAL,CAGA,IAAI1C,EAAM0C,EAAOzC,WAAW,MAC5B,GAAKD,IAGLA,EAAIE,iBACJF,EAAII,UAAU,EAAG,EAAGvB,EAAY1M,EAAS+M,GACzCc,EAAIK,UAAUtB,EAAO/I,MAAOgI,GACxBQ,GAAU,CACV,IAAIiB,EAAOjB,EAASiB,KAAMC,EAAOlB,EAASkB,KAAMC,EAAOnB,EAASmB,KAAMC,EAAOpB,EAASoB,KACtFI,EAAI2B,UAAY,kBAChB3B,EAAI2C,SAASlD,EAAME,EAAMD,EAAOD,EAAMG,EAAOD,OAElD,CAACnB,EAAUO,EAAO/I,KAAMgI,EAASkB,EAAWL,IAyBvC/N,IAAMC,cAAcD,IAAM2E,SAAU,MACxB,OAAf2I,QAAsC,IAAfA,OAAwB,EAASA,EAAWrB,IAAOjM,IAAMC,cAAc0M,EAAgB,CAAE1B,KAAMqC,EAAYxN,MAAOA,EAAO2J,QAAS,WAAc,OAAO8D,OAAclN,MAAoB,MAC7L,OAAnBmN,QAA8C,IAAnBA,OAA4B,EAASA,EAAevB,IAAOjM,IAAMC,cAAc+K,EAAU,CAAEC,KAAMuC,EAAgB1N,MAAOA,EAAO2J,QAAS,WAAc,OAAOgE,OAAkBpN,MAAoB,KAC/NL,IAAMC,cAAc,SAAU,CAAEmB,OAAQ2M,EAAY1M,GAAWkN,EAAoBvL,OAAQoL,EAAYG,EAAoBpN,MAAO,CAC1HC,MAAO2M,EAAY1M,EACnB2B,OAAQoL,EACRhF,IAAK0E,EAAUZ,EACfhI,KAAM,EACN3B,SAAU,YACXuE,YAAa,SAAU3H,GACtB,GAAKwH,EAAIX,QAAT,CAGA,IAAI8K,EAAM9C,EAAkB7O,IAAUqO,EAAoBrO,GAEtDwH,EAAIX,QAAQ7F,MAAMyC,OADlBkO,EAC2B,UAGA,UAE/BnE,EAAYqB,EAAkB7O,MAC/BN,QAAS,SAAUM,GAClB,IAAIoL,EAAIpL,EAAMoG,QAAS+E,EAAInL,EAAM+G,QAC7ByJ,EAAOnC,EAAoBrO,IAClB,OAATwQ,QAA0B,IAATA,OAAkB,EAASA,EAAK1E,KACjDsB,EAAcvD,EAASA,EAAS,GAAI2G,GAAO,CAAEpF,EAAGA,EAAGD,EAAGA,KAE1D,IAAIyG,EAAQ/C,EAAkB7O,IAChB,OAAV4R,QAA4B,IAAVA,OAAmB,EAASA,EAAM9F,KACpDwB,EAAkBzD,EAASA,EAAS,GAAI+H,GAAQ,CAAExG,EAAGA,EAAGD,EAAGA,MAEhE3D,IAAKA,IACZ3H,IAAMC,cAAc,SAAU,CAAEkB,MAAO,CAC/BC,MAAO2M,EAAY1M,EACnB2B,OAAQoL,EACRhF,IAAK0E,EAAUZ,EACfhI,KAAM,EACN3B,SAAU,WACVe,cAAe,OACfd,OAAQ,KACTpC,MAAO2M,EAAY1M,EAAS2B,OAAQoL,EAAWzG,IAAK0F,QAgGpD2E,EA9FEvR,oBAAS,SAAUb,GAChC,IAAIE,EAAQF,EAAGE,MACX6H,EAAM1B,iBAAO,MACbgM,EAAYhM,kBAAO,GACnBiM,EAASjM,iBAAO,GAChBkM,EAAQlM,iBAAO,GACf8H,EAAYjO,EAAMiO,UAAW/K,EAASlD,EAAMkD,OAAQoP,EAAUtS,EAAMsS,QACpE1R,EAAKC,oBAAS,GAAQwF,EAAgBzF,EAAG,GAAI2R,EAAmB3R,EAAG,GAgFvE,OA/EAoG,qBAAU,WACN,IAAIwL,EAAO3K,EAAIX,QACf,GAAKsL,EAiBL,OADAA,EAAKjL,iBAAiB,QAASkL,GACxB,WACHD,EAAKhL,oBAAoB,QAASiL,IAftC,SAASA,EAAQC,GACb,IAAIrS,EAAQsS,IAAeD,GAC3BN,EAAOlL,SAAW7G,EAAMuS,OACnBT,EAAUjL,UACXiL,EAAUjL,SAAU,EACpB2L,uBAAsB,WAClB7S,EAAM8S,WAAWV,EAAOlL,SACxBkL,EAAOlL,QAAU,EACjBiL,EAAUjL,SAAU,MAG5BwL,EAAUlS,oBAMf,CAACR,IACJgH,qBAAU,WACN,IAAI+L,EAAU,aACd,SAAS9L,EAAgB5G,GACrBA,EAAMG,iBACN,IACIwS,EADQ3S,EAAM+G,QACMiL,EAAMnL,QAC1B8L,IAGKb,EAAUjL,UACXiL,EAAUjL,SAAU,EACpBI,OAAOuL,uBAAsB,WACzB7S,EAAM8S,UAAUE,GAChBb,EAAUjL,SAAU,EACpBmL,EAAMnL,QAAU7G,EAAM+G,aAKtC,SAASD,IACLkL,EAAMnL,QAAU,EACZb,GACAkM,GAAiB,GAWzB,OARIlM,IACAiB,OAAOC,iBAAiB,YAAaN,GAAiB,GACtDK,OAAOC,iBAAiB,UAAWJ,GAAe,GAClD4L,EAAU,WACNzL,OAAOE,oBAAoB,YAAaP,GAAiB,GACzDK,OAAOE,oBAAoB,UAAWL,GAAe,KAGtD4L,IACR,CAAC/S,EAAOqG,IAsBHnG,IAAMC,cAAc,MAAO,CAAE0H,IAAKA,EAAKC,YArB/C,SAAmBzH,GAEf,IAAIqG,EAASrG,EAAMqG,OACfA,EAAOuM,WAAavM,EAAOwM,QAAQC,SAIlB,IAAjB9S,EAAM+S,SACNf,EAAMnL,QAAU7G,EAAM+G,QACtBmL,GAAiB,KAY8Cc,UAPvE,SAAiBhT,GACbA,EAAMG,iBACN+R,GAAiB,IAKsEe,aAH3F,SAAoBjT,GAChBA,EAAMG,kBAE2Ga,MAAO,CACpH6B,OAAQA,EACRO,SAAU,WACVG,SAAU,SACVtC,MAAO2M,EAAY1M,IAClB+Q,EAAQvG,KAAI,SAAUwH,GAAS,OAAQrT,IAAMC,cAAcgN,EAAW,CAAEf,IAAKmH,EAAOvT,MAAOA,EAAOoN,QAASmG,W,mCC7apHrJ,EAAsC,WAStC,OARAA,EAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,GAEJH,EAASa,MAAMC,KAAMP,YAGzB,SAAS+I,EAAUC,EAAKC,GAC3B,OAAOvJ,OAAOwJ,YAAYxJ,OAAOyJ,QAAQH,GAAK1H,IAAI2H,IAE/C,SAASG,EAAgBjR,EAAMkR,EAAQC,GAC1C,IAAIjU,OACW,IAAXgU,IAAqBA,EAAS,aACpB,IAAVC,IAAoBA,EAAQ,GAChC,IAAI5H,EAAK,GAAG1K,OAAOqS,EAAQ,KAAKrS,OAAOsS,GACvC,OAAO7J,EAASA,EAAS,GAAItH,GAAO,CAAEuJ,GAAIA,EAAI6H,WAAsC,QAAzBlU,EAAK8C,EAAKoR,iBAA8B,IAAPlU,OAAgB,EAASA,EAAGiM,KAAI,SAAUkI,EAAG1J,GACjI,OAAOsJ,EAAgBI,EAAG,GAAGxS,OAAO0K,EAAI,KAAK1K,OAAO8I,GAAIwJ,EAAQ,QAC7D,KAER,SAASG,EAAcC,EAAanR,GACvC,OAAOwQ,EAAUW,GAAa,SAAUrU,GACpC,IAAIsU,EAAStU,EAAG,GAAI0B,EAAQ1B,EAAG,GAC/B,MAAO,CACHsU,EACApR,EAAMI,QAAQiR,gBAAgBC,IAAM9S,GAAO+S,WC3BvD,IAmUef,IAnUI,CACfgB,QAAS,CACLC,EAAG,SACHC,EAAG,SACHC,EAAG,SACHC,EAAG,SACHC,EAAG,MACHC,EAAG,MACHC,EAAG,MACHC,EAAG,OACHC,EAAG,OACHC,EAAG,OACHC,EAAG,QACHC,EAAG,QACHC,EAAG,QACHC,EAAG,SAEPC,KAAM,CACFd,EAAG,SACHe,EAAG,SACHb,EAAG,SACHC,EAAG,SACHa,EAAG,QACHH,EAAG,QACHH,EAAG,QACHC,EAAG,QACHV,EAAG,QACHM,EAAG,QACHE,EAAG,QACHG,EAAG,QACHJ,EAAG,QACHS,EAAG,UACHC,EAAG,UACHd,EAAG,UACHe,EAAG,MACHC,EAAG,MACHf,EAAG,OACHC,EAAG,QAEPe,SAAU,CACNN,EAAG,aACHf,EAAG,aACHgB,EAAG,QACHG,EAAG,YACHC,EAAG,YACHH,EAAG,YACHC,EAAG,YACHR,EAAG,OACHC,EAAG,OACHC,EAAG,OACHC,EAAG,OACHN,EAAG,UACHC,EAAG,UACHC,EAAG,UACHL,EAAG,WACHC,EAAG,SACHC,EAAG,SACHL,EAAG,OACHC,EAAG,MACHC,EAAG,OAEPmB,yBAA0B,GAE1BC,OAAQ,CACJR,EAAG,UACHC,EAAG,UACHG,EAAG,UACHC,EAAG,UACHb,EAAG,UACHP,EAAG,UACHI,EAAG,UACHM,EAAG,UACHL,EAAG,UACHM,EAAG,UACHC,EAAG,UACHK,EAAG,UACHhB,EAAG,UACHiB,EAAG,UACHZ,EAAG,UACHJ,EAAG,UACHC,EAAG,UACHU,EAAG,UACHL,EAAG,UACHC,EAAG,WAEPe,YAAa,CACTT,EAAG,UACHC,EAAG,UACHhB,EAAG,UACHG,EAAG,UACHsB,EAAG,WAGPC,iBAAkB,CACdX,EAAG,UACHC,EAAG,UACHG,EAAG,UACHC,EAAG,UACHb,EAAG,UACHP,EAAG,UACHI,EAAG,UACHM,EAAG,UACHL,EAAG,UACHM,EAAG,UACHC,EAAG,UACHK,EAAG,UACHhB,EAAG,UACHiB,EAAG,UACHZ,EAAG,UACHJ,EAAG,UACHC,EAAG,UACHU,EAAG,UACHL,EAAG,UACHC,EAAG,WAGPkB,yBAA0B,GAC1BC,aAAc,CACVb,EAAG,UACHC,EAAG,UACHhB,EAAG,UACHG,EAAG,UACHsB,EAAG,WAEPI,eAAgB,CACZd,EAAG,UACHT,EAAG,UACHW,EAAG,UACHE,EAAG,UACHH,EAAG,UACHE,EAAG,UACHE,EAAG,UACHpB,EAAG,UACHI,EAAG,UACHM,EAAG,UACHC,EAAG,UACHN,EAAG,UACHO,EAAG,UACHL,EAAG,UACHN,EAAG,UACHC,EAAG,UACHC,EAAG,UACHK,EAAG,UACHC,EAAG,UACHI,EAAG,UACHiB,EAAG,UACHC,EAAG,UACHC,EAAG,WAEPC,uBAAwB,CACpBlB,EAAG,UACHT,EAAG,UACHW,EAAG,UACHE,EAAG,UACHH,EAAG,UACHE,EAAG,UACHE,EAAG,UACHpB,EAAG,UACHI,EAAG,UACHM,EAAG,UACHC,EAAG,UACHN,EAAG,UACHO,EAAG,UACHL,EAAG,UACHN,EAAG,UACHC,EAAG,UACHC,EAAG,UACHK,EAAG,UACHC,EAAG,UACHI,EAAG,UACHiB,EAAG,UACHC,EAAG,UACHC,EAAG,WAEPE,kBAAmB,CACfnB,EAAG,UACHT,EAAG,UACHW,EAAG,UACHE,EAAG,UACHH,EAAG,UACHE,EAAG,UACHE,EAAG,UACHpB,EAAG,UACHI,EAAG,UACHM,EAAG,UACHC,EAAG,UACHN,EAAG,UACHO,EAAG,UACHL,EAAG,UACHN,EAAG,UACHC,EAAG,UACHC,EAAG,UACHK,EAAG,UACHC,EAAG,UACHI,EAAG,UACHiB,EAAG,UACHC,EAAG,UACHC,EAAG,WAEPG,mBAAoB,CAChBpB,EAAG,UACHT,EAAG,UACHW,EAAG,UACHE,EAAG,UACHH,EAAG,UACHE,EAAG,UACHE,EAAG,UACHpB,EAAG,UACHI,EAAG,UACHM,EAAG,UACHC,EAAG,UACHN,EAAG,UACHO,EAAG,UACHL,EAAG,UACHN,EAAG,UACHC,EAAG,UACHC,EAAG,UACHK,EAAG,UACHC,EAAG,UACHI,EAAG,UACHiB,EAAG,UACHC,EAAG,UACHC,EAAG,WAEPI,iBAAkB,CACdrB,EAAG,UACHT,EAAG,UACHW,EAAG,UACHE,EAAG,UACHH,EAAG,UACHE,EAAG,UACHE,EAAG,UACHpB,EAAG,UACHI,EAAG,UACHM,EAAG,UACHC,EAAG,UACHN,EAAG,UACHO,EAAG,UACHL,EAAG,UACHN,EAAG,UACHC,EAAG,UACHC,EAAG,UACHK,EAAG,UACHC,EAAG,UACHI,EAAG,UACHiB,EAAG,UACHC,EAAG,UACHC,EAAG,WAEPK,eAAgB,CACZtB,EAAG,UACHT,EAAG,UACHW,EAAG,UACHE,EAAG,UACHH,EAAG,UACHE,EAAG,UACHE,EAAG,UACHpB,EAAG,UACHI,EAAG,UACHM,EAAG,UACHC,EAAG,UACHN,EAAG,UACHO,EAAG,UACHL,EAAG,UACHN,EAAG,UACHC,EAAG,UACHC,EAAG,UACHK,EAAG,UACHC,EAAG,UACHI,EAAG,WAEPyB,cAAe,CACXvB,EAAG,UACHT,EAAG,UACHW,EAAG,UACHE,EAAG,UACHH,EAAG,UACHE,EAAG,UACHE,EAAG,UACHpB,EAAG,UACHI,EAAG,UACHM,EAAG,UACHC,EAAG,UACHN,EAAG,UACHO,EAAG,UACHL,EAAG,UACHN,EAAG,UACHC,EAAG,UACHC,EAAG,UACHK,EAAG,UACHC,EAAG,UACHI,EAAG,WAEP0B,OAAQ,CACJnC,EAAG,OACHC,EAAG,OACHC,EAAG,OACHa,EAAG,MACHC,EAAG,MACHlB,EAAG,QACHC,EAAG,QACHc,EAAG,QACHC,EAAG,QACHH,EAAG,QACHF,EAAG,QACHF,EAAG,QACHD,EAAG,QACHE,EAAG,QACHL,EAAG,UACHC,EAAG,UACHC,EAAG,UACHR,EAAG,QACHD,EAAG,QACHgB,EAAG,SACHc,EAAG,OACHE,EAAG,OACHD,EAAG,OACH,IAAK,OACL,IAAK,UAK0B,SAAU1W,GAE7C,MAAO,CADGA,EAAG,GAGT0T,EAHmB1T,EAAG,IAGP,SAAUA,GACrB,IAAIsU,EAAStU,EAAG,GAAI0B,EAAQ1B,EAAG,GAC/B,MAAO,CAACsU,EAAQE,IAAM9S,GAAO+S,cASlC,SAAS0C,GAAiBC,EAAOlX,EAAOmX,EAAKC,GAChD,IAAIC,EAAQlN,OAAOmN,OAAOJ,GAAOK,QAAO,SAAUC,EAAGvD,GAAK,OAAOuD,EAAIvD,IAAM,GACvEwD,EAAIzX,EAAM0X,QAAQP,GAAKC,GACvBtX,EAAKoX,EAAMjC,EAAGA,OAAW,IAAPnV,EAAgB,EAAIA,EAAIc,EAAKsW,EAAM9B,EAAGA,OAAW,IAAPxU,EAAgB,EAAIA,EAAII,EAAKkW,EAAM5B,EAAGA,OAAW,IAAPtU,EAAgB,EAAIA,EAAIyE,EAAKyR,EAAM/B,EAAGA,OAAW,IAAP1P,EAAgB,EAAIA,EAAIG,EAAKsR,EAAM7B,EAAGA,OAAW,IAAPzP,EAAgB,EAAIA,EAAIG,EAAKmR,EAAM1B,EAAGA,OAAW,IAAPzP,EAAgB,EAAIA,EAAI4R,EAAKT,EAAMlC,EAAGA,OAAW,IAAP2C,EAAgB,EAAIA,EAAIC,EAAKV,EAAMzB,EAAGA,OAAW,IAAPmC,EAAgB,EAAIA,EAAIC,EAAKX,EAAMrC,EAAGA,OAAW,IAAPgD,EAAgB,EAAIA,EAAIC,EAAKZ,EAAMxC,EAAGA,OAAW,IAAPoD,EAAgB,EAAIA,EAAIC,EAAKb,EAAMnC,EAAGA,OAAW,IAAPgD,EAAgB,EAAIA,EAAIC,EAAKd,EAAMpC,EAAGA,OAAW,IAAPkD,EAAgB,EAAIA,EAAIC,EAAKf,EAAMvB,EAAGA,OAAW,IAAPsC,EAAgB,EAAIA,EAAIC,EAAKhB,EAAMrB,EAAGA,OAAW,IAAPqC,EAAgB,EAAIA,EAAIC,EAAKjB,EAAMtB,EAAGA,OAAW,IAAPuC,EAAgB,EAAIA,EAAIC,EAAKlB,EAAMtC,EAAGA,OAAW,IAAPwD,EAAgB,EAAIA,EAAIC,EAAKnB,EAAMvC,EAAGA,OAAW,IAAP0D,EAAgB,EAAIA,EAAIC,EAAKpB,EAAMzC,EAAGA,OAAW,IAAP6D,EAAgB,EAAIA,EAAIC,EAAKrB,EAAMhC,EAAGA,OAAW,IAAPqD,EAAgB,EAAIA,EAAIC,EAAKtB,EAAMxB,EACzyB+C,EAAaxD,EAAIG,EAAIE,EAAIH,EAAIE,EAAIG,EAAIR,EAAIS,EAAIZ,EAAIH,EAAIQ,EACrDwD,EAAK5D,EAAIC,EACT4D,EAAKhD,EAAIE,EAGb,OAAI4C,EAAapB,EAAQ,KACX,MAANI,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GACM,MAANA,GAEO,mBAGJ,MAANA,GAAmB,MAANA,KACbiB,EAAKrB,EAAQ,IAAOvC,EAAIuC,EAAQ,IAAOtC,EAAIsC,EAAQ,IAAO1B,EAAI0B,EAAQ,IAGjE,MAANI,IACCiB,EAAKrB,EAAQ,IACVsB,EAAKtB,EAAQ,IACbxB,EAAIwB,EAAQ,IACZ1B,EAAI0B,EAAQ,IACZzB,EAAIyB,EAAQ,IACT,oBAED,MAANI,IACCiB,EAAKrB,EAAQ,KA5BTxB,EAAID,GA6BAyB,EAAQ,IACbvC,EAAIuC,EAAQ,IACZtC,EAAIsC,EAAQ,IACZ1B,EAAI0B,EAAQ,IACT,oBAED,MAANI,UAvCuzB,IAAPe,EAAgB,EAAIA,GAuClzBnB,EAAQ,IAAOnC,EAAImC,EAAQ,MAGvC,MAANI,IACCiB,EAAKrB,EAAQ,IACVsB,EAAKtB,EAAQ,IACb1B,EAAI0B,EAAQ,KACZxB,EAAIwB,EAAQ,KACZvC,EAAIuC,EAAQ,KACZtC,EAAIsC,EAAQ,KART,OAWA,MAANI,GAAmB,MAANA,KAEbgB,EAAapB,EAAQ,KAhDjBzC,EAAID,GAiDA0C,EAAQ,IACb1C,EAAI0C,EAAQ,KACZzC,EAAIyC,EAAQ,KAGV,MAANI,GAAahC,EAAI4B,EAAQ,IAClB,qBAED,MAANI,GAAahD,EAAI4C,EAAQ,EAClB,oBAED,MAANI,GAAa/C,EAAI2C,EAAQ,EAClB,mBAEA,MAANI,GAAmB,MAANA,KACbgB,EAAapB,EAAQ,IAClBpC,EAAI,KACJC,EAAI,KACJM,EAAI,KACJC,EAAI,KACJf,EAAI,KACJiB,EAAI,KACJX,EAAI,KACJH,EAAI,KACJM,EAAI,KACJC,EAAI,KACJC,EAAI,KACJC,EAAI,UAbZ,EAeW,oBA1BA,iBApCA,OAuER,SAASsD,GAAwB1B,EAAOlX,EAAOmX,EAAKC,GAMvD,IALA,IAAIC,EAAQlN,OAAOmN,OAAOJ,GAAOK,QAAO,SAAUC,EAAGvD,GAAK,OAAOuD,EAAIvD,IAAM,GACvEwD,EAAIzX,EAAM0X,QAAQP,GAAKC,GACvBxD,EAAUzJ,OAAOyJ,QAAQsD,GACzB2B,EAAM,EACNzE,EAAS,GACJ7J,EAAI,EAAGA,EAAIqJ,EAAQlJ,OAAQH,IAC5BqJ,EAAQrJ,GAAG,GAAKsO,GAAyB,MAAlBjF,EAAQrJ,GAAG,KAClC6J,EAASR,EAAQrJ,GAAG,GACpBsO,EAAMjF,EAAQrJ,GAAG,IAGzB,IAAIuO,EAAaD,EAAMxB,EACnB0B,EAAS,iBAAiBtX,OAAO,IAAMgG,KAAKmI,IAAI,EAAIiJ,EAAMxB,EAAQ,EAAG,IAAM,MAC/E,GAAIyB,EAAa,IACTrB,IAAMrD,EACN,OAAO2E,EC7bnB,IAAIC,GAAWrY,oBAAS,SAAUb,GAC9B,IAAIE,EAAQF,EAAGE,MAAOqH,EAAUvH,EAAGuH,QAAS+F,EAAUtN,EAAGsN,QACrD6L,EAAMjZ,EAAMiZ,IAAKtR,EAAW3H,EAAM2H,SAAUuR,EAAUlZ,EAAMkZ,QAASxB,EAAU1X,EAAM0X,QAAS3J,EAAY/N,EAAM+N,UAAWC,EAAUhO,EAAMgO,QAASmL,EAAUnZ,EAAMmZ,QAASrL,EAAY9N,EAAM8N,UAAWqG,EAAcnU,EAAMmU,YAAaiF,EAAkBpZ,EAAMoZ,gBAAiB9K,EAAYtO,EAAMsO,UAAWG,EAAqBzO,EAAMyO,mBAAoB4K,EAAWrZ,EAAMqZ,SACjXrW,EAAQsW,cACRC,EAAiBC,mBAAQ,WAAc,OAAOtF,EAAcC,EAAanR,KAAW,CAACmR,EAAanR,IAClG6E,EAAM1B,iBAAO,MA4EjB,OA3EAa,qBAAU,WACN,GAAKa,EAAIX,QAAT,CAGA,IAAIkI,EAAMvH,EAAIX,QAAQmI,WAAW,MACjC,GAAKD,EAAL,CAGAA,EAAIE,iBACJF,EAAIG,MAAMd,EAAoBA,GAC9BW,EAAII,UAAU,EAAG,EAAGlB,EAAWA,GAC/Bc,EAAIK,WAAWpI,EAAS0G,EAAY,EAAIX,GACxCgC,EAAIzL,UAAY,SAChByL,EAAIM,KAAON,EAAIM,KAAKC,QAAQ,QAAS,GAAGlO,OAAOgG,KAAKmI,IAAI,EAAG7B,EAAY,GAAI,OAC3E,IAAIsD,EAASvD,EAAUuD,SACnB4C,EAAI3F,EAEJmL,EAAShS,KAAKmI,IAAI,EAAGnI,KAAKiS,OAAOtM,EAAUW,GAAaA,IACxD4L,EAAOlS,KAAKmI,IAAI,EAAGnI,KAAKY,MAAM+E,EAAU6G,EAAIlG,GAAaA,IAEzD6L,EAASnS,KAAKmI,IAAI,EAAGnI,KAAKiS,MAAMrS,EAAUM,IAC1CkS,EAAOpS,KAAKmI,IAAI,EAAGnI,KAAKY,MAAMhB,EAAU4M,GAAKtM,IAC7CmS,EAAgBzI,EAAO0I,MAAMN,EAAQE,GACzCG,EAAchK,SAAQ,SAAU3E,GAM5B,IALA,IAAIrL,EAGJ0L,EAAIL,EAAKM,EAAGF,EAAOJ,EAAK0F,KAAKtF,KACzByO,EAA+B,QAAxBla,EAAK4X,EAAQnM,UAA0B,IAAPzL,OAAgB,EAASA,EAAGia,MAAMH,EAAQC,GAC5EtP,EAAI,EAAGA,GAAa,OAARyP,QAAwB,IAARA,OAAiB,EAASA,EAAItP,QAASH,IAAK,CAC7E,IAAI6J,EAAS4F,EAAIzP,GACb/I,EAA4B,6BAApB4X,EACNnC,GAAiBoC,EAASO,EAASrP,GAAIvK,EAAOuL,EAAMqO,EAASrP,GACzC,6BAApB6O,EACIR,GAAwBS,EAASO,EAASrP,GAAIvK,EAAOuL,EAAMqO,EAASrP,GACpE4J,EAAYC,EAAO6F,eAC7B,GAAIf,EAAS,CACT,IAAIzN,EAAIlB,EAAI5C,EAAWN,EAAWA,EAAUM,EAC5CyH,EAAI2B,UAAYvP,GAAS,QACzB4N,EAAI2C,SAAStG,EAAGD,EAAIuC,EAAWpG,EAAUoG,QAIjDA,GAAa,IAAMpG,GAAYoG,EAAY,GAC3C+L,EAAchK,SAAQ,SAAU3E,GAM5B,IALA,IAAIrL,EAGJ0L,EAAIL,EAAKM,EAAGF,EAAOJ,EAAK0F,KAAKtF,KACzByO,EAA+B,QAAxBla,EAAK4X,EAAQnM,UAA0B,IAAPzL,OAAgB,EAASA,EAAGia,MAAMH,EAAQC,GAC5EtP,EAAI,EAAGA,GAAa,OAARyP,QAAwB,IAARA,OAAiB,EAASA,EAAItP,QAASH,IAAK,CAC7E,IAAI6J,EAAS4F,EAAIzP,GACb/I,EAAQ2S,EAAYC,EAAO6F,eAC3BC,EAAWX,EAAenF,EAAO6F,gBAAkB,QACnDxO,EAAIlB,EAAI5C,EAAWN,EAAWA,EAAUM,EAE5CyH,EAAI2B,UAAYmI,EAAUgB,EAAW1Y,GAAS,QAC9C4N,EAAIyC,SAASuC,EAAQ3I,EAAI9D,EAAW,EAAG6D,EAAIuC,EAAY,WAIpE,CACCkL,EACAxK,EACAiJ,EACAvD,EACAoF,EACAL,EACAnL,EACApG,EACAmG,EACAzG,EACA+F,EACAkB,IAEIpO,IAAMC,cAAc,SAAU,CAAE0H,IAAKA,EAAKG,YAAa,SAAU3H,GACjE,GAAKwH,EAAIX,QAAT,CAGA,IAAIpH,EAAK+H,EAAIX,QAAQP,wBAAyBvB,EAAOtF,EAAGsF,KAAMkE,EAAMxJ,EAAGwJ,IACnE6Q,EAAS9Z,EAAMoG,QAAUrB,EACzBgV,EAAS/Z,EAAM+G,QAAUkC,EAC7BtJ,EAAMqa,YAAY5S,KAAKiS,OAAOS,EAAS9S,GAAWM,GAAY,EAAGF,KAAKiS,OAAOU,EAAShN,GAAWW,MAClGuF,aAAc,WAAc,OAAOtT,EAAMqa,eAAkB/Y,MAAOgN,EAAYG,EAAoBvL,OAAQoL,EAAYG,EAAoBpN,MAAO,CAChJoC,SAAU,WACV6F,IAAK0E,EAAUZ,EACfhI,KAAM+T,EAAU9R,EAChB/F,MAAOgN,EACPpL,OAAQoL,QA6GLgM,GA1GC3Z,oBAAS,SAAUb,GAC/B,IAAIE,EAAQF,EAAGE,MACXiZ,EAAMjZ,EAAMiZ,IAAKsB,EAAgBva,EAAMua,cAAerX,EAASlD,EAAMkD,OAAQsX,EAAexa,EAAMwa,aAAcC,EAAWza,EAAMya,SACjI5S,EAAM1B,iBAAO,MAEbgM,EAAYhM,kBAAO,GACnBuU,EAASvU,iBAAO,GAChBiM,EAASjM,iBAAO,GAEhBwU,EAAQxU,iBAAO,GACfkM,EAAQlM,iBAAO,GACfvF,EAAKC,oBAAS,GAAQwF,EAAgBzF,EAAG,GAAI2R,EAAmB3R,EAAG,GAkEvE,OAjEAoG,qBAAU,WACN,IAAIwL,EAAO3K,EAAIX,QACf,GAAKsL,EAoBL,OADAA,EAAKjL,iBAAiB,QAASkL,GACxB,WACHD,EAAKhL,oBAAoB,QAASiL,IAlBtC,SAASA,EAAQC,GACb,IAAIrS,EAAQsS,IAAeD,GAC3BgI,EAAOxT,SAAW7G,EAAMua,OACxBxI,EAAOlL,SAAW7G,EAAMuS,OACnBT,EAAUjL,UACXiL,EAAUjL,SAAU,EACpB2L,uBAAsB,WAClB7S,EAAM6a,WAAWH,EAAOxT,SACxBlH,EAAM8S,WAAWV,EAAOlL,SACxBwT,EAAOxT,QAAU,EACjBkL,EAAOlL,QAAU,EACjBiL,EAAUjL,SAAU,MAG5BwL,EAAUlS,oBAMf,CAACR,IACJgH,qBAAU,WACN,IAAI+L,EAAU,aACd,SAAS9L,EAAgB5G,GACrBA,EAAMG,iBACN,IAAIsa,EAAQza,EAAMoG,QACdsU,EAAQ1a,EAAM+G,QACd4T,EAAYF,EAAQH,EAAMzT,QAC1B8L,EAAY+H,EAAQ1I,EAAMnL,SAC1B8T,GAAahI,KAGRb,EAAUjL,UACXiL,EAAUjL,SAAU,EACpBI,OAAOuL,uBAAsB,WACzB7S,EAAM6a,UAAUG,GAChBhb,EAAM8S,UAAUE,GAChBb,EAAUjL,SAAU,EACpByT,EAAMzT,QAAU7G,EAAMoG,QACtB4L,EAAMnL,QAAU7G,EAAM+G,aAKtC,SAASD,IACLwT,EAAMzT,QAAU,EACZb,GACAkM,GAAiB,GAWzB,OARIlM,IACAiB,OAAOC,iBAAiB,YAAaN,GAAiB,GACtDK,OAAOC,iBAAiB,UAAWJ,GAAe,GAClD4L,EAAU,WACNzL,OAAOE,oBAAoB,YAAaP,GAAiB,GACzDK,OAAOE,oBAAoB,UAAWL,GAAe,KAGtD4L,IACR,CAAC/S,EAAOqG,IACHnG,IAAMC,cAAc,MAAO,CAAE0H,IAAKA,EAAKC,YAAa,SAAUzH,GAE9D,IAAIqG,EAASrG,EAAMqG,OACfA,EAAOuM,WAAavM,EAAOwM,QAAQC,SAIlB,IAAjB9S,EAAM+S,SACNuH,EAAMzT,QAAU7G,EAAMoG,QACtB4L,EAAMnL,QAAU7G,EAAM+G,QACtBmL,GAAiB,KAEtBc,UAAW,SAAUhT,GACpBA,EAAMG,iBACN+R,GAAiB,IAClBe,aAAc,SAAUjT,GACvBA,EAAMG,kBACPa,MAAO,CACNoC,SAAU,WACVP,OAAQA,EACR5B,MAAOkZ,EACP5W,SAAU,WACRqV,GAAQsB,EAAwBtB,EAEmBwB,EAAS1O,KAAI,SAAUjM,GAChF,IAAImb,EAAKnb,EAAG,GAAIob,EAAKpb,EAAG,GACxB,OAAQI,IAAMC,cAAc6Y,GAAU,CAAE5M,IAAK,GAAG3K,OAAOwZ,EAAI,KAAKxZ,OAAOyZ,GAAKlb,MAAOA,EAAOqH,QAAS4T,EAAI7N,QAAS8N,OAJnEhb,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAEoC,SAAU,WAAY2B,KAAM,MAAOkE,IAAK,QAC3HpJ,IAAMC,cAAcgb,IAAkB,MACtCjb,IAAMC,cAAcO,IAAY,KAAM,eAFR,SCxK/B,SAAS0a,GAAUC,EAAOC,EAAKC,EAASC,EAAWC,GACtD,IAAI3b,OACc,IAAd0b,IAAwBA,GAAY,QACtB,IAAdC,IAAwBA,GAAY,GACxC,IAAIC,EA9BD,SAAyBnM,EAAOoM,EAAiBC,GAKpD,IAHA,IAAIC,EAAkBF,GADtBpM,EAAQ9H,KAAKC,IAAI6H,IAEbuM,EAAiBC,SAASC,OAAOH,GAAiBI,gBAAgBC,MAAM,MAAM,GAAI,IAClFC,EAAa1U,KAAK2U,IAAI,GAAIN,GACvBK,EAAaN,MAChBM,GAAc,IACIN,IAGlBM,GAAc,IAGlB,IAAIE,GADJF,EAAa1U,KAAKmI,IAAIuM,EAAY,IACF5M,EAC5B+M,EAAa,EAUjB,QATMH,EAAa,KAAOE,EAAe,IAAMT,EAC3CU,EAAaH,EAAa,KAEnBA,EAAa,IAAME,EAAe,GAAKT,EAC9CU,EAAaH,EAAa,IAEnBA,EAAa,IAAME,EAAe,GAAKT,IAC9CU,EAAaH,EAAa,GAEvB,CAAEA,WAAYA,EAAYG,WAAYA,GAM7BC,CAAgBhB,EAAS,GAAI,IACzCiB,EAAUnB,EACVoB,EAAUnB,EACd,GAAgB,OAAZkB,GAAgC,OAAZC,EACpB,MAAO,GAEPlB,EAAU,IACeiB,GAAzB1c,EAAK,CAAC2c,EAASD,IAAuB,GAAIC,EAAU3c,EAAG,IAI3D0c,GAAW/U,KAAKC,IAAI,GAAK6T,GACzBkB,GAAWhV,KAAKC,IAAI,GAAK6T,GAAW,EAIpC,IAHA,IAAImB,EAAYhB,EAAUY,YAAcZ,EAAUS,WAC9CQ,EAAQ,EACRC,EAAQ,GACHC,EAAOpV,KAAKY,KAAKmU,EAAUE,GAAaA,EAAWG,EAAOJ,EAASI,GAAQH,EAC5EjB,GAAaoB,GAA+B,EAAvBnB,EAAUS,aAC/BS,EAAME,KAAK,CAAEC,KAAM,QAASF,KAAMA,EAAO,EAAGF,MAAOA,IACnDA,GAAS,IAEJnB,GAAeqB,GAA+B,EAAvBnB,EAAUS,cACtCS,EAAME,KAAK,CAAEC,KAAM,QAASF,KAAMA,EAAO,EAAGF,MAAOA,IACnDA,GAAS,GAGjB,OAAOC,EAEX,SAASI,GAAUC,GACf,OAAIA,EAAM,IACCC,OAAOD,GAEX,GAAGxb,OAAOub,MAAaC,EAAM,MAAQ,KAAKxb,OAAO,KAAKA,UAAUwb,EAAM,MAAOE,QAAQ,EAAG,IAEnG,IAAIra,GAAYC,aAAW,WAA0B,MAAQ,CACzDqa,eAAgB,CACZC,SAAU,QAEdC,UAAW,CACP5M,OAAQ,QAEZ6M,UAAW,CACP7M,OAAQ,YAGhB,SAAS8M,GAAW1d,GAChB,IAAIub,EAAQvb,EAAGub,MAAOC,EAAMxb,EAAGwb,IAAKC,EAAUzb,EAAGyb,QAASkC,EAAW3d,EAAG2d,SAAUC,EAAQ5d,EAAG4d,MAAOC,EAAQ7d,EAAG6d,MAC3G/Y,EAAU9B,KACV8Z,EAAQxB,GAAUC,EAAOC,EAAKC,EAASmC,EAAOC,GAClD,OAAQzd,IAAMC,cAAcD,IAAM2E,SAAU,KACxC+X,EAAM7Q,KAAI,SAAU6R,GAChB,IAAInS,GAAKgS,EAAWnC,EAAMsC,EAAKf,KAAOe,EAAKf,KAAOxB,GAASE,EAC3D,OAAQrb,IAAMC,cAAc,OAAQ,CAAEiM,IAAKwR,EAAKf,KAAMgB,GAAIpS,EAAGqS,GAAIrS,EAAG2E,GAAI,GAAIE,GAAkB,UAAdsN,EAAKb,KAAmB,GAAS,GAAQgB,YAAa,EAAGrN,OAAsB,UAAdkN,EAAKb,KAAmB,OAAS,OAAQ1X,UAAyB,UAAduY,EAAKb,KAAmBnY,EAAQ0Y,UAAY1Y,EAAQ2Y,UAAW,UAAWK,EAAKf,UAExRD,EACKoB,QAAO,SAAUJ,GAAQ,MAAqB,UAAdA,EAAKb,QACrChR,KAAI,SAAU6R,GACf,IAAInS,GAAKgS,EAAWnC,EAAMsC,EAAKf,KAAOe,EAAKf,KAAOxB,GAASE,EAC3D,OAAQrb,IAAMC,cAAc,OAAQ,CAAEsL,EAAGA,EAAGD,EAAG,GAAIY,IAAK,SAAS3K,OAAOmc,EAAKf,MAAOoB,WAAY,SAAU5c,MAAO,CAAEgc,SAAU,QAAUhY,UAAWT,EAAQwY,gBAAkBJ,GAAUY,EAAKf,KAAO,QAG9M,IAqBeqB,GArBHvd,oBAAS,SAAUb,GAC3B,IAAIE,EAAQF,EAAGE,MACXiZ,EAAMjZ,EAAMiZ,IAAKtR,EAAW3H,EAAM2H,SAAU6S,EAAexa,EAAMwa,aAAc2D,EAAoBne,EAAMme,kBAAmBhF,EAAUnZ,EAAMmZ,QAASiF,EAAUpe,EAAMoe,QAAS9P,EAAYtO,EAAMsO,UAChMzG,EAAM1B,iBAAO,MACbkB,EAAU+W,EAAQ,GACtB,OAAQnF,EAAc/Y,IAAMC,cAAc,MAAO,CAAE0H,IAAKA,EAAKxG,MAAO,CAC5DoC,SAAU,WACVnC,MAAOkZ,EACP1W,OAAQ,YACRF,SAAU,SACVV,OAAQ,GACRC,WAAY,SAEhBjD,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAC5BC,MAAO8c,EAAQ1T,OAAS4D,EACxB7K,SAAU,WACV2B,KAAM+T,EAAU9R,EAAU8W,EAC1B3Z,cAAe,SAEnBtE,IAAMC,cAAcqd,GAAY,CAAEpR,IAAK/E,EAASgU,MAAOhU,EAAUM,EAAU2T,IAAKjU,EAAUM,EAAY2G,EAAY8P,EAAQ1T,OAAU/C,EAAU4T,QAAS,EAAI5T,MAdrJ,QCjGH0W,GALC1d,oBAAS,SAAUb,GAC/B,IACImO,EADQnO,EAAGE,MACOiO,UACtB,OAAO/N,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAEC,MAAO2M,Q,4DCDzCtN,uBAAS,SAAUb,GAC9B,IAAIE,EAAQF,EAAGE,MAAO2J,EAAU7J,EAAG6J,QAAS5E,EAAOjF,EAAGiF,KAClDuZ,EAAgBte,EAAM+N,UAAWwQ,EAAeve,EAAM2H,SAAU6W,EAAgBxe,EAAMiO,UAAWmL,EAAkBpZ,EAAMoZ,gBAAiB/K,EAASrO,EAAMqO,OACzJzN,EAAKC,mBAAS,GAAGY,OAAO6c,IAAiBvQ,EAAYnN,EAAG,GAAI6d,EAAe7d,EAAG,GAC9EI,EAAKH,mBAAS,GAAGY,OAAO8c,IAAgB5W,EAAW3G,EAAG,GAAI0d,EAAc1d,EAAG,GAC3EyE,EAAK5E,mBAAS,GAAGY,OAAO+c,IAAiBvQ,EAAYxI,EAAG,GAAIkZ,EAAelZ,EAAG,GAClF,SAAStE,EAAMqJ,GACX,OAAOwR,OAAO4C,OAAOpU,KAAOA,EAAI,EAEpC,IAAIqU,EAAiB1d,EAAM4M,GACvB+Q,EAAgB3d,EAAMwG,GACtBoX,EAAiB5d,EAAM8M,GAC3B,OAAQ/N,IAAMC,cAAc0J,IAAQ,CAAEF,QAAS,WAAc,OAAOA,KAAc5E,KAAMA,GACpF7E,IAAMC,cAAc2J,IAAa,KAAM,YACvC5J,IAAMC,cAAc4J,IAAe,KAC/B7J,IAAMC,cAAc6e,KAAkB,CAAEC,QAAS/e,IAAMC,cAAc+e,KAAU,CAAEC,QAASnf,EAAMkO,cAAekR,SAAU,WAAc,OAAOpf,EAAMqf,qBAAyB9W,MAAO,uBACpLrI,IAAMC,cAAc6e,KAAkB,CAAEC,QAAS/e,IAAMC,cAAc+e,KAAU,CAAEC,QAASnf,EAAMkZ,QAASkG,SAAU,WAAc,OAAOpf,EAAMsf,mBAAuB/W,MAAO,qBAC5KrI,IAAMC,cAAc6e,KAAkB,CAAEC,QAAS/e,IAAMC,cAAc+e,KAAU,CAAEC,QAASnf,EAAMuO,gBAAiB6Q,SAAU,WAAc,OAAOpf,EAAMuf,uBAA2BhX,MAAO,sBACxLrI,IAAMC,cAAc6e,KAAkB,CAAEC,QAAS/e,IAAMC,cAAc+e,KAAU,CAAEC,QAASnf,EAAMwO,SAAU4Q,SAAU,WAAc,OAAOpf,EAAMwf,oBAAwBjX,MAAO,6BAC9KrI,IAAMC,cAAc6e,KAAkB,CAAEC,QAAS/e,IAAMC,cAAc+e,KAAU,CAAEC,QAASnf,EAAMoO,iBAAkBgR,SAAU,WAAc,OAAOpf,EAAMyf,4BAAgClX,MAAO,6GAC9LrI,IAAMC,cAAcuf,KAAW,CAAEnX,MAAO,kBAAmBoX,MAAO5R,EAAW5M,MAAO0d,EAAgBO,SAAU,SAAU/e,GAAS,OAAOoe,EAAape,EAAMqG,OAAOiZ,UAClKzf,IAAMC,cAAcuf,KAAW,CAAEnX,MAAO,oBAAqBoX,MAAOhY,EAAUxG,MAAO2d,EAAeM,SAAU,SAAU/e,GAAS,OAAOqe,EAAYre,EAAMqG,OAAOiZ,UACjKzf,IAAMC,cAAc,KAAM,MACzBkO,EAA4L,KAAlLnO,IAAMC,cAAcuf,KAAW,CAAEnX,MAAO,kBAAmBoX,MAAO1R,EAAW9M,MAAO4d,EAAgBK,SAAU,SAAU/e,GAAS,OAAOse,EAAate,EAAMqG,OAAOiZ,UAC7Kzf,IAAMC,cAAc,KAAM,MAC1BD,IAAMC,cAAcuf,KAAW,CAAEE,QAAQ,EAAMrX,MAAO,eAAgBoX,MAAOvG,EAAiBgG,SAAU,SAAU/e,GAAS,OAAOL,EAAM6f,mBAAmBxf,EAAMqG,OAAOiZ,SAAaxV,OAAO2V,KAAKC,GAAchU,KAAI,SAAUiU,GAAU,OAAQ9f,IAAMC,cAAcwL,IAAU,CAAES,IAAK4T,EAAQL,MAAOK,GAAUA,OAC7S9f,IAAMC,cAAc8f,KAAe,KAC/B/f,IAAMC,cAAcgC,IAAQ,CAAEI,SAAUsc,GAAkBC,GAAiBC,EAAgBhf,QAAS,WAC5FC,EAAMye,cAAc1Q,GACpB/N,EAAM0e,aAAa/W,GACd0G,GACDrO,EAAM2e,cAAc1Q,GAExBtE,KACDrH,QAAS,YAAad,MAAO,WAAa,gB,UCnCjE,SAAS0e,GAAcpgB,GACnB,IAAI6J,EAAU7J,EAAG6J,QAAS5E,EAAOjF,EAAGiF,KACpC,OAAQ7E,IAAMC,cAAc0J,IAAQ,CAAEF,QAAS,WAAc,OAAOA,KAAc5E,KAAMA,GACpF7E,IAAMC,cAAc2J,IAAa,KAAM,mBACvC5J,IAAMC,cAAc4J,IAAe,KAC/B7J,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAE6B,OAAQ,IAAKU,SAAU,SAAY,qgDAEtE,SAASuc,GAAYrgB,GAChC,IAAI6J,EAAU7J,EAAG6J,QAAS5E,EAAOjF,EAAGiF,KAChCnE,EAAKC,oBAAS,GAAQuf,EAAUxf,EAAG,GAAIyf,EAAazf,EAAG,GAC3D,OAAQV,IAAMC,cAAcD,IAAM2E,SAAU,KACxC3E,IAAMC,cAAc+f,GAAe,CAAEvW,QAAS,WAAc,OAAO0W,GAAW,IAAWtb,KAAMqb,IAC/FlgB,IAAMC,cAAc0J,IAAQ,CAAEF,QAAS,WAAc,OAAOA,KAAc5E,KAAMA,GAC5E7E,IAAMC,cAAc2J,IAAa,KAAM,qBACvC5J,IAAMC,cAAc4J,IAAe,KAC/B7J,IAAMC,cAAcO,IAAY,KAC5B,WACA4f,KACA,KACApgB,IAAMC,cAAcC,IAAM,CAAEK,KAAM,kDAAoD,UACtF,KACJP,IAAMC,cAAc,KAAM,KACtBD,IAAMC,cAAc,KAAM,KACtBD,IAAMC,cAAcO,IAAY,KAC5B,qCACA,IACAR,IAAMC,cAAcC,IAAM,CAAEK,KAAM,0CAA4C,WAC9E,IACA,2CACA,IACAP,IAAMC,cAAcC,IAAM,CAAEL,QAAS,WAAc,OAAOsgB,GAAW,KAAY,UACzFngB,IAAMC,cAAc,KAAM,KACtBD,IAAMC,cAAcO,IAAY,KAC5B,0DACA,IACAR,IAAMC,cAAcC,IAAM,CAAEK,KAAM,oDAAsD,UAChGP,IAAMC,cAAc,KAAM,KACtBD,IAAMC,cAAcO,IAAY,KAC5B,uFACA,IACAR,IAAMC,cAAcC,IAAM,CAAEK,KAAM,sDAAwD,UAClGP,IAAMC,cAAc,KAAM,KACtBD,IAAMC,cAAcO,IAAY,KAC5B,+CACA,IACAR,IAAMC,cAAcC,IAAM,CAAEK,KAAM,yDAA2D,cC5C1GE,2BAAS,SAAUb,GAC9B,IAAIE,EAAQF,EAAGE,MAAO2J,EAAU7J,EAAG6J,QAAS5E,EAAOjF,EAAGiF,KAClDwb,EAAmBvgB,EAAMugB,iBAC7B,OAAQrgB,IAAMC,cAAc0J,IAAQ,CAAEF,QAAS,WAAc,OAAOA,KAAc5E,KAAMA,GACpF7E,IAAMC,cAAc2J,IAAa,KAAM,YACvC5J,IAAMC,cAAc4J,IAAe,KAC/B7J,IAAMC,cAAc6J,aAAY,CAAEC,WAAYsW,S,UCP3C5f,uBAAS,SAAUb,GAC9B,IAAIE,EAAQF,EAAGE,MAAO2J,EAAU7J,EAAG6J,QAAS5E,EAAOjF,EAAGiF,KAClDyb,EAASxgB,EAAMwgB,OACnB,OAAQtgB,IAAMC,cAAc0J,IAAQ,CAAEF,QAAS,WAAc,OAAOA,KAAc5E,KAAMA,GACpF7E,IAAMC,cAAc2J,IAAa,KAAM,aACvC5J,IAAMC,cAAc4J,IAAe,KAC/B7J,IAAMC,cAAcO,IAAY,KAAM,2DACtCR,IAAMC,cAAcsgB,KAAW,KAAMD,EAAOzU,KAAI,SAAU2U,GACtD,OAAQxgB,IAAMC,cAAc6e,KAAkB,CAAE5S,IAAKsU,EAAM1gB,MAAMmM,GAAI8S,QAAS/e,IAAMC,cAAc+e,KAAU,CAAEC,SAAUnf,EAAM2gB,gBAAgBC,IAAIF,EAAM1gB,MAAMmM,IAAKiT,SAAU,WACjKpf,EAAM6gB,YAAYH,EAAM1gB,MAAMmM,OAC5B5D,MAAOmY,EAAM1gB,MAAMuL,WAErCrL,IAAMC,cAAc8f,KAAe,KAC/B/f,IAAMC,cAAcgC,IAAQ,CAAEpC,QAAS,WAAc,OAAO4J,KAAcrH,QAAS,YAAad,MAAO,WAAa,e,oFCHhIsf,GAAWngB,oBAAS,SAAUb,GAC9B,IAAIE,EAAQF,EAAGE,MACX+gB,EAAmB/gB,EAAM+gB,iBAAkBC,EAAWhhB,EAAMghB,SAChE,OAAQ9gB,IAAMC,cAAc,MAAO,KAC/BD,IAAMC,cAAcO,IAAY,CAAEugB,QAAS,UACvC,aACAF,GACJ7gB,IAAMC,cAAc,OAAQ,CAAEkB,MAAO,CAAE6f,WAAY,MACnDhhB,IAAMC,cAAcO,IAAY,CAAEugB,QAAS,UACvC,aACAD,OAuCGG,GArCFxgB,oBAAS,SAAUb,GAC5B,IAAIE,EAAQF,EAAGE,MACXY,EAAKC,oBAAS,GAAQugB,EAAwBxgB,EAAG,GAAIygB,EAA2BzgB,EAAG,GACnFI,EAAKH,oBAAS,GAAQygB,EAAqBtgB,EAAG,GAAIugB,EAAwBvgB,EAAG,GAC7EyE,EAAK5E,oBAAS,GAAQ2gB,EAAuB/b,EAAG,GAAIgc,EAA0Bhc,EAAG,GACjFG,EAAK/E,oBAAS,GAAQ6gB,EAAyB9b,EAAG,GAAI+b,EAA4B/b,EAAG,GACrFgc,EAAmB5hB,EAAM4hB,iBAAkBC,EAAiB7hB,EAAM6hB,eACtE,OAAQ3hB,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAE4f,QAAS,SACnD/gB,IAAMC,cAAc2hB,KAAY,CAAE/hB,QAAS,WACnCC,EAAM0C,QAAQ,CAAEE,KAAM,GAAID,IAAK,KAC/B3C,EAAMqC,uBAAkB9B,GACxBP,EAAMoC,sBAAiB7B,GACvBP,EAAM+hB,WAAW,GACjB/hB,EAAMgiB,WAAW,GACjBhiB,EAAMiiB,oBAAoB,KAE9B/hB,IAAMC,cAAc+hB,KAAgB,OACxChiB,IAAMC,cAAc2hB,KAAY,CAAE/hB,QAAS,WAAc,OAAOshB,GAAyB,KACrFnhB,IAAMC,cAAcgiB,KAAc,OACtCjiB,IAAMC,cAAc2hB,KAAY,CAAE/hB,QAAS,WAAc,OAAO0hB,GAAwB,KACpFvhB,IAAMC,cAAcsI,IAAgB,OACxCvI,IAAMC,cAAc2hB,KAAY,CAAE/hB,QAAS,WAAc,OAAO4hB,GAA0B,KACtFzhB,IAAMC,cAAciiB,KAAU,OAClChB,EAAyBlhB,IAAMC,cAAckiB,GAAgB,CAAEtd,MAAM,EAAM/E,MAAOA,EAAO2J,QAAS,WAAc,OAAO0X,GAAyB,MAAgB,KAChKC,EAAsBphB,IAAMC,cAAcggB,GAAa,CAAEpb,MAAM,EAAM4E,QAAS,WAAc,OAAO4X,GAAsB,MAAgB,KACzIC,EAAwBthB,IAAMC,cAAcmiB,GAAe,CAAEvd,MAAM,EAAM/E,MAAOA,EAAO2J,QAAS,WAAc,OAAO8X,GAAwB,MAAgB,KAC7JC,EAA0BxhB,IAAMC,cAAcoiB,GAAiB,CAAExd,MAAM,EAAM/E,MAAOA,EAAO2J,QAAS,WAAc,OAAOgY,GAA0B,MAAgB,KACnKE,EAAenX,OAAS,EAAKxK,IAAMC,cAAcqiB,KAAQ,CAAEC,QAAQ,EAAM9C,MAAOiC,EAAkBxC,SAAU,SAAU/e,GAC9GL,EAAMiiB,qBAAqB5hB,EAAMqG,OAAOiZ,OACxC3f,EAAMgiB,WAAW,GACjBhiB,EAAM+hB,WAAW,KAChBF,EAAe9V,KAAI,SAAUiU,EAAQrD,GAAS,OAAQzc,IAAMC,cAAc,SAAU,CAAEiM,IAAK,GAAG3K,OAAOue,EAAQ,KAAKve,OAAOkb,GAAQgD,MAAOhD,GAASqD,OAAiB,KAC3K9f,IAAMC,cAAc2gB,GAAU,CAAE9gB,MAAOA,IACvCE,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAEqhB,KAAM,KAC5CxiB,IAAMC,cAAc2hB,KAAY,CAAE/hB,QAAS,WAAc,OAAOwhB,GAAsB,KAClFrhB,IAAMC,cAAcwiB,KAAU,W,0CCxDtC7f,GAAYC,aAAW,SAAUC,GAAS,MAAQ,CAClD4f,SAAU,CACNrhB,QAASyB,EAAMpB,QAAQ,GACvBgC,SAAU,OACVT,WAAY,OACZ0f,UAAW,kBAuBJC,GApBOniB,oBAAS,SAAUb,GACrC,IAAIE,EAAQF,EAAGE,MAAO2J,EAAU7J,EAAG6J,QAC/B/I,EAAKC,mBAAS,qBAAsB0H,EAAQ3H,EAAG,GAAImiB,EAAWniB,EAAG,GACjEgE,EAAU9B,KACd,OAAQ5C,IAAMC,cAAc0J,IAAQ,CAAE9E,MAAM,EAAM4E,QAASA,EAASqZ,WAAW,EAAMC,SAAU,MAC3F/iB,IAAMC,cAAc2J,IAAa,KAC7B,gBACA9J,EAAMuL,MACVrL,IAAMC,cAAc4J,IAAe,KAC/B7J,IAAMC,cAAcgC,IAAQ,CAAEG,QAAS,YAAad,MAAO,UAAWzB,QAAS,WACvEmjB,KAAKljB,EAAM6Q,MACXkS,EAAS,WACTI,YAAW,WACPJ,EAAS,uBACV,OACFxa,GACTrI,IAAMC,cAAc,MAAO,CAAEkF,UAAWT,EAAQge,UAAY5iB,EAAM6Q,OACtE3Q,IAAMC,cAAc8f,KAAe,KAC/B/f,IAAMC,cAAcgC,IAAQ,CAAEG,QAAS,YAAavC,QAAS4J,EAASnI,MAAO,aAAe,cCxBpGsB,GAAYC,aAAW,WAAc,MAAQ,CAC7CqQ,OAAQ,CACJ7R,QAAS,OAGN6hB,GAAaziB,oBAAS,SAAUb,GACvC,IAAIE,EAAQF,EAAGE,MAAO0gB,EAAQ5gB,EAAG4gB,MAC7B9f,EAAKC,qBAAY+H,EAAWhI,EAAG,GAAIyiB,EAAcziB,EAAG,GACpDI,EAAKH,oBAAS,GAAQyiB,EAAmBtiB,EAAG,GAAIuiB,EAAsBviB,EAAG,GACzE+M,EAAY/N,EAAM+N,UAAWzM,EAAQtB,EAAM2E,cAC3CzB,EAASwd,EAAMxd,OAAQqI,EAAOmV,EAAM1gB,MAAMuL,KAC1C3G,EAAU9B,KACV0gB,EAAmB/b,KAAKmI,IAAI,EAAG7B,EAAY,GAC/C,OAAQ7N,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CACpCC,MAAOA,EACP4B,OAAQA,EACRugB,WAAY,EACZ9f,UAAW,QACX0Z,SAAUmG,IAEdjY,EACArL,IAAMC,cAAc2hB,KAAY,CAAEzc,UAAWT,EAAQwO,OAAQ/R,MAAO,CAAEC,MAAOkiB,EAAkBtgB,OAAQsgB,GAAoBzjB,QAAS,SAAUM,GACtIgjB,EAAYhjB,EAAMqG,UAEtBxG,IAAMC,cAAcujB,KAAmB,OAC3C9a,EAAY1I,IAAMC,cAAciJ,IAAM,CAAER,SAAUA,EAAU8C,mBAAoB,EAAG3G,MAAM,EAAM4E,QAAS,WAChG0Z,OAAY9iB,KAEhBL,IAAMC,cAAcwL,IAAU,CAAEC,OAAO,EAAM7L,QAAS,WAC9CC,EAAM6gB,YAAYH,EAAM1gB,MAAMmM,IAC9BkX,OAAY9iB,KACX,SACTL,IAAMC,cAAcwL,IAAU,CAAEC,OAAO,EAAM7L,QAAS,WAC9CwjB,GAAoB,GACpBF,OAAY9iB,KACX,aAAgB,KAC7B+iB,EAAoBpjB,IAAMC,cAAc2iB,GAAiB,CAAE9iB,MAAO0gB,EAAM1gB,MAAO2J,QAAS,WAAc,OAAO4Z,GAAoB,MAAgB,SAsC1II,GApCHhjB,oBAAS,SAAUb,GAC3B,IAAIE,EAAQF,EAAGE,MAAO0gB,EAAQ5gB,EAAG4gB,MAC7BvC,EAAoBne,EAAMme,kBAC1Bjb,EAASwd,EAAM1gB,MAAMkD,OACrB2E,EAAM1B,iBAAO,MACbgM,EAAYhM,kBAAO,GACnBuU,EAASvU,iBAAO,GAwBpB,OAvBAa,qBAAU,WACN,IAAIwL,EAAO3K,EAAIX,QACf,GAAKsL,EAiBL,OADAA,EAAKjL,iBAAiB,QAASkL,GACxB,WACHD,EAAKhL,oBAAoB,QAASiL,IAftC,SAASA,EAAQC,GACb,IAAIrS,EAAQsS,IAAeD,GAC3BgI,EAAOxT,SAAW7G,EAAMua,OACnBzI,EAAUjL,UACXiL,EAAUjL,SAAU,EACpB2L,uBAAsB,WAClB7S,EAAM6a,WAAWH,EAAOxT,SACxBwT,EAAOxT,QAAU,EACjBiL,EAAUjL,SAAU,MAG5BwL,EAAUlS,oBAMf,CAACR,IACIE,IAAMC,cAAc,MAAO,CAAEiM,IAAKsU,EAAMvU,GAAI9K,MAAO,CAAE4f,QAAS,OAAQ/d,OAAQA,IAClFhD,IAAMC,cAAcijB,GAAY,CAAEpjB,MAAOA,EAAO0gB,MAAOA,IACvDxgB,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAEC,MAAO6c,EAAmBsF,WAAY,KAC5EvjB,IAAMC,cAAc,MAAO,CAAE0H,IAAKA,GAC9B3H,IAAMC,cAAcugB,EAAMkD,eAAgB,CAAE5jB,MAAOA,EAAO0gB,MAAOA,S,qBC9EzEmD,GAAgD,SAAUC,EAAIC,EAAMC,GACpE,GAAIA,GAA6B,IAArBvZ,UAAUC,OAAc,IAAK,IAA4BuZ,EAAxB1Z,EAAI,EAAGkN,EAAIsM,EAAKrZ,OAAYH,EAAIkN,EAAGlN,KACxE0Z,GAAQ1Z,KAAKwZ,IACRE,IAAIA,EAAKC,MAAMtZ,UAAUmP,MAAMjP,KAAKiZ,EAAM,EAAGxZ,IAClD0Z,EAAG1Z,GAAKwZ,EAAKxZ,IAGrB,OAAOuZ,EAAGriB,OAAOwiB,GAAMC,MAAMtZ,UAAUmP,MAAMjP,KAAKiZ,KAgBlDI,GAAMxjB,oBAAS,SAAUb,GACzB,IAAIyL,EAAOzL,EAAGyL,KAAMoU,EAAQ7f,EAAG6f,MAAOyE,EAAWtkB,EAAGskB,SAAUC,EAAUvkB,EAAGukB,QAASC,EAAWxkB,EAAGwkB,SAClG,OAAQpkB,IAAMC,cAAc,MAAO,KAC/BD,IAAMC,cAAc2hB,KAAY,CAAE/hB,QAASukB,EAAUjjB,MAAO,CAAE8M,OAAQ,KAClEjO,IAAMC,cAAcokB,KAAY,OACpCrkB,IAAMC,cAAcuf,KAAW,CAAEC,MAAOpU,EAAM6T,SAAU,SAAU/e,GAAS,OAAOgkB,EAAQhkB,EAAMqG,OAAOiZ,QAAWpX,MAAO,QACzHrI,IAAMC,cAAcuf,KAAW,CAAEC,MAAOA,EAAOP,SAAU,SAAU/e,GAAS,OAAO+jB,EAAS/jB,EAAMqG,OAAOiZ,QAAWpX,MAAO,cAEpH5H,uBAAS,SAAUb,GAC9B,IAAI6J,EAAU7J,EAAG6J,QAASkH,EAAO/Q,EAAG+Q,KAAM7Q,EAAQF,EAAGE,MACjDwkB,EAASxkB,EAAMwkB,OACf/M,EAAI5G,EAAKzL,KAAMqf,EAAI5T,EAAK5I,MACxBrH,EAAKC,mBAAS,CACd,CAAC,OAAQ,IACT,CAAC,KAAM,IACP,CAAC,OAAQ,MACT6jB,EAAO9jB,EAAG,GAAI+jB,EAAU/jB,EAAG,GAC/B,OAAQV,IAAMC,cAAc0J,IAAQ,CAAEF,QAAS,WAAc,OAAOA,KAAc5E,MAAM,GACpF7E,IAAMC,cAAc2J,IAAa,KAAM,gCACvC5J,IAAMC,cAAc4J,IAAe,KAC/B7J,IAAMC,cAAcO,IAAY,KAC5B,kDACA+W,EACA,KACAgN,EACA,IACAD,EAAO9Z,OACD,YAAYjJ,OAAOzB,EAAM4kB,OAAOnN,GAAI,MAAMhW,OAAOzB,EAAM4kB,OAAOH,IAC9D,IACVC,EAAK3Y,KAAI,SAAUjM,EAAI6c,GACnB,IAAIvQ,EAAMtM,EAAG,GAAI8Q,EAAM9Q,EAAG,GAC1B,OAAQI,IAAMC,cAAcgkB,GAAK,CAAE/X,IAAKuQ,EAAOpR,KAAMa,EAAKuT,MAAO/O,EAAKwT,SAAU,SAAUS,GAClF,IAAIC,EAAUjB,GAAc,GAAIa,GAAM,GACtCI,EAAQnI,GAAO,GAAKkI,EACpBF,EAAQG,IACTT,QAAS,SAAUU,GAClB,IAAID,EAAUjB,GAAc,GAAIa,GAAM,GACtCI,EAAQnI,GAAO,GAAKoI,EACpBJ,EAAQG,IACTR,SAAU,WACTI,EAAKM,OAAOrI,EAAO,GACnBgI,EAAQd,GAAc,GAAIa,GAAM,UAG5CxkB,IAAMC,cAAcgC,IAAQ,CAAEpC,QAAS,WAC/B4kB,EAAQd,GAAcA,GAAc,GAAIa,GAAM,GAAO,CAAC,CAAC,GAAI,MAAM,MAChE,WACTxkB,IAAMC,cAAc8f,KAAe,KAC/B/f,IAAMC,cAAcgC,IAAQ,CAAEpC,QAAS,WAC/BC,EAAMilB,cAAcxN,EAAGgN,EA3DtB,SAAU7T,GAC/B,IAAIoB,EAAM,GAOV,OANApB,EAAId,SAAQ,SAAUhQ,GAClB,IAAIsM,EAAMtM,EAAG,GAAI8Q,EAAM9Q,EAAG,GACrBkS,EAAI5F,KACL4F,EAAI5F,GAAO,IACf4F,EAAI5F,GAAK0Q,KAAKlM,MAEXoB,EAmDuCkT,CAAmBR,IAC7C/a,KACDrH,QAAS,YAAad,MAAO,WAAa,UACjDtB,IAAMC,cAAcgC,IAAQ,CAAEG,QAAS,YAAad,MAAO,YAAazB,QAAS,WAAc,OAAO4J,MAAgB,gBCzE3Hwb,GAAuBxkB,oBAAS,SAAUb,GACjD,IAAIE,EAAQF,EAAGE,MACXme,EAAoBne,EAAMme,kBAC1Bvd,EAAKC,oBAAS,GAAQwF,EAAgBzF,EAAG,GAAI2R,EAAmB3R,EAAG,GACnEuR,EAAYhM,kBAAO,GACnBwU,EAAQxU,iBAAO,GAwCnB,OAvCAa,qBAAU,WACN,SAASC,EAAgB5G,GACrBA,EAAMG,iBACN,IAAIsa,EAAQza,EAAMoG,QAClB,GAAsB,IAAlBkU,EAAMzT,QACNyT,EAAMzT,QAAU7G,EAAMoG,YAErB,CACD,IAAI2e,EAAatK,EAAQH,EAAMzT,QAC3Bke,IAGKjT,EAAUjL,UACXiL,EAAUjL,SAAU,EACpBI,OAAOuL,uBAAsB,WACzB7S,EAAMqlB,iBAAiBrlB,EAAM2E,cAAgBygB,GAC7CjT,EAAUjL,SAAU,EACpByT,EAAMzT,QAAU7G,EAAMoG,cAM1C,SAASU,IACLwT,EAAMzT,QAAU,EACZb,GACAkM,GAAiB,GAGzB,OAAIlM,GACAif,SAAS/d,iBAAiB,YAAaN,GAAiB,GACxDqe,SAAS/d,iBAAiB,UAAWJ,GAAe,GAC7C,WACHme,SAAS9d,oBAAoB,YAAaP,GAAiB,GAC3Dqe,SAAS9d,oBAAoB,UAAWL,GAAe,KAGxD,eACR,CAACd,EAAerG,IACXE,IAAMC,cAAc,MAAO,KAC/BD,IAAMC,cAAc,MAAO,CAAE2H,YAAa,WAAc,OAAOyK,GAAiB,IAAUlR,MAAO,CACzFyC,OAAQ,YACRZ,OAAQ,OACR5B,MAAO6c,EACPhb,WAAY,oBACZM,SAAU,kBAGf8hB,GAAyB5kB,oBAAS,SAAUb,GACnD,IAAIE,EAAQF,EAAGE,MACXme,EAAoBne,EAAMme,kBAC1Bvd,EAAKC,oBAAS,GAAQwF,EAAgBzF,EAAG,GAAI2R,EAAmB3R,EAAG,GACnEuR,EAAYhM,kBAAO,GACnBkM,EAAQlM,iBAAO,GAwCnB,OAvCAa,qBAAU,WACN,SAASC,EAAgB5G,GACrBA,EAAMG,iBACN,IAAIua,EAAQ1a,EAAM+G,QAClB,GAAsB,IAAlBiL,EAAMnL,QACNmL,EAAMnL,QAAU7G,EAAM+G,YAErB,CACD,IAAIoe,EAAazK,EAAQ1I,EAAMnL,QAC3Bse,IAGKrT,EAAUjL,UACXiL,EAAUjL,SAAU,EACpBI,OAAOuL,uBAAsB,WACzB7S,EAAMylB,UAAUzlB,EAAMkD,OAASsiB,GAC/BrT,EAAUjL,SAAU,EACpBmL,EAAMnL,QAAU7G,EAAM+G,cAM1C,SAASD,IACLkL,EAAMnL,QAAU,EACZb,GACAkM,GAAiB,GAGzB,OAAIlM,GACAif,SAAS/d,iBAAiB,YAAaN,GAAiB,GACxDqe,SAAS/d,iBAAiB,UAAWJ,GAAe,GAC7C,WACHme,SAAS9d,oBAAoB,YAAaP,GAAiB,GAC3Dqe,SAAS9d,oBAAoB,UAAWL,GAAe,KAGxD,eACR,CAACd,EAAerG,IACXE,IAAMC,cAAc,MAAO,KAC/BD,IAAMC,cAAc,MAAO,CAAE2H,YAAa,WAAc,OAAOyK,GAAiB,IAAUlR,MAAO,CACzFyC,OAAQ,YACRxC,MAAO,OACP4B,OAAQib,EACRhb,WAAY,oBACZM,SAAU,kBC3GtByG,GAAsC,WAStC,OARAA,GAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,GAEJH,GAASa,MAAMC,KAAMP,YAe5Bib,GAAkB/kB,oBAAS,SAAUb,GACrC,IAAIE,EAAQF,EAAGE,MACX6H,EAAM1B,iBAAO,MACbjD,EAASlD,EAAMkD,OAAQ5B,EAAQtB,EAAMsB,MAAOqD,EAAgB3E,EAAM2E,cAAewZ,EAAoBne,EAAMme,kBAAmBhF,EAAUnZ,EAAMmZ,QAAS6H,EAAWhhB,EAAMghB,SAAUrZ,EAAW3H,EAAM2H,SAyBvM,OAxBAX,qBAAU,WACN,GAAKa,EAAIX,QAAT,CAGA,IAAIkI,EAAMvH,EAAIX,QAAQmI,WAAW,MACjC,GAAKD,IAGLA,EAAIE,iBACJF,EAAII,UAAU,EAAG,EAAGlO,EAAO4B,QACV3C,IAAbygB,GAAwB,CACxB,IAAIvV,GAAKuV,EAAW,GAAKrZ,EAAWwR,EAAUxU,EAAgBwZ,EAC9D/O,EAAI2B,UAAY,wBAChB3B,EAAI2C,SAAStG,EAAG,EAAG9D,EAAUzE,OAElC,CACC8d,EACArZ,EACAwR,EACAjW,EACAib,EACAxZ,EACArD,IAEIpB,IAAMC,cAAc,SAAU,CAAE0H,IAAKA,EAAKvG,MAAOA,EAAO4B,OAAQA,EAAQ7B,MAAO,CAC/EoC,SAAU,WACV6F,IAAK,EACLlE,KAAM,EACN9D,MAAOA,EACP4B,OAAQA,EACRQ,OAAQ,IACRc,cAAe,aAGZ7D,uBAAS,SAAUb,GAC9B,IAAIE,EAAQF,EAAGE,MACX2lB,EAAO3lB,EAAM2lB,KAAMC,EAAc5lB,EAAM4lB,YAAajhB,EAAgB3E,EAAM2E,cAAezB,EAASlD,EAAMkD,OAAqD2iB,GAAzB7lB,EAAMme,kBAAoCne,EAAM6lB,gBACxL,OAAQ3lB,IAAMC,cAAc,MAAO,KAC9BylB,EAAqED,EAA6EzlB,IAAMC,cAAc,MAAO,KAC1KD,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAE6B,OAAQA,EAAQU,SAAU,WAC5D1D,IAAMC,cAAcghB,GAAQ,CAAEnhB,MAAOA,IACrCE,IAAMC,cAAc,MAAO,KACvBD,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAEoC,SAAU,aAC5CvD,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAE4f,QAAS,SAC3C/gB,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAEoiB,WAAY,EAAGniB,MAAOqD,IACxDzE,IAAMC,cAAcke,GAAW,CAAEre,MAAOA,KAC5CE,IAAMC,cAAc2lB,EAAY,CAAE9lB,MAAOA,EAAOsF,iBAAkBpF,IAAMC,cAAc+d,GAAO,CAAEle,MAAOA,OAAiC,OAAnB6lB,QAA8C,IAAnBA,OAA4B,EAC/KA,EAAe9Z,KAAI,SAAU2U,GAAS,OAAQxgB,IAAMC,cAAcwjB,GAAO,CAAEvX,IAAKsU,EAAM1gB,MAAMmM,GAAInM,MAAOA,EAAO0gB,MAAOA,OACrHxgB,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAE4f,QAAS,SAC3C/gB,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CAAEoiB,WAAY,EAAGniB,MAAOqD,IACxDzE,IAAMC,cAAc+R,EAAY,CAAElS,MAAOA,KAC7CE,IAAMC,cAAcglB,GAAsB,CAAEnlB,MAAOA,IACnDE,IAAMC,cAAcma,GAAW,CAAEta,MAAOA,IACxCE,IAAMC,cAAculB,GAAiB,CAAE1lB,MAAOA,QAC9DE,IAAMC,cAAcolB,GAAwB,CAAEvlB,MAAOA,KAhBqBE,IAAMC,cAAcO,IAAY,CAAE4B,QAAS,MAAQ,cAAjHpC,IAAMC,cAAc4lB,EAAY,CAAE/lB,MAAOA,IAiBzDA,EAAMgmB,gBAAmB9lB,IAAMC,cAAcH,EAAMgmB,gBAAiB9b,GAAS,GAAKlK,EAAMimB,aAAe,GAAK,CAAEtc,QAAS,WAC/G3J,EAAM6L,wBAAmBtL,OAAWA,OAC/B,KACbP,EAAMkmB,SAAYhmB,IAAMC,cAAcgmB,GAAkB,CAAEtV,KAAM7Q,EAAMkmB,SAAUlmB,MAAOA,EAAO2J,QAAS,WAAc,OAAO3J,EAAM8G,mBAAyB,S,+GCVpJsf,GA3EiB,WAC5B,SAASA,EAAWC,GAChBrb,KAAKiO,IAAMqN,iBAAMD,GAuErB,OArEAD,EAAWxb,UAAU2b,OAAS,WAC1B,OAAOvb,KAAKiO,KAEhBmN,EAAWxb,UAAU4b,OAAS,SAAUjb,GACpC,IAAIzL,EACJ,OAAiF,QAAzEA,EAAKkL,KAAKiO,IAAIwN,KAAKva,MAAK,SAAUwa,GAAO,OAAOA,EAAIva,KAAOZ,YAA6B,IAAPzL,OAAgB,EAASA,EAAG6mB,IAAIzK,MAAM,KAEnIkK,EAAWxb,UAAUgc,SAAW,WAC5B,OAAO5b,KAAKiO,IAAIwN,KAAK,GAAGE,IAAIjc,QAEhC0b,EAAWxb,UAAUic,WAAa,WAC9B,OAAO7b,KAAKiO,IAAI6N,QAEpBV,EAAWxb,UAAUmc,SAAW,WAC5B,OAAO/b,KAAKiO,IAAIwN,KAAK1a,KAAI,SAAU2a,GAAO,OAAOA,EAAIva,OAEzDia,EAAWxb,UAAUoc,cAAgB,WACjC,MAAO,IAEX7c,OAAO8c,eAAeb,EAAWxb,UAAW,iBAAkB,CAC1Dsc,IAAK,WACD,MAAO,IAEXC,YAAY,EACZC,cAAc,IAElBhB,EAAWxb,UAAUyc,QAAU,WAC3B,MAAO,CACHlb,GAAI,OACJkC,QAAQ,EACR2F,UAAWhJ,KAAK+b,WAAWhb,KAAI,SAAUR,GAAQ,MAAQ,CAAEY,GAAIZ,EAAMA,KAAMA,QAGnFpB,OAAO8c,eAAeb,EAAWxb,UAAW,eAAgB,CACxDsc,IAAK,WACD,OAAOlc,KAAKiO,IAAIqO,WAEpBH,YAAY,EACZC,cAAc,IAElBjd,OAAO8c,eAAeb,EAAWxb,UAAW,8BAA+B,CACvEsc,IAAK,aAGLC,YAAY,EACZC,cAAc,IAElBjd,OAAO8c,eAAeb,EAAWxb,UAAW,SAAU,CAClDsc,IAAK,WACD,IAAIpnB,EACJ,OAAqC,QAA5BA,EAAKkL,KAAKuc,oBAAiC,IAAPznB,OAAgB,EAASA,EAAG0nB,QACnE,CACE,CACIrb,GAAI,eACJZ,KAAM,qBACNsF,KAAM7F,KAAKuc,aACXE,kBAAmB,CACf,IAAK,QACL,IAAK,OACL,IAAK,WACL,IAAK,WAIf,IAEVN,YAAY,EACZC,cAAc,IAEXhB,EAzEqB,GC0DjB,SAASE,GAAMhc,GAI1B,IAHA,IAAIod,EAAY,GACZ9kB,EAAO,GACP+kB,EAASrd,EAAE4R,MAAM,uBACZ3R,EAAI,EAAGA,EAAIod,EAAOjd,OAAQH,IAAK,CACpC,IAAIqd,EAAQD,EAAOpd,GACfsd,EAAU,GACd,OAAQD,GACJ,IAAK,IACDhlB,EAAKoR,UAAY,CAAC6T,GAClBH,EAAU5K,KAAKla,GACfA,EAAOilB,EACP,MACJ,IAAK,IACDH,EAAUA,EAAUhd,OAAS,GAAGsJ,UAAU8I,KAAK+K,GAC/CjlB,EAAOilB,EACP,MACJ,IAAK,IACDjlB,EAAO8kB,EAAUI,MACjB,MACJ,IAAK,IACD,MACJ,QACI,IAAIrc,EAAIkc,EAAOpd,EAAI,GACT,MAANkB,GAAmB,MAANA,GAAmB,MAANA,EAC1B7I,EAAK2I,KAAOqc,EAED,MAANnc,IACL7I,EAAK8H,OAASqd,WAAWH,KAKzC,OAAOhlB,EC5FX,IAAIolB,GAAkC,SAAU1d,EAAG2d,GAC/C,IAAI5d,EAAI,GACR,IAAK,IAAIM,KAAKL,EAAOH,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,IAAMsd,EAAEC,QAAQvd,GAAK,IAC9EN,EAAEM,GAAKL,EAAEK,IACb,GAAS,MAALL,GAAqD,oBAAjCH,OAAOge,sBACtB,KAAI5d,EAAI,EAAb,IAAgBI,EAAIR,OAAOge,sBAAsB7d,GAAIC,EAAII,EAAED,OAAQH,IAC3D0d,EAAEC,QAAQvd,EAAEJ,IAAM,GAAKJ,OAAOS,UAAUwd,qBAAqBtd,KAAKR,EAAGK,EAAEJ,MACvEF,EAAEM,EAAEJ,IAAMD,EAAEK,EAAEJ,KAE1B,OAAOF,GAoIIge,GA/HmB,WAC9B,SAASA,EAAahC,EAAMzE,GACxB,IAAI0G,EAAMC,KAAUC,SAASnC,GAC7Brb,KAAK6F,KAAOyX,EACZtd,KAAKiO,IAAMqP,EAAI1G,GAyHnB,OAvHAyG,EAAazd,UAAU2b,OAAS,WAC5B,OAAOvb,KAAKiO,KAEhBoP,EAAazd,UAAU4b,OAAS,SAAUjb,GACtC,IAAIzL,EAAIc,EACR,OAAwF,QAAhFA,EAAyB,QAAnBd,EAAKkL,KAAKiO,WAAwB,IAAPnZ,OAAgB,EAASA,EAAG2oB,QAAQld,UAA0B,IAAP3K,OAAgB,EAASA,EAAGsb,MAAM,KAEtImM,EAAazd,UAAUgc,SAAW,WAC9B,IAAI9mB,EACAyL,EAAOpB,OAAO2V,KAAyB,QAAnBhgB,EAAKkL,KAAKiO,WAAwB,IAAPnZ,OAAgB,EAASA,EAAG2oB,SAAS,GACxF,OAAOzd,KAAKwb,OAAOjb,GAAMb,QAE7BP,OAAO8c,eAAeoB,EAAazd,UAAW,iBAAkB,CAC5Dsc,IAAK,WACD,OAAOlc,KAAK6F,KAAK9E,KAAI,SAAU2a,EAAK/J,GAAS,IAAI7c,EAAI,OAA6B,QAApBA,EAAK4mB,EAAIgC,GAAGC,UAAuB,IAAP7oB,OAAgB,EAASA,EAAG,KAAO,aAAa2B,OAAOkb,EAAQ,OAE7JwK,YAAY,EACZC,cAAc,IAElBiB,EAAazd,UAAUic,WAAa,WAChC,IAAI/mB,EAAIc,EACR,MAAO,CACHgoB,QAAS5d,KAAKiO,IAAIyP,GAClBG,WAAmC,QAAtB/oB,EAAKkL,KAAKiO,IAAI6P,UAAuB,IAAPhpB,OAAgB,EAASA,EAAGipB,GACvEC,OAA+B,QAAtBpoB,EAAKoK,KAAKiO,IAAI6P,UAAuB,IAAPloB,OAAgB,EAASA,EAAGqoB,KAG3EZ,EAAazd,UAAUU,cAAgB,SAAU4d,GAC7C,IAAIppB,EAAIc,EACR,MAAO,CACH2K,KAAM2d,EACNvc,UAAkC,QAAtB7M,EAAKkL,KAAKiO,IAAI6P,UAAuB,IAAPhpB,OAAgB,EAASA,EAAGipB,GAAGG,GACzEC,OAA+B,QAAtBvoB,EAAKoK,KAAKiO,IAAI6P,UAAuB,IAAPloB,OAAgB,EAASA,EAAGqoB,GAAGC,KAG9Eb,EAAazd,UAAUmc,SAAW,WAC9B,OAAO5c,OAAO2V,KAAK9U,KAAKiO,IAAIwP,UAEhCJ,EAAazd,UAAUwe,aAAe,aACtCf,EAAazd,UAAUoc,cAAgB,WACnC,IAAIlnB,EACAupB,EAAW,uCACXxQ,EAAM7N,KAAKiO,IACf,OAAO9O,OAAOyJ,SAA2B,QAAjB9T,EAAK+Y,EAAIiQ,UAAuB,IAAPhpB,OAAgB,EAASA,EAAGmpB,KAAO,IAC/Eld,KAAI,SAAUjM,GACf,IAAIqM,EAAKrM,EAAG,GAAIwpB,EAAKxpB,EAAG,GACxB,MAAO,CAACqM,EAAIkd,EAASE,KAAKD,OAEzBtL,QAAO,SAAUjc,GAAQ,QAASA,EAAK,MACvCgK,KAAI,SAAUjM,GACf,IAAIqM,EAAKrM,EAAG,GAAI0pB,EAAQ1pB,EAAG,GAK3B,MAAO,CAAEqM,GAAIA,EAAIM,IAJP+c,EAAM,GAAGC,cAIQC,MAHfF,EAAM,GAGuBG,UAFzBH,EAAM,GAEuCI,QAD/CJ,EAAM,OAGnBjS,QAAO,SAAUC,EAAGvD,GACrB,IAAI9H,EAAK8H,EAAE9H,GAAI0d,EAAO7B,GAAO/T,EAAG,CAAC,OAKjC,OAJKuD,EAAErL,KACHqL,EAAErL,GAAM,IAEZqL,EAAErL,GAAI2Q,KAAK+M,GACJrS,IACR,KAEP6Q,EAAazd,UAAUyc,QAAU,WAC7B,IAAIvnB,EAAIc,EAAII,EACR4B,EAA+H,QAAvH5B,EAA2E,QAArEJ,EAAyB,QAAnBd,EAAKkL,KAAKiO,WAAwB,IAAPnZ,OAAgB,EAASA,EAAG4oB,UAAuB,IAAP9nB,OAAgB,EAASA,EAAGkpB,UAAuB,IAAP9oB,OAAgB,EAASA,EAAG,GACvK,OAAO4B,EACDiR,EAAgBkW,GAAYnnB,IAC5B,CACEuJ,GAAI,OACJkC,QAAQ,EACR2F,UAAWhJ,KAAK+b,WAAWhb,KAAI,SAAUR,GAAQ,MAAQ,CACrDY,GAAIZ,EACJA,KAAMA,QAItBpB,OAAO8c,eAAeoB,EAAazd,UAAW,eAAgB,CAC1Dsc,IAAK,WACD,IAAIpnB,EACJ,OAA8B,QAAtBA,EAAKkL,KAAKiO,IAAI+Q,UAAuB,IAAPlqB,OAAgB,EAASA,EAAGmqB,UAEtE9C,YAAY,EACZC,cAAc,IAElBjd,OAAO8c,eAAeoB,EAAazd,UAAW,8BAA+B,CACzEsc,IAAK,WACD,IAAIpnB,EACJ,OAA8B,QAAtBA,EAAKkL,KAAKiO,IAAI+Q,UAAuB,IAAPlqB,OAAgB,EAASA,EAAGoqB,SAEtE/C,YAAY,EACZC,cAAc,IAElBjd,OAAO8c,eAAeoB,EAAazd,UAAW,SAAU,CACpDsc,IAAK,WACD,MAAO,CACH,CACI/a,GAAI,eACJZ,KAAM,qBACNsF,KAAM7F,KAAKuc,aACXE,kBAAmB,IAEvB,CACItb,GAAI,kBACJZ,KAAM,sBACNsF,KAAM7F,KAAKmf,4BACX1C,kBAAmB,CACf,IAAK,OACL,IAAK,gBAKrBN,YAAY,EACZC,cAAc,IAEXiB,EA7HuB,GC+DnB+B,GA7Ee,WAC1B,SAASA,EAAS/D,GACd,IAAIM,EAAM,GACNpb,EAAO,GACP8e,EAAK,UACThE,EAAKnK,MAAM,MAAMpM,SAAQ,SAAUwa,GAC/B,IAAId,EAAQa,EAAGd,KAAKe,GAChBd,EACA7C,EAAKpb,EAAOie,EAAM,IAAO,GAEpBje,IACLob,EAAIpb,GAAQob,EAAIpb,GAAQ+e,EAAK3a,QAAQ,SAAU,QAGvD3E,KAAKiO,IAAM,CAAEwP,QAAS9B,GA6D1B,OA3DAyD,EAASxf,UAAU2b,OAAS,WACxB,OAAOvb,KAAKiO,KAEhBmR,EAASxf,UAAUmc,SAAW,WAC1B,OAAO5c,OAAO2V,KAAK9U,KAAKiO,IAAIwP,UAEhC2B,EAASxf,UAAU4b,OAAS,SAAUjb,GAClC,IAAIzL,EAAIc,EACR,OAAwF,QAAhFA,EAAyB,QAAnBd,EAAKkL,KAAKiO,WAAwB,IAAPnZ,OAAgB,EAASA,EAAG2oB,QAAQld,UAA0B,IAAP3K,OAAgB,EAASA,EAAGsb,MAAM,KAEtIkO,EAASxf,UAAUgc,SAAW,WAC1B,IAAI9mB,EACAyL,EAAOpB,OAAO2V,KAAyB,QAAnBhgB,EAAKkL,KAAKiO,WAAwB,IAAPnZ,OAAgB,EAASA,EAAG2oB,SAAS,GACxF,OAAOzd,KAAKwb,OAAOjb,GAAMb,QAE7B0f,EAASxf,UAAUoc,cAAgB,WAC/B,MAAO,IAEX7c,OAAO8c,eAAemD,EAASxf,UAAW,iBAAkB,CACxDsc,IAAK,WACD,MAAO,IAEXC,YAAY,EACZC,cAAc,IAElBgD,EAASxf,UAAUic,WAAa,WAC5B,MAAO,IAEXuD,EAASxf,UAAUyc,QAAU,WACzB,MAAO,CACHlb,GAAI,OACJkC,QAAQ,EACR2F,UAAWhJ,KAAK+b,WAAWhb,KAAI,SAAUR,GAAQ,MAAQ,CACrDY,GAAIZ,EACJA,KAAMA,QAIlBpB,OAAO8c,eAAemD,EAASxf,UAAW,eAAgB,CACtDsc,IAAK,aAGLC,YAAY,EACZC,cAAc,IAElBjd,OAAO8c,eAAemD,EAASxf,UAAW,8BAA+B,CACrEsc,IAAK,aAGLC,YAAY,EACZC,cAAc,IAElBjd,OAAO8c,eAAemD,EAASxf,UAAW,SAAU,CAChDsc,IAAK,WACD,MAAO,IAEXC,YAAY,EACZC,cAAc,IAEXgD,EA3EmB,GCI1BG,GAAkB5pB,oBAAS,SAAUb,GACrC,IAAI4gB,EAAQ5gB,EAAG4gB,MAAO1gB,EAAQF,EAAGE,MAAOqH,EAAUvH,EAAGuH,QACjDiH,EAAYtO,EAAMsO,UAAW6K,EAAUnZ,EAAMmZ,QAASD,EAAUlZ,EAAMkZ,QAASsR,EAAmBxqB,EAAMmU,YAAaxM,EAAW3H,EAAM2H,SAAUoG,EAAY/N,EAAM+N,UAAWU,EAAqBzO,EAAMyO,mBACxM7N,EAAK8f,EAAM1gB,MAAOynB,EAAoB7mB,EAAG6mB,kBAAmB5W,EAAOjQ,EAAGiQ,KACtEsD,EAAcsT,GAAqB+C,EACnCxnB,EAAQsW,cACRzR,EAAM1B,iBAAO,MACboT,EAAiBC,mBAAQ,WAAc,OAAOtF,EAAcC,EAAanR,KAAW,CAACmR,EAAanR,IA2CtG,OA1CAgE,qBAAU,WACN,GAAKa,EAAIX,QAAT,CAGA,IAAIkI,EAAMvH,EAAIX,QAAQmI,WAAW,MACjC,GAAKD,EAAL,CAIAA,EAAIE,iBACJF,EAAIG,MAAMd,EAAoBA,GAC9BW,EAAII,UAAU,EAAG,EAAGlB,EAAWP,GAC/BqB,EAAIK,WAAWpI,EAAS,GACxB+H,EAAIzL,UAAY,SAChByL,EAAIM,KAAON,EAAIM,KAAKC,QAAQ,QAAS,GAAGlO,OAAOgG,KAAKmI,IAAI,EAAG7B,EAAY,GAAI,OAI3E,IAHA,IAAI6L,EAASnS,KAAKmI,IAAI,EAAGnI,KAAKiS,MAAMrS,EAAUM,IAC1CkS,EAAOpS,KAAKmI,IAAI,EAAGnI,KAAKY,MAAMhB,EAAUiH,GAAa3G,IACrDqS,EAAe,OAATnJ,QAA0B,IAATA,OAAkB,EAASA,EAAKkJ,MAAMH,EAAQC,GAChEtP,EAAI,EAAGyP,GAAOzP,EAAIyP,EAAItP,OAAQH,IAAK,CACxC,IAAI6J,EAAS4F,EAAIzP,GACb/I,EAAQ2S,EAAYC,EAAO6F,eAC/B,GAAIf,EAAS,CACT,IAAIzN,EAAIlB,EAAI5C,EAAWN,EAAWA,EAAUM,EAC5CyH,EAAI2B,UAAYvP,GAAS,QACzB4N,EAAI2C,SAAStG,EAAG,EAAG9D,EAAUoG,GACzBA,GAAa,IAAMpG,GAAYoG,EAAY,IAC3CqB,EAAI2B,UAAYwI,EAAenF,EAAO6F,gBAAkB,QACxD7K,EAAIyC,SAASuC,EAAQ3I,EAAI9D,EAAW,EAAGoG,EAAY,EAAI,UAIpE,CACCmL,EACA5K,EACA3G,EACAoG,EACA1G,EACAkS,EACApF,EACA1F,EACAoC,IAEI3Q,IAAMC,cAAc,SAAU,CAAE0H,IAAKA,EAAK3E,OAAQ6K,EAAYU,EAAoBnN,MAAOgN,EAAYG,EAAoBpN,MAAO,CAChIoC,SAAU,WACV2B,KAAM+T,EAAU9R,EAChB/F,MAAOgN,EACPpL,OAAQ6K,QAaL0c,GAVO9pB,oBAAS,SAAUb,GACrC,IAAI4gB,EAAQ5gB,EAAG4gB,MAAO1gB,EAAQF,EAAGE,MAC7Boe,EAAUpe,EAAMoe,QAAS5D,EAAexa,EAAMwa,aAAczM,EAAY/N,EAAM+N,UAClF,OAAQ7N,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CACpCoC,SAAU,WACVP,OAAQ6K,EACRzM,MAAOkZ,EACP5W,SAAU,WACTwa,EAAQrS,KAAI,SAAUkP,GAAM,OAAQ/a,IAAMC,cAAcoqB,GAAiB,CAAEne,IAAK6O,EAAIyF,MAAOA,EAAO1gB,MAAOA,EAAOqH,QAAS4T,WCjBvHyP,GAnDa,WACxB,SAASA,EAAO5qB,GACZ,IAAkCkB,QAAlB,IAAPlB,EAAgB,GAAKA,GAAY6qB,UAAWA,OAAmB,IAAP3pB,EAAgB,IAAQA,EACzFgK,KAAK4f,kBAAmB,EACxB5f,KAAK6f,MAAQ,IAAIvd,IACjBtC,KAAK8f,WAAa,IAAIC,IACtB/f,KAAK2f,UAAYljB,KAAKY,KAAKsiB,GAC3B3f,KAAKggB,aAAe,EA0CxB,OApCAN,EAAO9f,UAAUqgB,QAAU,SAAU9e,EAAI/G,EAAM6C,EAAO/E,EAAQ2N,GAE1D,IAAIqa,EAAiBlgB,KAAK8f,WAAW5D,IAAI/a,GACzC,GAAI+e,EACA,OAAOA,EAAenc,KAG1B,IADA,IAAIoc,EAAa,EACVngB,KAAK6f,MAAMO,SAAS,CACvBvc,KAAMzJ,EACN2J,KAAMoc,EACNrc,KAAM7G,EACN+G,KAAMmc,EAAajoB,KAEnBioB,GAAcngB,KAAK2f,WACnBQ,GAAc,EAElB,IAAIE,EAAS,CACTxc,KAAMzJ,EACN2J,KAAMoc,EACNrc,KAAM7G,EACN+G,KAAMmc,EAAajoB,EACnBiJ,GAAIA,EACJ0E,KAAMA,GAKV,OAHA7F,KAAK6f,MAAM1Z,OAAOka,GAClBrgB,KAAK8f,WAAWQ,IAAInf,EAAIkf,GACxBrgB,KAAKggB,aAAevjB,KAAKmI,IAAI5E,KAAKggB,aAAcG,GACzCA,GAEXhhB,OAAO8c,eAAeyD,EAAO9f,UAAW,cAAe,CACnDsc,IAAK,WACD,OAAOlc,KAAKggB,cAEhB7D,YAAY,EACZC,cAAc,IAEXsD,EAjDiB,GCGxBH,GAAkB5pB,oBAAS,SAAUb,GACrC,IAAI4gB,EAAQ5gB,EAAG4gB,MAAO1gB,EAAQF,EAAGE,MAAOqH,EAAUvH,EAAGuH,QACjDiH,EAAYtO,EAAMsO,UAAW3G,EAAW3H,EAAM2H,SAAU6c,EAASxkB,EAAMwkB,OAAQzW,EAAY/N,EAAM+N,UAAWU,EAAqBzO,EAAMyO,mBAAoB0K,EAAUnZ,EAAMmZ,QAC3KvY,EAAK8f,EAAM1gB,MAAOkD,EAAStC,EAAGsC,OAAQqoB,EAAW3qB,EAAG2qB,SAAUC,EAAoB5qB,EAAG4qB,kBACrFC,EAAQC,0BAAgBH,GACtBI,sBAAYJ,GACZA,EACFK,EAASpS,mBAAQ,WACjB,IAAIqS,EAAO,IAAInB,GAcf,OAbU,OAAVe,QAA4B,IAAVA,GAA4BA,EAAM3b,SAAQ,SAAUgc,EAASnP,GAC3E,IAAItB,EAAQyQ,EAAQzQ,MAAOC,EAAMwQ,EAAQxQ,IACzC,GAAIkQ,EAAmB,CACnB,IAAIlhB,EAAItK,EAAM+rB,kBAAkBP,EAAmBnQ,EAAQ,GACvD4M,EAAIjoB,EAAM+rB,kBAAkBP,EAAmBlQ,GACnDuQ,EAAKZ,QAAQ,GAAGxpB,OAAOkb,GAAQrS,EAAG2d,EAAGla,EAAW+d,OAE/C,CACGxhB,EAAItK,EAAMgsB,aAAa3Q,EAAQ,GAC/B4M,EAAIjoB,EAAMgsB,aAAa1Q,GAC3BuQ,EAAKZ,QAAQ,GAAGxpB,OAAOkb,GAAQrS,EAAG2d,EAAGla,EAAW+d,OAGjDD,IACR,CAAC9d,EAAW0d,EAAOD,EAAmBxrB,EAAOwkB,IAC5C3c,EAAM1B,iBAAO,MACb8lB,EAAW9lB,iBAAO,MAClBoH,EAAepH,iBAAO,MAiF1B,OAhFAa,qBAAU,WACN,GAAKa,EAAIX,QAAT,CAGA,IAAIkI,EAAMvH,EAAIX,QAAQmI,WAAW,MACjC,GAAKD,EAAL,CAGAA,EAAIE,iBACJF,EAAIG,MAAMd,EAAoBA,GAC9BW,EAAII,UAAU,EAAG,EAAGlB,EAAWpL,GAC/BkM,EAAIK,WAAWpI,EAAS,GACxB+H,EAAIzL,UAAY,SAChByL,EAAIM,KAAON,EAAIM,KAAKC,QAAQ,QAAS,GAAGlO,OAAOgG,KAAKmI,IAAI,EAAG7B,EAAY,GAAI,OAC3E,IAAI6L,EAASnS,KAAKmI,IAAI,EAAGnI,KAAKiS,MAAMrS,EAAUM,IAC9CyH,EAAI2B,UAAY,YAChB6a,EAAOd,WAAWhb,SAAQ,SAAU6P,GAChC,IAAI9Q,EAAO8Q,EAAM9Q,KAAMC,EAAO6Q,EAAM7Q,KAAMC,EAAO4Q,EAAM5Q,KAAMC,EAAO2Q,EAAM3Q,KACtE6O,GAAMhP,EAAO+K,GAAUjS,EAAWN,EAAWA,EAAUM,EACvDmW,GAAMhP,EAAO8K,GAAUjS,EAAWN,EAAWA,EAAUM,EACvDmW,EAAKD,EAAK,GACVzO,EAAI2C,SAAS8L,EAAI9O,EAAM+O,EAAKD,GAAK7O,EAAOD,GAAQ,UAGzD,CACCyc,EACAld,EACA3G,EACAikB,EAAOd,WACP9qB,EACA+N,EACA7K,EACAmE,EACAoH,EACA8c,EACA/G,IAEJxd,qBAAU,WACN,GAAKilB,EAAS/kB,QAAd,CAGA,IAAIkI,EAAM6c,EAAS/kB,QAAQmI,WAAW,MACjCD,IAILA,EAAIE,iBACJF,EAAIG,MAAMd,EAAoBA,GAC9BW,EAAII,UAAU,EAAG,EAAGlB,EAAWpL,GAC/BkM,EAAIK,WAAWpI,EAAS,GACxB+H,EAAIzL,UAAY,SAChByL,EAAIM,KAAON,EAAIM,KAAKC,QAAQ,QAAS,GAAGlO,OAAOgG,KAAKmI,IAAI,EAAG7B,EAAY,GAAI,OAC3EqB,EAAI2B,UAAY,QAChB3B,EAAIzL,UAAY,OAChBioB,EAAOd,WAAWhb,SAAQ,SAAU6P,GAChC,IAAI7f,EAAIc,EAAII,EAAIyE,EACZoJ,EAAO8Q,EAAM9Q,KAAMC,EAAO6Q,EAAM7Q,KAAME,EAAO2Q,EAAM3Q,KAAMD,EAAO4Q,EAAM5Q,KACtE+c,EAAUnM,EAAM9O,KAChBgN,EAAKhP,EAAOlH,EACZmW,EAAKhP,EAAOnH,EAChB,GAAImW,EAAKD,EAAK,EAAG,CACb,IAAIqO,EAAyF,QAAjFtrB,EAAmC,QAA7Bd,EAAKgsB,EAAQ7hB,kBAA+B,IAAPnK,OAAgB,EAASA,EAAGqsB,YAAyB,IAAPvrB,OAAgB,EAASA,EAAG,GAC7HwrB,EAA2F,QAAjF3mB,EAAmC,QAA7BzE,EAAK8qB,EAAQ7hB,kBAA+B,IAAPjJ,OAAgB,EAASA,EAAGqrB,YAAyB,IAAP5mB,OAAgB,EAASA,EAAG,GAC/HsX,EAAO+O,EAAQ/O,KACnB3N,EAAIyC,SAAS,CAACkL,EAAMqP,EAAQF,GAAMlO,QAAO,SAAUsO,GAAK,QAASA,KAAMC,KAAK,OAAQ9kB,KAAKmI,IAAInI,KAAK4I,KAAK8I,EAAS2E,GAAKD,GAAK9O,GAAQC,EAAOD,YAGlJ,CACCT,EACA3G,EACAwR,EACA1K,EACAvL,EACA0oB,EAAOd,WACPzjB,EACAkkB,EACAvrB,EACA+N,EACAyW,IAEI+G,EAAmBrrB,IAAMC,cAAcD,IAAM2E,SAAU,KAC3D3E,IAAMC,cAAc,SAAU,CAAE0H,IAAKA,EAAK3E,OAAQA,EAASuL,EAAoBnN,MAAOgN,EAAYG,EAAoBpN,MAAO,CACrHoC,SAAU,WACV2B,KAAM+T,EAAU9R,EAChB/F,MAAOgN,EACPpL,OAAQA,KAEhBhD,IAAMC,cAAc,SAAU,CAAE0H,IAAKokB,EAAU/oB,OAAQA,EAASuL,EAAoBnN,MAAOgN,EAAYG,EAAoBpN,MAAO,CAC1HoC,SAAU,WACV2B,KAAM+T,EAAU9R,EAChB/F,MAAOgN,EACPpL,OAAQA,KAEhBhD,IAAMC,cAAc,SAAU,CAAE0H,IAAK0F,EAAcrK,OAAQA,EAASuL,EAAoBnN,MAAOgN,EAAYG,EAAoBpN,MAAO,CAC9HoC,SAAU,WACV2B,KAAM+T,EAAU9R,EAChB/F,MAAOgN,EACPpL,OAAQA,MAjBD,QA+BRunB,GAXO9pB,oBAAS,SAAUb,GACrC,IAAIE,EAAQF,EAAGE,MAAO0gB,EAAQ5gB,EAAG4gB,MAC7BtC,EAAUpe,EAAMoe,QAAS5D,EAAexa,EAAMwa,aAC9CtX,EAASwd,EAAM1gB,MAAMkD,OACzB,OAAQhD,IAAMC,cAAc,MAAO,CAAEkB,MAAO,CACpCoC,SAAU,WACVP,OAAQA,EACR5B,MAAOkZ,EACP5W,SAAU,WACTwa,EAAQrS,KAAI,SAAUkP,GAAM,OAAQ/a,IAAMC,cAAcoqB,GAAiB,CAAE7J,MAAOA,EAAOtU,IAAK6O,EAAIjb,MAAOA,EAAOqH,QAAS4T,WC5IlI/Q,GAAsC,WAStC,OARAA,GAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,GAEJH,GAASa,MAAMC,KAAMP,YAE5B+hB,GAAwC,SAAUC,EAASC,EAAYhY,EAAGiY,GAE1E,OAAO,IAAKjY,IAAMA,EAAIkY,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAUpN,GAAS,IAAMqN,EAAKL,EAAUM,KAAKtN,IAAW,MAAOsI,GAAK6E,EAAO7E,IACpF,SAASiF,EAASvN,GAAS,IAAMqN,EAAKL,EAAS,MAAUhN,IAAW,MAAOsI,GAAK6E,EAAO7E,IACvF,SAAS+E,EAAKG,GAJlB,IAAexN,EAIawN,EAAOxH,KAAOkH,EAAQM,EAAOxN,QAJ1CA,EAIyDwN,EAAOxN,MAJhDA,aAAiBjL,EAAIiL,EAAQ,IAAIjL,GAAE,SAAUmY,GAAWA,EAAQlN,OAITyN,KAAKL,EAAWG,GAClGF,GAAML,EAAYA,EAAU5hB,MAAM0hB,EAASC,GAAc,KAAKO,YAGlEI,GAA4C,SAAUZ,EAASa,GAC/D,IAAsGhB,EAAG9gB,EAAGnB,EAAGkjB,EAA3G/jB,EAAI,CAAEjB,MAAO,EAAGilB,KAAM,WAAa,GAAW,EAAPnjB,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAOojB,KAAM,GAAIC,IAAK,IAChG,OAAOH,EAAI,CAAEN,KAAMU,EAAK,GAAI,MAASA,EAAK,GAAI,OAAUA,EAAK,IAAwB,oBAAXC,SAA0BL,EAAEK,OAAOC,UAAY,WAAa,OAAO7iB,OAAUuiB,EACvJ,SAASI,EAAKnjB,GAAK,OAAO,SAAUsjB,GAAK,OACzC,SAAcC,GACV,GAAIzB,EAAG,MAAM,IAAI0B,UAAU,mCAC3B,KAAOxkB,GAAG,IACN,GAAI8iB,EAAI,EAAG9gB,IAAMnB,EAAY,EAAR0jB,EAAG,GAASviB,EAAC,OAAauiB,EAAG,GAAKviB,EAAC,SAAenB,EAAImB,EAAC,SAAenB,EAAES,KAAKU,GAAI,GAAKA,EAAEyhB,SAAW5iB,EAAIA,EAAES,KAAKU,EAAGuiB,EAAG,KAAKpI,KAAM,OAAOtb,EAE3J,OADImB,EAAI,EAAGnB,IAAG0jB,EAAK,CAAS,EAARA,EAAG,GAAQ1jB,EAAEsV,QACzBoO,EAAG,IACP,KAAK,EAAG,KAAK,EAAG1jB,EAAI0jB,EAAI,MACxB,KAAK,EAAc,OAAXvkB,EAAEjB,QAAgB,CAAEoX,MAAOoO,EAAG,GAAIpI,MAAM,GAChD,KAAK,EAAGnc,EAAEjB,QAASiD,EAAIuiB,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKvkB,EAAEkkB,IAAI5F,MAAOte,EAAEikB,KAAK3F,MAAO,SACxC,QACI,KAAkBzd,GAAZA,EAAIb,EAAEikB,MAAY/iB,OAAS,GAAKL,EAAEA,EAAEK,OAAS,MAAkB,IAAVqjB,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAEvkB,EAAI,EAAG,SACjG,GAAc,IAAVukB,EAAG,MAAc1jB,GAAM0jB,EAAG,GAAK1jB,EAAE,IAAM0jB,EAAG,GAAK1jB,EAAE,IAAM,CAAEb,EAAEjB,MAAQwlB,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYvkB,EAAEjB,MAAQ8B,EAAE,GAAI,CAAEb,EAAEjB,MAAQ8B,EAAE,GAAIA,EAAI0jB,EAAI,MAC7D,GAAI1jB,GAAKb,EAAEjB,MAAQ8B,EAAE,GAAI,CAAEb,EAAEjB,MAAQ8B,EAAE,GAAIb,EAAEkkB,IAAI5Q,KAAKiR,GAAK,MACvD1jB,EAAE,IAAIb,EAAEkkB,IAAI5F,MAChBte,EAAEikB,KAAK3F,MAAO,SAEtBiG,EAAKT,EAAKxiB,KAAK2hB,EAASjjB,GAC1B,MAAOye,GAAK8F,EAAK,CAAC,EAAG9F,GAAIzc,EAAI,EAjBrB,QAiBoC8gB,EAAIjiB,EAAI,EACtD,GAAY,EAAR0jB,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAEpO,MAAOoO,EAAG,GAAKA,EAAG,QAAK,EAAQpI,MAAM,GArB9BqH,CAAK,CAACxiB,EAAGsjB,OAwBzD9F,GAAkC,SAAU1d,EAAG2d,GAC/C,IAAI5d,EAAI,GACR,IAAK,IAAIM,KAAKL,EAAOH,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,IAAMsd,EAAEC,QAAQvd,GAAK,IAC9EN,EAAEM,GAAKL,EAAEK,IACb,GAAS,MAALL,GAAqD,oBAAjCH,OAAOge,sBACtB,KAAI5d,EAAI,EAAb,IAAgBI,EAAIR,OAAOge,sBAAsB7d,GAAIC,EAAII,EAAED,OAAQH,IAC3D0d,EAAEC,QAAQvd,EAAEJ,IAAM,GAAKJ,OAAOS,UAAUwd,qBAAqBtd,KAAKR,EAAGK,EAAEJ,MACvEF,EAAEM,EAAEJ,IAAMD,EAAEK,EAAEJ,KAE1B,OAAOF,GAEPwZ,GAAgD,SAAUC,EAAIC,EAAMC,GACpE,GAAIA,GAA6B,IAArBvZ,UAAUC,OAAc,IAAK,IAA4BuZ,EAAxB1Z,EAAI,EAAGkN,EAAIsM,EAAKrZ,OAAYH,EAAIkN,EAAGlN,KACxE0Z,GAAQ1Z,KAAKwZ,IACRE,IAAIA,EAAKC,MAAMtZ,UAAUmP,MAAMjP,KAAKiZ,EAAM,EAAGxZ,IAClD0Z,EAAG1Z,GAAKwZ,EAAKxZ,IAGrB,OAAOuZ,EAAGriB,OAAOwiB,GAAMC,MAAMtZ,UAAUmP,MAAMjP,KAAKiZ,KAkBtD,SAASkK,GAAWzJ,EAAQ0J,GAGxB,IAFA,IAAI5jB,EAAI,GACJ2J,EAAI,EACCka,EAAI,EAAGA,EAAID,EAAIxjB,OAAQyjB,IACxBA,IAAM3J,EAAOvQ,GACbA,IAGA3J,GAAK4jB,EAAIC,GAGjB,OAAO7jB,EAEX,SAAS8jB,GAAYC,EAAGC,EAAIC,GACxB,IAAIzuB,EAEJuuB,EAAE/c,KAAOgd,GAAM7mB,KAAKmI,IAAIye,EAAExd,KAAKnG,QAAU,EAAG,IAAM6jB,EAC5B,QAArBzuB,EAAKuuB,EAAEpuB,gBAA6B,IAAPH,GAAyBA,EAAGgQ,SAAQ,SAAUue,GACxED,GAAYC,EAAGC,EAAIC,MAG3B,SAASC,GAAUH,GACf,OAAQA,EAAExd,KAAKnG,QAAU,IAAM2jB,EAAEpuB,SAAW2P,aAAIye,EAAEpuB,SAAUuuB,IAAa,GAI7E,SAASC,GAASJ,GACVA,EAAEpuB,WAEFouB,EAAEK,UAAYL,EAAEpuB,SAEhBouB,EAAEK,UAAU5e,QAAQ2e,IAEpBJ,EAAEpuB,SAAW,MAGrB,SAAS0uB,GAAMte,EAAK4M,EAAKrN,GACrB,OAAOnI,KAAK4I,IAAI5I,KAAKmI,IAAIqN,EAAK5M,GAAMT,GAExC,IAAIgf,GAAiBC,QAAM7uB,MAAM,CAC7BmM,GAAI0iB,QAAMC,WACVtiB,UAAWqiB,QAAM7uB,MAAM,CACnByM,IAAKoiB,QAAME,OACXpF,SAAUkF,QAAMG,OAChBpF,OAAQiF,QAAMG,SAElBC,MAAOJ,QAAMK,MAAML,QAAME,UAEzBI,GAAeN,QACd7uB,MAAM,CACPmM,GAAI0iB,QAAME,OACVpiB,UAAWkiB,QAAME,OACjBxjB,KAAMsjB,QAAME,OACZvD,kBAAmBqD,QAAME,OACzB7rB,OAAQ2rB,QAAMO,SAASP,QAAMG,OAAQ,OAEpCK,UAAS,WAAc,MAAQ,CAChCluB,WAAOZ,EACPsQ,UAAMtQ,MAEL+uB,SAAQ,SAAUC,GAAQ,MAAQ,CACnCjvB,SAAU,SAAUa,GAChBouB,EAAKpuB,MAAQA,GAEjBuB,QAAS,SAAUmO,GACf0e,EAAK1e,KAAOA,OAGfye,SAAQ,SAAUC,GAAQ,MAAQ,CACnCC,YAAa,WACT,IAAIC,EAAQzkB,KACZ0kB,sBAAYH,EAAMI,mBAAQ,WAAc,OAAOnD,GAAUiD,OAAO,OAAQ,GAAQ,WAC5E,IAAI9iB,EAAWijB,EAAKC,EAAUxJ,EAAMyJ,EACpC,OAAOzC,GAAYriB,MAAM,SAAUlL,GAC/B,OAAQA,EAAGyI,OACP,KAAK,EAID,OAHAzI,EAAG2tB,KAAK3Q,KAAK,CAAC,EAAG,EAAJ,CAAS,IACtBnQ,EAAY4iB,EAAK5iB,UACjBijB,EAAM,mCAAmCnuB,OAAOkL,EAAW,QACpD,CAAC,EAAaojB,MAAMH,IAC/B,KAAK,EAED,KADAC,EAAW/vB,EAAG0tB,QACAwC,GACV,MAAM,IAAIC,MAAM,QAAQxuB,OAAOouB,EAASK,OAAQ,KAAKzuB,OAAOouB,EAASM,WAAY,cAAc1uB,OAAOmuB,IAE1G,MAAO,CAAC,EAAaC,EAASxJ,QAClC,KAAK,EAGD,OAFAA,EAAOvmB,EAAG0tB,OACV+B,EAAK7sB,QAAQ2jB,GACN,CAAC,EAAa,GACzB,KAAK,EAGD,OAFAyJ,EAAMhwB,EAAG0tB,OACT+B,EAAKjvB,SAASwvB,GACP,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,mBAM/BM,OAAM,SAAUb,GAAQ,MAAQ,CAC7Bc,cACA,OAAQd,EAAK1e,MAEb0a,eACA,IAAIzrB,EACJ,OAA4B,QAApBA,EAAKyvB,EAAK1e,YAAyB,IAAP/Q,OAAgB,EAASA,EAAGoc,MAAM,MAAMnQ,KAAI,SAAUugB,GAAK,OAAOA,EAAE9E,UAAWxJ,QAAO,SAAUsO,GAAK,QAASA,KAAMtO,QAAO,SAAUsO,GAAK,OAAQA,EAAEgE,WAAW,QAASvkB,KAAI,SAAUugB,GACtN,IAAIxsB,EAAKwsB,EAAEpQ,MAAM,MAAOqU,EAASzwB,EAAG,GAAIiQ,EAASjQ,EAAG,GAAIid,EAAOjd,EAAG,GAAIub,EAAQvb,EAAG,GAAIwb,EAAMxb,EAAG,GAAI0wB,EAAQ1wB,EAAG,GAAI2wB,EAAS3wB,EAAG,GAAI4wB,EAAQ5wB,EAAG,GAAI6wB,EAAO7wB,EAAG,GAC1J,OAAOoK,GAAS,CAAEqmB,OAAQA,EAAQxgB,OAAQA,EAAQgN,KAAMA,EAAM1B,OAAQA,EAAOC,KAAMA,EAAKkV,OAAQA,EAAOC,OAAQA,EAAQC,MAAOA,GAASvmB,OAAOwJ,YAAYgd,EACrJzU,MAAM,KACNnQ,KAAI,SAAUugB,GAAK,OAAOA,EAAE9E,UAC5BxJ,QAAO,SAAUsO,GAAK,QAASA,KAC/BvgB,KAAI,SAAUugB,GAAK,OAAOA,EAAEpQ,MAAM,QAClCnQ,KAAI,SAAUjM,GACf,IAAIsM,EAAMtM,EAAG,GAAI8Q,EAAM9Q,EAAG,GAC1B,MAAO,CACHsM,EAAIob,OACJoJ,mBAAmBhgB,GAAK4W,OAAOtL,MAAM,KAAKqQ,KAAK,mBAM/DsE,GAAWhC,QACV7uB,MAAM,UAAW,CAClBmM,GAAI2kB,aACJ/T,KAAM8R,QAAMkC,QAAQ,WACpB7tB,OAAQ2rB,QAAMO,SAASP,QAAMG,OAAQ,KACrCrqB,cAAekqB,QAAMO,SAASP,QAAMG,OAAQ,KAC5C/gB,UAAW4gB,QAAMO,SAASP,QAAMG,OAAQ,KACxCjhB,UAAW,GACXC,QAAS,EACTmL,QAAS,EACTgF,kBAAmB,EACnB7P,UAAW,IACX0iB,SAAUnC,QAAMK,MAAML,QAAMG,QAC5BhO,SAAU6N,QAAMK,MAAML,QAAMG,QAC5B/iB,mBAAoB4iB,QAAMoC,MAAMrC,IAChCxgB,kBAAkB,EAClBzG,SAAU,GACVuG,eAAe,EACfgL,SAAS,EACT1K,UAAU,EACVD,iBAAiB,EACjBE,mBAAoB,EACpB2K,gBAAiB,WACjB8X,eAAgBrC,QAAMK,MAAMiC,iBAC5B5W,cAAesU,QAAMK,MAAMiC,iBAC3BvP,iBAAkB,EAClB7U,UAAW8hB,QAAMoC,MAAMpC,QAAME,QAC7B9hB,SAAU4hB,QAAMK,MAAML,QAAME,QAC5BqC,UAAWvC,QAAMoC,MAAM9B,IACvBxO,gBAAiBkO,QAAM9iB,IAAI8iB,QAAMwC,SACjCC,iBAAkBzC,QAAMoC,MAAMpC,QAAM7uB,MAAM,CACtCqb,MAAOwT,QAAMG,OACb1T,IAAKuT,QAAMG,OACX/kB,WAAY4kB,QAAM0C,YAEtB1gB,KAAMge,QAAMO,SAASP,QAChB7uB,MAAM,CACP4C,KAAMisB,QAAMK,MAAML,QAAME,QACxBpsB,IAAKksB,QAAMK,MAAML,QAAME,UAEtBO,SAAQ,SAAUC,GAAQ,MAAQ,CACnCiC,QAAS,SAAU5uB,GACf2sB,EAAK3sB,KAAOA,GAEhB6uB,OAAQ,SAAU9uB,GACd4sB,EAAK5sB,IAAMA,OAEX,CAAEC,KAAM,GAAID,IAAK,OAExB0sB,UAAS,WAAc,MAAQ,CAChCluB,WAAOZ,EACP4N,OAAQ,CAAE/I,KAAM,GAAIkE,IAAK,IAEzB0c,qBAAiBzlB,EAEjB0lB,iBAAa1lB,EAEb2lB,cAAU3lB,MAET+uB,SAAQ,SAAUC,GAAQ,MAAQ,CAEnC1jB,mBAAoB,SAAU6lB,EAAKC,GAC/BpC,EAAKvJ,gBAAkB0L,EACvBnC,EAAKtJ,YAAc0L,GAEvBlM,UAAW,SAAUviB,GACjBqsB,EAAKrsB,OAASA,GAElBwJ,wBAAyB,SAAUklB,GAC/BrC,EAAKtjB,mBAAmB6Q,KAAK8U,IAEjCrlB,6BAA8B,SAAUqlB,GACpC,IAAInN,EAAI8K,EAAKtjB,mBAAmBC,MAAK,SAAUf,GAAQ,OAAOA,EAAKgB,KAAOylB,EAAIzlB,MAC1EsY,GACA8K,EAAKtjB,mBAAmB4lB,OAAOpN,IAGvCqN,yBAA0B,SAAUF,GAChC,IAAInN,EAAI8K,EAAKtjB,mBAAmBC,MAAK,SAAUf,GAAQ,OAAOA,EAAKgB,KAAOylB,EAAIzlB,MAC1EsY,EACA8K,EAAKtjB,mBAAmB4lB,OAAOpN,GAG/B8K,EAAKtjB,mBAAmB6Q,KAAK8U,IAGrCG,wBAAyB,WAErBxC,EAAKtjB,mBAAqB,IAE9B3L,SAAU,SAAUa,GACZA,GACA6wB,QAAQ7wB,MAAMA,GAElBouB,EAAKpuB,MAAQA,GAEjBkZ,YAAa,SAAUjD,EAAKD,GACxBoY,EAAKvO,SAAW5J,EAChBmY,EAAKyB,SAAW7Z,GAEpBsH,aAAc,SAAUjU,GACpB+kB,EAAKxhB,UAAYvD,GAErBkU,YAAa,SAAUlU,GACnB+kB,EAAK5nB,SAAW6C,GAEpBqV,mBAAoB,SAAUtU,GAC1BgkB,EAAKnW,gBAAkB7N,GAE3BwW,WAAY,SAAUvX,GAClB+kB,EAAKvhB,QAAUxD,GAEnBwX,WAAY,SAAUxX,GAClB+kB,EAAKpW,QAAU3O,GAEnB6a,iBAAkB,SAAU7a,GACxB+kB,EAAK5qB,cAAgB6F,GAEzBmU,aAAc,SAAUnU,GACpB+kB,EAAKthB,UAAYzD,GAErByX,oBAAqB,SAAUzX,GAC3B+kB,EAAK3N,iBAAmBpX,GAE5BiV,uBAAwB,WACpB8P,EAAKnhB,kBAAoBmhB,EAAKnhB,kBAElCoR,eAAgB,WACZ+P,EAAK/gB,UAAY+gB,EAAK/gB,UAE1B1B,gBAAiB,SAAU3B,GACnBokB,EAAKxiB,UAAUC,SAAS7B,GACxBokB,EAAKxiB,UAAU8kB,OAAO1mB,GAGtBokB,EAAKxiB,UAAU+P,KAAK3R,IAG5B+B,YAAa,SAAU/B,GACnBokB,EAAKtiB,SAAW9B,GAEpBkU,gBAAiB,WACbkQ,EAAKrhB,eAAiBqhB,EAAKrhB,eAE/BoR,cAAe,WACXiQ,EAAKrW,SAAWqW,EAAKrW,SAEzBqG,kBAAmB,WACfgQ,EAAKhhB,iBAAmBghB,EAAKhhB,iBAEjC7L,QAAS,SAAUmO,GACf0e,EAAK1e,KAAOohB,eAAKphB,IAErBzO,iBAAkB,SAAUmY,GACxB,OAAOiS,GAAUxhB,UAAM,OAAQ,GAAQ,WACnC,OAAOqiB,GAAYriB,MAAM,SAAUlL,GAE/B,OADAyvB,EAAKhV,cAAgBA,EACd,CAAC,UAIpBlY,kBAAmB,SAAU6uB,GACzB,OAAO1E,GAAUxhB,UAAM,OAAQ,GAAQ,WACnC,IAAIyZ,EACJ,OAAO4I,GAAYriB,MAAM,SAAUlL,GAC/B,OAAQA,EAAGyI,OACP,KAAK,EACD,OAAM2oB,GAAkB,WAAYA,EAC7B,CAAC,EAAagB,wBAAahB,GAAgBiB,SAAS,SADC,CAAC,EAAa,GAE9E,KAAK,EAGD,OAFA1N,EAAK3kB,EAAG0tB,OACRxiB,KAAKwmB,QAAQ/M,GACN,CAAC,EAAa,GACzB,KAAK,EACD8K,EAAK2B,eAAiBA,EACtBpxB,EAAGyI,MAAQ,EACf,KAAK,EAAG,MAAO,CAAC,WAKhCkpB,OAAQ,SAAUtE,GACdoC,EAAK1e,KAAK4gB,OAAOtE,IAErBqE,QAAS,SAAUrE,GACfoC,EAAK1e,KAAK2gB,QAAQrE,IAEtBqC,YAAa,WACT,IAAIC,EAAQzkB,KACZ0kB,sBAAYH,EAAMI,mBAAQ,WAAc,OAAOnD,GAAUiD,OAAO,OAAQ,GAAQ,WAC5E,IAAIyB,EAAgBpxB,EAAIsyB,EACxB,OAAO/E,GAAYriB,MAAM,SAAUpK,GAC/B,OAAQA,EAAG2H,OACP,KAAK,EAED,KADA2oB,EAAiB3B,EAAK2B,gBACD,MAAO,CAAC,EAAa,GAC1CtwB,EAAG2H,MAAQ,EACf,KAAK,EAGD,OAFA3H,EAAG6sB,KAAK3Q,KAAK,CAAC,EAAG,EAAJ,CAAS,IACtBhd,EAAKkL,KAAKwmB,QACH,CAAC,EAAaU,wBAAahB,GAAgBiB,SAAS,SAC/D,KAAK,EAED,OADAryB,EAAGiL,MAAMC,KAAM,CAAEpK,EAAG4sB,SACb,CAAC,EAAa,GACzB,KAAK,EAGD,OAFA4E,EAAMxxB,EAAG4sB,OACTxiB,KAAK1K,SAAS8xB,GACP,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,cAI5B1C,sBAAYH,EAAMI,mBAAQ,WAAc,OAAOnD,GAAUiD,OAAO,OAAQ,GAAQ,WAC5E,IAAIlV,EAAeza,EAAIuyB,EACvB,OAAOhF,GAAYriB,MAAM,SAAUpK,GAC/B,OAAQA,EAAG2H,OACP,KAAK,EAED,KADAgS,EAAgBgV,EAAKhV,eACD,MAAO,CAAC,EAAa,GACzC3Z,EAAG2H,MAAQ,EACf,KAAK,EAGD,OAFA3H,EAAG6sB,KAAK3Q,KAAK,CAAC,EAAG,EAAJ,CAAS,IACtBhd,EAAKkL,KAAKymB,OACH,CAAC,EAAaS,wBAAa3X,GAAe4X,SAAS,SAC9D,KAAK,EAED,OADAryB,EAAGiL,MAAMC,KAAM,CAAEpK,EAAG4sB,SACb,CAAC,EAAa,GACzB,KAAK,EAGD,OAFA6E,EAAMzxB,EAAG4sB,OACTxiB,KAAK1K,SAAS+xB,GACP,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,mBAM/BjC,OAAM,SAAUb,GACjB,IAAI+C,EAAa,GACbC,EAAa,GACbC,EAAU,EACVC,EAAU,EACd,MAAO,CACC7M,kBACA,OAAS2J,EAAK1e,KAAKlO,KACf4sB,EAAK1e,KAAKjO,MACV2sB,EAAKhV,eACLgV,EAAK2B,kBACJ3B,EAAKpuB,OAEVid,cAIA,IAHA,IAAIjF,EAAUoW,EAAKpW,QAASuZ,EAAOnD,EAAKjhB,UAAW3G,EAAW4nB,EAAK5nB,SAC/DqK,GAAQ0gB,EAAOjrB,KAAKiS,MAAMP,EAAUuZ,GAASA,EAC7Cze,EAAI,GACC1J,EAAIyH,EAAKzH,EAAIyH,EAAa,EAAP0gB,EAAUnoB,GAAKmoB,EACnCnoB,EAAImoB,EAAO,GACXze,EAAE6I,KAAKvS,GAQf,OALI8B,KAAKC,UAAU2H,KAAO5H,KAAKC,UAAUgmB,IACrC3qB,IAAa6qB,IACbF,EAAare,EACbue,EAAU7qB,GAEP2qB,GAEPhgB,cAIA,IAHA,IAAItE,EAAUuhB,EAAKvhB,QAAS0kB,EAAOnD,EAAKjhB,UAAWP,EAAYwhB,EAAKxhB,UAChEiE,GAAQ0gB,EAAOjrB,KAAKiS,MAAM1L,EAAU0kB,GAAS,EAAIA,EACjDze,EAAI,GACC1J,EAAIyH,EAAKzH,EAAIyH,EAAa,EAAP0gB,EAAUnoB,GAAKmoB,EACnCnoB,EAAImoB,EAAO,GACXze,EAAE6I,KAAKvS,GAQf,OALI8B,KAAKC,UAAU2H,KAAO5H,KAAKC,UAAUimB,IACrCxkB,IAAc0kB,IACdF,EAAate,EACbwe,EAAU1kB,GAEPwkB,OAIdnC,OAAM,SAAUb,GAAQ,MAAQ,CAC7B9U,eACA,OAAO8U,EAAKjd,QAAQvG,KAAI,SAAUmP,GAAM,OAAOqU,EAAKnR,QAAQrS,KAAI,SAAUkP,GAAM,MAAO,CAACA,EAAIC,SAAYyX,QAExGhN,WACA,OAAO4J,EAAK3J,cAAgB2J,EAAK1e,KAAKlO,KAAO4sB,EAAK1e,KAAKjO,OAEvDuR,kBACA,OAAO4L,EAAawP,EAAKnW,kBAEzBmH,uBACA,IAAIzgB,EACJ,OAA4B,QAAnBA,EAAKkL,KAAKiO,WAAwB,IAAPnZ,OAAgB,EAASA,EAAG+mB,eAAiB,IAErFvb,cAAe,SAAUC,GACrB,IAAIzL,EAAIc,EAEJgyB,EAA2F,QAAhFhyB,EAAyB,QAAnBd,EAAKkL,KAAKiO,WAAwB,IAAPnZ,OAAgB,EAASA,EAAGwL,qBAAkC,IAAP1K,OAAgB,EAASA,EAAGkK,KAAKhL,EAAIyL,GACxIsnB,EAAUtnB,EAAKie,MAAM,oBACzB,OAAOtf,GAASA,GAAS,GAAI0oB,GAAWC,GAAW,CAAE5D,MAAO,CAAE5T,OAAQwX,EAAQ,GAAIvX,KAAMuX,EAAQ,OAEhGC,2BACA,OAAO9nB,KAAK6W,eAAe0N,EAAK3N,mBAEhCC,qBACA,IAAI/hB,EACJ,OAA4B,QAAnBA,EAAKkL,KAAKiO,WAAwB,IAAPnZ,OAAgB,EAASA,EAAG+hB,iBAAmB,IAEnFxT,aACA,QAASrD,KAAKpI,KAAKyL,QAEnB/F,gBACA,MAAO,IAEP2Q,UACA,IAAIoN,EAAOkJ,EAAK1e,KAAKlO,IACrB,OAAI0jB,EACIkC,KAAUwK,MAAM1M,GACT,IAAIgC,GAAahC,EAAMkJ,EAAK3N,kBAE9ByE,EAAKiK,WAAW,KACd,IAAIlG,GAAS/D,GAGb,IAAID,GAAWC,GAGvB,MAEP2M,iBACA,IAAIlzB,EACJ,SAA8B,QAAnBA,EAAKkL,KAAKiO,WAAwB,IAAPnZ,OAAgB,EAASA,EAAG8mB,aAAe,GAAK5b,KAAKwZ,OAAO9Z,QAAU6kB,EAAK5nB,UAEjH/E,WACA,IAAI9C,EACJ,OAAOyvB,EAAK1e,KAAKjO,KACXiR,EAAgBkW,GAAYwF,EAAK1e,KAAKjO,QACjB,QAAnB9C,EAAKkL,KAAKiO,WAAwB,IAAPnZ,OAAgB,EAASA,EAAGunB,YAAc,CAAEhZ,QAAQ,IAEvF4kB,eACA,OAAOjoB,KAAK8C,UAAUuD,SAAStF,KAAI,SAAUZ,GAAQ,OAAOA,EAAK0F,KAAKtF,SAEtEwV,uBACA,YAAyBxgB,IAAlBgvB,EAAKyB,SACNhmB,KAAKioB,SAAS1D,EAAKyB,eACnBzwB,GAEV2yB,oBAAqB,SAAUhK,GAC3B,OAAOle,KAAK0M,QAAQwR,IAEpBiK,WACA,IAAIC,EAAOtlB,aAAU9C,KAAKpI,MAAM,SAAUyrB,GAAK,OAAOA,EAAEra,aACnDqf,KAAI,SAAUhF,GAAK,OAAQA,EAAEra,UAAY,EAAI,KAC7Csf,MAAK,SAAU9b,EAAGvD,GACnB,OAAOsf,aAAU/b,EAAE3G,KAAKnG,QAAU,EAAGuJ,EAAEpD,KAAKnG,QAAU,MAE1D,GAAI6kB,EAAKtiB,SAAU,CACf,IAAIqb,EAAM8K,EAAKlnB,MAAK,SAAUf,GAAQ,OAAOA,EAAK0F,KAAK1E,KAAOojB,EAAKtiB,YAC/Dqb,IACA8K,EAAO9K,GAWf,OARIiH,EAAKxiB,UAAUrC,QACf6kB,EAAKxiB,UACAhB,KAAI,SAAUynB,GACf,OAAOJ,EAAKlnB,MAAK,SAAUf,GAAQ,OAAOA,EAAK0F,KAAK1E,KAAOqnB,QAE1DxV,QAAO,SAAUsO,GAAK,QAASA,KAC/BvgB,KAAI,SAAUZ,GAAQ,OAAOsjB,GAAStjB,MAExCioB,GAEPhoB,iBACA,IAAItL,EACJ,OAA4B,QAAnBA,EAAKkL,KAAKiO,WAAwB,IAAPnZ,OAAgB,EAASA,EAAGknB,kBAAoB,IAEpFyM,wBACA,IAAI1nB,EAAM5B,OAAOyJ,QAAQ5I,KAAKI,YACzBW,KAAI,SAAUjM,GACf,IAAIsM,EAAMtM,EAAG,GACb,OADuBA,EAAG,GACfiM,KAAI,SAAU2nB,GAAY,MAAO,CAACA,EAASjnB,IAAK,CAAEN,GAAIC,UAEhEumB,OACL,OAAOxoB,OAAOwJ,YAAY5H,IAE1ByO,mBAEA,OAAO+U,EAAKjuB,MAAQiuB,EAAK5qB,eAEzB6f,aAYA,IAXA,IACI1kB,EADA2vB,EAAQzkB,KAERwZ,EAAS,GACTmP,EAAO3oB,KAAK8C,UACXuD,SACAtF,KAAI,SAAUjM,GACf,IAAIc,EACAiQ,EAAO/Q,EAAG+Q,KACd,OAA4B,QAApBjQ,EAAK6uB,EAAMxW,WAAwB,IAAPrY,OAAgB,EAASA,EAAG4lB,OAAO3V,EAAKtF,SAE3EyS,QAAO,SAAUjc,GAAQ,QAASA,KAC9BwI,EAAI,EAAGA,GAAwB,QAAlBzK,EAAK6zB,EAAK,UAAuB,IAAP7zB,OAAgB,EAASA,EAAG4K,QAASH,IAAK,CAEtF,IADA,IAAIqpB,EAAU,EACLzF,EAAI,EAAGA,EAAIwF,EAAKjpB,OAAQyjB,IACV,MAAfwF,EAAKxF,GAAG5jB,IACRqpB,IAGJA,IAAYD,EAAKjpB,QACjB8Z,EAAO1H,KAAKvS,GAGpB,OAAOia,GAEPE,WACA,IAAI+K,EAAQzkB,KACZ,OAAOA,KAAK8C,UACPuD,SACAtF,KAAI,SAAUjM,GACf,IAAIc,EACAiQ,EAAO/Q,EAAG+Q,KACd,MAAO,CAACA,EAAKtF,KAA2B,QAApB3K,EAAK6uB,EAAMxW,WAAwB,IAAPrY,OAAgB,EAASA,EAAG4lB,OAAO3V,EAAKtF,UAEvFyS,QAAO,SAAUsO,GAAK,QAASA,EAAE,OAEtC5U,cACA,IAAIgN,EAAO1Z,KAAK0Z,KACZmP,EAAO7oB,KAAK8oB,UAChB,OAAO3pB,OAAOwJ,YAAY+Q,EAAK3Y,KAAI,SAAUoL,EAAKwF,GAAS,MAAO,CAACxF,EAAI,GAAI0c,EAAKlX,SAEhFmX,gBAGA,IAFA,IAAIH,EAAO3oB,KAAK0Z,KAAK3Y,KAAI,SAAU0Y,GAAK,OAAOA,EAAE,MAC7CzS,EAAM,GACDzH,EAAI,EAAGA,EAAIopB,EAAKjpB,OAAQH,IAC7ByH,EAAI8K,KAAKmR,GAAWjjB,KAAKwZ,OAAQmP,EAAKppB,KAE1C,OAAOyH,GAEPqH,eAGA,IAFA,IAAIoL,EAAI,GACJsP,EAAI/oB,KAAK8oB,UACJvpB,EAAI,EAAGA,EAAIwpB,EAAErpB,OAAQH,IAC1B,IAAK,IAAI4jB,EAAI,EAAGA,EAAI4F,EAAExpB,GAAGG,OAAQyjB,IAAK,CAClC,IAAI1W,EAAIgN,EAAE0J,IAAM,GACX1W,EAAEsc,EAAExpB,GAAG4jB,MACR1W,EAAEsc,EAAExpB,GAAG4jB,IAAM,GAEjB1W,EAAEsc,EAAExpB,GAAG4jB,MACP1J,EAAE0J,GAAK1W,EAGf,OAAOgN,GAGP3W,gBACA,IAAIqlB,EAAOnoB,KAAKmoB,KAQhB,OAPYa,eACPtB,KAAK,CAAC1nB,KAAKipB,YAAa1E,EAAKthB,YAC7BimB,YAAW,WAAc,OAAO,IACrCC,CAAMhB,GACN/E,GAAY+E,EAEXA,EAAKtiB,KAAKnG,OAAS,EAAI6kB,EAAKthB,UAAYugB,GAAU2E,IAC5CA,GAEPc,kBACA,OAAOjpB,KAAKmoB,KAAK9hB,SAAS3G,OAAS6kB,EAAKxhB,eAG3CuhB,SAAQ,SAAUC,GAAQ,MAAQ,CACnC3iB,gBAAiB,SAAUzB,GACnBokB,EAAK6B,UAAUllB,MAAK,SAAU7B,GAAK,OAAOA,EAAEkB,OAASJ,EAAKI,QACtDgkB,EAAK5O,gBAAgBC,IAAIzV,EAAKI,OAC9BP,KAAK6V,YAAY1V,EAAKI,MAI1BgkB,EAAK6B,UAAUtU,KAAK5S,GAASA,GAAS,GAAIiB,GAAO,CAAEgB,GAAIhB,EAAKI,KAAMigB,kBAAmBrgB,EAAKI,SAGlGuH,UAAW,SAAUV,GACjBmd,EAAKvhB,QAAU2gB,GAA0B,GAAnBY,EAAK0E,YAAkB1E,EAAKvhB,QAAUoE,EAAQ,IAExEyI,UAAW,SAAUH,GACjB6U,EAAKpW,QAAUwV,IAAOY,EAAKyD,YAAczD,EAAK/U,aAAe,KAAM+U,EAAKpW,QAAUuB,EAAQ,IAE9F0Z,qBAAsB,SAAU5pB,EAAGkf,EAAO2K,GACtC,IAAIv0B,EACAquB,EAAI,EACJ5jB,EAAI,EACJ4B,GAAMojB,EAAKkE,kBAAkBY,EAAKta,MAAM,GAAI,KAAO,IAAI5N,GACvDgL,EAA0B,QAAnBrX,EAAKyvB,EAAKtW,WAAwB,IAAPnZ,OAAgB,EAASA,EAAG0mB,OAAOra,GACzE,GAAIgL,EAAK,CACL,IAAK5M,EAAI,EAAGA,EAAI4M,EAAIzM,QAAUyjB,EAAI3jB,EAAGD,IAClB,MAAX4M,EAAI5M,IACJ4jB,IAGRoB,EAAKvO,SAAWmN,EAAI,OAGpBoB,EAAKvO,cAAWzgB,GAGxBsgB,YAAa,SAAU1U,GACfojB,EAAK5O,gBAAgBC,IAAIzU,GACzBojB,EAAK5O,gBAAgB2T,OAAOnoB,GAG5BojB,EAAK5O,gBAAgB2K,IAAInf,GAAI,QAIpCikB,OAAM,SAAUb,GAAQ,MAAQ,CAC7BpF,kCACA,IAAIrqB,EACJ,OAA2B,QAAnBA,EAAKyvB,EAAKtW,WAAwB,IAAPnZ,OAAgB,EAASA,EAAGqqB,6BAE/D5C,mBACA,IAAIznB,EACJ,OAA2B,QAAnBA,EAAKyvB,EAAKtW,WAAwB,IAAPnZ,OAAgB,EAASA,EAAGynB,cAE/DgN,mBACA,IAAIR,EAAIxE,EAAKuE,UACb,GAAIC,EAAErpB,OACF,IAAK,IAAIH,EAAI,EAAGA,EAAIwpB,EAAE,GAAGrpB,OAAQH,IAE7B,IADA,IAAI6M,EAAM,GACD+W,EAAI,EAAGA,EAAI4F,EAAErpB,OAAQyjB,IAC1B/W,EAAI0F,KAAKiX,EAAE5F,GAAG5jB,IAI1B,MAAO,CAAC,MAERiW,aACA,IAAIgE,EAAS+K,EAAK/K,OACdgQ,EAAgBjF,EAAKtW,IACnBsW,EAAKtW,IAAIuH,OAAOzU,KAAI,SAAU2U,GAC5B,IAAI7P,EAAO6P,EAAM7P,KACjB,MAAO,CACH7Q,MAAOkK,GAASA,GAAS,GAAIwW,GAAQ,CAAE7P,KAAMA,EAAOod,GAAWzJ,EAAQ3T,QAAQtQ,EAAW2C,OAAQqsB,EAAKxhB,YACvG6V,eAAgB6Q,OAGtB,GACFrD,EAAY7B,EAAK6B,UAEhBpT,QAAO,SAAU0C,GAAS,QAAS6O,EAAK7K,KAAKxY,MAAK,SAAUiL,GAAO,OAAOA,EAAI,KAAOuJ,EAAMnV,WAC3FQ,KAAI,SAAU2U,GAAS,MAAQ,CAChC1gB,MAAO0gB,EACPkD,eAAgB8Q,OAEhBC,EAAmBpF,EAAK+B,iBAAiB5mB,OAAS,EAChD,CACE,CACI1K,MAAO,CACHurB,SAAUgE,EAAK+B,iBACfpuB,OAAQ,IACRiJ,GAAI,cACJZ,KAAM,2BACNsF,KAAM0e,EAAK+B,iBACNvlB,KAAI,SAAU6oB,GACf,IAAIC,EAAQD,EAAO3qB,WACbE,OAAOyJ,QAAQghB,EAAO3qB,YACnB8B,KAAI,SAAUjM,GACf,IAAIyuB,EAAIzuB,EAAG,GAAIguB,EAAIhuB,EAAG,GACtB,MAAO,GAAG2B,OAAO8sB,EAAG,KAAK9sB,OAAOqsB,EAAEvB,KAAK,SAEtCA,KAAK,KACR,IACN,MAAO,CACH,eACA,IACA,IACAqI,EAAOvZ,MACPuZ,EAAOtZ,IACP,IACA,IACA,IACAuZ,GACFtI,KAAK,SAENA,KAAK,OAEd3I,eAAgB8Q,KAGtB,GACN,OAAO7Q,GAAcA,GAAcA,GAAc,GAAI2Q,GAAe,GAAOpD,GAAW,GAAOuD,GAAkB,IAE/G9O,qBACA,OAAO7a,KAAKwV,OAAOxC,QAAO,SAAUsO,GAAK,OAAQiD,EAAK5O,gBAAgBC,IAAI0L,EAAEtsB,MAAMmM,QAGtFjH,OAAQ,SAAU4vB,GACd,OAAOrtB,KAAKiS,OAAOob,EAAQvF,EAAKpW,SAAWoW,EAAK5nB,WAEpDokB,kBAAmB,SAAU7C,EAASzlB,GAClC,IAAI3D,EACAmzB,EAAW1D,EAAK0D,SAAUvO,EAAO6K,EAAK7K,KAAMF,EAAS+K,EAAK/K,OAE1DrN,EAAMuN,EADEuO,EAAS/K,QAAQgB,IACP,GAGlBhiB,EAAUzD,IADyB,QAAxB3D,EADDyvB,EAAKjkB,cAAc4d,GACL+F,aAA0B,IAAPnvB,OAAgB,EAASA,EAAGub,QAAU,GAErF,GAAInU,EAAU,EACV,OAAO,EAIX,IAFA,IAAIinB,EAAI,EACJ5jB,EAAI,EACDA,EAAI4M,EAAIzM,SACI,MAAXyM,EAAI5M,IAAc4jB,MAAQjnB,GADXqD,KAMvB,IADA,IAAIwqB,EAAQ,EACHxG,EAAI,EAAGA,EAAIpX,EAAIzM,OAAQ6jB,KACD,IAAvB/J,EAAO0D,QAAQqG,IAAaA,EAAIhkB,EAAI,GACpCwqB,IAGR,OAAOxqB,EAAIwqB,GAEf/I,aAAc,SAAUvoB,GAGpB,IAFA,IAAI3D,EACAi1B,EAAQ,EACHxG,EAAI,EAAGA,GAA6B,QAAvBzuB,EAAKyvB,EAAK7K,KAAK,UAAuB,IAAP5kB,OAAgB,EAASA,EAAG,GAAG4K,QAAS6jB,KACzD,IAA5BgB,EAAK/K,OAAO0D,QAAQqG,IAAaA,EAAI9qB,EAAW,GAChDsxB,IAGR,OAAOtxB,EAAWsxB,GAEtBC,eAAgB,SAAU9L,EAASzlB,GAK/B,IAJA,IAAIwvB,EAAW1D,EAAK0D,SAEhB9b,EAFiCoY,EAAK7K,KAC9BuO,EAAS/K,QAAQgB,IACP,GAClBqF,EAAI,EACChkB,EAAI,EAAGA,EAAI9G,EAAU8G,IAC1B,GAAe,MAAX4M,EAAI5M,GACJgkB,SAEC,GAAIA,GAAK9qB,EACV,MAGR,OAAO8qB,GAEX3J,OAAQ,SAAUqQ,GAEd,IADA,IAAI9G,EAAI,EACC5jB,EAAI,EAAGgkB,EAAI,EAAGhkB,EAAI0qB,EAAK1qB,IAAK4jB,IACjC,KAAOA,IAAMoB,EAAK/K,OAAO+J,IACrBA,IACAJ,IAGR,OAAOA,OAGVmB,SAAQ,SAAUC,GAAQ,MAAQ,CACnCtK,cAAe,SAAU5J,EAAOC,EAAKrR,GACjCslB,EAAK+B,iBAAiBxU,KAAK,CACvBzB,MAAOkU,EAAK3K,OAAOvJ,GACnBC,IAAKiU,EAAK3K,OAAOtJ,GACjBrR,WAAYA,KAGpBvB,WAAY,SAAUtD,EAAM6C,GACxBsnB,EAAKrJ,SAAW,CAAE9gB,KAAMA,EAAM6C,MAAOA,IAEzCnB,cAAe,WACXyoB,EAAKrJ,cAAW3lB,OAcTP,GAXH6uB,QAAMqG,kBAAkBrG,QAAMsG,QAAQC,KAAevE,IAAW,CACxEwE,cAAe,SAAUlI,GACrB,IAAIrtB,EAAKqtB,EAAOtc,KAAMjO,EAAO9C,EAAG8C,KAAMD,EAAM7C,EAAG6C,IAAKknB,EAAO7B,GAAOmF,EAGhE,CAAC,SAGH,OAAOjjB,GAAS,CAAE2G,KAAM3G,GAASA,GAAS,IAAMijB,EAAO+D,gBAAkB,CAAEtuB,KAAMA,KAAYuqB,EAAO5S,eAAiB,CAAE5X,IAAKA,KAAWknB,M,8BC92BhIyL,GAXHzG,QACT7uB,MAAM,CACLu1B,QAAS1E,GACT2E,aAAc3G,QAAMO,SAASP,QAAME,OAAQ,MAE5CO,SAAQ,SAACC,GAAD,MAAW,CAClBkG,gBADkB,SACFC,GACdnG,EAAKiG,aAAeE,O,wDCJ1BC,KAAmBC,IACjB,OACA,IAAIC,KAAiB,qCAehB,IAAMC,GAAen1B,oBAAS,YAAgB,IAAbX,EAAY,EAAZA,MAChC+1B,EAAc5vB,iBAAO,IAC3B,EAAwBtF,mBAAS,WAAjC,oBAAOkc,EAAP,KAAaiZ,EAAb,KACA,EAAsBn1B,mBAAS,IAA/B,oBAAOynB,EAAP,KAAY2N,EAAZ,KACA,EAA0Bp1B,qBAA1B,oBAAOq1B,EAAP,KAAcC,EAAd,KACA,EAA4Ct1B,oBAAS,GAArD,oBAAOu1B,EAAP,KAAwBC,EAAxB,KACQd,EAA0Bv1B,EAA1Bu1B,QAASC,EAAiBx1B,EAAjBw1B,aACTvpB,EAAiCspB,EAAjCtpB,mBAAoB+U,EAAauU,EAAbvU,SACtB5V,EAAaugB,sBAAY1f,GAEzBqqB,EAAkBC,uBAAY,SAACC,GACnC,GAAIA,EAAS,CACX,IAAMC,EAAe,IAAIC,KAAMF,GAC/BL,EAASM,MAEV,IA2EH,OAzEAzvB,qBAAU,WACR,OAAO,yBAAMkvB,QAAN,IAAMA,OAAN,EAAMA,EAAOS,aACnB,CAACT,IAEJlvB,qBAAU,WACHoE,EAAWV,QAAWwrB,GAG3B,wBAAC,6BAAA1e,EAAA,6DAEClQ,OAAOC,iBAAiB,UAAU,WAChC2uB,EAAMU,kBAHT,SAMmBhK,QAAQiK,IACxBzrB,EAAWW,KAAI,SAAC+qB,GACd,OAAOZ,EAAMa,SAAN,iBAAyBD,EAAUtqB,UAAUC,IAA7C,aARZ,OAMO6b,EANP,OAWC2N,EAAO3N,GAEP4N,EAAMc,QAAQC,QAAQrB,KAAI,SAACsB,GACzB,GAAIA,IAAiBA,EAAaC,MAAQD,EAAaE,MAAO,CAAC,IAAD,EACtDD,EAAOD,EAAaC,MAAQD,EAAaG,gBAC/C9B,EAAQnB,qBACN+C,EAAKG,OAAL,UAAalsB,EAAW,UAAxB,aAAa,EAAeoB,UAAUmd,UACtCwN,EAAKI,UACLL,EAAaM,OAAOhrB,UAAUjB,UAnBrC,0CAAD,KAwBC,CAACgqB,EAASnqB,EAAY8qB,IAEzBlvB,qBAAU,WACJkvB,IACF5N,EAAIxY,SAAQ,SAAC8hB,GACXA,EAAI6F,2BACJ7F,EAAI8F,kBAAkB3a,EAAM,CAAE4a,KAAMnC,OAEtCU,EAAM0B,cAEP,CAAC7a,EAAMuL,EAAK4N,EAAOV,IAEtBxuB,qBAAU,WACJoE,EAAWV,SAAW0rB,GACxB9N,EAAIxY,SAAQ,SAAC8hB,EAAKjV,GAKhB,GAJIoZ,EAAY7uB,QAAQwD,QACtBknB,EAAIiG,iBAAiB9B,EAAY7uB,QAAQyV,IAE3CoZ,EAAY7uB,QAAU,QACL3G,IAAbygB,EAAwB,CAC1B,IAAMrP,EAjFhB,SAAmB3R,EAAOkpB,EAAS1c,EAAWwU,EAAU2I,GAItD,IAHA,IAAMmO,EAAKtrB,EAAUurB,aAAahD,MAC5BiD,EAAKxrB,EAAUyrB,kBACfhD,EAAMj1B,EAAMu1B,QAAQP,eAAe9L,EAASlI,GACzCzW,EAAI,EAAGA,EAAIutB,IAAMvtB,EAExB,GADAytB,EAAGrb,MAAQpS,EACPytB,EAAGV,QAAUrC,EAAMtL,EAAW,EAChC,OAAOqO,EA0EYE,CACbl4B,EACAoL,EAAWuR,GAAOxQ,GAClBylB,EAAIplB,UACJwU,EACA5V,EAAW,GAAGoB,UAAUmd,UAE1B,GAAIhY,EAAQ,CACV,IAAMwmB,EAAKvG,EAAIplB,UAAU4rB,eACzBD,EAAGxb,MAAQhL,EAAO0mB,WAElBtC,EAAY7uB,QAAQ4V,KAClB8U,EAAI3M,cAAckT,EAAGG,oBAAqB3mB,EAAO4mB,mBAIvDrC,EAAMsC,OAAOC,qBAGhB,CAACz4B,EAAOghB,EAAU5V,EAAlB,OAA8B8qB,QAA9B,IAA8BA,OAA9B,EAA8BA,EAAOsC,OAAQlQ,EAAK8N,IAE9CnqB,EAAmBvB,OACxB,uBAAKrJ,MAAO,CAAEE,QAAS,IAAvB,UACE,uBAAKF,MAAO,CAAE4f,QAAS,OAAQnf,WAAY,UAA3C,UACE,eAACK,EAAA,EAAD,CACEpC,QAAS,kBAAMw1B,EAAQxD,2BACvBzvB,QAAQ,YAFV,mBAOA,sBAAKjB,MAAO,CAAEC,MAAO,MACrB,gBAACkhB,GAAA,EAAD,CAAQ7C,MAAO5C,EAAMqC,SAAU,SAAC/e,GAAD,OAAW21B,EAAQ31B,EAAMqG,OAAOiZ,QAA/D,UACE,eAAChU,EAAA,EAAD,CAAUgU,MAAO,UAAjB,qBACA,eAAChU,EAAA,EAAD,CAAUgU,MAAO,aAAjB,2BAEF,sBAAKte,MAAO,CAAEC,MAAO,MACrB,eAACoe,GAAA,EAAD,CACEpd,QAAQ,WACRiG,MAAM,YACNoX,MAAO6V,EACPpW,SAAU,SAAC/e,GAAD,OAAWL,EAAMy1B,gBAAgBp1B,EAAMqG,OAAOiZ,aAI5D,sBACE9X,IAAKyuB,EACLj1B,MAAO,CAAEC,MAAO,IAAK4B,OAAQ,KAC7Bw1B,aAAc,kBAAMrC,GAAiB,IACrC/iB,aAAc,kBAAM+iB,GAAiB,SAGvC,QCpIAzlB,GADY,IAAI+nB,gBAAgBrxB,OAAOrF,SAAS2M,QAChCsY,IAAI,QAEpB0R,GAAUC,GAAUC,OACxBloB,GAAMvE,KAAKia,MAAM1V,IAAO,CAAE2kB,QAAS,CAAExY,KAAM,aAG7C6b,GAAQrD,QAAQwD,SAASzxB,OAAO0xB,YAEhCC,qBACEL,GACAM,qBAAS,SAACC,GACR,IAAMvJ,EAAM,IAAIwJ,IAAI9xB,OAAOge,SAAS8T,KACpCxJ,EAAIyJ,aAAa/N,IAAI,OAAQjf,KAAKC,UAAU6sB,IAC5C7xB,OAAOgyB,QAAQC,aAAa,KAAM,GAAI3J,EAAI4J,cACzC,MAILlyB,OAAOC,iBAAiB,UAAU,WAChCqxB,GAAQrD,QAAQwD,SAASzxB,OAAO0xB,eAGlC,IAAM1D,GAAM30B,oBAAS,YAAqC,IAAlCX,EAAiC,EAAjCA,MACdu1B,EAAYv1B,EAAZu1B,QACR,OACE,iCACE,sBAAKl0B,MAAO,CAAEo4B,OAAQ,kBAAmBtrB,OAAQ,IAAjD,SACE,eAACurB,GAAD,CAAS15B,MAAOu1B,MAElB,eAACO,GAAD,CAAc91B,MAAOA,UAcZ25B,GATC,WACd,IAAM32B,EAAQ42B,gCACd,OACE,eAACC,GAAA,EAAD,CAAe72B,MAAOA,EAAtB,SACE,eAAC,GAAD,CAAKhD,MAAO44B,QCpCHkB,GAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,8BAAqB5M,MAAK,YAAkD,IAA/C6M,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCHdO,IAASC,OACP,eAAC,IAAMC,WAAP,UACE,eAAC,GAAD,MAEFlV,SAASmV,eAAe,SAM1BX,O","file":"static/js/main.896022e8.chunk.js","sourcesContent":["import React, { useState } from 'react';\nimport { Button, Container, Grid, Typography, Link } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { transaction } from 'mobx';\nimport { FileSelector } from '@jbrowse/core/ui';\nimport { smallTree, smallMSA, smallMSAOnly } from './data/seq2';\nvar ListItem = function (_a) {\n    var onClick = _a.onClick, model = _a.model, children = _a.children;\n    return (React.createElement(\"li\", null,\n        React.createElement(Link, { onClick: function (event) {\n                model.setError(undefined);\n                event.preventDefault();\n                onClick();\n            }, href: \"#\" },\n            React.createElement(Typography, null, children))));\n};\nexport default observer(function (_a) {\n    var model = _a.model;\n    var _b = useState(), msaFile = _b[0], setMsaFile = _b[1];\n    var _c = useState(), treeFile = _c[0], setTreeFile = _c[1];\n    var error = model.error;\n    return (React.createElement(Container, null,\n        React.createElement(\"div\", { style: { width: '50%' } },\n            error ? (React.createElement(\"div\", { style: { padding: 20 } },\n                React.createElement(Typography, { color: \"error\" },\n                    \"Error: \", \"\".concat(error)))) : null,\n            React.createElement(Typography, null, \"Open an MSA file (stockholm or clustal format) and/or a tree file (newick format).\"),\n            React.createElement(Typography, { color: \"error\" }, \"Note: you can open up just an MSA or just a tree, both are not required. Some MSA files e.g. stockholm format have an embedded tree also and this is fine, and opening a separate tree file is not required.\")),\n        React.createElement(Grid, { container: true, spacing: 10, justifyContent: \"center\", alignItems: \"center\" },\n            React.createElement(Grid, { item: true },\n                React.createElement(Typography, null, \"MSA file or URL\"),\n                React.createElement(FileSelector, { location: msaFile, setLocation: setMsaFile }),\n                React.createElement(Typography, null, \"Tree file or URL\"),\n                React.createElement(FileSelector, { location: treeFile, setLocation: setTreeFile })),\n            React.createElement(Grid, { item: true },\n                React.createElement(Button, { onClick: function () {\n                        model.setError(undefined);\n                        if (msaFile) {\n                            model.setMSAFilehandle(msaFile);\n                        }\n                        if (treeFile) {\n                            model.setTreeFilehandle(treeFile);\n                        }\n                    }, variant: \"contained\", color: \"primary\", disabled: !msaFile && !treeFile }, \"Open\")),\n            React.createElement(Grid, { item: true },\n                React.createElement(Typography, null, \"Examples\"),\n                React.createElement(\"ul\", null,\n                    React.createElement(ListItem, { model: model, onClick: function () {\n                            model.setTreeFilehandle({\n                                uri: 'https://jbrowse.org/genomes/newick_trees/sarscov2phylo.pub.ft.nh',\n                                locationType: 'UriLocation',\n                            });\n                        } }, \"230k COVID-19 samples (tree only)\"),\n                    React.createElement(ListItem, { model: model, onClick: function () {\n                            model.setData({ msa: smallMSA, tree: smallTree });\n                        } }, \"Small protein MSA+tree\"),\n                    React.createElement(ListItem, { model: model, onClick: function () {\n                            model.setData({ msa: smallMSAOnly });\n                        } }, \"Small MSA only\"),\n                    React.createElement(ListItem, { model: model, onClick: function () {\n                            model.setMSAFilehandle({\n                                uri: 'https://ihh.github.io/abrowse/build/pfam-cov2.stock',\n                                locationType: 'UriLocation',\n                            });\n                        } }, \"PFAM SARS-CoV2 multi-stockholm\"),\n                    React.createElement(ListItem, { model: model, onClick: function () {\n                            model.setMSAFilehandle({\n                                uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/Lysine.stock',\n                                locationType: 'UriLocation',\n                            });\n                        } }, \"Lysine stockholm file\"),\n                    React.createElement(ListItem, { model: model, onClick: function () {\n                            model.setMSAFilehandle({\n                                uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/PF01601_full.txt',\n                                locationType: 'UriLocation',\n                            });\n                        } }, \"PF01601 stockholm file (SARS-CoV2 spike protein)\"),\n                    React.createElement(ListItem, { model: model, onClick: function () {\n                            model.setMSAFilehandle({\n                                uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/europe_covid.fa',\n                                locationType: 'UriLocation',\n                            });\n                        } }, \"Europe COVID full genomes (LR883044.1 and 199 other sequences)\"),\n                    React.createElement(ListItem, { model: model, onClick: function () {\n                            transaction(function () {\n                                model.setMSAFilehandle({\n                                    uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/rhv_test-only.aligned_with_mafft_auto.fa',\n                                    locationType: 'UriLocation',\n                                });\n                                model.setTreeFilehandle({\n                                    uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/rhv_test-only.aligned_with_mafft_auto.nh',\n                                    locationType: 'UriLocation',\n                                });\n                            });\n                        } }, \"MAFFT+VeryFastTree(17.9k samples)\"))))));\n});\n","export var smallMSA = \"CLUSTAL O(1.2.3) multiple sequence alignment\\nUniProt/Swiss-Prot|P26898|IL2RA_SHEEP      MEPSLLMWRFFVFIVVPGCVTEACHDDPPSLRNA----------MFKVLRYE----VGTM\\nUniProt/Swiss-Prot|P01590|IL2RA_MOUSE      MEPRLLMLGFLSLTIVPSCRAELCLYDPPEVPNA----------TFKALSYK----NGTI\\nUniProt/Swiss-Prot|P41690|IL2RA_FELCA      MEPSLLLWGILTFVVVHGHVTELCDENPPDIQHA----------TFKALTYK----TGTM\\nUniProt/Swiss-Prot|P01589|IL2RA_HUMAN      MDSYLLMWGLLTFIMVPGCQAELCDDDPPEIPHA----------TFKAMAYK----EGTM\\nUniProt/Swiss-Prot|Q5MNY4|IL2RA_MACMU      MDPYLLMWGLLTFITVPGCQAELCDDDPPKITHA----------TFKAVAYK----EGTM\\nUniProt/Swiss-Prot|Q95118|IL2RG_BOVIN      -----------------------------------LLMWGLLT-----------------\\nUniProt/Swiss-Prot|P40321|IL2RG_CANFA      MLKPPLPLRSLLFLQLSLLGVGLNSTVPMPNGNEDIT------PDFFLTATPSETLSVSS\\nUniProt/Swiss-Prot|P26896|IL2RB_RAT        MATVDLSWRLPLYILLLLLATT--------------------------------WVSAAV\\nUniProt/Swiss-Prot|Q8BZM1|GLMN_MOUSE       PLPLRSLLFLQLPLLGVGLNP------------------PLPLRSLLFLQLPLLGVGLNP\\nUniProt/Swiss-Prot|P36835|IL2_CAPHI        -----------LLGVGLNPKFLTP------------------------------------\\nUniProt/Swiss-Prot|Q7JFM4|IL2_AOTVO        MLKPPLPLRSLLFLQLPLLGVGLNPKFLTPSGNEDIGGKPGTGGDFFLTSTPAGTLDVST\\nUniProt/Swiss-Prot|Q29416|IL2_CANFA        --------------LFLQLSLLG-------------------------------------\\n\";\nexport var smallMSAOnly = \"CLUSTAL O(1.2.4) multiple sequence alignment\\n\\n\\nsp|P69905|HBA_HUMAN       MVLSPADKTNVKAAWGKVGAHAGEYGAEALERMFLSFPTTKTYFPHFDLSHGSAQVKGHG\\t60\\nsp|P01942|HBA_MOUSE       MVLSGEDKSNIKAAWGKIGGHGAEYGAEALERMFASFPTTKTYFPHFDVSHGSAQVKGHG\\t60\\nsp|P13786|HBAZ_CAPHI      MSLTRTERTIILSLWSKISTQADVIGTETLERLFSCYPQAKTYFPHFDLHSGSAQLRAHG\\t60\\n                          * *:  ::: : : *.*:. :.   *:*:***:* .:* :********:  ****::.**\\n\\nsp|P69905|HBA_HUMAN       KKVADALTNAVAHVDDMPNALSALSDLHAHKLRVDPVNFKLLSHCLLVTLAAHLPAEFTP\\t120\\nsp|P01942|HBA_MOUSE       KKVADALASAAGHLDDLPGALSALSDLHAHKLRVDPVNFKLLSHCLLVTLASHHPADFTP\\t120\\nsp|P13786|HBAZ_CAPHI      SKVVAAVGDAVKSIDNVTSALSKLSELHAYVLRVDPVNFKFLSHCLLVTLASHFPADFTA\\t120\\n                          .**. *: .*.  :*:: .*** **:***: *********:**********:* **:**\\n\\nsp|P69905|HBA_HUMAN       AVHASLDKFLASVSTVLTSKYR\\t142\\nsp|P01942|HBA_MOUSE       AVHASLDKFLASVSTVLTSKYR\\t142\\nsp|P13786|HBAZ_CAPHI      DAHAAWDKFLSIVSGVLTEKYR\\t142\\n                           .**: ****: ** ***.***\";\nexport var smallTree = '(((UniProt/Swiss-Prot|P26898|IL2RA_SHEEP:0.24036,(UniProt/Swiss-Prot|P41690|IL2RA_FELCA:0.17737,(UniProt/Swiss-Prot|P01589|IL2RA_HUMAN:0.03906,UniProt/Swiss-Prot|Q5MNY4|IL2RA_MACMU:0.03787):0.13033):0.04964):0.02189,UniProt/Swiss-Prot|P01590|IL2RA_MOUSE:0.23072):0.06814,(((UniProt/Swiss-Prot|Q95118|IL2RG_BOVIN:0.09600,UniProt/Swiss-Prot|P40321|IL2RG_CANFA:0.09845):0.25333,UniProt/Swiss-Prot|Q29416|IL2_CANFA:-0.35055):0.10231,(UniProt/Swiss-Prot|P26896|IL2RB_RAT:0.33631,UniProt/Swiss-Prot|Q7JFM4|IL2_AOTVO:-0.33631):0.10166):0.01607,(UniProt/Swiss-Prot|Q8BZM1|GLMN_MOUSE:0.32378,UniProt/Swiss-Prot|P36835|IL2_CAPHI:-0.32378):0.09999)';\n","import React, { useRef, useEffect, useState } from 'react';\nimport { observer } from 'mobx-react';\n// material ui\nimport { Popover, Tooltip, Typography, makeStyles, alpha, } from '@material-ui/core';\nimport AssignmentIcon from '@material-ui/icons/Assignment';\n// import { stringify } from '@jbrowse/core/util'\nimport { Menu } from '@jbrowse/core/ui';\nvar useStyles = makeStyles(function (theme) {\n    var background = theme.palette.tertiary\n        ? alpha(theme.palette.tertiary.main, 0.7)\n        : alpha(theme.palette.primary.main, 0.7);\n    return {\n        rubberband: {\n            height: '100%',\n            background: background,\n            position: 'absolute',\n            zIndex: 10,\n            textAlign: 'center',\n            overflow: 'hidden',\n        },\n        rubberbandControl: {\n            cursor: 'crosshair',\n            width: '100%',\n            minHeight: 8,\n        },\n        rubberbandText: {\n            color: theme.palette.tertiary\n                ? theme.palette.tertiary.contrastText\n                : theme.palette.primary.contrastText,\n        },\n        popover: {\n            mouseEvents: 'none',\n            cursor: 'crosshair',\n        },\n        paper: {\n            paddingLeft: theme.spacing(1),\n            paddingRight: theme.spacing(1),\n        },\n        guide: {\n            pointerEvents: 'none',\n            height: '100%',\n            width: 1,\n            position: 'absolute',\n            zIndex: 10,\n        },\n    };\n});\nvar VerticalGuide = observer(function (_a) {\n    var model = _a.model, coordX = _a.coordX;\n    var treeAreaWidth = model.treeAreaWidth;\n    var classes = useStyles();\n    return (React.createElement(React.Fragment, null,\n        React.createElement(Tooltip, { open: true, placement: \"top\", title: \"\".concat(model.pxToBp(coordX) + 1), arrow: true },\n            React.createElement(\"div\", { style: {\n                    left: coordX + treeAreaWidth,\n                    position: 'absolute',\n                    height: 1,\n                } })),\n        React.createElement(\"div\", { className: classes.guide, style: {\n                left: coordX + treeAreaWidth,\n                background: 'red',\n            } })));\n});\nfunction Rubberband(_a) {\n    var model = _a.model, _b = _a.ControlComponent, ControlComponent = _b === void 0 ? React.createElement(\"div\", null) : _b;\n    var treeAreaWidth = model.treeAreaWidth;\n    var _c = useState(), startX = _c[0], setStartX = _c[1];\n    var _d = useState(), currentX = _d[0], setCurrentX = _d[1];\n    // clientX and clientY used for anchorPosition for menu\n    // offsetX used for calculations about width of selection\n    var _e = useState(), anchorPosition = _e[0], setAnchorPosition = _e[1];\n    var _f = useState(), guideX = _f[0], setGuideX = _f[1];\n    var controlsRef = useRef(null);\n    var rubberbandRef = useRef(null);\n    var classes = useStyles();\n    var mouseDragging = startX !== undefined && anchorPosition === undefined;\n    useEffect(function () {\n        function globalMouseMove(event) {\n            if (controlsRef.current && mouseDragging) {\n                var relativeX = event.clientX - controlsRef.current.getBoundingClientRect().left;\n                setCurrentX(relativeX);\n            }\n        }\n        function globalMouseUp(event) {\n            if (startX !== undefined && controlsRef.current) {\n                var clientX = event.clientX, clientY = event.clientY;\n                var ref = controlsRef.current;\n                var offsetX = clientX - ref.getBoundingClientRect().left;\n                // as stated above, store both clientX/Y and offsetX for different\n                // purposes\n                setAnchorPosition({\n                    offsetX: offsetX,\n                    clientX: clientX,\n                    clientY: clientY,\n                });\n                setGuideX(undefined);\n            }\n        }\n        if (mouseDragging) {\n            window.addEventListener('mousemove', globalMouseMove);\n            window.addEventListener('mouseup', globalMouseUp);\n            return function () {\n                window.removeEventListener('mousemove', globalMouseMove);\n                window.removeEventListener('mouseup', globalMouseUp);\n            };\n        }\n        return function () { };\n    }, [startX, mouseDragging, anchorPosition]);\n    useEffect(function () {\n        if (!mouseDragging &&\n            currentX !== undefined &&\n            startX !== undefined &&\n            Math.abs(currentX - startX) <= 3) {\n            handleClose();\n        }\n    }, [mouseDragging, currentX, startX, model.colWidth]);\n    function mouseDown(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        var relativeX = event.clientX -\n            event.target.getBoundingClientRect().left;\n        setStartX(relativeX);\n        setCurrentX(relativeX);\n    }\n    function mouseMove(event) {\n        var target = event.target;\n        setGuideX(event.clientX - target.getBoundingClientRect().left);\n    }\n    function mouseOut() {\n        setGuideX(undefined);\n        model.clearAnnotPos();\n    }\n    function handleClose() {\n        setAnchorPosition(undefined);\n        setStartX(undefined);\n        setCurrentX(undefined);\n    }\n    //eslint-disable-next-line @typescript-eslint/ban-types\n    function handleMenuItemClick(_, callback) {\n        callback();\n        handleClose();\n    }\n    if (startX === undefined) {\n        return (React.createElement(React.Fragment, null,\n            guideX !== undefined ? (React.createElement(VerticalGuide, { model: model, coordX: guideX })) : null,\n            React.createElement(\"div\", { \"data-testid\": \"rubberband_controls\", className: classes.rubberbandControl, role: \"presentation\", ref: controlsRef, onMouseDown: mouseDown, onMouseOut: mouseOut, onMouseMove: mouseMove }, ControlComponent)));\n    }\n    var right = anchorPosition ? anchorPosition.offsetX : currentX || 0;\n    var left = right < startX ? right : startX;\n    var width = Math.abs(right - startX);\n    var leftBpOffset = model.pxToBp(left);\n    var rightBpOffset = model.pxToBp(left + width);\n    var numOfBpSelected = Math.ceil(width / model.colWidth);\n    var menuItems = [\n        {\n            label: 'Create annotation',\n            icon: AssignmentIcon,\n            onClick: function () {\n                model.setOffsets(leftBpOffset, rightBpOffset);\n                handleClose();\n            },\n        },\n    ];\n    return (React.createElement(React.Fragment, null,\n        rubberbandRef.current ? (React.createElement(React.Fragment, null,\n            React.createElement(Popover, { className: classes.popover, classes: {\n                    paper: classes.paper,\n                }, open: true, anchorEl: rubberbandRef.current, anchorOrigin: {\n                    vertical: 'top',\n                    horizontal: 'left',\n                }, transformOrigin: {\n                    vertical: 'bottom',\n                    horizontal: 'right',\n                }, keepMounted: true, disableRestoreFocus: true },\n                React.createElement(Typography, null, leftBpOffset + 1)),\n            React.createElement(Popover, { className: classes.popover, classes: {\n                    paper: classes.paper,\n                }, open: true, anchorEl: rubberbandRef.current, anchorOrigin: {\n                    vertical: 'top',\n                    horizontal: 'right',\n                }, transformOrigin: {\n                    vertical: 'bottom',\n                    horizontal: 'left',\n                }, keepMounted: true, disableRestoreFocus: true },\n                React.createElement(Typography, null, rightBpOffset + 1)))) : null,\n        React.createElement(\"div\", { ref: rubberbandRef, className: classes.rubberband, style: { left: left + treeAreaWidth, width: width } },\n            React.createElement(Typography, { variant: \"h6\", className: classes.rubberbandText },\n                numOfBpSelected.toLocaleString('en-US'),\n                \" bp\")),\n        React.createElement(\"div\", { \"data-testid\": \"rubberband_controls\", className: classes.rubberbandControl, role: \"presentation\", ref: controlsRef, onMouseDown: mouseDown, onMouseOut: mouseOut, onMouseMove: mouseMove }, ControlComponent),\n        anchorPosition ? (React.createElement(Menu, { anchorReference: \"anchorPosition\", anchorPosition: {\n                left: anchorPosition.clientX,\n                top: anchorPosition.clientY,\n            }, onMenuItemClick: handleMenuItemClick, open: Boolean(anchorPosition), onClose: handleClose, menuItems: menuItems })) : null));\n}\nexport default observer(Rubberband);\n","import React from 'react';\nimport { Dialog, DialogTitle, DialogContent } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { Attributes } from '@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail';\nexport default observer(function (_a) {\n    var info = _a.info, onClose = _a.onClose;\n    return (React.createElement(Dialog, { onClose: function () { return onClose(); }, open: true },\n        React.createElement(DialogTitle, null, \"Metadata\"),\n        React.createElement(DialogContent, null,\n            React.createElement(Attributes, { attributes: info }))));\n});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Menu, MenuItem } from '@material-ui/core';\nimport normalizeWheel from 'normalize-wheel';\nimport { observer } from 'mobx-react';\nimport RBush from 'rbush';\nimport MoreInfoDlg from './MoreInfoDlg';\nvar extendBounds = 5;\nvar radius = 3.5;\nvar d = radius * 2;\nvar padding = 600;\nvar TreeMenu = observer(function (_a) {\n    var _b, _c;\n    var node = _a.node, onClose = _a.onClose, model = _a.model;\n    var structures = model.structures;\n    var nodeDetails = node ? model.getRowDetails(node.name) : undefined;\n    return (React.createElement(React.Fragment, null,\n        React.createElement(Menu, { anchorReference: \"anchorPosition\", anchorPosition: {\n                top: node.y,\n                left: node.x,\n            }, transitionDuration: 0, keepMounted: true, open: Boolean(node), onClose: onClose },\n            React.createElement(MenuItem, { dense: true, disabled: true }, node.name),\n            React.createElement(MenuItem, { dense: true, onClick: function () {\n                    model.setDialogComponent(MoreInfoDlg, {\n                        info: model.getRowDetails(node.name),\n                    });\n                    onClose();\n                } }, \"More info...\"), (_b = structures[node.name]) === null || _b === void 0 ? void 0 :\n            _b.map(function (entry) {\n                return !model.selectedStructures.find(function (n) { return n.id === node.name; }) ? (React.createElement(MenuItem, { key: JSON.stringify(entry), dense: true, onClick: function () {\n                        model.addStructureToSelection({\n                            structure: entry,\n                            id: node.name,\n                        });\n                        onClose();\n                    } },\n                    \"Add PDB to selection (\",\n                    entry.pdb,\n                    \")\")) : (React.createElement(MenuItem, { key: JSON.stringify(entry), dense: true, onClick: function () {\n                        model.removeStructureFromSelection({\n                            structure: entry,\n                            id: node.name,\n                        });\n                        onClose();\n                    } },\n                    \"Remove PDB from selection (\",\n                    entry.pdb,\n                    \")\"));\n            }), (_c = nodeDetails.accession) === null || _c === void 0 ? void 0 :\n            _c.map(function (accession) { return (React.createElement(MenuItem, { dense: true, key: accession, onClick: function () {\n                    model.addUniprotTrack({ name: nodeDetails.name, accession: accession });\n                    onClose();\n                } },\n                \"Open UniProt track (\",\n                accession,\n                \")\")); }))));\n});\nvar TreeBranchMenu = observer(function (_a) {\n    var node = _a.node, model = _a.model, onClose = _a.onClose;\n    return (React.createElement(Menu, { anchorReference: \"anchorPosition\", anchorPosition: {\n            left: node.x,\n            top: node.y,\n        }, transitionDuration: 0, keepMounted: true, open: Boolean(node), onClose: onClose },\n        React.createElement(MenuItem, { dense: true, disabled: true }, node.name),\n        React.createElement(MenuItem, { dense: true, onClick: function () {\n                model.toggleCollapsed(node.id);\n                onClose();\n            } }, model.collapsed.includes(node.id)\n            ? 'Expand this node'\n            : 'Collapse this node'),\n        React.createElement(MenuItem, { dense: true, onClick: function () {\n                model.showOnly === node.id\n                    ? model.setShowOnly(undefined)\n                    : model.setShowOnly(node.id);\n                onClose();\n            } }, model.showOnly === node.id\n            ? 'Disable show only this node'\n            : 'Show only this node')));\n});\nvar TreeBlock = observer(function (_a) {\n    var model = _a.model, offsetY = _a.offsetY;\n    var ref = useRef(null);\n    var clickMap = useRef(new RBush());\n    var mouseoverRef = useRef(null);\n    var _b = useState(), branchMenu = _b[0], setBranchMenu = _b[1];\n    var _c = useState(), toggleNodeMenu = _c[0], setToggleNodeMenu = _c[1];\n    var _d = useState(), hoverElt = _d[0], setHoverElt = _d[1];\n    var hierarchy = model.hierarchy, rowHeight = model.rowHeight, scrollY = model.scrollY, treeWidth = model.treeWidth, showBranchLen = model.showBranchLen, collapsed = model.collapsed, margin = model.margin, labelsAlignRight = model.labelsAlignRight, noTree = model.noTree, blockSize = model.blockSize, drawNodeBubbles = model.drawNodeBubbles, drawTree = model.drawTree, treeAreaWidth = model.treeAreaWidth, structures = model.structures, highResScaleFactor = model.highResScaleFactor;\n    useEffect(function () {\n        clickMap.current.clear();\n        if (!ref.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        ctx.resetTransform();\n        ctx.scale(highResScaleFactor, highResScaleFactor);\n        ctx.clearRect(0, 0, treeWidth + padding, blockSize);\n        ctx.translate(margin.left, -offsetY);\n        var font = ctx.font;\n        ctx.font = font.replace(/\\d+px/, \"\".concat(Math.max(8, rowHeight - 8), \"px\"));\n        if (!noTree && drawTree) {\n            hierarchy.links().forEach(function (_a) {\n                var source = _a.source, target = _a.target;\n                var y = showBranchLen ? 'len' : 'y';\n                //@ts-ignore\n                var _b = source, sy = _b.x, _c = y, sx = _b[_c];\n                //@ts-ignore\n                var _d = target, ty = _d.x, _e = y, tx = _d[_e];\n                var y1 = Math.min(sy, ty);\n                var y2 = Math.max(sy, ty);\n                //1d line intersection to check if line crosses block at all, this is\n                //an optimization that allows us to skip drawing most tree links\n                //outside the block\n                if (offsetY + blockSize >= y1 && y2 >= offsetY) {\n                    ctx.beginPath();\n                    ctx.moveTo(sx, sy);\n                    ctx.lineTo(sx, ty);\n                    ctx.lineTo(tx, ty);\n                    ctx.stroke();\n                }\n            });\n            if (drawNodeBubbles) {\n                hierarchy.descendants().forEach(function (node) {\n                    var val = showBranchLen ? 'len' : 'y';\n                    var _a = node, \n                    //@ts-ignore\n                    y = _a.x, \n                    //@ts-ignore\n                    _b = val, \n                    //@ts-ignore\n                    x = _a[_b], data = _a.data;\n                    var _c = data.id, id = _c === void 0 ? '' : _c, _d = data.name, name = _d === void 0 ? '' : _d;\n                    if (y > offsetY - extendBounds &&\n                        y < offsetY + blockSize + extendBounds) {\n                        ctx.strokeStyle = 'black';\n                        ctx.fillStyle = collapsed.includes(id) ? 'black' : 'white';\n                        ctx.beginPath();\n                        ctx.arc(x, y, radius, 0, 2 * Math.PI);\n                        ctx.fill();\n                        ctx.stroke();\n                        clickMap.current.insert({\n                            minX: x - radius,\n                            maxX: x - radius + d,\n                            minY: y - radius,\n                            maxY: y - radius + d,\n                            branch: true,\n                            id: id,\n                            name: name,\n                        });\n                    }\n                });\n            }\n        }\n        if (rowHeight >= 10) {\n            if (labelsAlignRight) {\n                ctx.textAlign = 'right';\n                ctx.setLineDash([1, 3]);\n            }\n            else {\n                ctx.textAlign = 'start';\n            }\n            hierarchy.leaves().forEach(function (node) {\n                var \n                //@ts-ignore\n                y = node.x, \n                //@ts-ignore\n                x = node.y, _a = node.data, name = _a.name, id = _a.id, \n                //@ts-ignore\n                len = node.len;\n                if (y > offsetY - extendBounds &&\n                    y < offsetY + blockSize + extendBounds) {\n                    //note: +rowHeight/4 matches with -rowHeight/4 in msa\n                    var yp = y + rowHeight / 4;\n                    var xp = showBranchLen ? len : x;\n                    var width = ctx.measureText(name).width;\n                    var height = ctx.measureText('M').width; // use an 'em' for height\n                    var hasStructure = structures[name];\n                    ctx.fillStyle = hasStructure ? 'blue' : 'black';\n                    if (!drawTree && !labelsAlignRight) {\n                        ctx.fillText(name, 0, yp);\n                        clickMap.current.insert({\n                            minX: 0,\n                            maxX: width,\n                            minY: yp - height,\n                            maxY: yp,\n                            name: name,\n                            id: id,\n                        });\n                    }\n                    else if (labelsAlignRight) {\n                        var smallPadding = 2;\n                        var offset = treeAreaWidth - smallPadding - margin.left;\n                        if (drawTree && !noTree) {\n                            var width_1 = ctx.measureText(name).width;\n                            ctx.moveTo(xp + radius + 2, y);\n                            ctx.lineTo(offset - smallPadding - width_1, y);\n                            ctx.stroke();\n                        }\n                        ctx.fillText(name, offset, yp);\n                        clickMap.current.insert({\n                            minX: treeAreaWidth - margin.left - width,\n                            maxX: treeAreaWidth - margin.left,\n                            minY: yp - height,\n                            maxY: yp,\n                            name: name,\n                            id: id,\n                        });\n                    }\n                    else {\n                        ctx.fillText(name, xp + d, yp);\n                        clickMap.current.insert({\n                            minX: xp + d,\n                            maxX: xp + d + width,\n                            minY: yp - height,\n                            maxY: yp,\n                            name: name,\n                            id: id,\n                        });\n                    }\n                }\n            });\n            ctx.setLineDash([]);\n        }\n    }, [\n        collapsed,\n        rowHeight,\n        margin.left,\n        hierarchy,\n        offsetY,\n        treeWidth,\n        showBranchLen,\n        noTree,\n        blockSize,\n        drawNodeBubbles,\n        drawTree,\n        labelsAlignRight,\n        treeAreaWidth,\n        structures,\n        highResScaleFactor,\n    ]);\n    useEffect(function () {\n        var canvas = mouseoverRef.current;\n        if (!canvas) {\n            return;\n        }\n        var ctx = canvas.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        ctx.resetTransform();\n        ctx.clearRect(0, 0, treeWidth + padding, blockSize);\n        ctx.translate(margin.left, -offsetY);\n        if (hoverElt) {\n            var minX = hoverElt.minX, maxX = hoverElt.maxX, minY = hoverElt.minY, maxY = hoverElt.maxY;\n            ctx.fillStyle = 'rgba(0,0,0,0.1)';\n            ctx.fillRect(minX, minY, maxX - minX, maxY - minY);\n        }\n    }, [hoverElt, margin.left, offsetY, blockSize, treeWidth]);\n    function hoverBranchClickMap(event) {\n        var x = event.nativeEvent.offsetX - margin.left;\n        var y = event.nativeEvent.offsetY;\n        var entry = clickMap.current.search({\n            minX: x,\n            maxX: x + 1,\n            minY: y + offsetY,\n            maxY: y + 1 + offsetY,\n        })[0];\n        return entry && entry.branch\n            ? __assign(__assign({}, entry), { x: event.clientX, y: event.clientY }) : undefined;\n    }\n    function hoverNameClickMap(event) {\n        var x = event.nativeEvent.offsetX - margin.left;\n        var y = event.nativeEvent.offsetY;\n        var entry = clickMap.current.search({\n            minX: x,\n            maxX: x + 1,\n            minY: y + offsetY,\n            maxY: y + 1 + offsetY,\n        })[0];\n        return entry && !entry.branch\n            ? __assign(__assign({}, entry), { x: event.clientX, y: event.clientY }) : undefined;\n    }\n    return (React.createElement(React.Fragment, null,\n        (branchMenu === null || branchMenu === void 0 ? void 0 : branchMenu.id) ? (React.createElement(TreeBranchMenu, { node: branchMenu, model: model, onClose: function () { return setBranchMenu(undefined); } })) : null,\n        (toggleNodeMenu === null || toggleNodeMenu === void 0 ? void 0 : toggleNodeMenu.id) ? (React.createElement(TreeMenu, { node: toggleNodeMenu, model: model, onClose: function () { return setToggleNodeMenu(undefined); } })) : null,\n        React.createElement(\"canvas\", { width: (treeWidth + padding) * highResScaleFactor, height: blockSize * highResScaleFactor, style: {\n                width: treeWidth + padding,\n                height: blockSize,\n                top: scrollY + offsetY,\n                left: 0,\n                position: 'absolute',\n            }, onMouseMove: function (event) {\n                if (!ref.current) {\n                    return;\n                }\n                var ret = hoverNameClickMap(event) || hoverBranchClickMap(event);\n                if (ret) {\n                    ref.current.style.cursor = 'pointer';\n                }\n                else {\n                    ref.current.style.cursor = 'default';\n                }\n                setHoverElt(hoverNameClickMap(event));\n            }, onClick: function (event) {\n                var x = event.clientX, y = event.clientY;\n                var data = hoverBranchClickMap(event);\n                if (data === null || data === void 0 ? void 0 : data.id) {\n                    setBranchMenu(__assign(__assign({}, data), { x: x, y: y }));\n                }\n                var data2 = hoverNameClickMap(event);\n                if (data2 === null || data2 === void 0 ? void 0 : data2.id) {\n                    setToggleNodeMenu(__assign(__assign({}, data2), { x: x, y: y }));\n                }\n            }, ref: ref }),\n        React.createElement(\"canvas\", { style: {\n                width: treeWidth + padding,\n                height: blockSize,\n                top: scrollY + offsetY,\n                left: 0,\n                position: 'absolute',\n                pointerEvents: 'none',\n                zIndex: 100,\n            }, width: treeWidth + padding, height: blockSize, ref: mouseoverRef })));\n});\nvar TreeCanvas = observer(function (_a) {\n    var model = _a.model;\n    var ref = useRef(null);\n    var scheduled = useRef(false);\n    var deltaY = useRef(0);\n    var prevY = useRef(0);\n    var treeWidth = model.treeWidth, height = model.height, blocksY = model.blocksY;\n    var _b = useState(false), mouseDragging = _b[0], setMouseDragging = _b[1];\n    useEffect(function () {\n        var curr = ref.current;\n        if (!curr) {\n            return;\n        }\n        function onWheel(origEvent) {\n            var event = normalizeWheel(origEvent);\n            deltaY.current += event.pixelY;\n            if (!scheduled.current) {\n                scheduled.current = true;\n                requestAnimationFrame(function () {\n                    model.doScrollY(-deltaY.current);\n                    deltaY.current = 0;\n                    scheduled.current = false;\n                });\n            }\n            origEvent.preventDefault();\n        }\n        curr.addEventListener('wheel', onWheel);\n        return function () {\n            curr.removeEventListener('wheel', onWheel);\n        };\n    }, [model]);\n    useEffect(function () {\n        var cleanup = function () { };\n        function globalMouseMove(event) {\n            event.preventDefault();\n            var currY = event.clientY;\n            var distanceY = currY - prevY.current;\n            if (distanceY) {\n                // use rAF to make it so multiple event handlers aren't fired per-frame\n                // see https://calendar.perfplanet.com/2013/the-runtime-performance-checklist/\n                if (!scheduled.current) {\n                    scheduled.current = true;\n                    window.requestAnimationFrame(function () {\n                        model.doScrollY(distanceY);\n                        scheduled.current = false;\n                        prevY.current = event.clientY;\n                    });\n                }\n            }\n        }\n        function globalMouseUp() {\n            prevY.current = 0;\n            if (mouseDragging) {\n                setMouseDragging(false);\n            }\n        }\n        if (mouseDragging) {\n            window.addEventListener('mousemove', globalMouseMove, true);\n            window.addEventListener('mouseup', globalMouseUp, true);\n            cleanup = function () {\n                window.removeEventListener('mousemove', globalMouseMove, true);\n                window.removeEventListener('mouseup', globalMouseUp, true);\n            };\n        }\n        return cleanup;\n    }, [model, mouseDragging]);\n    function mouseDown(event) {\n        // check if clicking a draggable element or a resize handle\n        var target = event.target;\n        if (target.draggable || target.dataset.resizer) {\n            return;\n        }\n        // otherwise do click and drag scroll\n        if (event.button === 0) {\n            prevY.current = event.clientY;\n            setMouseDragging(true);\n        }\n    }\n    // this local mouseup is used in addition to the global because sometimes\n    // the global add/remove are not called in time, resulting in issue #533\n    function mouseUp(event) {\n        event.preventDefault();\n        setMouseDragging(false);\n    }\n    function mouseLeave(event) {\n        event.preventDefault();\n    }\n    return (React.createElement(\"div\", { ref: ref, onMouseDown: mouseDown, onMouseUp: mouseUp, onMouseLeave: mouseLeave, style: {\n            height: height,\n            position: 'relative',\n            overflow: 'hidden',\n            width: treeWidth + padding,\n        } }, blocksY.map(function (block) { return (React.createElement(TreeBlock, { key: block, model: model, offsetY: block })); })));\n});\nexport default TreeCanvas;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport Color from 'color';\nexport function transform(obj, cb) {\n    return Object.fromEntries(Object.entries(obj).map(cb));\n}\nexport function generateNodeIds(tree, parent, depth) {\n    var _a;\n    if (parent === void 0) { parent = 'node'; }\n    if (depth === void 0) { depth = 0; }\n    var id = \"\".concat(parent, \"-\").concat(depth);\n    return __assign(__assign({}, tree), { id: id, branchset: ((_a = tree.branchset) === null || _a === void 0 ? void 0 : _a.map(function (b, i) {\n            return generateNodeIds(b, \"\".concat(id, \"-\").concat(i), depth + 1);\n        })) || [] });\n}\nexport function colorContrast(colorScheme, theme) {\n    return transform(colorScheme, function (_a) {\n        var letter = _a[0], color = _a[1];\n        return [\n            letter,\n            theme.palette.getContrastText(Color(color).hex()),\n        ];\n    });\n}\n","import Color from 'color';\nimport { transform } from './util';\nvar colorSchemes = {\n    clustal: {\n        G: 'orange',\n        P: 'orange',\n        S: 'orange',\n        T: 'orange',\n        H: 'red',\n        K: 'red',\n        R: 'red',\n        F: 'blue',\n        W: 'blue',\n        Y: 'blue',\n        I: 'green',\n        L: 'green',\n        M: 'green',\n        V: 'green',\n    },\n    lesk: {\n        G: 'orange',\n        A: 'orange',\n        S: 'orange',\n        T: 'orange',\n        C: 'green',\n        V: 'green',\n        I: 'green',\n        L: 'green',\n        P: 'green',\n        F: 'green',\n        Y: 'green',\n        M: 'green',\n        W: 'green',\n        N: 'magenta',\n        Q: 'magenta',\n        H: 'magenta',\n        D: 'red',\n        E: 'red',\n        K: 'blue',\n        R: 'blue',\n    },\n    maeditor: {\n        A: 'lightgreen',\n        G: 'lightgreen',\n        C: 'green',\n        D: 'darkgreen',\n        E: 'darkgreen',\n        N: 'darkgreen',\n        Q: 'darkgreen',\n        I: 'blue',\n        L: 'blue',\n        M: 'blue',\n        V: 'blue',\n        F: '#c8a2c8',\n        W: '#c8a2c8',\n        Y: '#c8a2c8',\n        H: 'darkblue',\n        K: 'orange',\n        R: 'orange',\n        P: 'pink',\n        S: 'red',\n        T: 'red',\n    },\n    percent_identity_dynamic: {},\n    //https://github.com/biotite-dev/biotite/blob/8c460972f8ab904312f130dfb80f3efc8c9bd7c5/src/biotite/sequence/graphics/color_schemes/flower.json\n    flower: {\n        A: '#b18a51',\n        C: '#ff5701',\n        D: '#01a578',\n        E: '#2da0a1',\n        F: '#fa559d',\n        G: '#b1c23c',\n        H: '#0194f9',\n        I: '#f27663',\n        K: '#7fc3d7',\n        L: '#df6e75',\n        M: '#fe9daf',\n        N: '#0bcec6',\n        P: '#4fa32a',\n        Q: '#7295ae',\n        R: '#83bff1',\n        S: '#b4bd9b',\n        T: '#d2b576',\n        V: '#fd997b',\n        W: '#ff2ded',\n        Y: '#c96ecf',\n    },\n    rainbow_dna: {\n        A: '#3737f5',\n        C: '#37f537',\n        G: '#f5f537',\n        T: '#f53737',\n        U: '#f53737',\n    },\n    //https://github.com/biotite-dev/biotite/blob/8c460972f8ab904312f130dfb80f3efc8c9bd7c5/src/biotite/sequence/graphics/color_schemes/clustalx_protein.json\n    clustalx_protein: {\n        A: '#197fe5',\n        C: '#e57f7f',\n        D: '#cc4ccc',\n        E: '#cc4ccc',\n        F: '#197fe5',\n        G: '#e5994c',\n        H: '#19b2b2',\n        I: '#197fe5',\n        K: '#e53319',\n        L: '#197fe5',\n        M: '#197fe5',\n        N: '#19cc19',\n        P: '#cccc00',\n        Q: '#19cc19',\n        R: '#e53319',\n        S: '#19cc19',\n        T: '#19cc19',\n        V: '#197fe5',\n        W: '#197fe5',\n        Y: '#19b2b2',\n    },\n    // this has special handling\n    clustalx_protein_dynamic: {},\n    clustalx_dna: {\n        A: '#e53319',\n        C: '#197fe5',\n        G: '#e5994c',\n        T: '#19cc19',\n        U: '#19cc19',\n    },\n    jalview_buried: {\n        A: '#00a35c',\n        R: '#00fc03',\n        N: '#00eb14',\n        D: '#00eb14',\n        C: '#0000ff',\n        Q: '#00f10e',\n        E: '#00f10e',\n        G: '#009d62',\n        H: '#00d52a',\n        I: '#0054ab',\n        L: '#007b84',\n        K: '#00ff00',\n        M: '#009768',\n        F: '#008778',\n        P: '#00e01f',\n        S: '#00d52a',\n        T: '#00db24',\n        W: '#00a857',\n        Y: '#00e619',\n        V: '#005fa0',\n        B: '#00eb14',\n        X: '#00b649',\n        Z: '#00f10e',\n    },\n    jalview_hydrophobicity: {\n        A: '#ad0052',\n        R: '#0000ff',\n        N: '#0c00f3',\n        D: '#0c00f3',\n        C: '#c2003d',\n        Q: '#0c00f3',\n        E: '#0c00f3',\n        G: '#6a0095',\n        H: '#1500ea',\n        I: '#ff0000',\n        L: '#ea0015',\n        K: '#0000ff',\n        M: '#b0004f',\n        F: '#cb0034',\n        P: '#4600b9',\n        S: '#5e00a1',\n        T: '#61009e',\n        W: '#5b00a4',\n        Y: '#4f00b0',\n        V: '#f60009',\n        B: '#0c00f3',\n        X: '#680097',\n        Z: '#0c00f3',\n    },\n    jalview_prophelix: {\n        A: '#e718e7',\n        R: '#6f906f',\n        N: '#1be41b',\n        D: '#778877',\n        C: '#23dc23',\n        Q: '#926d92',\n        E: '#ff00ff',\n        G: '#00ff00',\n        H: '#758a75',\n        I: '#8a758a',\n        L: '#ae51ae',\n        K: '#a05fa0',\n        M: '#ef10ef',\n        F: '#986798',\n        P: '#00ff00',\n        S: '#36c936',\n        T: '#47b847',\n        W: '#8a758a',\n        Y: '#21de21',\n        V: '#857a85',\n        B: '#49b649',\n        X: '#758a75',\n        Z: '#c936c9',\n    },\n    jalview_propstrand: {\n        A: '#5858a7',\n        R: '#6b6b94',\n        N: '#64649b',\n        D: '#2121de',\n        C: '#9d9d62',\n        Q: '#8c8c73',\n        E: '#0000ff',\n        G: '#4949b6',\n        H: '#60609f',\n        I: '#ecec13',\n        L: '#b2b24d',\n        K: '#4747b8',\n        M: '#82827d',\n        F: '#c2c23d',\n        P: '#2323dc',\n        S: '#4949b6',\n        T: '#9d9d62',\n        W: '#c0c03f',\n        Y: '#d3d32c',\n        V: '#ffff00',\n        B: '#4343bc',\n        X: '#797986',\n        Z: '#4747b8',\n    },\n    jalview_propturn: {\n        A: '#2cd3d3',\n        R: '#708f8f',\n        N: '#ff0000',\n        D: '#e81717',\n        C: '#a85757',\n        Q: '#3fc0c0',\n        E: '#778888',\n        G: '#ff0000',\n        H: '#708f8f',\n        I: '#00ffff',\n        L: '#1ce3e3',\n        K: '#7e8181',\n        M: '#1ee1e1',\n        F: '#1ee1e1',\n        P: '#f60909',\n        S: '#e11e1e',\n        T: '#738c8c',\n        W: '#738c8c',\n        Y: '#9d6262',\n        V: '#07f8f8',\n        B: '#f30c0c',\n        X: '#7c8383',\n        Z: '#5ba4a4',\n    },\n    jalview_taylor: {\n        A: '#ccff00',\n        R: '#0000ff',\n        N: '#cc00ff',\n        D: '#ff0000',\n        C: '#ffff00',\n        Q: '#ff00cc',\n        E: '#ff0066',\n        G: '#ff9900',\n        H: '#0066ff',\n        I: '#66ff00',\n        L: '#33ff00',\n        K: '#6600ff',\n        M: '#00ff00',\n        F: '#00ff66',\n        P: '#ffcc00',\n        S: '#ff3300',\n        T: '#ff6600',\n        W: '#00ccff',\n        Y: '#00ffcc',\n        V: '#99ff00',\n    },\n    jalview_zappo: {\n        A: '#ffafaf',\n        R: '#6464ff',\n        N: '#00ff00',\n        D: '#ff0000',\n        C: '#ffff00',\n        Q: '#00ff00',\n        E: '#ff0000',\n        G: '#ff00ff',\n        H: '#6464ff',\n        I: '#ffafaf',\n        L: '#ffafaf',\n        K: '#6464ff',\n        M: '#ffafaf',\n        F: '#ffc800',\n        P: '#ff00ff',\n        S: '#00ff00',\n        T: '#00ff00',\n        W: '#ffc800',\n        Y: '#ffc800',\n        V: '#ffafaf',\n    },\n    cinema: {\n        H: 'blue',\n        K: 'blue',\n        R: 'blue',\n        D: 'red',\n        E: 'red',\n        S: 'green',\n        T: 'green',\n        N: 'green',\n        Q: 'green',\n        A: 'white',\n        V: 'white',\n        L: 'white',\n        I: 'white',\n        M: 'white',\n        F: 'magenta',\n        W: 'magenta',\n        Y: 'magenta',\n        P: 'brown',\n        G: 'brown',\n        C: 'yellow',\n        B: 'gray',\n        Z: 'gray',\n        X: 'gray',\n        '-': 'gray',\n        '.': 'gray',\n    },\n};\n// turn all supplied colors to hex colors which getContrastText from mui\n// requires\nexport default transform(colorSchemes, function (_a) {\n    var key = _a[0], val = _a[1];\n    return [\n        key,\n        transform(val, function (_a) {\n            var letter = _a[0], color = _a[1];\n            return [letter, Color(color).hex()];\n        }),\n    ];\n});\n// info http://www.jalview.org/help/html/colourSchemes/clustal.html\n// modifications:\n// reference to clustalX source code scheme modifies what the jalview.org\n// scheme says there the jalview.org colorscheme says WLVIMAFCHP but it\n// should be WLVIMAFCHPY, colprot.xml says e.g. %#ACFHILMVWYPp\" which has Y\nexport function getClustalXColor(stats, model, row, col) {\n    var total = Object.values(stats).reduce(function (a, b) { return a + b; }, 0);\n    var l = model.columns[row][col];\n    var _a = stats.W, W = _a === void 0 ? 0 : _a, _b = stats.L, L = _b === void 0 ? 0 : _b, _c = stats.V, V = _c === void 0 ? 0 : _c, _d = stats.I, I = _d === void 0 ? 0 : _d, _e = stats.M, M = _e === void 0 ? 0 : _e, _f = stats.A, A = _f === void 0 ? 0 : _f, _g = stats.F, F = _g === void 0 ? 0 : _g, _h = stats.C, C = _h === void 0 ? 0 : _h, _j = stats.H, H = _j === void 0 ? 0 : _j, _k = stats.P, P = _k === void 0 ? 0 : _k, _l = stats.R, R = _l === void 0 ? 0 : _l, _m = stats.K, K = _m === void 0 ? 0 : _m, _o = stats.Q, Q = _o === void 0 ? 0 : _o, _p = stats.E, E = _p === void 0 ? 0 : _p, _q = stats.D, D = _q === void 0 ? 0 : _q, _r = stats.T, T = _r === void 0 ? 0 : _r, _s = stats.S, S = _s === void 0 ? 0 : _s, _t = stats.G, G = _t === void 0 ? 0 : _t, _u = stats.Y, Y = _u === void 0 ? 0 : _u, _v = stats.N, N = _v === void 0 ? 0 : _v;\n    var WLVIMAFCHP = W + L + V + I + M + A + F + C + H + P + Y;\n    var KR = K + R;\n    var QE = Q + E;\n    var ED = E + D;\n    var TS = T + S;\n    if (WLVIMAFCHP / total > 0.6) {\n        if (l === 'W' ||\n            l === 'L' ||\n            l === 'V' ||\n            l === 'A' ||\n            l === 'I' ||\n            l === 'M' ||\n            l === 'F' ||\n            l === 'C') {\n            // blue from jalview.org docs\n            return 'rgb(128,179,230)';\n        }\n    }\n    if ((l === 'K' || l === 'R') &&\n        (KR / total > 0.6 || K / total > 0.8 || R / total > 0.8 || Q / total > 0.8)) {\n        return '#d88';\n    }\n    if (l === 'E' &&\n        (KR / total > 0.6 ||\n            QE / total > 0.5 ||\n            E / total > 0.8 ||\n            Q / total > 0.8 ||\n            D / total > 0.8)) {\n        return 'rgb(192, 72, 192)';\n    }\n    if (l === 'D' &&\n        (KR / total > 0.6 ||\n            ED / total > 0.5 ||\n            K / total > 0.8 ||\n            R / total > 0.8 ||\n            Q / total > 0.8)) {\n        return 'rgb(204, 77, 204)';\n    }\n    if (l === 'N' && (N / total > 0.5 || Y / total > 0.85)) {\n        return '#8f8';\n    }\n    if (l === 'Q' &&\n        (KR / total > 0.6 ||\n            QE / total > 0.6 ||\n            Q / total > 0.85 ||\n            E / total > 0.85 ||\n            K / total > 0.85 ||\n            R / total > 0.85)) {\n        return '#8f8';\n    }\n    if ((l === 'S' || l === 'T') &&\n        // WLVIMAFCHP modified from 0.6 to 0.55 on page to match what i see in jalview\n        (WLVIMAFCHP / total > 0.6 ||\n            TS / total > 0.5 ||\n            S / total > 0.85 ||\n            T / total > 0.85)) {\n        return 'rgb(26,204,26)';\n    }\n    if (l === 'C' && C / total > 0.85) {\n        return 'rgb(240, 128, 128)';\n    }\n    if (l === 'G' && G / total > 0) {\n        return 'rgb(240, 144, 72)';\n    }\n    if (l === 'P' && P / total > 0) {\n        return 'rgb(204, 204, 0)';\n    }\n    if ((l === 'H' || l === 'Y') &&\n        (WLVIMAFCHP / total > 0.6 ||\n            W > 0.85 ||\n            Y > 0.85 ||\n            A > 0.85 ||\n            C > 0.85 ||\n            P > 0.85 ||\n            Q > 0.85 ||\n            F > 0.85 ||\n            H > 0.85 ||\n            I > 0.85 ||\n            L > 0.85 ||\n            M > 0.85 ||\n            V > 0.85)) {\n        // cyan from jalview.org docs\n        return 'rgb(26, 179, 179)';\n    }\n    return undefined;\n}\n// info http://www.jalview.org/help/html/colourSchemes/clustal.html\n// modifications:\n// reference to clustalX source code scheme modifies what the jalview.org\n// scheme says there the jalview.org colorscheme says WLVIMAFCHP but it\n// should be WLVIMAFCHPY, colprot.xml says e.g. %#ACFHILMVWYPp\" which has Y\nexport function getPercentIdentityColor(stats, model, row, col) {\n    var total = Object.values(stats).reduce(function (a, b) { return a + b; }, 0);\n    var l = model.columns[row][col];\n    var entries = Object.entries(stats);\n    var ent = 0;\n    var letter = '';\n    for (var i = 0; i < entries.length; i++) {\n        if (entries[i][1] > ent && entries[i][0] !== '-') {\n            letter = entries[i][0];\n            ent = entries[i][1];\n        }\n    }\n    var proportion = ent / total;\n    var thresh = \"hsl(240, 30%, \".concat(100 * Math.max(1 - ent / total / 3, 0.3), \"%)\");\n    if (proportion > 0.4) {\n        if (l === letter) {\n            return thresh;\n        }\n    }\n}\n","import React, { useEffect, useState, useRef, useMemo } from 'react';\nimport { Typography, CircularProgress, useTheme } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport normalizeWheel from 'normalize-wheel';\nimport { colorContrast } from '../util';\nimport { getClustalXColor, getPercentIdentityColor } from '../colorSchemes';\nvar MSABlock = observer(function (_a) {\n    var model = _a.model, offsetX = _a.offsetX, offsetY = _a.offsetY;\n    var MSA = model.MSA, colWidth = model.colWidth, bgColor = model.bgColor, columns = model.columns, rowHeight = model.rowHeight, scrollY = model.scrollY, scrollX = model.scrollX, hierarchy = model.hierarchy, colorScheme = model.colorScheme, colorSchemeName = model.colorSchemeName, blockSize = model.blockSize, highResScaleFactor = model.highResScaleFactor, colStats = model.colStats;\n    var theme = useTheme();\n    var contrastScheme = useMemo(function () { return colorContrast(colorScheme, theme); }, [colorScheme, theme]);\n    var ref = useRef(null);\n    useEffect(function () {\n        if (!ref.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        ctx.resetTransform();\n        ctx.scale(highResScaleFactor, highResScaleFactor);\n        ctx.clearRect(0, 0, blockSize, blockSize);\n        ctx.translate(-offsetX, rowHeight / 2 - offsetY);\n        ctx.textAlign = 'center';\n        ctx.font = ctx.font.replace(/\\d+px/, \"\".concat(Math.max(8, rowHeight - 8), \"px\"));\n        var leaves = hierarchy.leaves();\n        var b = blockSize;\n        // slice vertical rows, e.g. tree leaves, avoid negative slice\n        var yStart = Math.max(0, Math.floor((offsetY - rowHeight) / rowHeight));\n        var yEnd = Math.max(0, Math.ceil((offsetY + b + rowHeight) / rowHeight));\n        // slice horizontal visible letters, avoid negative slice\n        var xStart = Math.max(0, Math.floor(offsetX / colWidth));\n        var xEnd = Math.max(0, Math.ceil((offsetX + b) / colWidth));\n        var visibleLeaves = leaves.slice(yStart, yEnd);\n        visibleLeaves.forEach(function (node) {\n            var _a;\n            var \n            //@ts-ignore\n            y = node.x, name = node.data.name;\n            var str = (_a = columns[name]) === null || _a === void 0 ? void 0 : _a.slice(xStart, xEnd);\n            for (var i = 0; i < (str === null || str === void 0 ? void 0 : str.length); i++) {\n                var letter = str[i];\n                var color = colorSchemeName === 'clustalx_protein_dynamic'\n                    ? getClustalXColor(colStats[xStart + i], model, name, xStart + i)\n                    : colorSchemeName === 'percent_identity_dynamic'\n                        ? getPercentIdentityColor(colStats[xStart + i], model, name, xStart + i)\n                        : colorScheme[letter.toUpperCase()];\n                if (bgColor) {\n                    var x = i * colWidth + offsetX - (offsetX % colWidth);\n                    ctx.fillStyle = color || 'white';\n                    ctx.fillRect(x, y - rowHeight, colWidth, rowHeight);\n                }\n            }\n        });\n        if (rowHeight >= 10 && colWidth >= rowHeight / 2) {\n            visibleLeaves.forEach(function (node) {\n                var _a;\n                var \n                //@ts-ignore\n                y = node.x, name = node.data.name;\n                var str = (_a = columns[name]) === null || _a === void 0 ? void 0 : _a.slice(xStart, xEnd);\n                for (var i = 0; i < (str === null || str === void 0 ? void 0 : str.length); i++) {\n                    var letter = str[i];\n                    var color = colorScheme[letter.toUpperCase()];\n                    var contrast = contrastScheme[letter.toUpperCase()] || 'black';\n                    var x = i * colWidth + offsetX - (offsetX % colWidth);\n                    //note: -rowHeight/4 matches +rowHeight/4 in tree\n                    ctx.fillStyle = bgColor ? contrast : color || 'black';\n                    ctx.fillText(letter, x + colWidth / 2, y - rowHeight / 4);\n                }\n            });\n        }\n    }, [\n        MSA,\n        highResScaleFactor,\n        columns,\n        colorScheme,\n        contrastScheme,\n        bgColor,\n        rowHeight,\n        colWidth,\n        hierarchy,\n        offsetX,\n        offsetY,\n        blockSize,\n    ]);\n    return (React.createElement(\"canvas\", { ref: ref, onMouseMove: function (event) {\n            if (!ref.current) {\n                return;\n            }\n            var _a = ref.current.getBoundingClientRect(), left = _a.left, top = _a.top;\n            var mouseX = event.clientX - left;\n            var mouseY = event.clientY - top;\n            model.setMousePos(Math.floor((mouseX + offsetX) / colWidth) + 1, Math.floor((mouseY + offsetY) / rowHeight));\n        }, onMouseLeave: function () { return model.setMousePos(); }, width: blockSize * highResScaleFactor, height: blockSize * highResScaleFactor, style: {\n            position: 'absolute',\n            top: scrollY + offsetY,\n            left: scrollX + offsetX,\n            width: blockSize,\n            height: blockSize,\n        } }));\n});\nvar MSACanvas = observer(function (_a) {\n    var model = _a.model;\n    var MSA = model.MSA, msaFilehandle = model.msaFilehandle, height = model.height, msaAreaWidth = model.msaAreaWidth, blocks2d = model.blocks2d;\n    var ref = useRef(null);\n    // wheel\n    var scheduled = useRef(false);\n    var deltaX = useRef(0);\n    var deltaY = useRef(0);\n    // mouse click-and-drag scrolling\n    var prevX = useRef(0);\n    var prevY = useRef(0);\n    var _b = useState(false), mouseDragging = _b[0], setMouseDragging = _b[1];\n    useEffect(function () {\n        var curr = ref.current;\n        if (!curr) {\n            return;\n        }\n        function onWheel(origEvent) {\n            var event = normalizeWheel(origEvent);\n            deltaX.current += event.pixelX;\n            deltaY.current += event.pixelY;\n            if (!scheduled.current) {\n                scheduled.current = true;\n                requestAnimationFrame(function () {\n                    model.doScrollX(-deltaX.current);\n                    model.doScrollY(-deltaY.current);\n                    deltaX.current = 0;\n                    deltaY.current = 0;\n                    scheduled.current = false;\n                });\n            }\n            origEvent.preventDefault();\n        }\n        curr.addEventListener('wheel', onWheel);\n        return function () {\n            curr.removeEventListener('wheel', onWheel);\n        };\n    }, [model]);\n    useEffect(function () {\n        var cleanup = function () { };\n        function globalMouseMove(event) {\n            event.preventDefault();\n            var currX = event.clientX;\n            var currY = event.clientY;\n            var distanceX = currX - prevX.current;\n            var distanceY = currY - prevY.current;\n            if (distanceX || distanceY) {\n                // use rAF to make it so multiple event handlers aren't fired per-frame\n                // see https://calendar.perfplanet.com/2013/the-runtime-performance-checklist/\n                if (!scheduled.current) {\n                    scheduled.current = true;\n                    window.requestAnimationFrame(function () {\n                        model.doScrollX(distanceX);\n                        model.doScrollY(distanceY);\n                        scheduled.current = false;\n                        prevX.current = event.clientX;\n                        prevY.current = event.clientY;\n                    });\n                }\n            }\n        }\n        function globalMouseUp() {\n            prevX.current = 0;\n            if (mouseDragging) {\n                setMouseDragging(false);\n            }\n        }\n        if (mouseDragging) {\n            window.addEventListener('mousemove', globalMouseMove, true);\n            window.addEventListener('mouseup', globalMouseUp, true);\n            cleanup = function () {\n                window.removeEventListener('mousemove', globalMouseMove, true);\n                window.removeEventListener('mouseup', globalMouseUp, true);\n            };\n        }\n        return cleanup;\n    }, [model, mouseDragging]);\n    return (React.createElement(\"div\", { ref: ref, onMouseDown: function (event) {\n            // check if clicking a draggable element or a resize handle\n            var target = event.target;\n            if (target.draggable || target.dataset.resizer) {\n                return;\n            }\n            // otherwise do click and drag scroll\n            if (event.button === 0) {\n                prevX.current = event.clientX;\n                prevY.current = event.clientY;\n                setMouseDragging(true);\n            }\n        }, onMouseUp: function (event) {\n            event.preventDefault();\n            setMouseDragging(false);\n        }, onMouseLeave: function (event) {\n            event.preventDefault();\n        }, style: {\n            position: 'relative',\n            height: height,\n            width: msaAreaWidth,\n            overflow: 'hidden',\n        } }, !MSA && !msaFilehandle ? null : !MSA ? (React.createElement(\"div\", { style: { position: 'absolute', left: '50%', top: '50%' } },\n        React.createElement(CircularProgress, null),\n        React.createElement(Typography, null, \"Loading...\"))) : (blocks2d.map(function (_a) {\n        var bx = _a[0], by = _a[1];\n        return (React.createElement(MSABlock, { key: \"\".concat(bx, \"_\").concat(by), model: model, offsetX: bx, offsetY: by }));\n    }))));\n});\nexport default MSACanvas;\n","import React, { useRef } from 'react';\nimport { makeStyles } from '@material-ui/core';\nimport { observer } from 'mobx-react';\n/**\n * Given a scale ( bp/px ) and minimum distances (px) between major and minor\n * gridlines, return an object like `{ majorPitch: bp, minorPitch: bp }` giving\n * the gridline pitches to use.\n */\nexport function chooseGridPitch(scale, minMajorPitchPx, minMinorPitchPx) {\n    scale = Math.abs(scale);\n    var minMajorPitchBp = minMajorPitchPx * scale;\n    var majorMagnitude = parseInt(Number(minMajorPitchBp).toExponential().split(/e/i)[1], 10);\n    var majorPitch = Math.pow(10, majorMagnitude);\n    while (majorPitch < minMajorPitchBp) {\n        majorPitch *= 2;\n        if (majorPitch >= minMajorPitchBp) {\n            break;\n        }\n        majorPitch *= 2.5;\n    }\n    majorPitch = Math.max(majorPitch, 5);\n    var majorPitchPx = majorPitch / scale;\n    var minorPitch = 0;\n    if (!(majorPitch % 10) && majorPitchPx / 10 >= minMinorPitchPx) {\n        minorPitch = majorPitch / 10;\n    }\n    else if (!(majorPitch % 5) && majorPitchPx / 5 >= minMinorPitchPx) {\n        minorPitch = majorPitch / 5;\n    }\n    else if (!(majorPitch % 2) && majorPitchPx / 2 >= minMinorPitchPx) {\n        minorPitch = majorPitch / 2;\n    }\n    return { majorPitch: majorPitch, minorPitch: minorPitch };\n}\nexport function makeTicks(start, end, bpPerPx, emitMajor, emitMinor) {\n    var _a;\n    if (emitMajor === void 0) { emitMajor = true; }\n    if (emitMinor === void 0) { emitMinor = true; }\n    var gridPitch = chooseGridPitch(bpPerPx, 60, 15);\n    var minBase = start;\n    var maxBase = end;\n    if (minBase === null || maxBase === null) {\n        return [];\n    }\n    if (bpPerPx < 0) {\n        _a = [maxBase, minBase], minBase = _a[0], maxBase = _a[1];\n    }\n    // add 20px additional on the right and left to allow us to draw the ends of\n    // labels that lie a little outside our region\n    minBase -= Math.abs(20 * bpPerPx);\n    maxBase += Math.abs(20 * bpPerPx) + 1;\n    var iterPitch = gridPitch.minorPitch || gridPitch.majorPitch;\n    var index = 0;\n    var ticks = [];\n    for (var base = Math.ceil(minBase / iterPitch) * iterPitch; base < maxBase; base += iterPitch) {\n        if (emitMinor && base % (gridPitch.majorPitch * 2)) {\n            ticks.push({ type: 'minor', base: base - 1, index: index });\n            index += 1;\n        }\n        else if (emitMajor && !(base % (gridPitch.majorPitch * 2))) {\n            ticks.push({ type: 'major', base: base - 1, index: index });\n            index += 1;\n        }\n    }\n    return ticks;\n}\nfunction mathPower(num) {\n    if (num < 999) {\n        return String(num);\n    }\n    return \"\".concat(mathPower(~~(num / 1000)), \",\").concat(\"00\".concat(~~(num % 1000)).substr(-3, 3));\n}\nvar useStyles = makeStyles(function ( /* theme */) { return ({\n    majorTickLabel: {\n        fontSize: '11px',\n    },\n    majorTick: {\n        stroke: '#555',\n    },\n    minorTick: {\n        stroke: '#999',\n    },\n}); });\nfunction RulerBlock(_a) {\n    var start = _a.start, end = _a.end, bpPerPx = _a.bpPerPx, reversed = _a.reversed, major = _a.major, minor = _a.minor;\n    var classes = useStyles();\n    var ticks = makeTicks(start, end, bpPerPx, major, minor);\n    return (React.createElement(React.Fragment, null,\n        ticks.map(function (tick) {\n            var x = (reversed ? end - tick.base : tick.base - start) / bpPerPx;\n            return (React.createElement(\"line\", { key: tick.base, x1: x, x2: x, y1: 11, y2: tick.type === 'major' ? 11 + 6 : 11 + 4, strokeWidth: 1, stroke: tick.type === 'major' ? '#555' : '#999', className: tick.type === 'major' ? classes.majorTick : classes.minorTick, \"data-bp\": tick.base }));\n        }),\n        ticks\n            .filter(function (tick) { return tick.type === 'major'; })\n            .map(function (tick) {\n            var x = (reversed ? end - tick.base : tick.base - start) / bpPerPx;\n            return (React.createElement(\"text\", { x: x, y: 10, key: \"label-\".concat(tick.base), textAnchor: \"middle\", style: { fontSize: '11px' }, className: classes.majorTickLabel }, mathPower(tick.base + 1)));\n        })));\n}\nvar Ruler = observer(function (_a) {\n    var model = _a.model;\n    var MSA = model.MSA, colWidth = model.colWidth, msaAreaWidth = model.msaAreaWidth, resizeHandleWidth = model.resizeHandleWidth, scrollX = model.scrollX, blocksX = model.blocksX, blockSize = model.blockSize;\n    var ref = useRef(null);\n    var offsetX = blocksX[0];\n    return !MSA ? null : (React.createElement(\"div\", { ref: ref, style: {\n            position: 'relative',\n            width: msaAreaWidth,\n            cursor: 'crosshair',\n            overflow: 'hidden',\n            height: 20,\n            background: '#ccc',\n        } },\n        React.createElement(\"svg\", { style: {\n                width: blocksX.length * blockSize,\n                position: 'absolute',\n                left: scrollX + offsetX + resizeHandleWidth,\n                pointerEvents: 'none',\n            } },\n            React.createElement(RulerBlock, { key: offsetX, start: offsetX / colWidth, end: offsetX / colWidth + (blockSize * blocksX.length) / colWidth, bpPerPx: 1 / colWidth }))));\n});\nexport default Ruler;\n","import React from 'react';\nimport { observer } from 'mobx-react';\nvar TreeRuler = observer(function (_a) {\n    var model = _a.model;\n    var treeWidth = model.treeWidth;\n    return React.createElement(\"div\", { style: { width: treeWidth } });\n});\nexport default TreeRuler;\n","import React, { useState } from 'react';\nimport { observer } from 'mobx-react';\nimport { Button, Checkbox, Dialog, DialogActions, DialogTitle, DialogContent, FormControlLabel, MenuItem, TextField, } from '@material-ui/core';\nimport colorSchemes from '../colorSchemes';\nexport default observer(function (_a) {\n    var model = _a.model, onClose = _a.onClose, open = _a.open;\n    var rowHeightInit = model.rowHeight, colWidthInit = model.colWidth, treeWidthInit = model.treeWidth, colorSchemeName = model.colorSchemeName, noTree = model.noTree;\n    var _b = useState(\"\".concat(rowHeightInit)), rowHeight = _b[0], setRowHeight = _b[1];\n    var _c = useState(\"\".concat(colWidthInit)), colWidth = _c[0], setColWidth = _c[1];\n    var _d = useState(\"\".concat(treeWidthInit)), treeWidth = _d[0], setTreeWidth = _d[1];\n    function error(n) {\n        return Number.isNaN(+n) || +n < 0;\n    }\n    var rowHeightError = error(rowHeight);\n    var colWidthError = error(colWidth);\n    var treeWidthError = error(treeWidth);\n    return (React.createElement(Dialog, { onClose: function () { return onClose(); }, open: open },\n        React.createElement(DialogTitle, null, \"Settings\"),\n        React.createElement(DialogContent, null,\n            React.createElement(FormControlLabel, { control: React.createElement(Checkbox, { checked: model.showBranchLen, onChange: function () { return model.toggleBranchLen(); } }), label: \"Show branch length\" }),\n            React.createElement(FormControlLabel, { control: React.createElement(Checkbox, { checked: model.bgColor, onChange: function () { return model.toggleBgColor(); } }), label: \"Color background\" }),\n            React.createElement(FormControlLabel, { control: React.createElement(Checkbox, { checked: model.drawNodeBubbles, onChange: function () { return model.toggleNodeBubbles(); } }), label: \"Draw node bubbles\" }),\n            React.createElement(FormControlLabel, { control: React.createElement(Checkbox, { checked: model.drawTree, onChange: function () { return model.toggleDrawTree(); } }), label: \"Draw tree (if available)\" }),\n            React.createElement(FormControlLabel, { control: React.createElement(Checkbox, { checked: model.labelsAlignRight, onChange: function () { return model.toggleLabelsAlignRight(); } }), label: \"Labels align right (note: labels may draw over tree, but can adjust tree width or tree area width in UI)\" }),\n            React.createElement(TextField, { label: \"Row height (px)\", value: rowHeight, error: rowHeightError, onChange: function (event) { return setRowHeight(event.target.value); } }),\n            React.createElement(TextField, { label: \"Column width (px)\", value: colWidth, error: colWidthError, onChange: function (event) { return setColWidth(event.target.value); } }),\n            React.createElement(\"br\", null),\n            !noTree ? (React.createElement(TextField, { label: \"Tree width (px)\", value: treeWidth, error: treeWidthError, onChange: function (event) { return setTreeWidth(event.target.value); } })) : null,\n            React.createElement(\"br\", null),\n            React.createElement(TextField, { select: true, label: \"Color scheme\", value: colorSchemeName, onChange: function (event) { return model.setColorSchemeName(event.target.value); } }, Object.keys(colorSchemes).map(function (option) { return (React.createElement(MenuItem, { key: option, value: option }, option)); })),\n            React.createElement(DialogActions, null,\n                React.createElement(Button, { disabled: rowHeightError || colWidthError || treeWidthError, onClick: function () {\n                        model.setRowHeight(+rowHeight);\n                        model.setColWidth(+colWidth);\n                        if (!noTree) {\n                            model.setTreeWidth(+treeWidth);\n                        }\n                        onClose();\n                    }, variant: \"contained\", color: \"primary\" }, \"Submit\")))));\n});\n","import React, { useState } from 'react';\nimport { Dialog, DialogTitle, DialogContent, Typography, Link, } from '@material-ui/core';\nimport { version } from './package.json';\nfunction LicenseDialog(_a) {\n    var onClose = _a.onClose, open = _a.open;\n    return (React.createElement(Dialog, { onClose: function () { return onClose(); }, open: open },\n        React.createElement(DialogTitle, null, \"Biotite License\"),\n        React.createElement(DialogContent, null,\n            React.createElement(\"pre\", { style: { height: 100, overflow: 'auto' } }, \"\\nCopyright 2017 - 2020, The Biotite contributors\\nAll rights reserved.\\n\\nRedistribution and use in source and binary forms, with or without modification,\\nare permitted provided that the following conditions are met:\\n\\n1. Redistributions of source code must retain the above copyright notice, this\\nlist of conditions and the following disclaimer.\\n\\n2. Redistributions in binary form must reproduce the above copyright notice,\\nthis list of conditions and the following disclaimer in the documentation and/or\\nother materials provided with the distribution.\\n\\n3. Neither the name of the copyright holder nor the names of its contributors\\nmay be used to endorse or promote products derived from this software without\\nspecific prior written permission.\\n\\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \\\"AS IS\\\" AND\\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\\n        \"))));\n}\nexport default function AboutDialog(_a) {\n    var onClose = _a.onClose, open = _a.open;\n    var _b = useState(false), dlgOpen = _b[0], setDlgOpen = _b[1];\n    return (React.createElement(React.Fragment, null,\n        React.createElement(LicenseDialog, { onClose: function () { return setDlgOpen(false); }, open: dlgOpen }),\n        React.createElement(Dialog, { onClose: function () { return onClose(); }, open: open },\n            React.createElement(DialogTitle, null, \"About this plugin\"),\n            React.createElement(DialogContent, null,\n                React.createElement(Typography, null,\n                    \"MSAView \",\n                    version,\n                    \" (\",\n                    React.createElement(Link, { href: \"https://github.com/gmod/jbrowse-plugin-msaview\" }, \"Github\"),\n                    \")\"),\n                React.createElement(\"ul\", null,\n                    React.createElement(\"li\", null,\n                        React.createElement(Typography, null,\n                            \"We use some color schemes from the\",\n                            ' ',\n                            React.createElement(Link, { href: \"https://github.com/biotite-dev/biotite\" }, \"biotite\"),\n                            ' ',\n                            \"project, and their license is reproduced\",\n                            ' ',\n                            React.createElement(Link, { onClick: function () { return setDlgOpen(true); } }, \"here\"))),\n                    React.createElement(\"li\", null,\n                        React.createElement(Typography, null,\n                            \"See this page for some information on jalview colorings\",\n                            ' ',\n                            React.createElement(Link, { href: \"https://www.jalview.org/help/html/colourSchemes/\" }, \"here\"))),\n                    React.createElement(\"li\", null,\n                        React.createElement(Typography, null,\n                            \"See this page for some info on the clustal, cinema, maeditor, and lesk color schemes\",\n                            ' ',\n                            React.createElement(Link, { href: \"http://www.bioinformatics.nl/~berndb/aacolour.html\" }, \"here\"))),\n                    React.createElement(\"li\", null,\n                        React.createElement(Typography, null,\n                            \"See this paper about the flower color scheme\",\n                            ' ',\n                            React.createElement(Link, { href: \"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7245768/\" }, \"here\"))))))));\n}\n","import React from 'react';\nimport { Dialog, DialogTitle, DialogContent } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { Attributes } from '@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail';\nexport default observer(function (_a) {\n    var model = _a.model, onClose = _a.onClose, open = _a.open;\n    var alignmentDetails = model.alignmentDetails;\n    return (React.createElement(Dialog, { onClose: function () { return onClose(); }, open: open },\n        React.createElement(DialogTitle, null, \"Metadata\"),\n        React.createElement(DialogContent, null,\n            React.createElement(Attributes, { attributes: alignmentDetails }))));\n});\n","import React from 'react';\nimport { Dialog, DialogTitle, DialogContent, FormControlLabel, FormGroup, Checkbox, DialogActions, Button, Typography, } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nexport default observer(function (_a) {\n    var model = _a.model, onClose = _a.onClose, open = _a.open;\n    var tracks = model.tracks;\n    return (React.createElement(Dialog, { onClose: function () { return onClose(); }, open: open },\n        React.createElement(DialogTitle, null, \"Add track\"),\n        React.createElement(DialogContent, null,\n            React.createElement(Typography, null, \"Open relevant per-alignment tracks e.g. protein domains\"),\n            React.createElement(FormGroup, null, tracks.map(function (track) {\n                return (React.createElement(FormControlLabel, { key: track.model.id, control: React.createElement(Checkbox, { checked: !model.turnedOffTracks.has(track.model.id), onChange: function () {\n                            model.toggleTrack(track.model.id);\n                        } }), label: track.model.name }));\n            })),\n            React.createElement(DialogActions, null,\n                React.createElement(Button, { onClick: function () { return onClose(); }, variant: \"contained\", color: \"primary\" }, \"Close\")))));\n});\n","import React, { useState } from 'react';\nimport { IconButton, Select, Typography } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport SettingsDialog from './SettingsDlg';\nimport AboutDialog from './AboutDlg';\nimport DetailsDialog from './DetailsDlg';\nimport TracklistDialog from './TracklistDlg';\n//icons\nimport FolderOpenIcon from '@material-ui/icons/FolderOpen';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport HelpIcon from '@material-ui/icons/Help';\nimport AssignmentIcon from '@material-ui/icons/Assignment';\nimport ListIcon from '@material-ui/icons/List';\nvar InfoArea = observer(function (_a) {\n    var model = _a.model;\n    var mouseOverRowName = model.mouseOverRowName, mouseCol = model.mouseCol;\n    return (React.createElement(\"div\", null,\n        React.createElement(Typography, { display: \"inline\" },\n            \"Row name: \",\n            mouseOverRowName),\n        React.createElement(\"span\", { style: { marginLeft: 10 } }),\n        React.createElement(Typography, { display: \"inline\" },\n            \"Position: \",\n            mouseCol)));\n});\nvar Header = observer(function (_a) {\n    var model = _a.model;\n    var _b = useState(false), settingsDialogVisible = _b[0], setSettingsDialogVisible = _b[1];\n    var _c = useState(false), aboutDialogVisible = _c[0], setAboutDialogVisible = _c[1];\n    var _d = useState(false), detailsDialogVisible = _d[0], setDetailsDialogVisible = _d[1];\n    var _e = useState(false), tracklistDialogVisible = _e[0], setTracklistDialogVisible = _e[1];\n    var currentAlignment = model.currentAlignment, alignmentNames = model.alignmentNames;\n    return (React.createElement(\"div\", { style: { display: 'flex' } },\n        React.createElement(IconButton, { onClick: function () {\n                model.setData({ tree: '', msa: '' });\n                model.setTreeFilehandle(undefined);\n                model.setMSAFilehandle(undefined);\n                model.setScrollY(0);\n                model.setScrollX(0);\n                model.setCurrentAlignment(0);\n            } },\n            React.createElement(FolderOpenIcon, null)),\n        React.createElement(IconButton, { onClick: function () { return setSettingsDialogVisible(true); } },\n            React.createElement(SettingsIcon, null)),\n        React.createElement(IconButton, { onClick: function () { return setDetailsDialogVisible(true); } },\n            React.createElement(AssignmentIcon, null)),\n        React.createElement(IconButton, { onClick: function () { return setTracklistDialogVisible(true); } },\n            React.createElement(ListIcon, null)),\n        settingsDialogVisible ? (React.createElement(SettingsDialog, { open: true, model: model, onClose: function () { return setSettingsDialogVisible(false); } })) : null,\n        aboutDialogVisible ? (React.createElement(AboutDialog, { open: true, onClose: function () { return setAboutDialogVisible(false); } })) : null,\n        detailsDialogVisible ? (React.createElement(DetailsDialog, { open: true, model: model, onClose: function () { return setDetailsDialogVisible(false); } })) : null,\n        tracklistDialogVisible ? (React.createElement(TracklistDialog, { open: true, model: model, onClose: function () { return setTracklistDialogVisible(false); } })) : null,\n        alignmentNames.length > 0 ? (React.createElement(Select, { native: true, value: currentAlignment, onChange: function (event) {\n                model.setCurrentAlignment(+event.target.value);\n                model.setScrollX(0);\n                model.setScrollY(0);\n            } }, alignmentNames.map(function (option, index) { return (React.createElement(\"option\", { key: \"\".concat(option, \"-\").concat(index), value: index }, option)); }))) : null,\n        React.createElement(InfoArea, { model: model }),\n        React.createElement(\"div\", { style: { flex: 1 } }),\n        React.createElement(IconButton, { onClick: function () { return setAboutDialogVisible(true); } },\n            React.createElement(HelpIcon, null))));\n});\nexport default Header;\n","import React, { useState } from 'react';\nimport copy from 'copy-to-clipboard';\nimport { observer } from 'mobx-react';\nimport { Button, Dialog, DialogActions, DialogTitle, DialogContent, makeStyles, } from '@material-ui/core';\nvar useStyles = makeStyles(function (theme) { return ({\n    textArea: {\n        padding: theme.spacing(2),\n        overflow: 'auto',\n        background: '#ddd',\n        wordBreak: 'break-word',\n    },\n}); });\nvar TrackInfoDialog = observer(function (_a) {\n    var model = _a.model, onClose = _a.onClose;\n    var _b = useState('Copy to clipboard'), label = _b[0], setLabel = _b[1];\n    var classes = useStyles();\n    return (React.createElement(Dialog, { open: true, onClose: onClose, fullWidth: true, maxWidth: \"lg\" },\n        React.createElement(DialogTitle, null,\n            \"Track info - \",\n            model.name),\n        React.createElement(DialogContent, null,\n            React.createElement(Button, { variant: \"contained\", color: \"primary\", onClick: function () {\n                    copy(model.data);\n                    setLabel('Copied!');\n                    setTimeout(function () {\n                        setLabel('Copy to clipboard');\n                    }, 300);\n                } }, label),\n            React.createElement(\"pre\", { className: classes.textArea }, model.data)),\n        React.createElement(DialogActions, null,\n            React.createElement(Button, { variant: \"contained\", onClick: onClose, color: \"secondary\" }, \"Close\"))));\n});\nexport default TrackInfoDialog;\n","import React, { useState, useRef, useEffect } from 'react';\nimport normalizeWheel from 'normalize-wheel';\nimport { observer } from 'mobx-react';\nimport { IconButton, Menu, MenuItem, makeStyles } from '@material-ui/core';\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\nimport TrackInfoDialog from './TrackInfoDlg';\nvar useStyles = makeStyles(function () { return ({\n    button: {\n        padding: 0,\n    },\n}); });\nexport var TrackLabel = observer(function (_a) {\n    var model = _a.model, track = _a.track;\n    var _b = useState(), anchorEl = _b[0], setAnchorEl = _b[1];\n    var _c = useState(false), trackInfoDlgOpen = _c[0], setTrackInfoDlgOpen = _c[1];\n    var rowHeight = model.rowHeight, width = model.treeAreaWidth;\n    var height = track.height, name = track.model.name;\n    var classes = useStyles();\n    var trackLabelHeight = Math.max(8, rowHeight - 8);\n    return (React.createElement(\"div\", { style: {\n            width: width,\n            height: height,\n            flexShrink: 0,\n            textAlign: 'right',\n            fontSize: trackLabelHeight,\n        } },\n        name,\n        React.createElement(IconButton, { className: classes.button, style: { width: trackLabelHeight, height: trackLabelHeight }, onClick: function (event) {\n                setAnchorEl(event.target);\n            } },\n            React.createElement(ArrowDropDownIcon, null)),\n        anchorEl ? (React.createElement(Menu, { anchorEl: anchorEl, transitionDuration: 0, open: true, onClose: function () {\n                setAnchorEl(undefined);\n            } },\n            React.createElement(MenuItem, { dense: true, onClick: function () {\n                    model.toggleTrack(track.model.id);\n                    setAnchorEl(undefined);\n                } }, \"Close\"),\n            React.createElement(MenuItem, { dense: true, onClick: function () {\n                    setTrackInfoDlgOpen(true);\n                    setAnchorEl(undefined);\n                } }, \"Get info\"))) : null,\n        trackInfoDlgOpen ? (React.createElement(TrackInfoDialog, { model: track.model, onClose: function () { return setTrackInfoDlgOpen(false); } })) : null));\n});\nvar Track = observer(function (_a) {\n    var model = _a.model, track = _a.track;\n    var resizeHandleWidth = model.resizeHandleWidth;\n    var height = track.model.height;\n    var ref = useRef(null);\n    var scheduled = useRef(false);\n    var deltaX = useRef(0);\n    useEffect(function () {\n        var curr = ref.current;\n        if (!curr) {\n            return;\n        }\n        function onWheel(origEvent) {\n            var event = normalizeWheel(origEvent);\n            deltaX.current += event.pixelX;\n            if (!scheduled.current) {\n                scheduled.current = true;\n                requestAnimationFrame(function () {\n                    model.doScrollX(-deltaX.current);\n                    deltaX.current = 0;\n                    scheduled.current = false;\n                });\n            }\n            origEvent.preventDefault();\n        }\n        curr.addEventListener('wheel', onWheel);\n        return function () {\n            curr.removeEventListener('wheel', onWheel);\n        };\n    }, [model]);\n    return (React.createElement(\"div\", { key: track.id, style: { display: 'flex', height: height } },\n        React.createElement(TrackLabel, { model: model, track: track }),\n        React.createElement(\"div\", { style: { width: resizeHandleWidth, flexShrink: 0 } }),\n        React.createElement(\"div\", { ref: ref },\n            React.createElement(track.ReactComponent, { model: model, track: track }))));\n});\nexport default Track;\n","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport React, { useState } from 'react';\nimport { observer } from 'mobx-react';\nimport { Button, Dialog, DialogActions, DialogTitle, DialogContent, IconButton, TextField, Typography, } from '@material-ui/core';\nimport DeleteIcon from '@material-ui/icons/Delete';\nvar specialFromEntries = function (val) {\n    var ret = {};\n    val.forEach(function (_a) {\n        var key = _a[0], val = _a[1];\n        if (!ret[key])\n            ret[key] = [];\n        ret[key].push(val);\n    });\n    return ret;\n};\nvar Row = observer(function (_a) {\n    var name = _a.name, value = _a.value, setValue = _a.setValue, setName = _a.setName, onDelete = _a.onDelete;\n    return (React.createElement(\"div\", null,\n        React.createElement(IconButton, { onClick: onDelete, style: { margin: 10 } },\n            React.createElement(DeleteIcon, null)),\n        React.createElement(TextField, { value: name, onChange: function (event) { return setName(event.target.value); }, label: \"Key\" }),\n        React.createElement(TextField, { value: value, onChange: function (event) { return setValue(event.target.value); }, label: \"Value\" })));\n});\nexport default observer(function (_a) {\n    var onClose = _a.onClose, data = _a.data, model = _a.model;\n    var blanks = model.blanks;\n    var l = data.left, r = data.right;\n    var _b = useState([\n        ['Name', ''],\n        ['ID', ''],\n        ['Note', ''],\n    ]), rows = _b[0], setRows = _b[1];\n    return (React.createElement(Dialog, { onClose: function () { return onClose(); }, open: true },\n        React.createElement(DialogTitle, null, \"Create new region annotation\"),\n        React.createElement(DialogContent, null,\n            React.createElement(Typography, null,\n                \"Do you want to add an annotation to the MSA at \",\n                l,\n                \"..\",\n                r,\n                ' ',\n                blanks.length\n                    ? \" (gapped \".concat(model.getPos(l), \"..\").concat(model.getPos(r))\n                    : ''),\n            rows.map(function (_a, index) {\n                var key = _a[0], val = _a[1];\n                return (React.createElement(Row, { key: index, name: key, value: val, setValue: function (newValue) {\n                        var newRows = __spreadArray([], rows, true);\n                        newRows[index][1] = newValue;\n                        setRows(newRows);\n                    }, setName: function (newName) {\n                        var newRows = __spreadArray([], rows, true);\n                        newRows[index][0] = newName;\n                        setRows(newRows);\n                    }, onDelete: function () {\n                        rows.splice(index, 1);\n                        setRows(__spreadArray([], rows, true));\n                    } }));\n            }),\n            React.createElement(Button, { onClick: function () {\n                    setRows(__spreadArray(__spreadArray([], rows, true), [['', '']], false));\n                } }, \"Add row\"),\n            React.createElement(DialogActions, null,\n                React.createElement(Button, { onClick: function () {\n                        model.addAnnotation(l, r, specialFromEntries(rows));\n                        onClose();\n                    }, variant: \"contained\", color: \"primary\" }, \"Submit\"),\n                React.createElement(Button, { variant: \"contained\", color: \"secondary\", onClick: function () { return onClose(); } }, \"Cancel\")))));\n});\n","import React, { useEffect, useRef, useState } from 'react';\nimport { observer } from 'mobx-react';\nexport var VerticalResizeHandle = observer(function (_a) {\n    var model = _a.model;\n    var resizeHandleWidth = model.resizeHandleWidth;\n    var _b = useState(false), mouseDragging = _b[0], setMouseDragging = _b[1];\n    var scheduled = useRef(false);\n    var prevX = useRef(0);\n    useEffect(function () {\n        function globalMouseMove(event) {\n            event.preventDefault();\n            var currX = event.clientX;\n            if (prevX.current === 0) {\n                prevX.current = event.clientX;\n            }\n            else {\n                var distance_1 = currX - prevX.current;\n                if (distance_1) {\n                    // use rAF to make it so multiple event handlers aren't fired per-frame\n                    // see https://calendar.perfplanet.com/2013/the-runtime-performance-checklist/\n                    if (!scheduled.current) {\n                        scheduled.current = true;\n                        window.requestAnimationFrame(function () {\n                            model.setTreeAreaWidth(model.treeAreaWidth + distance_1);\n                            scheduled.current = false;\n                            prevX.current = event.clientX;\n                        });\n                    }\n                }\n            }\n        }\n        function globalMouseUp() {\n            prevX.current = 0;\n            if (mouseDragging) {\n                setMouseDragging(false);\n            }\n        }\n        if (mouseDragging) {\n            document.addEventListener('mousemove', globalMouseMove, true);\n            document.addEventListener('mouseup', globalMouseUp, true);\n            return function () {\n                document.removeEventListener('mousemove', globalMouseMove, true);\n                document.removeEventListener('mouseup', globalMouseUp, true);\n            };\n        }\n        return function () { };\n    }, [mouseDragging, model]);\n    return (React.createElement(\"div\", null,\n        React.createElement(\"div\", { onMouseDown: function () { return setMouseDragging(true); }, style: {\n                cursor: 'ew-resize',\n                height: '100%',\n                width: resizeHandleWidth,\n                background: \"rgba(200,200,200)\",\n                position: 'relative',\n            } })));\n});\nexport var HorizontalResizeHandle = observer(function (_a) {\n    var model = _a.model;\n    var resizeHandleWidth = model.resizeHandleWidth;\n    var _b = useState(false), mouseDragging = _b[0], setMouseDragging = _b[1];\n    var scheduled = useRef(false);\n    var prevY = useRef(0);\n    useEffect(function () {\n        function globalMouseMove(event) {\n            event.preventDefault();\n            var currY = event.clientY;\n            if (prevY.current === 0) {\n                prevY.current = event.clientY;\n            }\n            else {\n                var distance_2 = currY - prevY.current;\n                if (distance_2) {\n                    // use rAF to make it so multiple event handlers aren't fired per-frame\n                    // see https://calendar.perfplanet.com/2013/the-runtime-performance-checklist/\n                    if (!scheduled.current) {\n                        scheduled.current = true;\n                        window.requestAnimationFrame(function () {\n                            model.setHeight(model.height + distance_2);\n                            scheduled.current = false;\n                            prevY.current = event.clientY;\n                        });\n                    }\n                }\n            }\n        }\n        function globalMouseUp() {\n            prevY.current = 0;\n            if (mouseDragging) {\n                setMouseDragging(false);\n            }\n        }\n        if (mouseDragging) {\n            document.addEventListener('mousemove', globalMouseMove, true);\n            document.addEventListener('mouseup', globalMouseUp, true);\n            return function () {\n                document.removeEventListener('mousemove', globalMouseMove, true);\n                document.removeEventListener('mouseup', globalMouseUp, true);\n            };\n        }\n        return function () { };\n    }, [mouseDragging, model]);\n    return (React.createElement(\"div\", null,\n        React.createElement(\"div\", { onMouseDown: function () { return setMouseDragging(true); }, style: {\n                cursor: 'ns-resize',\n                width: '100%',\n                height: resizeHandleWidth,\n                background: \"rgba(200,200,200)\",\n                position: 'relative',\n            } })));\n});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport React, { useRef, useEffect } from 'react';\nimport { observer } from 'mobx-react';\nimport { Typography } from '@material-ui/core';\nimport ImportForm from './ImportForm';\nimport Rubberband from './Rubberband';\nimport TreeCanvas from './TreeCanvas';\nimport MSACanvas from './MSACanvas';\nimport Ruler from './Ruler';\nimport TreeRuler from './TreeRuler';\nimport Header from './Header';\nimport Track from './Track';\nimport AnnotationDialog from './AnnotationDlg';\nimport { HorizontalResizeHandle, VerticalResizeHandle } from './ResizeHandles';\nvar MouseoverCanvas = observer(function (_a) {\n    var model = _a.model;\n    var ref = useRef(null);\n    var height = model.height, width = model.width, treeAreaWidth = model.treeAreaWidth, resizeHandleWidth = model.resizeHandleWidth, scrollX = model.scrollX, mouseCol = model.mouseCol, colWidth = model.colWidth;\n    useEffect(function () {\n        if (!ref.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        ctx.resetTransform();\n        ctx.clearRect(0, 0, width, height);\n        if (mouseCol !== undefined) {\n            var x = (mouseCol - 1) * colWidth + scrollX + treeAreaWidth + resizeHandleWidth;\n            ctx.fillStyle = 'rgba(100,100,100,0.5)';\n            ctx.fillRect(x, 0, colWidth, height);\n        }\n    }, [\n        mouseCol,\n        colWidth,\n        scrollX,\n        height,\n        resizeHandleWidth,\n        treeAreaWidth,\n        width,\n    ]);\n    return (React.createElement(\"canvas\", { ref: ref, width: width, height: height, style: {\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            width: width,\n            height: height,\n            zIndex: 1000,\n            pointerEvents: 'none',\n        } }));\n});\nexport default observer(function (_a) {\n    var model = _a.model;\n    var done = model.done, initialized = model.initialized, treeAreaWidth = model.treeAreaWidth, height = model.height, resizeHandleWidth = model.resizeHandleWidth, turnedOnTracks = model.turnedOnTracks;\n    return (React.createElement(\"div\", null,\n        !initialized ? (React.createElement(ImportForm, { model: model })) : !done ? (React.createElement(Typography, { variant: \"h4\" }, \"Loading...\")) : (React.createElement(\"div\", null,\n            React.createElement(\"div\", { style: { height: height, overflow: 'hidden' } },\n                React.createElement(Header, { model: model }),\n                React.createElement(\"div\", null,\n                    React.createElement(\"div\", { style: { position: 'relative' } },\n                        React.createElement(\"div\", { style: { display: 'flex' } },\n                            React.createElement(\"div\", { style: { flexShrink: 0, width: treeAreaWidth } },\n                                React.createElement(TreeRuler, { model: model })),\n                            React.createElement(Rubberband, { model: model, ControlComponent: React.createElement(Ruler, { model: model }) })), turnedOnTracks === null || turnedOnTracks === void 0 ? void 0 :\n                        turnedOnTracks.map(function (track) { return (React.createElement(Track, { key: track.model.id, model: model, track: track })); }),\n                        React.createElement(\"div\", { style: { display: 'flex' } },\n                            React.createElement(\"div\", { style: { flexShrink: 0, width: treeAreaWidth } },\n                                React.createElement(TreeCanvas, { model: model })),\n                            React.createElement(VerticalResizeHandle, { model: model }),\n                            React.createElement(MSACanvas, { model: model }),\n                            React.createElement(MouseoverCanvas, { model: model }))))),\n            React.createElement(HorizontalResizeHandle, { model: model }))),\n        model.DialogComponent ? (React.createElement(model.DialogComponent, __assign({}, (model.DialogProps || {}), { onClose: function () {\n                model.setDialogComponent(undefined, undefined);\n            } }))) : null,\n        model.annotPos ? (React.createElement(AnnotationDialog, { data: model.annotPos, model: model, onClose: function () { return model.clearAnnotPos(); } })) : null));\n});\n","import { parse } from 'clustal-js';\nvar ClustalMSA = /** @class */ (function () {\n    function ClustalMSA(text) {\n        this.MSA = parse(text);\n    }\n    ClustalMSA.prototype.getMSA = function () {\n        return this.MSA;\n    };\n    ClustalMSA.prototype.getRow = function (name) {\n        var _a;\n        return (_a = this.MSA.alns.find(function (aln) { return aln.id === name; })) === null || _a === void 0 ? void 0 : _a.seq.split('');\n    };\n    ClustalMSA.prototype.getWidth = function () {\n        return this.MSA.alns[0].seq.length;\n    };\n    ClustalMSA.prototype.getDetails = function () {\n        return this.MSA.header;\n    };\n    ClustalMSA.prototype.getNames = function () {\n        return this.MSA.alns.map(function (aln) { return aln.id; });\n    };\n    ClustalMSA.prototype.getStructures = function () {\n        return {};\n    };\n    Object.defineProperty(ClustalMSA.prototype, \"alignmentNames\", {\n        get: function () {\n            return [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ClustalMSA.prototype.getTree = function () {\n        return {\n            id: 'root',\n            noTree: true,\n            branchset: this.getNames().map(function (name) { return ({ id: name, name: name }); }),\n        };\n    };\n    Object.defineProperty(ClustalMSA.prototype, \"seqConsensus\", {\n        get: function () {\n            return this.MSA.consensus;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ClustalMSA.prototype, \"secondaryStructureConsensus\", {\n        get: function () {\n            return undefined;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ClustalMSA.prototype, \"tracks\", {\n        get: function () {\n            var _a;\n            return ((_a = this.seqConsensus) === null || _a === void 0 ? void 0 : _a.trim())\n                ? [\n                    {\n                        id: 'seqConsensus',\n                        name: 'Sequence consensus',\n                        data: this.seqConsensus,\n                        customColorScheme: {\n                            '*': 'white',\n                            ':': 'grey',\n                            '.': 'darkgrey',\n                            ' ': 'black',\n                        },\n                    },\n                ]\n                : [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ClustalMSA;\n}());\nexport default ClustalMSA;\n","/**\n * Newick format parser in JavaScript.\n *\n * Copyright (c) Jason Davies 2010.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n * Example tree (from http://en.wikipedia.org/wiki/Newick_format):\n *\n * +--0.1--A\n * F-----0.2-----B            +-------0.3----C\n * +------------------0.5-----E\n *                            +---------0.4------D\n *\n * Newick format:\n * (A:0.1,B:0.2,(C:0.3,D:0.4)E:0.5)F;\n *\n * Converted to JSON:\n * {\n *   name: \"F\",\n *   branchset: [\n *     {name: \"A\", length: 0.1},\n *     {name: \"B\", length: 0.2},\n *     {\n *       name: \"E\",\n *       length: 0.5,\n *       branchset: [\n *         {name: \"C\", length: 0.3},\n *         {name: \"D\", length: 0.4}\n *       ]\n *     }\n *   ]\n * }\n *\n * Converted to JSON, but with no names or lengths:\n * {\n *   branchset: [\n *     {}, {}, {\n *       branchset: [{}, {}]\n *     }\n *   ]\n * }\n */\nexport default function parse(s) {\n    var ancestors = [];\n    var tree = {};\n    var tokens = s.split(/\\s*(;|\\(|\\)|,|:)\\s*/);\n    for (var i = 0; i < tokens.length; i++) {\n        var token = tokens[i];\n        var subtree = {};\n        switch (token) {\n            case '(': // new branchset\n                tree.branchset = [subtree];\n                ancestors.push(tree);\n                tree = subtree;\n                break;\n            case ',': // another branch\n                ancestors[ancestors.length - 1].branchset.push(subtree);\n                tree = subtree;\n                break;\n            case ')': // optional name next\n                tree = ancestors.pop();\n                break;\n            case ':': // optional length next\n                break;\n            default: {\n                var x = tokens[i - 1];\n                if (x === ')' || x === '(' || x === ',') {\n                    tree.name = token;\n                }\n                else if (x === ':') {\n                    tree.length = parseFloat(token);\n                }\n            }\n        }\n    }\n    return tree;\n}\n","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport Stockholm from 'stockholm-js';\nimport parseNewick from '../parseNewick';\nimport { generateNodeIds } from '../util';\nvar StockholmMSA = /** @class */ (function () {\n    function StockholmMSA(text, currentAlignment) {\n        var res = Stockholm.parseAll(text);\n        this.data = res;\n        this.MSA = res[currentAlignment];\n    }\n    StockholmMSA.prototype.getMSA = function () {\n        return this.MSA;\n    };\n    StockholmMSA.prototype.getRow = function (name) {\n        var _a, _b;\n        return (_b = (_a = this.MSA) === null || _a === void 0 ? void 0 : _a.seqdata[name]) === null || _b === void 0 ? void 0 : _b.split('');\n    };\n    StockholmMSA.prototype.getWidth = function () {\n        var _a;\n        var name = Object.keys((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.seqdata)[0];\n        return this.getRow(name).length;\n    };\n    Object.defineProperty(StockholmMSA.prototype, \"alignmentNames\", {\n        get: function () {\n            return this.data.map(function (aln, index) { var _a; return ((_a = aln.gf.DE) === null || _a === void 0 ? void 0 : _a[0]) || \"Alignment \".concat(index + 1); });\n        },\n        enumerable: false,\n        configurable: true\n    });\n    StockholmMSA.prototype.getDetails = function () {\n        var _a, _b;\n        return {\n            General: this.MSA.gf,\n            Accessions: (_a = this.MSA.gs) === null || _a === void 0 ? void 0 : _a.AC,\n            Dbxref: (_b = this.MSA.gs) === null || _b === void 0 ? void 0 : _b.DR,\n        };\n    };\n    StockholmMSA.prototype.getRowDetails = function (rowName) {\n        var _a, _b;\n        return {\n            name: rowName,\n            accession: (_a = this.MSA.gs) === null || _a === void 0 ? void 0 : _a.AC[rowName],\n            dbxref: (_b = this.MSA.gs) === null || _b === void 0 ? void 0 : _b.DR[rowName],\n        };\n    };\n    StockholmMSA.prototype.getNames = function () {\n        return Object.keys(this.MSA.seqdata);\n    };\n    StockholmMSA.prototype.getSeqCoords = function () { };\n    StockholmMSA.prototype.getStructures = function () {\n        var _a;\n        var pdbRegex = /PDB; +(\\S+) +(\\S); ([0-9]+)-([0-9]+)/;\n        var ent = this.MSA;\n        return Object.entries(((_a = ent.gs) === null || _a === void 0 ? void 0 : _a.DR) || {})\n            .map(function (_a) {\n            var id = _a[0], dr = _a[1];\n            return [id, pdbRegex.exec(dr)];\n        })\n            .filter(function (item) { return !!item[1]; })\n            .map(function (_a) {\n            var id = _a[0], match = _a[1];\n            var pdb = match[1].toLowerCase();\n            var chain = match[2];\n            var startPos = +match[3];\n            var endPos = +match[4];\n            return { id: id, pdb: pdb, chain: chain, startPos: startPos, endPos: endPos };\n        })\n            .reduce(function (a, b) {\n            var id = b.id, rest = __rest(b, [\"id\"]);\n            if (!a[id]) {\n                a[id] = [];\n            }\n            a[id].push(rest);\n            return a;\n        }, {});\n    };\n    StockholmMSA.prototype.getTree = function () {\n        var _a, _b, _c;\n        var tree = (_c = (_b = (_a = this.MSA) === null || _a === void 0 ? void 0 : _a.gf) === null || _b === void 0 ? void 0 : _b.NH) === null || _c === void 0 ? void 0 : _c[0];\n        return tree\n            ? generateNodeIds(parseNewick(tree))\n            : {\n                id: 'root',\n                noTree: true,\n                branchset: this.getNames().map(function (name) { return ({\n                    id: name,\n                    name: name,\n                }); }),\n            };\n    };\n    Object.defineProperty(StockholmMSA.prototype, \"seqConsensus\", {\n        get: function () {\n            var _a;\n            return (_a = this.MSA.gc) === null || _a === void 0 ? void 0 : _a.seq_cons;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(StockholmMSA.prototype, \"secondaryStructureConsensus\", {\n        get: function () {\n            var _a;\n            return (_a = this.MSA.gc) === null || _a === void 0 ? void 0 : _a.SS_cons;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(StockholmMSA.prototype, \"tracks\", {\n        get: function () {\n            return [\n                {\n                    id: 'seqConsensus',\n                    name: 'Sequence consensus',\n                    data: this.seqConsensus,\n                    customColorScheme: {},\n                },\n                {\n                    id: 'secondaryStruct',\n                    name: 'Secondary-structure',\n                    data: this.secondaryStructureConsensus,\n                    customColorScheme: {\n                        '>': 'pink',\n                        '<': 'lightblue',\n                    },\n                },\n            ];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return StockholmMSA;\n}());\nexport default StockholmMSA;\n","var FastaMSA = /** @class */ (function () {\n    function FastaMSA(text) {\n        var seq = {};\n        var name = '';\n        var re = /^>(\\S+)/;\n        text.split('\\n').forEach(function (line) {\n            var match = re.exec(line);\n            if (match) {\n                seq[(name = match[1])] = '';\n            }\n            else if (name) {\n                seq[name] = seq[name] + line.replace(/[ \\t]/g, '');\n            }\n        });\n        this.MSA = { seqdata: seq };\n    }\n    FastaMSA.prototype.getMSA = function () {\n        return this.MSA;\n    };\n    FastaMSA.prototype.getNames = function () {\n        return Object.keys(this.MSA.seqdata);\n    };\n    FastaMSA.prototype.getRow = function (name) {\n        var _a, _b;\n        return (_b = (_a = this.MSA) === null || _a === void 0 ? void 0 : _a.seqdata[name]) === null || _b === void 0 ? void 0 : _b.split('');\n    };\n    FastaMSA.prototype.getWidth = function () {\n        var _a;\n        var name = Object.keys((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.seqdata)[0];\n        return this.getRow(name).length;\n    };\n    FastaMSA.prototype.getStructures = function () {\n        return {};\n    };\n    Object.defineProperty(FastaMSA.prototype, \"alignmentNames\", {\n        get: function () {\n            return [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    FastaMSA.prototype.getDetails = function () {\n        return {};\n    };\n    FastaMSA.prototype.getTree = function () {\n        return {\n            id: 'root',\n            noTree: true,\n            branchset: this.getNames().map(function (name) { return ({\n                id: name,\n                name: name,\n            }); }),\n        };\n    };\n    Object.defineProperty(FastaMSA.prototype, \"seqConsensus\", {\n        get: function () {\n            return undefined;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FastaMSA.prototype, \"secondaryStructureConsensus\", {\n        get: function () {\n            return undefined;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FastaMSA.prototype, \"tracks\", {\n        get: function () {\n            return [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return FastaMSA;\n}());\nexport default FastaMSA;\n","import React, { useRef, useMemo, useEffect } from 'react';\nimport { useTheme } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { colorContrast } from '../util';\nvar AnnotationBlock = observer(function (_a) {\n    var track = _a.track, model = _a.model, offsetX = _a.offsetX;\n    var blockSize = model.blockSize, scrollX = model.scrollX, bgColor = model.bgColor, modelColorScheme = model.colorScheme, colWidth = model.colWidth, rowHeight = model.rowHeight, highResScaleFactor = model.highResScaleFactor;\n    var _b = track.model, customColorScheme = _b.customColorScheme, data = _b.data;\n    var colorScheme = customColorScheme || modelColorScheme;\n    var theme = useTheme();\n    var ref = useRef(null);\n    var contrastScheme = useMemo(function () { return colorContrast(colorScheme, theme); }, [colorScheme, theme]);\n    useEffect(function () {\n        if (!ref.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        // this logic is very similar to MSACanvas\n        ctx.resetTransform();\n        ctx.scale(highResScaleFactor, highResScaleFactor);\n        ctx.clearRect(0, 0, blockSize, rowHeight);\n        ctx.translate(-offsetX, 0);\n        ctx.textAlign = 'center';\n        ctx.font = ctx.font.replace(/\\d+px/, \"\".concat(Math.max(8, rowHeight - 8), \"px\"));\n        var xStart = Math.max(0, Math.floor(offsetX / colWidth));\n        var xEnd = Math.max(0, Math.ceil((offsetX + blockSize) / colWidth));\n        var str = data === null || data === void 0 ? void 0 : data.slice(xStart, xEnd);\n        for (var i = 0; str && i < str.length; i++) {\n            var letter = str[i];\n            var color = colorScheme[letter.toUpperCase()];\n            if (bgColor) {\n                var x = i * colWidth + offsetX - (offsetX % colWidth);\n                ctx.fillStyle = color || 'white';\n                ctx.fillRect(x, 0, colWidth, rowHeight);\n                if (rowHeight >= 10 && colWidth >= rowHeight / 2) {\n                    ctx.fillStyle = contrastScheme[letter.toUpperCase()] || 'black';\n                    ctx.fillText(letter, x + colWidth / 2, rowHeight / 2 + 1); //+1 to avoid cutoff at height:10\n                }\n            }\n        }\n    }, [\n        bgColor,\n        blockSize,\n        colWidth,\n        rowHeight,\n        offsetX,\n        contrastScheme,\n        colorScheme,\n        highResScaleFactor,\n        data,\n    ]);\n    return (React.createElement(\"canvas\", { ref: ref, height: rowHeight * highResScaleFactor, width: blockSize * highResScaleFactor, style: {\n            position: 'absolute',\n            left: scrollX + offsetX,\n            width: blockSize,\n            height: rowHeight,\n        } }));\n});\nvar AnnotationTrack = observer(function (_a) {\n    var track = _a.track, model = _a.model;\n    var blocksX = model.blocksX, msaAreaWidth = model.msaAreaWidth, rowHeight = model.rowHeight;\n    return (React.createElement(\"div\", { style: {\n            position: 'relative',\n            height: rowHeight,\n            width: msaAreaWidth,\n            overflow: 'hidden',\n        } }, blocksX.map(function (bx) { return (React.createElement(AnnotationBlock, { key: bx, track: track, model: model, offsetX: bx })); })));\n});\nexport default AnnotationTrack;\n","import RBush from 'rbush';\nvar Layout = /** @class */ (function () {\n    function Layout(_a) {\n        var _b = _a === void 0 ? {} : _a, _c = _b.maxHeight, maxHeight = _c === void 0 ? 10000 : _c;\n        this.maxHeightReached = false;\n        this.rbush = new RBush();\n        this.rectangles = new Map();\n        this.maxHeight = Math.ceil(maxHeight);\n        this.pTotalHeight = 0; // total height, in units of bitmap squares (px/pitchY)\n    }\n    /**\n     * @returns top position for the rect, or Null if laying\n     *  out the rect would exceed maxHeighe\n     */\n    Layout.prototype.addRect = function (id, left, right, height, data) {\n        // add to rbush\n        var existingRecord = this.rectangles.get(id);\n        if (existingRecord) {\n            return existingRecord.minY;\n        }\n        var currHeight = 0;\n        while (this.rbush.collides({\n            minX: left,\n            minY: currHeight,\n            maxX: right,\n            maxY: currHeight + height,\n        }) &&\n            currHeight <= this.maxHeight) {\n            currHeight += 1;\n        }\n        var record = {\n            minX: left,\n            minY: currHeight,\n            maxX: right,\n            maxY: currHeight + height,\n            id: id,\n            data: data,\n        };\n        this.rbush.insert(record);\n        this.rectangles.set(id, record);\n        this.pTotalHeight = Math.max(this.pTotalHeight, currHeight);\n        return currHeight;\n    };\n    Object.defineProperty(Layout.prototype, \"totalHeight\", {\n        get: function () {\n            return this.pTotalHeight;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return Layout;\n}());\nexport default Layout;\n","import React, { useRef, useMemo, useEffect } from 'react';\nimport { observer } from 'mobx-react';\nimport { getSnapshot, isStateTreeNode } from 'mobx-state-tree';\nimport Layout from '../layout';\nvar AnnotationBlock = observer(function (_a) {\n    var track = _a.track, model = _a.model, offsetX = _a.offsetX;\n    var blockSize = model.blockSize, colWidth = model.colWidth, blanks = model.blanks, rowHeight = model.rowHeight, highResScaleFactor = model.highResScaleFactor, scrollX = model.scrollX;\n    var _b = track.model, height = _b.height, features = _b.features, associatedRowName = _b.associatedRowName;\n    var feats = isStateTreeNode(features)\n        ? getSnapshot(features)\n        : features;\n    var layout = useMemo(function () {\n        var temp = new Layout();\n        feats === null || feats === void 0 ? void 0 : feats.forEach(function (feature, index) {\n            var start = feature.start, end = feature.end;\n            if (associatedRowName) {\n                var s = model.rowSpecificBpToPx(associatedRowName, start - 1);\n                var e = model.rowSpecificBpToPx(associatedRowName, end);\n                temp.addRect(\"\".concat(index), s, e, rowHeight, feature);\n            }\n            else {\n                var s = model.globalBpToPx(start - 1);\n                var e = model.globalBpToPx(end);\n                temp.addRect(\"\".concat(index), s, e, rowHeight, feature);\n            }\n        });\n        return temp;\n    }, [rowHeight, feats, associatedRowName, model, blanks]);\n    var ref = useRef(null);\n    var labelRef = useRef(null);\n    var mouseoverRef = useRef(null);\n    useEffect(function () {\n        if (!ref.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        ctx.resetTransform();\n        ctx.scale(highResScaleFactor, highResScaleFactor);\n        ctx.clearRect(0, 0, blockSize, height);\n        ctx.translate(-offsetX, 0);\n        ctx.textAlign = 'center';\n        ctx.font = ctx.font.replace(/\\d+px/, \"\".concat(Math.max(8, rowHeight - 8), \"px\"));\n        var xStart = Math.max(0, Math.floor(offsetX / colWidth));\n        ctx.fillStyle = 'goldenrod';\n        layout.rectangles.forEach(function (value) {\n            var minX = value.minX, maxX = value.maxX, minY = value.minY, maxY = value.maxY;\n            var x1 = (minX - xStart) * colWidth + offsetX - (offsetX % colWidth);\n            var x2 = (maxX - xStart) * colWidth + offsetX - (offsetX % colWidth);\n            if (x2 - x1 > 0) {\n                ctx.fillRect(x1, minY, x2 - x1, (maxY - minY) / 2);\n            }\n        });\n    }, [\n        associatedRowName,\n        blockSize,\n        colWidth,\n        layout.rectangles,\n        model,\n        rowHeight,\n        height,\n        offsetX,\n        highResScaleFactor,\n        features,\n        blanks,\n    ]);\n    useEffect(function () {\n        if (!labelRef.current) {\n            return;\n        }\n        var ctx = labelRef.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        // this logic is very similar to MSACanvas\n        ctx.resetTransform();\n        ctx.scale(highResScaleFactor, highResScaleFactor);\n        ctx.clearRect(0, 0, blockSize, height);\n        ctx.translate(-offsetX, 0);\n        ctx.textAlign = 'center';\n        ctx.font = ctx.font.replace(/\\d+px/, \"\".concat(Math.max(8, rowHeight - 8), \"px\"));\n        ctx.fillStyle = 'black';\n        ctx.textAlign = 'left';\n        layout.rectangles.forEach(function (value) {\n            var _a, _b, _c, _d;\n            var minX = value.minX, maxX = value.maxX, maxY = value.maxY, minY = value.minY;\n            var feature = value.data;\n            var x1 = minX * colWidth;\n            var x2 = maxX * colWidth;\n            if (x2 - x1 > 0) {\n                var note = (_b = (_a = feature.attributes) === null || _a === void 0 ? void 0 : _a.Note) === null || _b === void 0 ? void 0 : _b[0];\n                var name_1 = (_d = (_c = feature.attributes) === null || _c === void 0 ? void 0 : _c.Name) === null || _d === void 0 ? void 0 : _d[0];\n                var type = feature.type;\n                ctx.fillText([type, name_1, note].filter(function (f) { return !!f; }).join(' - '), Math.max(Math.min(-scrollX, x2), x1), minY + (maxY - minY));\n            }\n        });\n    }, [\n        blockSize,\n        colWidth,\n        scrollX,\n        highResScaleFactor,\n        height,\n        layout.rectangles,\n        offsetX,\n        features,\n        model,\n        rowHeight,\n        blanks,\n    ]);\n    return !features ? null : (React.createElement(React.Fragment, null,\n        React.createElement(\"canvas\", { ref: ref, height: height * highResScaleFactor, width: blockSize * highResScaleFactor, style: {\n                position: 'absolute',\n                left: scrollX + offsetX,\n                width: blockSize,\n                height: height,\n            } }),\n        React.createElement(\"canvas\", { ref: labelRef, height: height * highResScaleFactor, width: blockSize * highResScaleFactor, style: {\n                position: 'absolute',\n                left: scrollX + offsetX,\n                width: blockSize,\n                height: height,\n            } }),\n        React.createElement(\"canvas\", { ref: mouseoverRef, height: height * highResScaleFactor, width: blockSize * highResScaleFactor, style: {\n                position: 'absolute',\n                left: scrollX + offsetX,\n                width: blockSize,\n                height: height,\n            } })));\n});\nvar AnnotationTrack = observer(function (_a) {\n    var model = _a.model, track = _a.track;\n    var blocksX = model.blocksX, msaAreaWidth = model.msaAreaWidth;\n    var height = track.model.height;\n    return (React.createElement(\"div\", { style: {\n            position: 'relative',\n            height: height,\n            width: msaAreaWidth,\n            overflow: 'hidden',\n        } }, blocksX.map(function (bx) { return (React.createElement(AnnotationBlock, { track: track, key: bx, model: model, offsetX: bx })); })));\n});\nexport default AnnotationTrack;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { cast, types, addDisposer } from 'mobx-state-tree';\nimport { hierarchy, cluster } from 'd3-hierarchy';\nimport { ascending, max } from 'd3-array';\nimport { FileLocation, ElementId } from '@jbrowse/core/util/types/mst';\nimport { openLocation } from '@jbrowse/core/util/io';\nimport { autorun } from 'mobx';\nimport BaseViewModel from '@jbrowse/core/pluggableElementTypes/models/BaseViewModel';\nimport Stockholm from 'stockholm-js';\nimport ClustalMSA from './parsers/ClustalMSA';\nimport StockholmMSA from './parsers/StockholmMSA';\nimport FastaMSA from './parsers/FastaMSA';\nimport parseNewick from './parseNewick';\nimport colorSchemes from './colorSchemes';\nimport { generateNodeIds } from './util';\nimport TextTrack from './components/TextTrack';\nimport BoxTrack from './components/BoxTrack';\nfunction skipBlanks(blanks, arg) {\n    var s = '';\n    var b = 0;\n    for (var j = 0; j < arg.length; j++) {\n        if (j === blanks[b]) {\n            b++;\n        }\n        else {\n            s += arg[j];\n        }\n    }\n    return s;\n}\nfunction setBrLength(d, y0, k) {\n    var _a;\n    //@ts-ignore\n    d.len = (y0 += Math.max(d.data.length || 0, 0)) * k;\n    (_a = d.children) === null || _a === void 0 ? void 0 : _a.forEach(function (d) {\n        setBrLength(d, y0, k);\n    });\n}\nfunction maxLength(d) {\n    return (d.data.length || 1) + (d.children ? max(d.children, maxLength) : 0);\n}\n// Collapse the node and all it's children, from\n// https://bl.ocks.org/d3noob/43a860bc0024792f8803bba8ca0d5ecd\nfunction collapse(d) {\n    if (d.children) {\n        //@ts-ignore\n        d._children = d.children;\n        //@ts-ignore\n        d._children.forEach(collapse);\n        //@ts-ignore\n        d.children = null;\n    }\n}\nfunction clamp(min, num, max) {\n    return Math.min(Math.max(num, min), max);\n}\nvar StructureModel = types.model({\n    id: types.identifier,\n    structure: types.model({\n        pdb: types.string,\n        startPos: types.number,\n        endPos: types.number,\n    }),\n    range: types.maybe(types.string),\n});\nvar UniprotTrack = types\n    .model({\n    id: types.string,\n    accession: types.string,\n    name: types.string,\n    associatedRowName: types.string,\n    height: types.optional(types.number, 100),\n})\n    .volatile(function () { return ({\n    error: undefined,\n    data: undefined,\n}); })\n    .actions(function (self) { return ({\n    setError: function (error) {\n        self.error = error;\n    },\n    setData: function (data) {\n        self.data = data;\n    },\n}); })\n    .actions(function (self) { return ({\n    afterCreate: function () {\n        var _this = this;\n        addDisposer(self, autorun(function () { return __awaiter(_this, void 0, void 0, function () {\n            var accession, url, response, text, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 3, , 4]);\n                        accession = self.accession;\n                        url = \"https://www.uniprot.org/uniprot/\".concat(accession, \".gff\");\n                        return [4 /*yield*/, fetch(url)];\n                    case 1:\n                        response = _a.sent();\n                        if (!response.ok) {\n                            throw new Error(\"HTTP \".concat(response.status, \" \").concat(response.statusText, \" fetching \").concat(url));\n                        }\n                        return [4 /*yield*/, response.text()];\n                    case 2:\n                        text = _a.sent();\n                        self.setData(text);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _a.sent();\n                        self.setError(e_1);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); }));\n    },\n}); })\n    .views(function (self) { return ({\n    get loading() {\n        return !self.data;\n    },\n    get features() {\n        var _a;\n        return (_a = self.data) === null || _a === void 0 ? void 0 : _a.split('\\n').map(function (f) { return f.trim(); }).filter(function (f) { return !!f; }).filter(function (f) { return !f.startsWith('#'); }).map(function (f) {\n            var _a = f.split('\\t'), seq_id = _a[0], source = _a[1], type = _a[2], start = _a[3], end = _a[4], score = _a[5], strand = _a[6], phase = _a[7], col9 = _a[8];\n            return __assign({ seq_id: seq_id, source: source, type: type, start: +start, end: +end, score: +score, strand: strand, phase: phase }, Object.fromEntries(col9\n                .split(';')\n                .map(function (f) { return f.trim(); })\n                .filter(function (f) { return !!f; })\n                .map(function (f) { return f.split('='); })\n                .map(function (_a) {\n                var key = _a[0], val = _a[1];\n                return [\n                    key.trim(),\n                    decodeURIComponent(val).trim().split(',').join(' '),\n                ];\n            })));\n        });\n    },\n}); });\nvar MSAModel = types\n    .model('MsaView', {\n    id: ElementId,\n    type: types.literal('MsaView'),\n    height: types.optional(types.number, 550),\n    treeAreaWidth: types.optional(types.number, 400),\n    treeWidth: types.optional(types.number, 300),\n    rowHeight: 20,\n    scrollY: 0,\n    scrollX: 0,\n    resizeHandleWidth: 5,\n    blockSize: 1000,\n    mouseRow: types.maybe(types.number),\n    mouseCol: types.maybe(types.number),\n    selectedStructures: types.array(StructureModel),\n    labelsAlignRight: false,\n    colWidth: 16,\n    showBranchLen: true,\n    bgColor: true,\n    drawTree: true,\n    drawNodeBubbles: true,\n    highResScaleFactor: 2,\n    colorSchemeName: 'maeditor',\n    treeFilehandle: types.maybe(FileLocation),\n    msaFilehandle: types.maybe(FileLocation),\n    currentAlignment: 0,\n    collapsed: types.array(types.string),\n    showOnly: types.maybe(types.string),\n    boxTracks: types.array(UniprotTrack),\n    turnedOffTracks: types.map(types.boolean),\n    annotatedRegions: types.array(types.model({\n        start: types.number,\n        end: types.number,\n        attributes: types.frozen(),\n    })),\n    data: types.optional(types\n        .model({\n        tree: types.maybe(types.string),\n        msa: types.maybe(types.string),\n    })\n        .actions(function (self) { return ({\n        setTree: function (tree) {\n            self.tree = tree;\n        },\n        setMSA: function (msa) {\n            self.msa = msa;\n        },\n    }); }), { tree: '', msa: '' }),\n})\n    .volatile(function () { return ({\n    error: undefined,\n    margin: { left: 20, top: 20 },\n    //eslint-disable-next-line @typescript-eslint/no-explicit-any\n    DialogComponent: undefined,\n    //eslint-disable-next-line @typescript-eslint/no-explicit-any\n    DialogProps: undefined,\n    // annotations\n    annotPos: undefined,\n}); })\n    .actions(function (self) { return ({\n    //eslint-disable-next-line @typescript-eslint/no-explicit-any\n    setDialogComponent: function (dlg, props) {\n        self.DialogComponent = dlg;\n        self.DialogProps = props;\n    },\n    setHeight: function (height) {\n        self.height = height;\n    },\n    addStructureToSelection: function (elt) {\n        self.selectedStructures.push(elt);\n    },\n    removeStructureFromSelection: function (elt) {\n        var r = self.selectedStructures.find(function (node) { return node.id === elt.id; });\n        if (r) {\n            self.selectedStructures.remove(r);\n        }\n    },\n    toggleStructureSelection: function (elt) {\n        var r = self.selectedStructures.find(function (node) { return node.id === elt.id; });\n        if (r) {\n            self.selectedStructures.remove(r);\n        }\n        else {\n            self.selectedStructures.push(elt);\n        }\n    },\n    clearSelectedStructures: function () {\n        //@ts-ignore\n        self.selectedStructures = [];\n    },\n    setError: function (error) {\n        if (error) {\n            console.error(error);\n        }\n        self.error = error;\n    },\n    setMousePos: function (col, row) {\n        self.mouseCol = col;\n        self.mouseRow = row;\n    },\n    setRowHeight: function (n) {\n        self.rowHeight = n;\n    },\n    setColWidth: function (n) {\n        self.colWidth = n;\n    },\n    setColorSchemeName: function (name) {\n        self.colorSchemeName = name;\n    },\n    setScrollY: function (n) {\n        self.scrollY = n;\n    },\n    setScrollX: function (n) {\n        self.scrollX = n;\n    },\n    setTreeAreaWidth: function (n) {\n        self.treeAreaWidth = n;\n    },\n    setTreeWidth: function (n) {\n        self.treeWidth = n;\n    },\n    setCurrentAlignment: function (n) {\n        self.currentAlignment = n;\n    },\n    toggleLabelsAlignRight: function () {\n        self.labelsAlignRight = !self.labelsAlignRight;\n    },\n    toggleDrawTree: function () {\n        self.drawTree = !self.drawTree;\n    },\n    toggleCollapsed: function (node) {\n        if (self.collapsed.includes(node)) {\n            self.collapsed.remove(node);\n        }\n        else {\n            self.collapsed.push(node);\n        }\n    },\n    setShowOnly: function (node) {\n        self.showOnly = node;\n    },\n    toggleBranchLen: function () {\n        self.showBranchLen = !self.showBranchLen;\n    },\n    toggleBgColor: function () {\n        self.bgColor = !self.bgColor;\n    },\n    toggleNodeBubbles: function () {\n        self.drawNodeBubbles = !self.drawNodeBubbles;\n    },\n    setData: function (data) {\n        self.data = cast(data);\n    },\n    setMSAFilehandle: function (msaFilehandle) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                self.msaFilehandle = msaFilehandle;\n                return [2 /*return*/];\n            });\n        });\n    },\n    setTreeFilehandle: function (treeFilehandle) {\n        return __awaiter(this, void 0, void 0, function () {\n            var r;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!(treeFilehandle && 'blobId' in treeFilehandle)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, openLocation(treeFilehandle).readFile('utf8')];\n                    case 1:\n                        r = (_a.sent());\n                        this.setTree(r);\n                        return [3 /*break*/, 3];\n                    case 2:\n                        self.treeFilehandle = treeFilehandle;\n                        _a.label = 3;\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    },\n    setMSA: function (result) {\n        self.data.setMSA(result);\n    },\n    setTree: function (result) {\n        self.data.setTree(result);\n    },\n    afterCreate: function () {\n        var _this = this;\n        addDisposer(self, autorun(function () { return __awaiter(_this, void 0, void 0, function () {\n            var treeFilehandle, _a, e_2;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        treeFilehandle = self.treeFilehandle;\n                        if (!treeFilehandle) return [3 /*break*/, 4];\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 3, , 4]);\n                        _a = this.setTree;\n                        return [4 /*yield*/, openLocation(treeFilehandle).readFile('utf8')];\n                    case 2:\n                        _a.apply(this, [(_b.sent())]);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_2 = _b.sent();\n                        this.setError(e_2);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); }));\n        addDisposer(self, autorun(function () { return __awaiter(_this, void 0, void 0, function () {\n            var msaFilehandle, _a, e_3;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        msaFilehandle = self.msaFilehandle;\n                        if (!msaFilehandle) return [3 /*break*/, 4];\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 3, , 4]);\n                        _a = this.setMSA;\n                        return [4 /*yield*/, openLocation(msaFilehandle).readFile('utf8')];\n                    case 2:\n                        _a.apply(this, [(_b.sent())]);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_3 = _b.sent();\n                        this.setError(e_3);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); }));\n    },\n}); })\n    .views(function (self) {\n    var oldBlocksX = [];\n    var oldBlocksY = [];\n    var oldValX = 0;\n    var oldValY = 0;\n    return {\n        get initialized() {\n            return ((self.data.msa ||\n                self.data.tree ||\n                self.msaFilehandle ||\n                self.treeFilehandle) &&\n                !self.error);\n        },\n        get blocksX() {\n            var scrollX = self.scrollX, size = self.blockSize, colWidth = self.colWidth;\n            var ret = -(size * Math.floor(scrollX / size)) - size;\n            var b = [];\n            for (var i = ret; i < ret + size * 3; i += size) {\n                if (i + size > 0) {\n                    b.push(i);\n                }\n            }\n            if (JSON.stringify(b) !== JSON.stringify(oldBlocksX) ||\n                colWidth !== oldValX) {\n                oldBlocksX = b;\n                oldValX = colWidth;\n            }\n            return oldBlocksX;\n        },\n        get blocksY() {\n            var scrollY = self.scrollY, size = self.blockSize, rowHeight = self.rowHeight;\n            var ret = -(size * Math.floor(scrollY / size)) - 2 * size;\n            var b = [];\n            for (var i = ret; i < ret + size * 3; i += size) {\n                if (i + size > 0) {\n                    b.push(i);\n                }\n            }\n            if (JSON.stringify(b) !== JSON.stringify(oldBlocksY) ||\n                rowHeight !== oldValY) {\n                oldBlocksY = b;\n                oldValY = rowHeight;\n            }\n            return oldBlocksY;\n        },\n    };\n})\n    .views(function (self) { return ({\n    get blocks2d() {\n        return self.blocksY.map(function (by) { return self.blocksX.map(function (bx) { return [bx, by]; }); }).flat();\n    },\n    get done() {\n        return self.initialized && (self.data.msa || self.data.tree);\n    },\n    get colorScheme() {\n        return colorSchemes[self.colorSchemeName];\n    },\n    get alignmentDetails() {\n        var _a;\n        return ((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getDetails()) || {};\n    },\n    getRowDetails: function (name) {\n        var _a, _b;\n        //@ts-ignore\n        var details = (_b = (_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getRowDetails) === null || _b === void 0 ? void 0 : _b.call(_a, name);\n        var matches = name.match(/\\S+\\/(\\d+)-(\\d+)/);\n        return __assign(__assign({}, details), (matches && { range: { start: +matches[1], end: +matches[2] } }));\n    },\n    get currentAlignmentName() {\n        return this.alignmentNames[self.currentAlignment];\n    },\n    get alignmentNames() {\n        var _a;\n        return ((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.alignmentNames) || [];\n    },\n    get noTree() {\n        return !!this.tree.noTree;\n    },\n    get menuItems() {\n        return [];\n    },\n    get MSA() {\n        var text = self.data.msa;\n        if (text) {\n            if (Stockholm.sniff(text)) {\n                return new StockholmMSA(text, self.currentAlignment);\n            }\n            else if (text.startsWith('>')) {\n                return new FastaMSA(text);\n            }\n            else {\n                return new ClustalMSA(text);\n            }\n        }\n        return null;\n    },\n    get numColumns() {\n        var _a;\n        return ((((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getWidth()) || 0) - this.blanks.length) * self.colWidth;\n    },\n    get tree() {\n        var _a;\n        return self.data.tree\n            ? generateNodeIds(parseNewick(self.data.tree))\n            : ((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getTree()) || { noTree: true };\n    },\n    get rowNames() {\n        return this.hierarchy.leaves().map(function (node) { return node.data.name; });\n    },\n    get mouseOverRowName() {\n        return self.mouseRow !== undefined\n            ? this.rowNames[self.mouseRow]\n            : undefined;\n    },\n    getMouseOverResidue: function (rowName) {\n        return this.columns[rowName];\n    },\n    get root() {\n        var hier = hierarchy(this.tree, function (d) { return d.branchset; })\n            .sum(function (d) { return (d.branchset ? 0 : 1); })\n            .sort(function (a, b) {\n            return ascending(a.data.length || 1, b.data.length || 1);\n        });\n        if (self.showOnly) {\n            var res = hier.find(function (node) { return node.data.id === self.showOnly; });\n            if (res) {\n                hier = res;\n            }\n        }\n        if (self.collapsed.length) {\n            self.collapsed\n                .map(function (collapsedId) {\n                return hier.find(function (node) { return node.data.id === collapsedId; });\n            })\n                .filter(function (f) { return !!f; })\n                .map(function (node) { return collapse(node); });\n        }\n        return hier;\n    },\n    get structures() {\n        var _a;\n        return ((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getStructures()) || {};\n    },\n    get inverseStructures() {\n        var map = Object.entries(this.structures)\n            .map(function (_a) {\n            var key = _a[0], val = _a[1];\n            return val.map(function (pdbEntry) { return [pdbEntry.pdb, { id: key }]; });\n        })\n            .flat();\n        return Object.fromEntries(map);\n    },\n    get msaAreaWidth() {\n        //@ts-ignore\n        return self.width - self.treeAreaWidth;\n    },\n    get blanks() {\n        var _this = this;\n        var _a;\n        var blanks = [];\n        var strs = this.hierarchy\n            .leaves()\n            .map(function (_a) {\n            var _b;\n            var data = _a.data;\n            return (_b = _this.MSA) === null || _b === void 0 ? void 0 : _b.getRow(data.name);\n        })\n            .filter(function (item) { return !!item; });\n        for (var i = 0; i < ((_a = strs[0]) === null || _a === void 0 ? void 0 : _a.length); i++) {\n            var counter = 0;\n            for (var j = 0; j < strs.length; j++) {\n                if (strs[j][i] === '-') {\n                    counter++;\n                }\n            }\n            if (counter === strs.length) {\n                blanks.push(i);\n            }\n        }\n        return blanks;\n    },\n    get rows() {\n        var _this = this;\n        return this.hierarchy\n            .leaves()\n            .map(function (_a) {\n            var _b;\n            var data = _a.data;\n            return [data.name, (_b = _this.MSA) === null || _b === void 0 ? void 0 : _b.getRow(data.name)];\n        })\n            .filter(function (f) { return !!f[1]; });\n    },\n    get columns() {\n        var rows = this.rows;\n        var cols = this.columns2d;\n        return Object.fromEntries(rows.map(function (row, index) { return [row[0], cols[index]]; }));\n    },\n    get columns2d() {\n        var strs = this.rows.map(function (r) { return r[1]; });\n        var ret = [];\n        for (var i = 0; i < strs.length; i++) {\n            ret.push(skipBlanks(this.blanks, strs[i]));\n        }\n        return ret;\n    },\n    get colStats() {\n        var r = [];\n        var m = this.columns2d;\n        for (var i = 0; i < m.length; i++) {\n            for (var j = 0; j < m[i].length; j++) {\n                var l = r[j] || {};\n                if (!l[m[i][j]]) {\n                    l[m[i][j]] = 0;\n                }\n                l[m[i][j]]++;\n                r[j] = l;\n            }\n        }\n        return r;\n    },\n    // generates a new tree that is clustered with x,y positions\n    get hierarchy() {\n        var root = this.root;\n        var clust = cluster()\n            .size([this.totalHeight, self.treeWidth])\n            .separation(function () { return 1; });\n        clust(root);\n        setBrLength(root, \n        //@ts-ignore\n        (root.data.length = 0), self.treeWidth / maxLength(root));\n        return root;\n    },\n    get totalHeight() {\n        return this.root.leaves().length * self.rowHeight;\n    },\n}); })\n    .actions(function (self) { return ({\n    addUniprotTrack: function (node) {\n        if (self.boxTracks.find(function (t) { return t.name === node.name; })) {\n            if (self.turnedOffTracks.has(node.name)) {\n                this.toggleTrack(node.name);\n            }\n        }\n        else {\n            self.boxTracks.push(__assign(__assign({}, node), { id: node.name, associatedRowName: node.name }));\n        }\n    },\n    doScrollY: function (deltaY) {\n        self.scrollY = clamp(-self.totalHeight + 10, self.scrollY + deltaY, 0);\n    },\n    doScrollX: function (deltaX) {\n        self.scrollX = clamp(-self.numColumns + (self.msaAreaWidth - 100), self.scrollX + deltaX, 0);\n    },\n    setMouseoveredColumn: function (n, chain, file) {\n        var _a;\n        var j = 0;\n        var i = 0;\n        var id = (self.inverseStructures[file.slice(0, -4)] || {}).id;\n        var row = (_a = self.MSA) === null || _a === void 0 ? void 0 : _a.getRow(id);\n        if (row) {\n            for (i = 0; i < row.length && j < n; i++) {\n                if (row[i] !== '-') {\n                    j++;\n                }\n            }\n            self.mouseCol = j + 1;\n        }\n        else {\n            self.mouseCol = undefined;\n        }\n    },\n    toggleTrack: function (id) {\n        if (self.turnedOffTracks.has(id)) {\n            self.turnedOffTracks.delete(id);\n        }\n        else {\n            self.turnedOffTracks.set(id, true);\n        }\n    },\n}); })\n    .views(function (self) { return ({\n    get secondaryStructureConsensus() {\n        var _a;\n        return (_a = self.MSA) === null || _a === void 0 ? void 0 : _a.secondaryStructureConsensus;\n    },\n    get seqConsensus() {\n        var _a;\n        return (_a = self.MSA) === null || _a === void 0 ? void 0 : _a.seqConsensus;\n    },\n    get conservation() {\n        var m = self.columns2d;\n        if (m.length) {\n            for (var i = 0; i < m[0].length; i++) {\n                var col = [];\n                for (var j = 0; j < m.length; j++) {\n                    col.push(m[j][i]);\n                }\n            }\n        }\n        return ['a'];\n    },\n    get tracks() {\n        var blanks = self.blanks;\n        var adapterTracks = self.MSA\n            ? self.MSA.tracks.map(function (track) {\n                var data = track.data;\n                return {\n                    model: __assign(__assign({}, track), { data: data ? skipBlanks(blanks, data) : undefined, height: self.rowHeight }),\n                    ReactComponent: TextTrack,\n                };\n            })\n            : [];\n        var boxTracks = self.boxTracks\n            // filter out tracks that are associated with hidden rows\n            .filter(function (track) { return !!self.rows.find(function (row) { return row[0] === track.name; }); })\n            .map(function (track) { return ({\n            model: track,\n            ReactComponent: BoxTrack,\n        }); });\n        var annotationTracks = self.annotatedRegions.length > 0\n            ? [\n                {\n                    model: {\n                        features: self.annotatedRegions,\n                        height: 100,\n                        id: 'annotations',\n                        name: 'User-created annotations',\n                        data: self.annotatedRegions\n                            .map(function (region) {\n                            var attrs = region.attributes\n                                ? Object.entries(region.attributes)\n                                    .map(function (_a) {\n                                    var k = _a[0], v = _a[1];\n                                    return \"\".concat(k, \"=\").concat(v.join(','));\n                                })\n                                    .join(';')\n                                : '.';\n                            return [\n                                'MSA_refcoord',\n                                '.',\n                                '.',\n                                region.start,\n                                region.end,\n                                '.',\n                                '.',\n                                '.',\n                                attrs,\n                            ].join('\\t');\n                        })\n                            .join('\\n'),\n                    },\n                    ReactComponent: BoxTrack,\n                },\n            ]\n            : [];\n        return __spreadArray(__spreadArray(__spreadArray([], adapterTracks, true), boxTracks, true), annotationTracks, true);\n    },\n    get turnedOnTracks() {\n        return this.tracks.filter(function (f) { return !self.turnedOffTracks.has(f.model.id); });\n    },\n    // returns coordinate in the current relative coordinate scheme\n    pxToBp: function (coord) {\n        return Math.floor((coord - self.scrollX) / self.colWidth);\n    },\n    rowSpecificBpToPx: function (rowName, position) {\n        var _a;\n        var rowNames = self.rowNames, rows = self.rows, blanks = self.blanks;\n        var index = rowNames.indexOf(rowName);\n        var row = rows[index][1];\n        var details = self.getRowDetails(rowName);\n        var offset = ((_a = details.range) === null || _a === void 0 ? void 0 : _a.start) || 0;\n        var current = position - offset;\n        if (current < 0) {\n            return 0;\n        }\n        var j = 0;\n        var i = 0;\n        for (; i < row.length; i++) {\n            if (row[i] !== '-' && j++ === current) {\n                break;\n            }\n        }\n        var count = 0;\n        for (var k = 0; k < row.length; k++) {\n            if (blanks.indexOf(k) !== -1 && k < i + 1) {\n                count++;\n            }\n        }\n        return i - count;\n    },\n    globalBpToPx: function (position) {\n        var _a;\n        var count = 0;\n        for (var k = 0; k < ((_a = self.rows[0]) === null || _a === void 0 ? void 0 : _a[1].length); k++) {\n            if (self.blanks.indexOf(k) !== -1 && k < position + 1) {\n                count++;\n            }\n        }\n        return position - count;\n    },\n    relativePxToBp: function (rowName, position) {\n        var rowNames = self.rowNames, rows = self.rows;\n        var index = rowNames.indexOf(rowName);\n        var row = rows[index][1];\n        var k = 0;\n        for (var i = 0; i < position; i++) {\n            if (row[i] !== '-') {\n                k++;\n            }\n            else if (k >= position) {\n                break;\n            }\n        }\n        return k;\n    },\n    getPos: function (pos) {\n        var j = 0;\n        for (var i = 0, k = 0; i < pos; i++, j++) {\n            while (j === self.blanks[k]) {\n                k++;\n                j++;\n            }\n        }\n        return j;\n    },\n}); })\n    .actions(function (self) { return ({\n    addAnnotation: function (start, end, attributes) {\n        self.annotatedRegions.push({\n            start: self.getPos(start),\n            end: self.getPos(end),\n            attributes: attributes,\n        });\n    },\n    setOffsets: function (left, right) {\n        self.annotPos = { left: left, right: right };\n    },\n    clearAnnotPos: function () {\n        self.annotPos = undefined;\n    },\n}); });\nvar model = types.snapshotProcessor(types.compose(BaseViewModel, MSAModel), {\n    postProcessor: function (result) {\n        var _a = result.data, tree = _a.tree, msa = _a.msa, rest = __rest(result\n        // remove the MSA/tree data from the tree if the filehandle available in\n        // which case it can be reloaded on refresh\n        , [\"data\"]);\n        // remove the MSA/tree data from the tree if the filehandle available in\n        // which case it can be reloaded on refresh\n        return __assign({ data: __assign(__assign({}, (!result.treeFilehandle && { tree: tree })), (!result.msaFilehandle && { msa: msa })) }, rest);\n    },\n});\nexport default model;\n","import { MSAModel } from \"react-msaview\";\nimport { types, Instance } from \"mobx-state-tree\";\n\nconst App = types\n  .model({\n    msaview: MSAModel,\n    nglSelection: types.optional(types.string, \"\"),\n  })\n  .actions((self) => ({\n    setNGLSelection(sel: any) {\n      self.nglSelection = sel;\n    },\n  }));\n\nexport default App;\nexport type AppModel = Instance<typeof App>;\n","import React, { useCallback, useState, useEffect, useRef } from \"react\";\nimport { getSnapshot } from \"mobx-state-tree\";\nimport { observer } from \"mobx-react\";\nimport { Button, Select, MenuItem, TextField } from \"@material-ui/core\";\nimport { Stage, StaticDatasource, DatasourceRegistry } from \"ngl\";\n\nDatasourceRegistry.add(\n  \"data\",\n  new StaticDatasource(\"https://files.rcsb.org/download/\")\n);\n\nfunction getOffset(model, rowName, structure, mouseCol, startPos) {\n  const rn = structure.residueStore.count;\n  const rp = structure.getResidueProxy();\n  const pos = model.msaview.relativePxToBp(rowName, mouseCol);\n  for (let i = 0; i < rn; ++i) {\n    rp.index = i;\n    if (rp.resno === pos + startPos - 1) {\n      return rp;\n    }\n  }\n}\n\nexport const ProteinPanel = observer(({ model }) => {\n  const annotations = useRef([]);\n  const [type, setType] = useState(\"cartoon\");\n  const [res, setRes] = useState([]);\n  const [stage, setStage] = useState();\n  const [isMouseHovering, setMouseHovering] = useState(false);\n  const { msaview, nglSelection } = model;\n  const { selectedStructures, mouseCol } = msaview;\n  const structures = getSnapshot(selectedStructures);\n\n  const stageElementRef = useCallback((element) => {\n    if (element) {\n      const currentStage = new Stage(element);\n      setStage(currentStage);\n    }\n  }, []);\n\n  useEffect(() => {\n    return () => stage?.dispose();\n  }, [stage]);\n\n  useEffect(() => {\n    if (!structures.length || !stage) {\n      return;\n    }\n    (async () => {\n      // Handle window resizing\n      window.addEventListener(\"resize\", () => {\n        stage.handleResize();\n      });\n\n      const res = await Promise.all(\n        structures.map((selection) => {\n          return stage.loadFile(`data://${selection.structure.pdb}.pdb`);\n        })\n      );\n      setRes(res);\n\n      stage.signals.hovered.add((pickingProxy) => {\n        if (pickingProxy && (pickingProxy.atom || pickingProxy.bond)) {\n          const atom = pickingProxy.atom || pickingProxy.closestBondAtom;\n          msaview.setMouseoveredColumn(\n            atom.resno - structures[0]?.structure.startPos,\n            atom.chainname,\n            pickingProxy.picker.structure.name\n          );\n        }\n      });\n    })();\n  }, [msaview, structures, stage]);\n\n  useEffect(() => {\n    if (stage) {\n      res.forEach((elt) => {\n        elt.removeAllRepresentations();\n        elt.addRepresentation(type, { sele: nglSelection });\n      });\n      stage.autoView();\n    }\n  }, [type, res, stage, nglSelection]);\n\n  useEffect(() => {\n    if (structures.length && !isMouseHovering) {\n      res.forEach((elt, index) => {\n        if (annotations.current.length) {\n          elt.removeAnnotation(annotations.current[index]);\n        }\n        annotations.current = [];\n        if (mouseCol !== undefined) {\n          const offset = getOffset(\n            model,\n            structures[index].id,\n            elt.structure,\n            mouseCol,\n            structures[0].structure.startPos\n          );\n          if (offset) {\n            const ap = elt.structure.getAtomProxy();\n            ap.index = offset.atomOffset;\n\n            annotations.current.push(\n              elt.addAnnotation(ap.positionToVector3(), offset.qualifiedName())\n            );\n          }\n        }\n        stage.viewer.requestRender();\n      });\n    }\n  }, [model, mouseCol, structures, stage?.viewer, res, isMouseHovering]);\n\n  return selectedStructures.length ? (\n    <div style={{ padding: 20 }}>\n      <div style={{ display: \"flex\", alignItems: \"center\" }}>\n        <Button\n          onClick={() => msaview.clearSelectedStructures()}\n          variant=\"contained\"\n        >\n          Clear\n        </Button>\n\n        <div style={{ width: 20 }} />\n        <Select value={type} onChange={(event) => setType(event.target.value)}>\n          <MenuItem value={\"cartoon\"}>cartoon</MenuItem>\n          <MenuItem value={\"ball+stick\"}>ball+stick</MenuItem>\n        </Select>\n        <div style={{ width: 20 }} />\n        <TextField\n          variant=\"outlined\"\n          label=\"Selection\"\n          value={nglSelection}\n          onChange={(event) => model.setNGLSelection(event.target.value)}\n        />\n      </div>\n\n      <div\n        ref={stageElementRef}\n        style={{ width: 600, height: 400 }}\n        onMouseEnter={() => setMouseHovering(true)}\n        onMouseLeave={() => setMouseHovering(false)}\n      />\n    </div>\n  ) : null;\n});\n","import React from \"react\";\nimport { observer } from \"mobx-react\";\nimport { onSnapshot } from \"mobx-state-tree\";\nimport { MSAView } from \"react-msaview\";\nimport { createJBrowseTheme } from \"@jbrowse/core/ui/theme\";\nimport { ThemeProvider } from \"@material-ui/core/styles\";\nimport { throttle } from \"lodash\";\nimport AppGlobal, { AppModel } from \"./model\";\n\nimport { ProteinPanel } from \"./ProteinPanel\";\n\nconst urlParams = new URLSearchParams(window.location.search);\nconst val = urlParams.get(\"data\");\n\nconst mymodel = AppGlobal.create(\n  val ? JSON.parse(val) : { msaview: { type: \"MsaView\" } }\n);\n\nmymodel.msaview.setWidth(window.innerWidth);\n\nonSnapshot(\n  mymodel,\n  throttle((snap) => {\n    const url = new URL(window.document.URL);\n    url.searchParams.set(\"data\", JSON.stringify(snap));\n    window.history.replaceState(null, \"\", url.toString());\n  }, 500)\n);\n\n// Handle window resizing\nwindow.addEventListener(\"resize\", () => {\n  mymodel.msaview.setWidth(window.innerWidth);\n});\n\nconst App = observer(({ model }: { model: AppModel }) => {\n  const { msaview } = model;\n  return (\n    <div>\n      <div style={{ border: \"1px solid black\", margin: 20 }}>\n        <MSAView model={msaview} />\n      </div>\n      <ProteinPanel model={model} />\n    </div>\n  );\n});\n\nconst MainApp = () => {\n  const theme = createJBrowseTheme();\n  return (\n    <ThemeProvider theme={theme}>\n      <App model={mymodel} />\n    </ThemeProvider>\n  );\n};\n\nexport default MainApp;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}