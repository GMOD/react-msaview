{"version":3,"sources":["../../lib/dist/components/ImportForm.js","../../lib/dist/components/data/seq2.js","../../lib/dist/components/Rubberband.js","../../lib/dist/components/MoreInfoDlg.js","../../lib/dist/components/TreeCanvas.js","../../lib/dist/util.js","../../lib/dist/components/MSACanvas.js","../../lib/dist/components/Ruler.js","../../lib/dist/components/TreeRuler.js","../../lib/dist/colorSchemes.js","../../lib/dist/components/SettingsDlg.js","../../lib/dist/components/AboutDlg.js","../../lib/dist/components/DetailsDlg.js","../../lib/dist/components/TracklistDlg.js","../../lib/dist/components/Header.js","../../lib/dist/components/TrackInfoDlg.js","../../lib/dist/components/Track.js","../../lib/dist/components/AnnotationDlg.js","../../lib/dist/components/ResizeHandles.js","../../lib/dist/components/MSAView.js","../../lib/dist/parsers/ClustalMSA.js","../../lib/dist/parseNewick.js","../../lib/dist/parsers/StockholmMSA.js","../../lib/dist/parsers/FastaMSA.js","../../lib/dist/components/TextTrack.js","../../lib/dist/layout.js","../../lib/dist/components/BoxTrack.js","../../lib/dist/model.js","model.ts","ProteinPanel.js","App.tsx","reportWebVitals.ts","index.tsx"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","ListItem","_a","onClick","model","children","_jsx","Link","setError","undefined","href","Typography","observer","_b","useState","msaFile","setMsaFile","_c","treeFile","setTreeFile","error","_jsxs","Container","style","width","padding","color","Grid","container","spacing","justify","alignItems","item","FileSelector","location","setLocation","Button","setMSAFilehandle","setTreeFilehandle","variant","disabled","uri","setData","msa","tree","transaction","useStyles","makeStyles","theme","rubberband","height","background","palette","tertiary","alpha","main","primary","position","zIndex","textAlign","overflow","rubberbandControl","cursor","minHeight","rubberbandText","contrastText","popover","mouseEvents","paper","paddingLeft","paddingRight","guide","pointerEvents","VerticalGuide","coordX","treeAreaWidth","classes","_Fragment","Tooltip","open","placement","title","pxToBp","arrow","left","className","ControlComponent","startX","setStartX","_d","currentX","setCurrentX","_e","anchorPosition","setAnchorPosition","_f","guideX","setGuideX","controlsRef","useRef","rubberbandRef","mouseDragging","mouseDown","event","preventDefault","stopPropagation","relativeX","clientX","target","getBoundingClientRect","mouseMove","mouseOut","clearAnnotPos","handleClose","useEffect","globalMouseMove","current","globalMouseUp","clientY","offsetX","window","addEventListener","removeEventListener","Math","abs","colWidth","role","ref","onMouseDown","onMouseOut","onMouseMove","right","leftBpOffset","rightBpOffset","numOfBpSelected","ceil","menuItems","label","icon","AssignmentIcon","setOffsets","Popover","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","keepMounted","disableRestoreFocus","toLocaleString","Menu","anchorReference","top","onMenuItemClick","_","callback","Boolean","onClose","info","Dialog","DialogTitle","DialogContent","Attributes","attributes","radius","TreeMenu","node","structures","nodeDetails","getRowDetails","name","y","x","transitionDuration","MenuItem","dense","setDialogComponent","MoreInfoDlg","map","entry","selectedStructures","find","id","removeStructureFromSelection","structure","pdb","JSON","stringify","addStructureToSelection","accession","addUniprotTrack","TreeBranchMenu","toggleCollapsed","collapsed","includes","showOnly","setShowOnly","TreeBlock","offsetY","clickMap","RBush","mouseoverRef","branchMenu","setBranchMenu","toggleNodeMenu","setToggleNodeMenu","hoverElt","setHoverElt","hierarchy","rowHeight","scrollY","treeWidth","showBranchLen","margin","labelsAlignRight","noTree","blockSize","drawNodeBubbles","drawTree","highResScaleFactor","hoverBranchClickMap","nativeEvent","search","minX","maxX","minY","maxY","branch","hoverNameClickMap","clear","ctx","getContext","resetTransform","scale","clearRect","translate","font","replace","max","links","forEach","source","sy","sx","ty","tx","y1","min","y2","beginPath","moveTo","lineTo","stroke","descendants","val","data","strokeStyle","fillStyle","arc","PI","fill","insert","setLineDash","leaves","len","yp","xp","measureText","hasStructure","offset","width_1","fillText","canvas","fillRect","ret","data2","TreeCanvas","scheduled","deltaY","prevY","blocksY","setMouseDragging","curr","onWheel","origEvent","normalizeWheel","pixelY","requestAnimationFrame","doScrollY","cleanup","distanceY","draggable","dataset","resizer","button","onMouseUp","onMouseLeave","block","transform","obj","cb","fromEntries","entries","generateNodeIds","parent","depth","branchset","b","colorContrast","colorScheme","letter","getContrastText","Color","hex","MSABlock","MSA","bgColor","columns","scrollX","useTheme","contrastScheme","useMemo","yStart","floor","yEnd","xStart","xEnd","visibleLeaves","slice","str","toUpperCase","contrast","mouseX","mouseY","setMousePos","MSACanvas","msaFilehandle","msaAreaWidth","blocks2d","deltaX","prevX","pixelX","doScrollX","currX","currY","distanceX","bx","by","CircularProgress","makeTicks","start","end","bpPerPx","emitMajor","emitMinor","gridPitch","minMajorPitchPx","minMinorPitchPx","minMajorPitchBp","majorMagnitude","parseInt","Number","toExponential","split","majorPitch","pow","majorPitchPx","minorPitch","chooseGridPitch","minBase","maxBase","iterPitch","index","ticks","base","push","type","mathPower","num","String","substr","majorTickLabel","fontSize","majorTick","minorTick","RulerBlock","reversed","major","minor","tick","x1","x2","strokeWidth","filter","textAnchor","Ruler","resizeHandleWidth","blocksX","TreeRuler","clustal","G","P","S","T","H","K","R","F","W","Y","I","L","M","V","lesk","A","C","N","Q","D","E","maeditor","flower","rainbow_dna","U","clustalx_protein","clustalx_dna","jalview_buried","B","X","Z","jalview_hydrophobicity","jalview_prophelix","jalview_propstrand","jalview_propturn","jalview_taylor","jalview_zappo","cinema","rowHeightInit","colWidthInit","treeWidthInit","colorSchemeName","setRowHeight","setColWidth","setTreeWidth","isNaN","rowHeightError","colWidthError","treeWidthError","FormControlLabel","control","Checkbox","checked","onChange","toggleBranchLen","toggleBgColor","toggleNodeBubbles","toggleDrawTree","toggleLabelsAlignRight","TextField","value","select","setColorSchemeName","keys","colorSchemes","option","DialogActions","LicenseDialog","AboutDialog","dlgOpen","setDlgOpen","version","alignmentDetails","tracks","FormGroup","track","turnedOffTracks","has","toggleTrack","InfoArea","mouseOverRowName","mouseCol","display","marginLeft","Header","settingsDialogVisible","setSettingsDialogVisible","aboutDialogVisible","setAboutDialogVisible","detailsDialogVisible","setDetailsDialogVisible","tracklistDialogVisible","setTracklistDialogVisible","currentAlignment","alignmentNames","IconButton","setScrollY","setScrollX","setCurrentAlignment","FolderOpenIcon","SettingsIcon","ListIcon","SettingsDialog","DetailsDialog","TracklistDialog","Select","native","flex","HelpIcon","textArea","wordBreak","TrackInfoDialog","setLabel","fullWidth","maxWidth","copy","setTimeout","TrackLabel","setAnchorEl","trackInfoDlgOpen","setTrackInfoDlgOpen","trackLabelHeight","flexShrink","ArrowDropDownIcon","Track","ReactComponent","__spreadArray","to","from","il","j","Row","setValue","setName","rows","setRows","getRealPos","key","newValue","newRows","newName","addRelativeAnnotation","specialFromEntries","VerticalResizeHandle","distance_1","setTreeAreaWidth","document","HorizontalResizeHandle","distance_2","setHeight","MouseoverCanvas","done","initialized","turnedOnTracks","Rubberband","ImportForm","DialogComponent","DialogProps","annotPos","AnnotationDialog","ClustalMSA","text","parse","getMSA","getRow","alns","aln","seq","getWidth","getDetails","header","getNames","getStructures","defineProperty","get","enumerable","configurable","getTree","consensus","seqConsensus","trim","customColorScheme","ancestors","tokens","token","subtree","pop","parseFloat","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","StockholmMSA","res","Stockholm","parseAll","seqdata","gf","DE","General","Accessions","gs","AC","Dbxref","DR","rowName","dbxref","getSeqCoords","pdbRegex","ent","dr","exec","match","toLowerCase","chain","startPos","endPos","reduce","a","rest","NH","parseNewick","gc","seq_cons","SS_cons","secondaryStructureConsensus","FastaMSA","re","line","AnnotationBlock","modelColorScheme","AnnotationTrack","Layout","maxHeight","maxHeightReached","rbush","rectangles","Map","pTotalHeight","addRect","existingRecord","currHeight","collides","record","set","blanks","features","associatedRowName","layout","temp","feature","bpToPx","isStateTreeNode","getSnapshot","labelRef","note","Note","name_1","Name","f","join","__awaiter","thisArg","_arguments","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","then","__generator","body","g","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","skipBlanks","arg","setBrLength","d","y0","k","maxLength","collapse","_children","clamp","StructureModel","types","identifier","string","number","range","maybe","UniprotTrack","optional","volatile","actions","self","afterCreate","_this","addDisposer","autorun","url","response","e_1","fetch","ok","Error","status","statusText","views","gff","parseStringSync","MSAModel","ElementId","literal","mouseRow","array","treeFilehandle","FileLocation","boxTracks","boolean","annotatedRegions","frozen","setTree","setMSA","dlg","props","elt","r","remove","toggleStructureSelection","clearSelectedStructures","console","col","row","cast","openLocation","readFile","e_2","e_3","oldBlocksX","oldBlocksY","oldValX","oldValY","size","flat","details","matches","sniff","startsWith","rowNames","getMouseOverResidue","hier","sum","sort","ascending","collapsedId","pdbEntry","strs","counter","cols","columns2d","root","cluster","totalHeight","separation","clust","numColumns","setMouseoveredColumn","file","inverseStructures","delete","m","adapterTracks","TextTrack","BoxTrack","annotationTracks","region","attrs","coord","count","pos","snapshotProcessor","compose","BaseViewModel","postProcessor","App","msaview","nglSelection","setNGLSelection","sel","DatasourceRegistry","add","StaticDatasource","ProteinPanel","setType","setRes","annotation","setAnnotation","stage","setStage","isMouseHovering","setMouseHovering","stageElementRef","useCallback","element","currentStage","Stage","dispose","handleResize","all","selection","loadFile","signals","hovered","pickingProxy","atom","bond","closestBondAtom","resno","chainname","picker","removeAllRepresentations","addRepresentation","sele","autoView","annots","removeAnnotation","rn","residueStore","rp","getResidueProxy","ap","getAtomProxy","atomOffset","addAnnotation","positionToVector3","qualifiedName","viewer","requestRender","clearSelection","onMouseEnter","URLSearchParams","mymodel","AppGlobal","create","setWidth","innerWidth","onSnapshot","throttle","snap","URL","searchParams","history","replaceState","toString","border","MSAView","MainApp","createJBrowseTheme","ThemeProvider","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.a2d97358.chunk.js","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { Button, Container, Grid, Typography, Link } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { transaction } from 'mobx';\nimport { FileSelector } from '@jbrowse/core/ui';\nimport { smallTree, smallMSA, smallMSAOnly } from './data/seq2';\nvar ListItem = function (_a) {\n    var onClick = _a.onClick, model = _a.model, children = _a.children;\n    return (_jsx(\"li\", { children: _jsx(Link, __assign({ onClick: function () {\n                model.setError(undefined);\n                onClick();\n            }, href: \"#\" }, { children: _jsx(Typography, { children: children }, void 0) }), void 0) }, void 0));\n};\nexport default observer(function (_a) {\n    var model = _a.model;\n    var _b = useState(), msaFile = _b[0], setMsaFile = _b[1];\n    var _c = useState(), treeFile = _c[0], setTreeFile = _c[1];\n    var error = model.error;\n    return (_jsxs(Container, { children: [_jsxs(\"div\", __assign({ style: { width: '50%' } }, { children: [error ? (_jsx(\"div\", __assign({ style: { padding: 20 } }, { children: _jsxs(Typography, __assign({ color: \"error\" }, { children: [\"Error: \", \"\" + error] }), void 0) }), void 0)) : null,\n                    _jsx(Typography, { children: \"Open an MSA file (stockholm or clustal format) and/or a tree file (newick format).\" }, void 0),\n                    _jsx(Typography, __assign({ color: \"error\" }, { children: \"Note: you can open up just an MSA or just a tree, both are not required. Some MSA files e.g. stockholm format have an embedded tree also and this is fine, and opening a separate tree file is not required.\" }), void 0)] }), void 0),\n            _jsxs(Grid, __assign({ container: true, spacing: 10, justify: \"center\", alignItems: \"center\" }, { children: [_jsxs(Grid, __assign({ item: true }, { children: [_jsx(Typography, { children: \"MSA file or URL\" }, void 0),\n                            _jsx(FileSelector, { location: msaFile, setLocation: setMsaFile }, void 0),\n                            _jsx(Typography, { children: \"Tree file or URL\" }, void 0),\n                            _jsx(FileSelector, { location: treeFile, setLocation: setTreeFile }, void 0)] }), void 0),\n                    _jsx(Grid, __assign({ item: true }, { children: _jsx(Button, __assign({ onClick: function () {\n                                model.setError(undefined);\n                                if (msaFile) {\n                                    model.setMSAFilehandle(msaFile);\n                                }\n                                if (treeFile) {\n                                    model.setTreeFilehandle(treeFile);\n                                }\n                            }, variant: \"contained\", color: \"primary\", disabled: !msaFile && !treeFile }, { children: \"Open\" }), void 0) }), void 0),\n                    _jsxs(Grid, __assign({ item: true }, { children: [_jsx(Typography, { children: \"Examples\" }, void 0),\n                            _jsxs(\"ul\", { children: [_jsx(ListItem, __assign({ model: model, onClick: function () {\n                                            model.setTreeFilehandle({\n                                                uri: 'https://jbrowse.org/genomes/newick_trees/sarscov2phylo.pub.ft.nh',\n                                            });\n                                        } }, { children: \"230k COVID-19 samples (tree only)\" }), void 0),\n                                    _jsx(ListItem, __assign({ model: model, onClick: function () {\n                                            model.setData({ msa: smallMSA, tree: smallTree });\n                                        } }, { children: \"Small protein MSA+tree\" }), void 0),\n                                    _jsx(ListItem, __assign({ model: model, onClick: function () {\n                                            model.setData({ msa: smallMSAOnly });\n                                        } }, { children: \"Small MSA only\" }), void 0),\n                                    _jsx(ListItem, __assign({ model: model, onClick: function () {\n                                            model.setMSAFilehandle({\n                                                uri: 'https://ihh.github.io/abrowse/build/pfam-cov2.stock',\n                                            });\n                                        } }, { children: \"PFAM SARS-CoV2 multi-stockholm\" }), void 0),\n                                    _jsx(ListItem, __assign({ model: model, onClick: function () {\n                                            model.setMSAFilehandle({\n                                                uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/Lysine.stock',\n                                            });\n                                        } }, { children: \"Lysine stockholm file\" }), void 0),\n                                    _jsx(ListItem, __assign({ model: model, onClick: function () {\n                                            model.setMSAFilehandle({\n                                                uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/PF01601_full.txt',\n                                            });\n                                        } }, { children: \"PF01601 stockholm file (SARS-CoV2 spike protein)\" }), void 0),\n                                    _jsx(ListItem, __assign({ model: model, onClick: function () {\n                                            model.setMSAFilehandle({\n                                                uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/europe_covid.fa',\n                                            });\n                                        } }, { children: \"Europe COVID full genomes (LR883044.1 and 199 other sequences)\" }), void 0),\n                                    _jsx(ListItem, __assign({ model: model, onClick: function () {\n                                            transaction(function () {\n                                                model.setMSAFilehandle({\n                                                    uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/rhv_test-only.aligned_with_mafft_auto.fa',\n                                                });\n                                                model.setTreeFilehandle({\n                                                    uri: 'https://jbrowse.org/genomes/multiple_sequence_alignments/rhv_test-only.aligned_with_mafft_auto.nh',\n                                                });\n                                            });\n                                        } }, { children: \"MAFFT+VeryFastTree(17.9k samples)\" }), void 0)] }, void 0)] }), void 0)] }), void 0)] }, void 0));\n});\n","export var smallMSA = \"CLUSTAL O(1.2.3) multiple sequence alignment\\nUniProt/Swiss-Prot|P26898|IL2RA_SHEEP      MEPSLLMWRFFVFIVVPGCVTEACHDDPPSLRNA----------MFKVLRYE----VGTM\\nUniProt/Swiss-Prot|P01590|IL2RA_MOUSE      MEPRLLMLGFLSLTIVPSCRAELCLYDPPEVPNA----------TFKALSYK----NGTI\\nUniProt/Swiss-Prot|P41690|IL2RA_FELCA      MEPSLLLWGILTFVVVHGHVTELCDENPPDIQHA----------TFKALTYK----TGTM\\nUniProt/Swiss-Prot|P01589|IL2RA_HUMAN      MDSYLLMWGLLTFIMVPGCQAELCDDDPPEIPHA----------TFKAMAYK----EGTM\\nUniProt/Swiss-Prot|Q5MNY4|IL2RA_MACMU      MDPYLLMWGLLTFITVPGCQAELCDDDPPKITHA----------TFKAVAYK----EGTM\\nUniProt/Swiss-Prot|Q95118|IL2RG_BOVIN      -----------------------------------LLMWGLLT-----------------\\nUniProt/Swiss-Prot|P40321|IL2RG_CANFA      MLKPPLPLRSLLFLQLSLLGVGLNSTVPMPNGNEDIT------PDFFLTATPSETLSVSS\\nUniProt/Swiss-Prot|P26896|IL2RB_RAT        MATVDLSWRLPLYILLLLLATT--------------------------------WVSAAV\\nUniProt/Swiss-Prot|Q8BZM1|GLMN_MOUSE       PLPLRSLLFLQLPLLGVGLNP------------------PLPLRSLLFLQLPLLGVGLNP\\nUniProt/Swiss-Prot|P36835|IL2_CAPHI        -----------LLGVGLNPKFLTP------------------------------------\\nUniProt/Swiss-Prot|Q7JFM4|IL2_AOTVO        MLKPPLPLRSLLFLQLPLLGVGLNPKFLTPSGNEDIGGKPGTGGDFFLTSTPAGTLDVST\\nUniProt/Swiss-Prot|Q29416|IL2_CANFA        --------------LFLQLSLLG-------------------------------------\\n\";\nexport var smallMSAOnly = \"CLUSTAL O(1.2.4) multiple sequence alignment\\n\\n\\nsp|P69905|HBA_HUMAN       MVLSPADKTNVKAAWGKVGAHAGEYGAEALERMFLSFPTTKTYFPHFDLSHGSAQVKGHG\\t60\\nsp|P01942|HBA_MOUSE       MVLSGEDKSNIKAAWGKIGGHGAEYGAEALERMFASFPTTKTYFPHFDVSHGSAQVKGHG\\t60\\nsp|P13786|HBAZ_CAPHI      MSLTRTERTIILSLWSKISTQADVIGTETLERLFSCYPQAKTYFPHFDLHSGSAQLRAHG\\t60\\n                          * *:  ::: : : *.*:. :.   *:*:***:* .:* :********:  ****::.**\\n\\nsp|P69905|HBA_HUMAN       KKVADALTNAVAHVDDMPNALSALSDLHAHKLRVDPVNFKLLSHCLLVTLAAHLPAEFTP\\t120\\nsp|P01942|HBA_MOUSE       KKVADALASAAGHLDDLPGALSALSDLHAHKLRVDPVNFKLLSHCLLVTLASHHPADFTP\\t120\\nsp|P13786|HBAZ_CAPHI      SKVVAAVGDAVKSIDNVTSALSKLSELHAYVLRVDPVNFKFLSHCLLVTLASHFPADFTA\\t120\\n                          .**. *: .*.  :*:: .*** **:***: *********:**********:* **:**\\n\\nsp|P69905|HBA_HUMAN       AVHASLDKFLASVSTVLTSKYR\\t142\\nsp|P01942|HBA_MOUSE       AVHASLDKFLASVSTVLTSKYR\\t142\\nsp|P13786|HBAZ_CAPHI      DAHAAWDKFLSIVSGVLTEKYR\\t142\\n                           .**: ****: ** ***.***\";\nexport var smallTree = '(((UniProt/Swiss-Prot|P26898|IL2RA_SHEEP:0.24036,(UniProt/Swiss-Prot|P41690|IL2RA_FELCA:0.17737,(UniProt/Swiss-Prot|P01589|IL2RA_HUMAN:0.03906,UniProt/Swiss-Prot|Q5MNY4|IL2RA_MACMU:0.03787):0.13033):0.04964):0.02189,UniProt/Swiss-Prot|P01590|IL2RA_MOUSE:0.23072):0.06814,(((UniProt/Swiss-Prot|Q95118|IL2RG_BOVIN:0.09600,UniProt/Swiss-Prot|P40321|IL2RG_CANFA:0.09845):0.25333,UniProt/Swiss-Prot|Q29416|IL2_CANFA:-0.35055):0.10231,(UniProt/Swiss-Prot|P26896|IL2RB_RAT:0.33631,UniProt/Swiss-Prot|Q7JFM4|IL2_AOTVO:-0.33631):0.10166):0.01607,(UniProt/Swiss-Prot|Q8BZM1|GLMN_MOUSE:0.32378,UniProt/Swiss-Prot|P36835|IL2_CAPHI:-0.32378):0.09999)';\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useRef, useEffect, useState } from 'react';\nimport { observer } from 'mobx-react';\n// material ui\nimport { Popover, Tooltip, Typography, makeStyles, alpha, } from '@material-ui/core';\nimport AssignmentIcon from '@material-ui/icons/Assignment';\n// import { stringify } from '@jbrowse/core/util'\nimport { Menu } from '@jbrowse/core/ui';\nvar useStyles = makeStyles(function (theme) {\n    var background = theme.palette.tertiary\n        ? alpha(theme.palette.tertiary.main, 0.7)\n        : alpha(theme.palette.primary.main, 0.7);\n    return {\n        rubberband: {\n            height: '100%',\n            background: background,\n            position: 'absolute',\n            zIndex: 10,\n            textAlign: 'center',\n            overflow: 'hidden',\n        },\n        rubberbandControl: {\n            cursor: 'crosshair',\n            width: '100%',\n            minHeight: 8,\n        },\n        rubberbandText: {\n            color: theme.palette.tertiary\n                ? theme.palette.tertiary.contrastText\n                : theme.palette.primary.contrastText,\n        },\n        popover: {\n            mouseEvents: 'none',\n            cursor: 'crosshair',\n        },\n        paper: {\n            paddingLeft: theme.spacing(1),\n            paddingRight: theme.spacing(1),\n        },\n        guide: {\n            pointerEvents: 'none',\n            height: '100%',\n            width: 1,\n            position: 'absolute',\n            zIndex: 10,\n        },\n    };\n});\nvar VerticalGuide = observer(function (_a) {\n    var model = _a.model, coordX = _a.coordX;\n    var treeAreaWidth = model.treeAreaWidth;\n    var classes = useStyles();\n    return (_jsxs(_Fragment, { children: [_jsx(Tooltip, __assign({ open: true, placement: \"top\", title: \"\" + (model.pxToBp(coordX) + 1), arrow: true }, { children: _jsx(\"div\", { style: {\n                        left: coordX + treeAreaWidth,\n                        position: 'absolute',\n                        height: 1,\n                    } }, void 0) }), void 0),\n            _jsx(\"div\", { className: classes.guide, style: {\n                    left: coordX + treeAreaWidth,\n                    background: 'red',\n                } }, void 0)] }, void 0));\n});\nfunction Rubberband(_a) {\n    var model = _a.model, _b = _a.ControlComponent, ControlComponent = _b === void 0 ? _jsx(\"div\", {}, void 0) : _b;\n    var treeAreaWidth = model.treeAreaWidth;\n    var _c = useState(), startX = _c[0], setStartX = _c[1];\n    var _d = useState(), currentX = _d[0], setCurrentX = _d[1];\n    // clientX and clientY used for anchorPosition for menu\n    // offsetX used for calculations about width of selection\n    var _e = useState(), anchorPosition = _e[0], setAnchorPosition = _e[1];\n    var _f = useState(), guideX = _f[0], setGuideX = _f[1];\n    var controlsRef = useRef(null);\n    var rubberbandRef = useRef(null);\n    var classes = useStyles();\n    var mouseDragging = startX !== undefined && anchorPosition === undefined;\n    useEffect(function () {\n        function globalMouseMove(event) {\n            if (controlsRef.current && mouseDragging) {\n                var relativeX = event.clientX - controlsRef.current.getBoundingClientRect().left;\n                setCurrentX(relativeX);\n            }\n        }\n        function globalMouseUp(event) {\n            if (startX !== undefined && controlsRef.current) {\n                var clientX = event.clientX, clientY = event.clientY;\n                var ref = controlsRef.current;\n                var offsetX = clientX - ref.getBoundingClientRect().left;\n                // as stated above, store both clientX/Y and offsetX for different\n                // purposes\n                setAnchorPosition({\n                    offsetX: offsetX,\n                    clientX: clientX,\n                    clientY: clientY,\n                });\n                setGuideX(undefined);\n            }\n        }\n        if (mouseDragging) {\n            window.addEventListener('mousemove', globalMouseMove);\n            window.addEventListener('mouseup', globalMouseUp);\n            return function () {\n                window.removeEventListener('mousemove', globalMouseMove);\n                window.removeEventListener('mouseup', globalMouseUp);\n            };\n        }\n        return function () { };\n    }, [startX, mouseDragging, anchorPosition]);\n    useEffect(function () {\n        if (!mouseDragging &&\n            currentX !== undefined &&\n            startX !== undefined &&\n            Math.abs(currentX - startX) <= 3) {\n            handleClose();\n        }\n    }, [mouseDragging, currentX, startX, model.colWidth]);\n    function mouseDown(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        var relativeX = event.clientX -\n            event.target.getBoundingClientRect().left;\n        setStartX(relativeX);\n        setCurrentX(relativeX);\n    }\n    function mouseMove(event) {\n        var target = event.target;\n        setGuideX(event.clientX - target.getBoundingClientRect().left);\n    }\n    function mouseOut() {\n        setGuideX(undefined);\n        model.clearAnnotPos();\n    }\n    function handleClose() {\n        setAnchorPosition(undefined);\n        setStartX(undefined);\n        setCurrentX(undefined);\n    }\n    //eslint-disable-next-line @typescript-eslint/ban-types\n    function handleMenuItemClick(_, callback) {\n        callback();\n        handleClose();\n    }\n    if (startX === undefined) {\n        return (_jsxs(_Fragment, { children: [guideX !== undefined ? (_jsx(VerticalGuide, { model: model, coordX: guideX }, void 0)) : null,\n                _jsx(\"div\", __assign({ \"data-testid\": \"rubberband_controls\", className: classes.rubberbandControl, role: \"presentation\", ref: controlsRef, onMouseDown: mouseDown, onMouseOut: mouseOut, onMouseMove: mouseMove }, { children: ControlComponent }), void 0)] }, void 0));\n    }\n    var right = anchorPosition ? anchorPosition.offsetX : currentX || 0;\n    var left = right < startX ? right : startX;\n    var width = Math.abs(right - startX);\n    var leftBpOffset = model.pxToBp(left);\n    var rightBpOffset = model.pxToBp(left + width);\n    var numOfBpSelected = Math.ceil(width / model.colWidth);\n    var menuItems = [\n        {\n            label: 'Create annotation',\n            icon: AssignmentIcon,\n            onClick: function () {\n                model.setOffsets(leftBpOffset, rightBpOffset);\n                handleClose();\n            },\n        },\n    ];\n    return (_jsxs(_Fragment, { children: [rubberbandRef.current ? (_jsxs(_Fragment, { children: [_jsx(Popover, __assign({ className: classes.popover, classes: {\n                            paper: classes.paper,\n                        }, open: true, anchorEl: rubberbandRef.current, anchorOrigin: {\n                            vertical: 'top',\n                            horizontal: 'left',\n                        }, transformOrigin: {\n                            vertical: 'bottom',\n                            horizontal: 'right',\n                        }, keepMounted: true, disableRestoreFocus: true }, { children: _jsx(Typography, { children: leftBpOffset + 1 }, void 0) }), void 0),\n                    _jsx(Popover, __assign({ className: classes.popover, classes: {\n                            paper: classes.paper,\n                        }, open: true, anchorEl: rubberbandRef.current, anchorOrigin: {\n                            vertical: 'top',\n                            horizontal: 'right',\n                        }, transformOrigin: {\n                            vertical: 'bottom',\n                            horizontal: 'left',\n                        }, keepMounted: true, disableRestoreFocus: true }, { children: _jsx(Typography, { children: rightBpOffset + 1 }, void 0) }), void 0)] }, void 0)) : null,\n            _jsx(\"div\", __assign({ ref: rubberbandRef, className: classes.rubberband, style: { left: left + treeAreaWidth, width: width } }, { children: _jsxs(Typography, __assign({ variant: \"h6\", className: classes.rubberbandText }, { children: [numOfBpSelected.toLocaleString('en-US'), \" bp\"] }), void 0) }), void 0),\n            _jsx(\"div\", __assign({ \"data-testid\": \"rubberband_controls\", className: classes.rubberbandControl, role: \"presentation\", ref: controlsRef, onMouseDown: mouseDown, onMouseOut: mouseOut, onMouseMove: mouseMove }, { children: ControlComponent }), void 0),\n            anchorPosition ? (_jsx(Menu, { anchorReference: \"anchorPosition\", anchorPosition: {\n                    left: anchorPosition.clientX,\n                    top: anchorPosition.clientY,\n                }, onMenuItemClick: handleMenuItemClick, open: Boolean(anchorPosition), onClose: handleClose, menuItems: menuItems }, void 0)) : null] }, void 0));\n}\nexport default observer(Rubberband);\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Dialog, DialogTitle, DialogContent } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { Attributes } from '@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail';\nexport default observer(function (_a) {\n    var info = _a.info, onClose = _a.onClose;\n    return (_jsxs(Dialog, __assign({ onClose: function () { return onClose(); }, open: true }, { children: [_jsx(DialogTitle, { children: \"Metadata\" }, void 0),\n            _jsx(DialogContent, { children: _jsx(Attributes, { attributes: info }, void 0) }, void 0)] }), void 0));\n});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { useEffect, useRef, useState } from 'react';\nimport { Menu, MenuItem } from '@material-ui/core';\nimport normalizeWheel from 'normalize-wheel';\nimport { observer } from 'mobx-react';\nimport RBush from 'rbush';\nimport MoreInfoDlg from './MoreInfoDlg';\nvar extendBounds = 5;\nvar radius = 3.5;\nvar d = radius * 2;\nvar padding = 600;\nvar TreeMenu = observer(function (_a) {\n    var _b, _c;\n    var node = _a.node, onClose = _a.onClose, model = _a.model;\n    var structures = model.structures;\n    var nodeDetails = node ? model.getRowDetails(node.name) : undefined;\n    return (_jsx(_Fragment, { children: _jsxs(Menu, __assign({ anchorReference: \"anchorPosition\", anchorPosition: {\n                top: node.y,\n                left: node.x,\n            }, transitionDuration: 0, keepMounted: true, open: Boolean(node), onClose: onClose }, { children: [_jsx(MenuItem, __assign({ dense: true, disabled: true }, { children: node.name }), void 0),\n                _jsx(MenuItem, __assign({ dense: true, onClick: function () {\n                        model.setDialogComponent(MoreInfoDlg, {\n                            info: model.getRowDetails(node.name),\n                        });\n                        onClose();\n                    } }, { children: \"More info...\" }), void 0),\n                (_b = structures[node.name]) === null || _b === void 0 ? void 0 : _b.map(function (entry) {\n                    return !model.selectedStructures.find(function (n) { return n.id === node.name; }) ? (_jsxs(MenuItem, __assign({ dense: true, onClick: function () {\n                            model.addStructureToSelection({\n                                structure: entry,\n                                id: node.name,\n                            });\n                            onClose();\n                        } }, { children: [\"Add PDB to selection (\", entry.pdb, \")\"] }), JSON.stringify(entry))) : (_jsxs(MenuItem, __assign({ dense: true, onClick: function () {\n                            model.removeStructureFromSelection({\n                                structure: entry,\n                                id: node.name,\n                            });\n                            onClose();\n                        } }, { children: [\"Remove PDB from selection (\", entry.pdb, \")\"] }), JSON.stringify(entry)));\n                }),\n                (_c = nodeDetails.accession) === null || _c === void 0 ? void 0 : _c.map(function (accession) { return (_jsxs(MenuItem, __assign({ dense: true, onClick: function () {\n                        model.addUniprotTrack({ name: nodeDetails.name, accession: accession });\n                        onClose();\n                    } }, { children: [\"Open UniProt track (\", accession, \")\"] }), accession)); })] }), void 0) }, void 0));\n});\nvar TreeBranchMenu = observer(function (_a) {\n    var node = _a.node, model = _a.model, onClose = _a.onClose;\n    return (_jsxs(Menu, __assign({ anchorReference: \"anchorPosition\", anchorPosition: {\n            left: node.x,\n            top: node.y,\n        }, transitionDuration: 0, keepMounted: true, open: Boolean(node), onClose: onClose }, { children: [_jsx(MenuItem, __assign({ dense: true, disabled: true }, { children: node.name }), void 0),\n            _jsx(MenuItem, __assign({ dense: true, onClick: function () {\n                    model.toggleCollapsed(node.id);\n                    onClose();\n                } }, { children: model.collapsed.includes(node.id)\n                    ? 'Expand this node'\n                    : 'Collapse this node' }), void 0),\n            _jsx(MenuItem, __assign({ dense: true, onClick: function () {\n                    model.showOnly === node.id\n                        ? model.setShowOnly(undefined)\n                        : model.setShowOnly(node.id);\n                    onClose();\n                } }, { children: model.showOnly === node.id\n                    ? 'Disable show only this node'\n                    : 'Show only this node' }), void 0)] }), void 0));\n});\nvar TreeBlock = observer(function (_a) {\n    var model = _a.model, offsetY = _a.offsetY;\n    var ref = useRef(null);\n    var clickMap = useRef(new RBush());\n    var mouseoverRef = useRef(null);\n    var _b = useState(), branchMenu = _b[0], setBranchMenu = _b[1];\n    var _c = useState(), toggleNodeMenu = _c[0], setToggleNodeMenu = _c[1];\n    var _d = useState(), hoverElt = _d[0], setHoverElt = _d[1];\n    var hierarchy = model.hierarchy, rowHeight = model.rowHeight, scrollY = model.scrollY, treeWidth = model.treeWidth, showBranchLen = model.showBranchLen, collapsed = model.collapsed, margin = model.margin, labelsAlignRight = model.labelsAlignRight, noTree = model.noTree, blockSize = model.blockSize, drawNodeBubbles = model.drawNodeBubbles, drawTree = model.drawTree, treeAreaWidth = model.treeAreaWidth, structures = model.structures, highResScaleFactor = model.highResScaleFactor;\n    useEffect(function () {\n        clickMap.current.clear();\n        if (!ref.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        ctx.resetTransform();\n        ctx.scale(highResScaleFactor, highResScaleFactor);\n        ctx.clearRect(0, 0, treeWidth + padding, blockSize);\n        ctx.translate(margin.left, -offsetY);\n        var font = ctx.font;\n        ctx.font = font.replace(/\\d+px/, Math.max(8, rowHeight - 8) + \"px\");\n        if (!noTree && drawTree) {\n            hierarchy.links().forEach(function (_a) {\n                var source = _a.source, target = _a.target;\n                var y = showBranchLen ? 'len' : 'y';\n                //@ts-ignore\n                var _b = source, sy = _b.x, _c = y, sx = _b[_c];\n                //@ts-ignore\n                var _d = target, ty = _d.x, _e = y, tx = _d[_e];\n                var y1 = Math.min(sy, ty);\n                var y2 = Math.max(sy, ty);\n                //1d line intersection to check if line crosses block at all, this is\n                //an optimization that allows us to skip drawing most tree links\n                //outside the block\n                if (offsetY + blockSize >= y1 && y2 >= offsetY) {\n                    ctx.beginPath();\n                    ctx.moveTo(sx, sy);\n                    ctx.lineTo(sx, ty);\n                    ctx.lineTo(tx, ty);\n                    ctx.stroke();\n                }\n            });\n            if (drawNodeBubbles) {\n                hierarchy.descendants().forEach(function (node) {\n                    var val = showBranchLen ? 'len' : 'y';\n                    var _a = node, \n                    //@ts-ignore\n                    y = _a.x, \n                    //@ts-ignore\n                    _b = val, \n                    //@ts-ignore\n                    x = _a[_b], data = _a.data;\n                    var _c = data.id, id = _c === void 0 ? '' : _c, _d = data.name, name = _d === void 0 ? '' : _d;\n                    if (y > offsetY - extendBounds &&\n                        y < offsetY + blockSize + extendBounds) {\n                        ctx.strokeStyle = 'black';\n                        ctx.fillStyle = collapsed.includes(id) ? 'black' : 'white';\n                        ctx.beginPath();\n                        ctx.arc(x, y, radius, 0, 2 * Math.PI);\n                        ctx.fill();\n                        ctx.stroke();\n                        clickMap.current.insert({\n                            minX: x - radius,\n                            maxX: x - radius + d,\n                            minY: y - radius,\n                            maxY: y - radius + d,\n                            branch: true,\n                            id: id,\n                            name: name,\n                        });\n                    }\n                });\n            }\n        }\n        if (rowHeight >= 10) {\n            if (labelsAlignRight) {\n                ctx.textAlign = 'right';\n                ctx.setLineDash([1, 3]);\n            }\n            else {\n                ctx.textAlign = 'start';\n            }\n            hierarchy.leaves().forEach(function (node) {\n                var \n                //@ts-ignore\n                y = node.x, \n                //@ts-ignore\n                x = node.y, _a = node.data, name = _a.name, id = _a.id, \n                //@ts-ignore\n                len = node.len;\n                if (y > offsetY - extendBounds &&\n                    y < offsetY + blockSize + extendBounds) {\n                    //note: +rowHeight/4 matches with -rowHeight/4 in msa\n                    var yp = y + rowHeight / 4;\n                    var xp = showBranchLen ? len : x;\n                    var width = ctx.measureText(name).width;\n                    var height = ctx.measureText('M').width; // use an 'em' for height\n                    var hasStructure = structures[name];\n                    ctx.fillStyle = hasStructure ? 'blue' : 'black';\n                    if (!drawTree && !labelsAlignRight) {\n                        ctx.fillText(name, 0, yp);\n                        clickMap.current.insert({\n                            minX: 0,\n                            maxX: width,\n                            minY: yp - height,\n                            maxY: yp,\n                            name: name,\n                            id: id,\n                        });\n                    }\n                    else if (labelsAlignRight) {\n                        var smallPadding = 2;\n                        var offset = treeAreaWidth - smallPadding - margin.left;\n                        if (drawTree && !noTree) {\n                            var width_1 = ctx.measureText(name).width;\n                            ctx.moveTo(xp + radius + 2, y);\n                            ctx.lineTo(offset - smallPadding - width_1, y);\n                            ctx.stroke();\n                        }\n                        ctx.fillText(name, offset, yp);\n                        clickMap.current.insert({\n                            minX: treeAreaWidth - margin.left - width,\n                            maxX: treeAreaWidth - margin.left,\n                            minY: yp - height,\n                            maxY: yp,\n                            name: name,\n                            id: id,\n                        });\n                    }\n                    else {\n                        ctx.fillText(name, xp + d, yp);\n                        clickMap.current.insert({\n                            minX: xp + d,\n                            maxX: xp + d + width,\n                            minY: yp - height,\n                            maxY: yp,\n                            name: name,\n                            id: id,\n                        });\n                    }\n                }\n            });\n            ctx.setLineDash([]);\n        }\n    }, [\n        collapsed,\n        rowHeight,\n        margin.left,\n        hierarchy,\n        offsetY,\n        treeWidth,\n        showBranchLen,\n        noTree,\n        blockSize,\n        drawNodeBubbles,\n        drawTree,\n        labelsAlignRight,\n        treeAreaWidth,\n        structures,\n    ]);\n    useEffect(function () {\n        var canvas = mouseoverRef.current;\n        if (!canvas) {\n            return;\n        }\n        var ctx = canvas.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        ctx.resetTransform();\n        ctx.clearRect(0, 0, treeWidth + padding, blockSize);\n        ctx.translate(margin.left, -offsetY);\n        if (hoverElt) {\n            var minX = hoverElt.minX, maxX = hoverElt.maxX, minY = hoverElt.minY, maxY = hoverElt.maxY;\n            ctx.fillStyle = 'rgba(0,0,0,0.1)';\n            ctx.fillRect(minX, minY, maxX - minX, maxY - minY);\n        }\n    }, [hoverElt, margin.left, offsetY, blockSize, treeWidth]);\n    function hoverBranchClickMap(event) {\n        var x = event.nativeEvent.offsetX - margin.left;\n        var y = event.nativeEvent.offsetY;\n        var entry = clickMap.current.search({\n            minX: x,\n            maxX: x + 1,\n            minY: y + offsetY,\n            maxY: y + 1 + offsetY,\n        })[0];\n        return entry && entry.branch\n            ? __assign(__assign({}, entry), { x: event.clientX, y: event.clientY }) : undefined;\n    }\n    function hoverNameClickMap(event) {\n        var x = event.nativeEvent.offsetX - margin.left;\n        var y = event.nativeEvent.offsetY;\n        var entry = clickMap.current.search({\n            minX: x,\n            maxX: x + 1,\n            minY: y + offsetY,\n            maxY: y + 1 + offsetY,\n        })[0];\n        return entry && !entry.branch\n            ? __assign(__assign({}, entry), { x: event.clientX, y: event.clientY }) : undefined;\n    }\n    return (_jsxs(_Fragment, { children: [(branchMenu === null || branchMenu === void 0 ? void 0 : branchMenu.id) ? (_jsx(TreeBranchMenu, { node: branchMenu, model: model, onClose: function () { return setBranchMenu(undefined); } }, void 0)) : null,\n            (toggleNodeMenu === null || toggleNodeMenu === void 0 ? void 0 : toggleNodeMenu.id) ? (_jsx(TreeMenu, { node: toggleNodeMenu, model: model, onClose: function () { return setToggleNodeMenu(undefined); } }, void 0)) : null,\n            _jsx(\"canvas\", { width: (treeWidth + padding) * highResScaleFactor, height: blockSize * highResScaleFactor, style: {\n                    width: treeWidth + padding,\n                    height: blockSize,\n                    top: scrollY + offsetY,\n                    left: 0,\n                    position: 'absolute',\n                }, onMouseMove: function (event) {\n                    if (!ref.current) {\n                        return;\n                    }\n                    var ret = hoverNameClickMap(event) || hoverBranchClickMap(event);\n                    if (ret) {\n                        ref.current.style.cursor = 'pointer';\n                    }\n                    else {\n                        ref.current.style.cursor = 'default';\n                    }\n                    setHoverElt(hoverNameClickMap(event));\n                }, onClick: function (event) {\n                    var x = event.clientX, y = event.clientY;\n                    var data = hoverBranchClickMap(event);\n                    if (data === null || data === void 0 ? void 0 : data.id) {\n                        setBranchMenu(__assign(__assign({}, data), { x: x, y: y }));\n                    }\n                    var data2 = hoverNameClickMap(event);\n                    if (data2 === null || data2 === void 0 ? void 0 : data2.id) {\n                        setToggleNodeMenu(__assign(__assign({}, data2), { x: x, y: y }));\n                    }\n                }, ref: ref }, void 0),\n            _jsx(\"canvas\", { style: {\n                    width: treeWidth + padding,\n                    height: blockSize,\n                    top: scrollY + offsetY,\n                    left: 0,\n                    position: 'absolute',\n                    pointerEvents: 'none',\n                    zIndex: 100,\n                }, width: treeWidth + padding, height: blockSize, ref: mouseoverRef }, void 0)] }, void 0));\n});\nvar TreeCanvas = observer(function (_a) {\n    var model = _a.model;\n    var ref = useRef(null);\n    var scheduled = useRef(false);\n    var deltaY = useRef(0);\n    var prevY = useRef(0);\n    var treeWidth = model.treeWidth, height = model.height, blocksY = model.blocksY;\n    var _b = useState(false), mouseDragging = _b[0], setMouseDragging = _b[1];\n    useEffect(function () {\n        var curr = ref.current;\n        if (!curr) {\n            return;\n        }\n        function onWheel(origEvent) {\n            var event = normalizeWheel(origEvent);\n            deltaY.current += event.pixelY;\n            if (!scheduled.current) {\n                scheduled.current = true;\n                requestAnimationFrame(function () {\n                    model.doScrollY(-deltaY.current);\n                    deltaY.current = 0;\n                    scheduled.current = false;\n                });\n            }\n            origEvent.preventDefault();\n        }\n        curr.addEventListener('wheel', onWheel);\n        return function () {\n            curr.removeEventListener('wheel', onWheel);\n        };\n    }, [model]);\n    useEffect(function () {\n        var cleanup = function () { };\n        function globalMouseMove(event) {\n            event.preventDefault();\n            var currY = event.clientY;\n            var distanceY = currY - prevY.current;\n            if (distanceY) {\n                // use rAF to make it so multiple event handlers aren't fired per-frame\n                // see https://calendar.perfplanet.com/2013/the-runtime-performance-checklist/\n                if (!scheduled.current) {\n                    scheduled.current = true;\n                    window.requestAnimationFrame(function () {\n                        model.doScrollY(distanceY);\n                        scheduled.current = false;\n                        prevY.current = event.clientY;\n                    });\n                }\n            }\n        }\n        function globalMouseUp() {\n            prevY.current = 0;\n            if (mouseDragging) {\n                setMouseDragging(false);\n            }\n        }\n        if (mouseDragging) {\n            window.addEventListener('mousemove', globalMouseMove, true);\n            window.addEventListener('mouseup', globalMouseUp, true);\n            cleanup = function () {\n                window.removeEventListener('mousemove', globalMouseMove, true);\n                window.removeEventListener('mouseup', globalMouseUp, true);\n            };\n        }\n        return cleanup;\n    }, [model, mouseDragging]);\n    function mouseDown(event) {\n        // check if clicking a draggable element or a resize handle\n        var target = event.target;\n        if (target.draggable || target.dataset.resizer) {\n            return;\n        }\n        // otherwise do click and drag scroll\n        if (event.button === 0) {\n            prevY.current = event.clientY;\n            setMouseDragging(true);\n        }\n    }\n    // this local mouseup is used in addition to the global because sometimes\n    // the global add/remove are not called in time, resulting in issue #533\n    function mouseUp(event) {\n        event.preventDefault();\n        setMouseDragging(false);\n    }\n    function mouseLeave(event) {\n        event.preventDefault();\n    }\n    return (_jsx(\"div\", __assign({ ref: ref, onMouseDown: mouseDown, onMouseUp: mouseUp, onMouseLeave: mouseLeave, style: {\n            height: height,\n            position: 'relative',\n            overflow: 'hidden',\n            width: treeWidth + padding,\n        } }, { children: blocksY.map(function (block) { return (_jsx(TreeBlock, { model: model, offsetY: block }, block)); }) }), void 0));\n});\nexport default TreeCanvas;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport Color from 'color';\nexport function transform(obj, cb) {\n    return Object.fromEntries(Object.entries(obj).map(cb));\n}\nexport function generateNodeIds(tree, parent, depth) {\n    var _a;\n    if (parent === void 0) { parent = 'node'; }\n    if (depth === void 0) { depth = 0; }\n    var id = parent + \"-\" + depth;\n    return __assign(__assign({}, tree), { id: id, branchset: ((_a = tree.branchset) === null || _a === void 0 ? void 0 : _a.map(function (b, i) {\n            return generateNodeIds(b, id + \"-\" + i, depth + 1);\n        })) || [] });\n}\nexport function colorContrast(colorScheme, theme) {\n    return transform(colorScheme, function (_a) {\n        var letter = _a[0], color = _a[1];\n        return [\n            letter,\n            theme.palette.getContrastText(Color(color).hex()),\n        ];\n    });\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useEffect, useState, useRef, useMemo } from 'react';\nimport { Typography, CircularProgress, useTheme } from '@material-ui/core';\nimport normalizeWheel from 'normalize-wheel';\nimport { observer } from 'mobx-react';\nimport { colorContrast } from '../util';\nvar MSABlock = observer(function (_a) {\n    var model = _a.model, offsetX = _a.offsetX, offsetY = _a.offsetY;\n    var MSA = model.MSA, colWidth = model.colWidth, bgColor = model.bgColor, columns = model.columns, rowHeight = model.rowHeight, scrollY = model.scrollY, scrollX = model.scrollX, hierarchy = model.hierarchy, colorScheme = model.colorScheme, blockSize = model.blockSize, highResScaleFactor = model.highResScaleFactor;\n    var theme = useTheme();\n    var contrastScheme = useMemo(function () { return colorContrast(colorScheme, theme); }, [colorScheme, theme]);\n    var ref = useRef(null);\n    useEffect(function () {\n        if (!ref.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        ctx.resetTransform();\n        ctx.scale(highResScaleFactor, highResScaleFactor);\n        ctx.clearRect(0, 0, blockSize, blockSize);\n        ctx.translate(-offsetX, rowHeight / 2 - offsetY);\n        ctx.textAlign = 'center';\n        ctx.font = ctx.font.replace(/\\d+px/, Math.max(8, rowHeight - 8) + \"px\");\n        var leaves = hierarchy.leaves();\n        var b = blockSize;\n        // slice vertical rows, e.g. tree leaves, avoid negative slice\n        var yStart = Math.max(0, Math.floor((offsetY - rowHeight) / rowHeight));\n        var yEnd = Math.max(0, Math.ceil((offsetY + b + rowHeight) / rowHeight));\n        // slice horizontal visible letters, avoid negative slice\n        var xStart = Math.max(0, Math.floor(offsetX / colWidth));\n        var xEnd = Math.max(0, Math.ceil((offsetX + b) / colWidth));\n        var visibleLeaves = leaves.slice(yStart, yEnd);\n        visibleLeaves.forEach(function (node) {\n            var _a;\n            var \n            //@ts-ignore\n            y = node.x, name = node.data.name;\n            var str = (_a = columns[name]) === null || _a === void 0 ? void 0 : _a.slice(xStart, xEnd);\n            for (var i = 0; i < (str === null || str === void 0 ? void 0 : str.length); i++) {\n                var letter = str[i];\n                var color = colorScheme[letter.toUpperCase()];\n                if (bgColor) {\n                    var x = i * colWidth + offsetX - (offsetX % colWidth);\n                    ctx.fillStyle = color || 'white';\n                    ctx.fillRect(x, y - rowHeight, colWidth, rowHeight);\n                }\n            }\n        });\n        if (rowHeight >= 10 && colWidth >= rowHeight / 2) {\n            visibleLeaves.forEach(function (node) {\n                var _a;\n                var \n                //@ts-ignore\n                y = node.x, name = node.data.name;\n                var str = (_a = columns[name]) === null || _a === void 0 ? void 0 : _a.slice(xStart, xEnd);\n                for (var i = 0; i < (str === null || str === void 0 ? void 0 : str.length); i++) {\n                    var letter = str[i];\n                    var color = colorScheme[letter.toUpperCase()];\n                    var contrast = contrastScheme[letter.toUpperCase()] || 'black';\n                    var x = i * colWidth + offsetX - (offsetX % colWidth);\n                    //note: -rowHeight/4 matches +rowHeight/4 in tree\n                    ctx.fillStyle = bgColor ? contrast : color || 'black';\n                    ctx.fillText(letter, x + colWidth / 2, y - rowHeight / 4);\n                }\n            });\n        }\n    }, [\n        MSA,\n        highResScaleFactor,\n        columns,\n        colorScheme,\n        contrastScheme,\n        bgColor,\n        rowHeight,\n        colWidth,\n        hierarchy,\n        offsetX,\n        offsetY,\n        blockSize,\n    ]);\n    return (_jsx(\"canvas\", { ref: ref, onMouseMove: function (event) {\n            if (!ref.current) {\n                return;\n            }\n            var _a = ref.current.getBoundingClientRect(), left = _a.left, top = _a.top;\n            var mouseX = event.clientX - left;\n            var mouseY = event.clientY - top;\n            model.setMousePos(Math.floor((mouseX + offsetX) / colWidth) + 1, Math.floor((mouseY + offsetY) / rowHeight));\n        }, onMouseLeave: function () { return model.setMousePos(); }, width: blockSize * highResScaleFactor, height: blockSize * highResScaleFactor, style: {\n            position: 'absolute',\n            top: scrollY + offsetY,\n            left: scrollX + offsetX,\n            width: blockSize,\n            height: blockSize,\n        } }, void 0));\n});\nvar MSACanvas = observer(function (_a) {\n    var model = _a.model;\n    var MSA = model.MSA, msaFilehandle = model.msaFilehandle, height = model.height, msaAreaWidth = model.msaAreaWidth, blocks2d = model.blocks2d;\n    var ref = useRef(null);\n    // wheel\n    var scheduled = useRef(false);\n    var deltaX = useRef(0);\n    var deltaY = useRef(0);\n    // mouse click-and-drag scrolling\n    var prevX = useRef(0);\n    var prevY = useRef(0);\n    var _b = useState(false), mouseDragging = _b[0], setMouseDragging = _b[1];\n    useEffect(function () {\n        var curr = ref.current;\n        if (!curr) {\n            return;\n        }\n        function onWheel(origEvent) {\n            var event = normalizeWheel(origEvent);\n            deltaX.current += event.pixelX;\n            deltaY.current += event.pixelY;\n            if (!scheduled.current) {\n                scheduled.current = true;\n                requestAnimationFrame(function () {\n                    model.doScrollX(-deltaX.current);\n                    model.doScrollY(-deltaY.current);\n                    deltaX.current = 0;\n                    deltaY.current = 0;\n                    scheduled.current = false;\n                });\n            }\n            origEvent.preventDefault();\n        }\n        curr.addEventListener('wheel', onWheel);\n        return function () {\n            curr.removeEventListener('wheel', onWheel);\n        };\n    }, [model]);\n    useEffect(function () {\n        var cleanup = function () { };\n        function globalMouseMove(event) {\n            event.preventDefault();\n            var currX = event.clientX;\n            var currY = event.clientY;\n            var distanceX = currX - prevX.current;\n            var distanceY = currY - prevY.current;\n            if (distanceX || distanceY) {\n                // use rAF to make it so multiple event handlers aren't fired per-frame\n                // see https://calendar.perfplanet.com/2013/the-runtime-performance-checklist/\n                if (!scheduled.current) {\n                    scheduled.current = true;\n                    window.requestAnimationFrame(function () {\n                        model.doScrollX(distanceX);\n                        model.doScrollY(distanceY);\n                        scheduled.current = false;\n                        prevX.current = event.clientX;\n                        prevY.current = event.clientY;\n                    });\n                }\n            }\n        }\n        function globalMouseUp() {\n            prevX.current = 0;\n            if (mouseDragging) {\n                setMouseDragging(false);\n            }\n        }\n        if (mouseDragging) {\n            window.addEventListener('mousemove', globalMouseMove, true);\n            window.addEventListener('mouseup', globalMouseUp, true);\n            cleanup = function () {\n                window.removeEventListener('mousemove', globalMouseMove, true);\n                window.removeEventListener('mouseup', globalMouseUp, true);\n            };\n        }\n        return cleanup;\n    }, [model, mouseDragging]);\n    return (_jsx(\"div\", __assign({ ref: ref, onMouseDown: function (event) {\n            // check if clicking a draggable element or a resize handle\n            var target = event.target;\n            if (target.draggable || target.dataset.resizer) {\n                return;\n            }\n            // otherwise do click and drag scroll\n            if (event.button === 0) {\n                prevX.current = event.clientX;\n                prevY.current = event.clientY;\n                setMouseDragging(true);\n            }\n        }, onMouseUp: function (event) {\n            event.preventDefault();\n            setMouseDragging(false);\n        }, onMouseLeave: function (event) {\n            event.preventDefault();\n        }, style: {\n            position: 'relative',\n            height: height,\n            width: msaAreaWidth,\n            overflow: 'hidden',\n        } }, { children: !MSA && !msaFilehandle ? null : !MSA ? (_jsxs(\"div\", __assign({ style: { position: 'absolute', left: '50%', top: '50%' } }, { children: [_jsx(CircularProgress, {}, void 0),\n                _jsx(Typography, { children: \"Loading...\" }, void 0)] }), void 0)) : (blocks2d.map(function (_a) {\n            var bx = _a[0], by = _a[1];\n            return (_jsx(MSABlock, { model: model, offsetX: bx, offsetY: by }, bx + \"_\" + by));\n        })) }), void 0));\n});\nexport default MSACanvas;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useRef } from 'react';\nimport { makeStyles } from '@material-ui/core';\nimport { observer } from 'mobx-react';\n/**\n * Given a scale ( bp/px ) and minimum distances (px) between major and minor\n * gridlines, return an object like `{ majorPitch: bp, minorPitch: bp }` giving\n * the gridline pitches to use.\n */\nexport function chooseGridPitch(scale, minMajorPitchPx, minMinorPitchPx) {\n    scale = Math.abs(scale);\n    var minMajorPitchBp = minMajorPitchPx * scale;\n    var majorMagnitude = parseInt(Number(minMajorPitchBp).toExponential().split(/e/i)[1], 10);\n    var majorPitch = Math.pow(10, majorMagnitude);\n    while (majorPitch < minMajorPitchBp) {\n        majorPitch *= 2;\n        if (majorPitch >= minMajorPitchBp) {\n            break;\n        }\n        majorPitch *= 2.5;\n    }\n    majorPitch = Math.max(majorPitch, 5);\n    var majorPitchPx = majorPitch / scale;\n    var minorPitch = 0;\n    if (!(majorPitch % 10) && majorPitchPx / 10 >= minMinorPitchPx) {\n        minorPitch = majorPitch / 10;\n    }\n    else if (!(majorPitch % 5) && majorPitchPx / 5 >= minMinorPitchPx) {\n        minorPitch = majorPitch / 5;\n    }\n    else if (!(majorPitch % 2) && majorPitchPx / 2 >= minMinorPitchPx) {\n        minorPitch = majorPitch / 2;\n    }\n    return { majorPitch: majorPitch, minorPitch: minorPitch };\n}\nexport function makeTicks(start, end, bpPerPx, emitMajor, emitMinor) {\n    var _a;\n    if (emitMajor === void 0) { emitMajor = true; }\n    if (emitMinor === void 0) { emitMinor = true; }\n    var gridPitch = chooseGridPitch(bpPerPx, 60, 15);\n    var minBase = start;\n    var maxBase = end;\n    if (minBase === null || maxBase === null) {\n        return [];\n    }\n    if (bpPerPx < 0) {\n        _a = [maxBase, minBase], minBase = _a[0], maxBase = _a[1];\n    }\n    // add 20px additional on the right and left to allow us to draw the ends of\n    // labels that lie a little outside our region\n    minBase -= Math.abs(20 * bpPerPx);\n    maxBase += Math.abs(20 * bpPerPx) + 1;\n    var iterPitch = gridPitch.minorPitch || gridPitch.majorPitch;\n    var index = 0;\n    var ticks = [];\n    for (var base = Math.ceil(minBase / iterPitch) * iterPitch; base < maxBase; base += iterPitch) {\n        if (emitMinor && base % (gridPitch.majorPitch * 2)) {\n            ticks.push({ type: 'minor', base: base - 1, index: index });\n            index += 1;\n        }\n        else if (emitMajor && !(base % (gridPitch.majorPitch * 2))) {\n            ticks.push({ type: 'major', base: base - 1, index: index });\n            index += 1;\n        }\n    }\n    return ticks;\n}\nfunction mathPower(num) {\n    if (num < 999) {\n        return String(num);\n    }\n    return mathPower(~~(num / 1000)) + \",\" + (\"00\" + ~~(num % 1000)).substr(-3, 3);\n}\nvar useStyles = makeStyles(function ( /* theme */) { return ({\n    majorTickLabel: {\n        fontSize: '11px',\n    },\n    majorTick: {\n        stroke: '#555',\n    },\n    minorTick: {\n        stroke: '#999',\n    },\n}); });\nfunction RulerBlock(_a) {\n    var start = _a.start, end = _a.end, bpPerPx = _a.bpPerPx, reversed = _a.reversed, major = _a.major, minor = _a.minor;\n    var classes = useStyles();\n    var ticks = makeTicks(start, end, bpPerPx, major, minor);\n    return (_jsxs(_Fragment, { children: [ticks.map(function (tick) {\n                var x = (reversed ? end - tick.base : tick.base - start) / bpPerPx;\n                return (_jsx(\"line\", { x1: x, x2: x, y1: 11, y2: tick.type === 'major' ? 11 + 6 : 11 + 4, strokeWidth: 1, stroke: tick.type === 'major' ? '#555' : '#999', className: tick.type === 'major' ? classes.majorTick : classes.minorTick, \"data-bp\": tick.base }, tick.base));\n            }),\n            ticks\n                .filter(function (tick) { return tick.type === 'major'; })\n                .map(function (tick) {\n                var x = (reversed ? end - tick.base : tick.base - start) / bpPerPx;\n                return (_jsx(\"text\", __assign({ x: x, y: 10, textAnchor: \"middle\", style: { fontSize: '11px' }, className: classes.majorTickLabel }, { children: mathPower(tick.base + 1) }), \"label-\" + tick.base));\n            })] }, void 0));\n}\nvar Ruler = observer(function (_a) {\n    var model = _a.model;\n    var MSA = model.MSA, colWidth = model.colWidth, msaAreaWidth = model.msaAreaWidth, resizeHandleWidth = model.resizeHandleWidth, scrollX = model.scrollX, blocksX = model.blocksX, blockSize = model.blockSize;\n    var ref = useRef(null);\n    var offsetX = blocksX[0];\n    return !MSA ? null : (_jsx(\"div\", __assign({ ref: ref, style: {\n            position: 'relative',\n            width: msaAreaWidth,\n            cursor: 'crosshair',\n            overflow: 'hidden',\n            height: 20,\n            background: '#ccc',\n        } }, { children: _jsx(\"svg\", __assign({ style: {\n                width: blocksX.length * blockSize,\n                position: 'absolute',\n                left: scrollX + offsetX + resizeHandleWidth,\n                pointerEvents: 'none',\n            } }, { children: _jsx(RulerBlock, { start: offsetX / colWidth, end: offsetX / colWidth + (blockSize * blocksX.length) / colWidth, bpPerPx: 1 / colWidth }, offsetX) }), void 0) }), void 0));\n});\nexport default Ruler;\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { observer } from 'mobx-react';\nvar TreeRuler = observer(function (_a) {\n    var model = _a.model;\n    var treeWidth = model.treeWidth;\n    return _jsx(\"div\", { style: { width: treeWidth } }, void 0);\n});\nexport default TreeRuler;\n","import Color from 'color';\nimport { transform } from './util';\nvar colorSchemes = {\n    clustal: {\n        G: 'orange',\n        P: 'orange',\n        S: 'orange',\n        T: 'orange',\n        H: 'red',\n        K: 'red',\n        R: 'red',\n        F: 'blue',\n        W: 'blue',\n        Y: 'blue',\n        I: 'green',\n        L: 'green',\n        M: 'green',\n        V: 'green',\n    },\n    lesk: {\n        G: 'orange',\n        A: 'orange',\n        S: 'orange',\n        T: 'orange',\n        C: 'green',\n        V: 'green',\n        I: 'green',\n        L: 'green',\n        P: 'green',\n        F: 'green',\n        Y: 'green',\n        M: 'green',\n        W: 'green',\n        N: 'magenta',\n        Q: 'magenta',\n        H: 'magenta',\n        D: 'red',\n        E: 'red',\n        K: 'blue',\n        R: 'blue',\n    },\n    maeditor: {\n        A: 'lightgreen',\n        G: 'lightgreen',\n        C: 'green',\n        D: 'darkgreen',\n        E: 'darkgreen',\n        N: 'darkgreen',\n        Q: 'darkgreen',\n        I: 'blue',\n        L: 'blue',\n        M: 'blue',\n        V: 'blue',\n        F: '#c8a2c8',\n        W: '#c8a2c8',\n        Y: '#c8a2c8',\n        H: 'darkblue',\n        K: 'orange',\n        R: 'orange',\n        P: 'pink',\n        S: 'red',\n        T: 'red',\n    },\n    //https://github.com/biotite-dev/biotite/blob/8c460972f8ab904312f130dfb80f3efc8c9bd7c5/src/biotite/sequence/graphics/color_schemes/flower.json\n    flower: {\n        A: '#b18a51',\n        C: '#ff5701',\n        D: '#01a578',\n        E: '#2da0a1',\n        F: '#fa559d',\n        G: '#b1c23c',\n        H: '#0194f9',\n        I: '#f27663',\n        K: '#7fc3d7',\n        L: '#df6e75',\n        M: '#fe9daf',\n        N: '#0bcec6',\n        P: '#4fa32a',\n        Q: '#7295ae',\n        R: '#83bff1',\n        S: '#b4bd9b',\n        T: '#d2b576',\n        V: '#fd997b',\n        W: '#ff2ded',\n        Y: '#c96ecf',\n    },\n    rainbow_dna: {\n        A: '#3737f5',\n        C: '#37f537',\n        G: '#f5f537',\n        T: '#f53737',\n        U: '#f53737',\n    },\n    //https://github.com/biotite-dev/biotite/blob/8c460972f8ab904312f130dfb80f3efc8c9bd7c5/src/biotite/sequence/graphics/color_schemes/clustalx_protein.json\n    clustalx_protein: {\n        A: '#197fe5',\n        C: '#e57f7f',\n        D: '#cc4ccc',\n        E: '#cc4ccc',\n        F: '#197fe5',\n        G: '#e5994c',\n        H: '#19b2b2',\n        I: '#197fe5',\n        K: '#e53319',\n        L: '#197fe5',\n        M: '#197fe5',\n        N: '#19cc19',\n        P: '#cccc00',\n        Q: '#19cc19',\n        R: '#e53319',\n        S: '#19cc19',\n        T: '#19cc19',\n        V: '#197fe5',\n        W: '#197fe5',\n        Y: '#19b2b2',\n    },\n    clustalx_dna: {\n        A: '#e53319',\n        C: '#197fe5',\n        G: '#e5994c',\n        T: '#19cc19',\n        U: '#19cc19',\n    },\n    jalview_buried: {\n        A: '#00a35c',\n        R: '#00fc03',\n        N: '#00eb14',\n        D: '#00eb14',\n        C: '#0000ff',\n        Q: '#00f10e',\n        E: '#00f10e',\n        G: '#009d62',\n        H: '#00d52a',\n        I: '#0054ab',\n        L: '#007b84',\n        K: '#00ff00',\n        M: '#009768',\n        F: '#008778',\n        P: '#00e01f',\n        S: '#00d52a',\n        T: '#00db24',\n        W: '#00a857',\n        Y: '#00e619',\n        V: '#005fa0',\n        B: '#00eb14',\n        X: '#00b649',\n        Z: '#00f10e',\n    },\n    jalview_hydrophobicity: {\n        A: '#ad0052',\n        R: '#0000ff',\n        N: '#0c00f3',\n        D: '#0c00f3',\n        C: '#c2003d',\n        Q: '#0c00f3',\n        E: '#0c00f3',\n        G: '#6a0095',\n        H: '#1500ea',\n        I: '#ff0000',\n        L: '#ea0015',\n        K: '#0000ff',\n        M: '#b0004f',\n        F: '#cb0034',\n        P: '#4600b9',\n        S: '#5e00a1',\n        T: '#61009e',\n        W: '#5b00a4',\n        Y: '#4f00b0',\n        V: '#f60009',\n        B: '#0c00f3',\n        X: '#680097',\n        Z: '#0c00f3',\n    },\n    jalview_prophelix: {\n        A: '#e718e7',\n        R: '#6f906f',\n        N: '#1be41b',\n        D: '#778877',\n        C: '#23dc23',\n        Q: '#926d92',\n        E: '#ff00ff',\n        G: '#00ff00',\n        H: '#758a75',\n        I: '#8a758a',\n        L: '#ae51ae',\n        K: '#a05fa0',\n        M: '#ef10ef',\n        F: '#986798',\n        P: '#00ff00',\n        S: '#36c936',\n        T: '#47b847',\n        W: '#8a758a',\n        Y: '#21de21',\n        V: '#857a85',\n        B: '#49b649',\n        X: '#758a75',\n        Z: '#c936c9',\n    },\n    jalview_propstrand: {\n        A: '#5858a7',\n        R: '#6b6b94',\n        N: '#64649b',\n        D: '#2121de',\n        C: '#9d9d62',\n        Q: '#8c8c73',\n        E: '#0000ff',\n        G: '#4949b6',\n        H: '#60609f',\n        I: '#ecec13',\n        L: '#b2b24d',\n        K: '#4747b8',\n        M: '#82827d',\n        F: '#c2c23d',\n        P: '#2323dc',\n        S: '#4949b6',\n        T: '#9d9d62',\n        W: '#c0c03f',\n        Y: '#d3d32c',\n        V: '#ffff00',\n        B: '#4343bc',\n        X: '#797986',\n        Z: '#4747b8',\n    },\n    jalview_propturn: {\n        A: '#2cd3d3',\n        R: '#708f8f',\n        N: '#ff0000',\n        D: '#e81717',\n        C: '#a85757',\n        Q: '#3fc0c0',\n        E: '#778888',\n        G: '#ff0000',\n        H: '#708f8f',\n        I: '#00ffff',\n        L: '#1ce3e3',\n        K: '#7e8181',\n        M: '#1ee1e1',\n        F: '#1ee1e1',\n        P: '#f60909',\n        S: '#e11e1e',\n        T: '#738c8c',\n        W: '#738c8c',\n        Y: '#9d6262',\n        V: '#07f8f8',\n        B: '#f30c0c',\n        X: '#7c8383',\n        Z: '#5ba4a4',\n    },\n    jalview_taylor: {\n        A: '#ccff00',\n        R: '#0000ff',\n        N: '#cc00ff',\n        D: '#ff0000',\n        C: '#ffff00',\n        Q: '#ff00cc',\n        E: '#ff0066',\n        G: '#ff9900',\n        H: '#0066ff',\n        I: '#66ff00',\n        L: '#33ff00',\n        K: '#6600ff',\n        M: '#00ff00',\n        F: '#00ff66',\n        P: '#ffcc00',\n        S: '#ff3300',\n        T: '#ff6600',\n        W: '#00ccff',\n        Y: '#00ffcc',\n        V: '#99ff00',\n    },\n    jalview_zappo: {\n        A: '#ffafaf',\n        R: '#6464ff',\n        N: '#00ff00',\n        D: '#ff0000',\n        C: '#ffff00',\n        Q: '#00ff00',\n        E: '#ff0000',\n        G: '#ff00ff',\n        H: '#6464ff',\n        I: '#ffafaf',\n        L: '#ffafaf',\n        K: '#6464ff',\n        M: '#ffafaf',\n        F: '#ffc800',\n        P: '#ff00ff',\n        S: '#00ff00',\n        T: '#00ff00',\n        W: '#ffc800',\n        Y: '#ffc800',\n        V: '#ffafaf',\n    },\n    cinema: {\n        H: 'blue',\n        K: 'blue',\n        R: 'blue',\n        D: 'red',\n        E: 'red',\n        S: 'green',\n        T: 'green',\n        N: 'green',\n        Q: 'green',\n        A: 'white',\n        V: 'white',\n        L: 'white',\n        I: 'white',\n        M: 'white',\n        F: 'magenta',\n        W: 'magenta',\n        Y: 'magenta',\n        P: 'brown',\n        G: 'brown',\n        C: 'yellow',\n        B: 'gray',\n        Z: 'gray',\n        X: 'gray',\n        '-': 'gray',\n        '.': 'gray',\n    },\n};\n// turn all supplied colors to hex colors which getContrastText from mui\n// requires\nexport default transform(colorSchemes, function (_a) {\n    var key = _a[0], val = _a[1];\n    return [\n        key,\n        transform(val, function (_a) {\n            var letter = _a[0], color = _a[1];\n            return [letter, Color(color).hex()];\n        }),\n    ];\n});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { observer } from 'mobx-react';\nimport { Button, Checkbox, Dialog, DialogActions, DialogTitle, DialogContent, FormControlLabel, MenuItem, TextField, } from '@material-ui/core';\nimport colorSchemes from '../colorSchemes';\nexport default observer(function (_a) {\n    var model = _a.model, onClose = _a.onClose, open = _a.open;\n    var rowHeightInit = model.rowHeight, colWidthInit = model.colWidth, treeWidthInit = model.treeWidth, colorSchemeName = model.colorSchemeName, noTree = model.noTree;\n    var _b = useState(\"\" + rowHeightInit), rowHeight = _b[0], setRowHeight = _b[1];\n    var _c = useState(\"\" + colWidthInit), colWidth = _c[0], setColWidth = _c[1];\n    var _d = useState(\"\" + treeWidthInit), treeWidth = _d[0], setTreeWidth = _d[1];\n    function error(n) {\n        return Number.isNaN(+n) || +n < 0;\n    }\n    var rowHeightError = error(rowHeight);\n    var colWidthError = error(colWidth);\n    var treeWidthError = error(treeWidth);\n    return (_jsxs(Dialog, __assign({ onClose: function () { return onClose(); }, open: open }, { children: [_jsx(DialogTitle, { children: \"Settings\" }, void 0),\n            _jsxs(DialogContent, { children: [_jsx(FormControlLabel, { control: _jsx(Checkbox, { checked: model.showBranchLen, onChange: function () { return model.toggleBranchLen(); } }, void 0), label: \"Show branch length\" }, void 0),\n                    _jsx(FormControlLabel, { control: _jsx(Checkbox, { checked: model.bgColor, onChange: function () { return model.toggleBgColor(); } }, void 0), label: \"Color background\" }, void 0),\n                    _jsx(FormControlLabel, { control: _jsx(Checkbox, { checked: model.drawNodeBubbles, onChange: function () { return model.toggleNodeBubbles(); } }, void 0), label: \"Draw node bubbles\" }, void 0),\n                    _jsx(FormControlLabel, { control: _jsx(Checkbox, { checked: model.drawTree, onChange: function () { return model.toggleDrawTree(); } }, void 0), label: \"Draw tree (if available)\" }, void 0),\n                    _jsx(FormControlLabel, { control: _jsx(Checkbox, { checked: model.labelsAlignRight, onChange: function () { return model.toggleLabelsAlignRight(); } }, void 0), label: \"Labels align right (note: labels may draw over tree, but can adjust tree width or tree area width in UI)\" }, void 0),\n                    _jsx(TextField, { label: \"Row height (px)\", value: rowHeight, error: rowHeightError, onChange: function (event) { return setRowHeight(event.target.value); } }, void 0),\n                    _jsx(TextField, { label: \"Column width (px)\", value: colWidth, error: colWidthError, onChange: function (event) { return setColWidth(event.target.value); } }, void 0),\n                    _jsx(\"br\", {}, void 0),\n                    !noTree ? (_jsx(TextField, { label: \"Tree width (px)\", value: treeWidth, error: treeWidthError, onChange: function (event) { return setTreeWidth(event.target.value); } }, void 0)) : null,\n                    _jsx(\"br\", {}, void 0),\n                    _jsx(TextField, __assign({ select: true, label: \"Color scheme\", value: colorSchemeName, onChange: function (event) { return model.setColorSchemeName(event.target.value); } }, { children: Object.keys(colorSchemes).map(function (option) { return (_jsx(MenuItem, __assign({ value: option }, { children: option }), option)); }) }), void 0),\n                    _jsx(DialogActions, { children: _jsx(Button, __assign({ disabled: rowHeightError || colWidthError || treeWidthError, onClick: function () {\n                                model.setRowHeight(+rowHeight);\n                                model.setColWidth(+colWidth);\n                                if (!noTree) {\n                                    model.setTreeWidth(+treeWidth);\n                                }\n                                onClose();\n                            }, variant: \"contained\", color: \"primary\" }, { children: \"Submit\" }), void 0) }, void 0)] }, void 0)] }), void 0));\n});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { Dialog, DialogTitle, DialogContent, Typography, Link, } from '@material-ui/core';\nimport { version } from './package.json';\nfunction LicenseDialog(_a) {\n    var onClose = _a.onClose, open = _a.open;\n    return (_jsxs(Dialog, __assign({ onClose: function () { return onClose(); }, open: open }, { children: [_jsx(DialogTitle, { children: \"Biotite License\" }, void 0),\n            _jsx(DialogContent, { children: _jsx(\"pre\", __assign({ style: { height: 100, overflow: 'auto' } }, { children: \"\\nCopyright 2017 - 2020, The Biotite contributors\\nAll rights reserved.\\n\\nRedistribution and use in source and binary forms, with or without modification,\\nare permitted provided that the following conditions are met:\\n\\n1. Redistributions of source code must retain the above copyright notice, this\\nlist of conditions and the following disclaimer.\\n\\n2. Redistributions in binary form must reproduce the above copyright notice,\\nthis list of conditions and the following disclaimer in the documentation and/or\\nother materials provided with the distribution.\\n\\n3. Neither the name of the copyright holder nor the names of its contributors\\nmay be used to endorse or promote products derived from this software without\\nspecific prior written permission.\\n\\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \\\"AS IS\\\" AND\\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\\n        \" }), void 0) }, void 0)] }), void 0));\n}\nexport default function AboutDialog(_a) {\n    var onClose = _a.onClose, open = _a.open;\n    var _b = useState(false), dlgOpen = _b[0], setDlgOpen = _b[1];\n    return (_jsxs(_Fragment, { children: [_jsx(LicenseDialog, { onClose: function () { return setDlgOpen(false); }, open: dlgOpen }, void 0),\n            _jsxs(Dialog, __assign({ onClose: function () { return onClose(); }, open: open }, { children: [_jsx(DialogTitle, { children: \"About this plugin\" }, void 0),\n                    _jsxs(DialogContent, { children: [_jsxs(Typography, { children: [\"JBrowse 2 MSAView plugin \", version, \" (\", _jsx(Link, __assign({ href: \"https://github.com/gmod/jbrowse-plugin-msaview\" }, { children: \"Github\" }), void 0), \")\"] }, void 0),\n                            _jsxs(\"ul\", { children: [_jsx(\"li\", { children: _jsxs(Typography, { children: [\"We use some color schemes from the\", ' ',\n                                                _jsx(Link, __assign({ href: \"https://github.com/biotite-dev/biotite\" }, { children: \"biotite\" }), void 0), ' ', \"project, and their license is reproduced\", ' ',\n                                                _jsx(Link, __assign({ onClick: function () { return setDlgOpen(true); } }, { children: \"here\" }), void 0)] }, void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsxs(Typography, { children: [\"See this page for some information on jalview colorings\", ' ',\n                                                _jsx(Link, __assign({ href: \"https://www.jalview.org/help/html/colourSchemes/\" }, { children: \"here\" }), void 0)] }, void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsxs(Typography, { children: [\"See this page for some info on the clustal, cinema, maeditor, and lesk color schemes\", ' ',\n                                                _jsx(Link, __assign({ href: \"http://www.bioinformatics.nl/~berndb/aacolour.html\" }, { children: \"here\" }), void 0)] }, void 0) }, void 0),\n                                    _jsx(\"li\", { children: _jsxs(Typography, { children: [\"See this paper about the flower color scheme\", ' ',\n                                                _jsx(Link, __assign({ href: \"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7245768/\" }, { children: \"here\" }), void 0)] }, void 0) }, void 0)] }, void 0)] }, void 0)] }), void 0)] }, void 0));\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Dialog, DialogTitle, DialogContent } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { Attributes } from '@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail';\nexport default observer(function (_a) {\n    var model = _a.model, onClose = _a.onClose, open = _a.open;\n    var alignmentDetails = model.alignmentDetails;\n    return (_jsxs(Dialog, __assign({ onClose: function () { return onClose(); }, open: open }, { children: [_jsx(DialogTitle, { children: \"Metadata\" }, void 0),\n            _jsx(DialogContent, { children: _jsx(Attributes, { attributes: alignmentDetails }, void 0) }, void 0)] }), void 0));\n});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Dialog, DialogTitle, DialogContent, FormControlLabel, FormGroup, Checkbox, DialogActions, Button, Typography, } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nexport default observer(function (_a) {\n    var model = _a.model, onClose = _a.onClose, open = _a.open;\n    var tracks = model.tracks;\n    return (_jsxs(Dialog, __assign({ onClose: function () { return onClose(); }, open: open }, { children: [_jsx(DialogTitle, { children: \"Add track\" }, void 0),\n            _jsxs(DialogContent, { children: [_jsx(Typography, { children: \"Open relevant per-alignment tracks e.g. protein domains\" }, void 0),\n                    _jsx(FormGroup, { children: tracks.map(function (track) {\n                            return (_jsx(FormControlLabel, { control: _jsx(Checkbox, { checked: !model.turnedOffTracks.has(track.model.id), onChange: function () {\n                                        model.toggleTrack(track.model.id);\n                                    } }, void 0), label: track.model.name }, track.model.id));\n                        }) }, void 0),\n                    _jsx(DialogActions, { children: _jsx(Button, __assign({ onClick: function () { return onClose(); }, variant: \"contained\", color: \"primary\" }, { children: \"Close\" }), void 0) }, void 0)] }, void 0)] }), void 0));\n});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsxs as _jsxs, jsx as _jsx } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { IconButton, Select, Typography } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport SettingsDialog from './SettingsDlg';\nimport AboutDialog from './AboutDlg';\nimport DetailsDialog from './DetailsDlg';\nimport TracklistDialog from './TracklistDlg';\n//icons\nimport FolderOpenIcon from '@material-ui/icons/FolderOpen';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport HelpIcon from '@material-ui/icons/Help';\nimport AssignmentIcon from '@material-ui/icons/Assignment';\nimport ListIcon from '@material-ui/icons/List';\nvar InfoArea = observer(function (_a) {\n    var model = _a.model;\n    var mouseOverRowName = model.mouseOverRowName, mouseCol = model.mouseCol;\n    return (_jsxs(\"div\", { children: [_jsxs(Typography, __assign({ display: \"inline\" }, { children: [\"Row name: \", mouseOverRowName] }), void 0),\n            _jsx(\"span\", { style: { marginLeft: 10 } }, void 0),\n            _jsxs(Typography, __assign({ display: \"inline\" }, { children: [\"Position: \", mouseCol] }), void 0)] }, void 0));\n});\nvar Header = observer(function (_a) {\n    var model = _a.model;\n    var _b = useState(false), settingsDialogVisible = _b[0], setSettingsDialogVisible = _b[1];\n    var _c = useState(false), aboutDialogVisible = _c[0], setAboutDialogVisible = _c[1];\n    var _d = useState(false), detailsDialogVisible = _d[0], setDetailsDialogVisible = _d[1];\n    var _e = useState(false), tracklistDialogVisible = _e[0], setTracklistDialogVisible = _e[1];\n    var currentAlignment = model.currentAlignment, alignmentNames = model.alignmentNames;\n    return (_jsxs(\"div\", __assign({ style: { display: 'flex' } }, { children: [_jsx(IconButton, __assign({ onClick: function () {\n                    model.setData({ tree: '', msa: '' });\n                    model.setTreeFilehandle(undefined);\n                    model.setMSAFilehandle(undefined);\n                    model.setScrollY(0);\n                    model.setScrollX(0);\n                    model.setCurrentAlignment(0);\n                } }, { children: _jsx(FolderOpenIcon, {}, void 0) }), void 0),\n            _jsx(IconButton, __assign({ onClick: function () { return setSettingsDialogVisible(true); } }, { children: _jsx(SettingsIcon, {}, void 0) }), void 0),\n            _jsx(IconButton, __assign({ onClick: function () { return setDetailsDialogVisible(true); } }, { children: _jsx(AssignmentIcon, {}, void 0) }), void 0),\n            _jsx(IconButton, __assign({ onClick: function () { return setTracklistDialogVisible(true); } }, { children: _jsx(ListIcon, {}, void 0) }), void 0),\n            settingsDialogVisible ? (_jsx(SettingsDialog, { open: true, model: model, onClose: function () { return setSettingsDialogVisible(false); } }, void 0)) : null,\n            aboutDialogVisible ? (_jsx(AboutDialog, { open: true, onClose: function () { return setAboutDialogVisible(false); } }, void 0)) : null,\n            detailsDialogVisible ? (_jsx(DetailsDialog, { open: true, model: model, onClose: function () { return setDetailsDialogVisible(false); } }, void 0)) : null,\n            tracklistDialogVisible ? (_jsx(TracklistDialog, { open: true, model: model, onClose: function () { return setTracklistDialogVisible(false); } }, void 0)) : null,\n            alignmentNames.length > 0 ? (_jsx(Select, __assign({ native: true, value: currentAlignment, onChange: function (event) {\n                    model.setCurrentAlignment(+event.target.value);\n                    model.setScrollX(0);\n                    model.setScrollY(0);\n                } }, { children: alignmentNames.map(function (option, index) { return (_jsx(\"option\", __assign({ value: index }, { children: option }), option + \"-\" + index)); }) }), void 0)) : null,\n            _jsx(InfoArea, { model: model }, void 0),\n            _jsx(\"div\", { style: { flex: 1 } }, void 0),\n            _jsx(IconButton, __assign({ onClick: function () { return setAboutDialogVisible(true); } }, { children: _jsx(HelpIcon, {}, void 0) }), void 0)] }), void 0));\n});\nexport default Header;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsxs as _jsxs, jsx as _jsx } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport copy from 'copy-to-clipboard';\nimport { observer } from 'mobx-react';\nimport { Button, Dialog, DialogActions, DialogTitle, DialogContent, makeStyles, } from '@material-ui/core';\nvar useStyles = makeStyles(function (theme) { return ({\n    textArea: {\n        padding: theme.spacing(2),\n        overflow: 'auto',\n        background: '#ddd',\n        wordBreak: 'break-word',\n    },\n}); });\nvar TrackInfoDialog = observer(function (_a) {\n    var model = _a.model, onClose = _a.onClose;\n    var _b = useState('Copy to clipboard'), label = _b[0], setLabel = _b[1];\n    var classes = useStyles();\n    return (_jsxs(Dialog, __assign({ open: true, onClose: onClose, fullWidth: true, maxWidth: \"lg\" }, { children: [_jsxs(DialogTitle, { children: [\"Track info - \", model.name] }, void 0),\n            _jsxs(DialogContent, { children: [_jsx(Button, __assign({ variant: \"contained\", color: \"primary\", onClick: function () {\n                            copy(model.data);\n                            setLabel('Copied!');\n                            setTimeout(function () {\n                                setLabel('Copy to clipboard');\n                            }, 300);\n                        } }, { children: label }), void 0),\n                    _jsx(\"pre\", __assign({ className: classes.textArea }, { children: model.data }), void 0)] }, void 0),\n            _jsx(DialogActions, { children: _jsx(Button, __assign({ variant: \"contained\", onClick: onClose, color: \"secondary\" }, { children: \"Close\" }), void 0) }, void 0)] }), void 0));\n});\nexport default TrackInfoDialog;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState, useRef, useEffect } from 'react';\nimport normalizeWheel from 'normalize-wheel';\nimport { observer } from 'mobx-react';\nimport { IconButton, Menu, MenuItem, makeStyles } from '@material-ui/core';\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\nimport TrackInfoDialog from './TrackInfoDlg';\nvar useStyles = makeStyles(function () { return ({\n    button: {\n        padding: 0,\n    },\n}); });\nexport var TrackLabel = observer(function (_a) {\n    var model = _a.model, track = _a.track;\n    var _b = useState(), anchorEl = _b[0], setAnchorEl = _b[1];\n    var _c = useState(false), trackInfoDlgOpen = _c[0], setTrackInfoDlgOpen = _c[1];\n    var rowHeight = model.rowHeight, width = model.treeAreaWidth;\n    var height = track.height, name = track.model.name;\n    var classes = useStyles();\n    var trackLabelHeight = Math.max(8, rowHeight - 8);\n    return (_jsxs(\"div\", __assign({ style: {\n            width: width,\n            height: height,\n            flexShrink: 0,\n            textAlign: 'right',\n            fontSize: trackLabelHeight,\n        } }, { children: [name,\n            _jsx(IconButton, __assign({ className: classes.button, style: { width: trackLabelHeight, height: trackLabelHeight }, onClick: function (event) {\n                    setAnchorEl(event.target);\n                } }, { children: _jsx(ArrowDropDownIcon, {}, void 0) }), void 0),\n            anchorEl ? (_jsxs(Menu, __assign({ anchorEl: anchorEl, transitionDuration: 0, open: true, onClose: function () {\n                    setAnchorEl(undefined);\n                } }, { children: [_jsx(MenuItem, __assign({ dense: true, onClick: function () {\n                            model.toggleTrack(track.model.id);\n                            setAnchorEl(undefined);\n                        } }, { children: \"Close\" }), void 0),\n                    _jsx(MenuItem, __assign({ dense: true, onClick: function () {\n                            setTrackInfoDlgOpen(true);\n                            setAnchorEl(undefined);\n                        } }, { children: \"Get info\" }), void 0)] }), void 0)) : null,\n            trackInfoDlgOpen ? (_jsx(TrackInfoDialog, { model: track.model, onClose: function () { return setTrackInfoDlgOpen(false); } }, void 0)) : null] }), void 0));\n});\nvar Track = observer(function (_a) {\n    var model = _a.model, track = _a.track;\n    var resizeHandleWidth = model.resizeHandleWidth;\n    var height = track.model.height;\n    var ref = useRef(null);\n    var scheduled = useRef(false);\n    var deltaX = useRef(0);\n    useEffect(function () {\n        var curr = ref.current;\n        if (!curr) {\n            return;\n        }\n        function onWheel(origEvent) {\n            var event = normalizeWheel(origEvent);\n            deltaX.current += event.pixelX;\n            if (!scheduled.current) {\n                scheduled.current = true;\n                requestAnimationFrame(function () {\n                    model.doScrollX(-deltaX.current);\n                    deltaX.current = 0;\n                    scheduled.current = false;\n                });\n            }\n            origEvent.preventDefault();\n        }\n        curr.addEventListener('wheel', onWheel);\n        return function () {\n            curr.removeEventListener('wheel', onWheel);\n        };\n    }, [model]);\n    return (_jsxs(\"div\", __assign({ style: { display: 'flex', height: height } }, { children: [_jsx(TrackLabel, { model: model, track: track }, void 0),\n            _jsx(\"div\", { style: { width: resizeHandleWidth, flexShrink: 0 } }, void 0),\n            _jsx(\"div\", __assign({ ref: ref }, { children: _jsx(track.ReactComponent, { model: model, track: track }, void 0) }), void 0)] }), track.id));\n});\nexport default Track;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { observer } from 'mobx-react';\nimport { Button, Dialog, DialogActions, DialogTitle, DialogContent, TextField, Typography, } from '@material-ui/core';\nvar specialFromEntries = function (val) {\n    var ret = {};\n    val.forEach(function (_a) {\n        var key = _a[0], val = _a[1];\n        if (!ret[key])\n            ret[key] = [];\n        ret[key].push(val);\n    });\n    return ret;\n};\nvar Row = observer(function (_a) {\n    var name = _a.name, value = _a.value, setValue = _a.setValue, setName = _a.setName;\n    return (_jsxs(\"div\", { children: [_jsx(TextField, { value: name, onChange: function (event) { return setName(event.target.value); }, label: \"Key\" }, void 0),\n            _jsx(TextField, { value: value, onChange: function (event) { return setValue(event.target.value); }, label: \"Value\" }, void 0)] }, void 0));\n});\nexport default observer(function (_a) {\n    var onClose = _a.onClose, data = _a.data, model = _a.model;\n    var left = data.left, right = data.right;\n    var _b = useState([['Name', '']]), rows = _b[0], setRows = _b[1];\n    return (_jsxs(Dialog, __assign({ onClose: function () { return onClose(); }, open: true }, { children: [_jsx(DialogTitle, { children: \"Create new region annotation\" }, void 0),\n            _jsxs(DialogContent, { children: [_jsxs(Typography, { children: [\"Do you want to add an annotation to the MSA at \", left, \"..\", right, \" (real position \", model.getRealPos(left), \"..\", model.getRealPos(right), \")\"] }, void 0),\n                    rows.map(function (_a, index) {\n                        var key = _a[0], val = _a[1];\n                        return (_jsx(Row, { name: key, value: val, setValue: function (newValue) {\n                                var newRows = __spreadArray([], rows);\n                                newRows[index][1] = newValue;\n                                setRows(newRows);\n                            }, setName: function (newName) {\n                                var newRows = __spreadArray([], rows);\n                                newRows[index][0] = newName;\n                                setRows(newRows);\n                            } }, index));\n                    }),\n                    _jsx(Button, __assign({ onClick: function () {\n                            setRows(__spreadArray(__spreadArray([], rows), [['', '']]));\n                        } }, { children: \"Add row\" }), void 0),\n                    _jsxs(DialogActions, { children: [_jsx(Button, __assign({ onClick: function () {\n                                    model.addRelativeAnnotation(left, right, specialFromEntries(rows));\n                                    onClose();\n                                }, variant: \"contained\", color: \"primary\" }, { children: \"Submit\" }), void 0),\n                            _jsx(Button, __assign({ variant: \"contained\", color: \"secondary\", onClick: function () { return onClose(); } }, { children: \"Cancel\" }), void 0)] }, void 0)] }, void 0)] }), void 0));\n});\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useEffect, useRef, useState } from 'react';\nimport { observer } from 'mobx-react';\nexport var VerticalResizeHandle = observer(function (_a) {\n    var model = _a.model;\n    var resizeHandleWidth = model.resizeHandleWidth;\n    var _b = useState(false), mouseDragging = _b[0], setMouseDragging = _b[1];\n    var scheduled = useRef(false);\n    var prevX = useRef(0);\n    useEffect(function () {\n        function globalMouseMove(event) {\n            event.preventDefault();\n            var currX = event.clientX;\n            if (prevX.current === 0) {\n                prevX.current = event.clientX;\n            }\n            else {\n                var distance_1 = currX - prevX.current;\n                if (distance_1) {\n                    // use rAF to make it so multiple event handlers aren't fired per-frame\n                    // see https://calendar.perfplanet.com/2013/the-runtime-performance-checklist/\n                    if (!scheduled.current) {\n                        scheduled.current = true;\n                        window.requestAnimationFrame(function () {\n                            model.setTreeAreaWidth(model.treeAreaWidth + distance_1);\n                            scheduled.current = false;\n                            prevX.current = event.clientX;\n                        });\n                    }\n                }\n            }\n        }\n        function globalMouseUp() {\n            prevX.current = 0;\n            if (mouseDragging) {\n                setMouseDragging(false);\n            }\n        }\n        if (mouseDragging) {\n            document.addEventListener('mousemove', globalMouseMove, true);\n            document.addEventListener('mouseup', globalMouseUp, true);\n            return function () {\n                document.removeEventListener('mousemove', globalMouseMove, true);\n                document.removeEventListener('mouseup', globalMouseUp, true);\n            };\n        }\n        return function () { };\n    }, [mouseDragging, model]);\n    return (_jsx(\"div\", { children: _jsx(\"div\", { onMouseDown: function () { return setMouseDragging(true); }, style: {\n                cursor: 'ew-resize',\n                height: '100%',\n                width: resizeHandleWidth,\n                background: \"rgba(200,200,200)\",\n                position: 'relative',\n            } }, void 0) }, void 0));\n});\nexport var HorizontalResizeHandle = observer(function (_a) {\n    var model = _a.model;\n    var resizeHandleWidth = model.resizeHandleWidth;\n    var _b = useState(false), mouseDragging = _b[0], setMouseDragging = _b[1];\n    var scheduled = useRef(false);\n    var prevY = useRef(0);\n    useEffect(function () {\n        function globalMouseMove(event) {\n            event.preventDefault();\n            var currY = event.clientY;\n            if (prevY.current === 0) {\n                prevY.current = event.clientY;\n            }\n            else {\n                var distance_2 = currY - prevY.current;\n                if (distance_2) {\n                    // use rAF to make it so multiple event handlers aren't fired per-frame\n                    // see https://calendar.perfplanet.com/2013/the-runtime-performance-checklist/\n                    if (!scheduled.current) {\n                        scheduled.current = true;\n                        window.requestAnimationFrame(function () {\n                            model.setHeight(model.height + distance_2);\n                            scheduled.current = false;\n                            prevY.current = event.clientY;\n                        });\n                    }\n                }\n            }\n        }\n        function globalMouseUp() {\n            prevY.current = 0;\n            if (mouseDragging) {\n                setMouseDragging(false);\n            }\n        }\n        if (mouseDragging) {\n            document.addEventListener('mousemove', globalMouseMove, true);\n            document.addEventListener('mouseup', globalMouseUp, true);\n            return function () {\n                document.removeEventListener('mousemove', globalMouseMove, true);\n                document.removeEventListener('mouseup', globalMouseUp, true);\n            };\n        }\n        return function () { };\n    }, [mouseDragging, model]);\n    return (_jsx(\"div\", { children: _jsx(\"div\", { onMouseDown: function () { return setMouseDragging(true); }, style: {\n                cursor: 'ns-resize',\n                width: '100%',\n                height: resizeHandleWidth,\n                background: \"rgba(200,200,200)\",\n                position: 'relative',\n            } }, void 0) }, void 0));\n});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useRef, useEffect } from 'react';\nimport { observer } from 'mobx-react';\nimport { Typography } from '@material-ui/core';\nimport ImportForm from './ImportForm';\nimport Rubberband from './Rubberband';\nimport TreeCanvas from './TreeCanvas';\nimport MSACanvas from './MSACanvas';\nimport Ruler from './Ruler';\nimport TreeRuler from './TreeRuler';\nimport Header from './Header';\nimport Track from './Track';\nimport AnnotationDialog from './AnnotationDlg';\nimport { HorizontalResizeHandle, VerticalResizeHandle } from './ResizeHandles';\nvar MouseoverCanvas = observer(function (_a) {\n    var model = _a.model;\n    var ref = useRef(null);\n    var height = model.height, width = model.width, treeAreaWidth = model.treeAreaWidth, resizeHandleWidth = model.resizeHandleWidth, scrollX = model.scrollX, mouseCol = model.mouseCol, colWidth = model.colWidth;\n    useEffect(function () {\n        if (!ref.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        ctx.resetTransform();\n        ctx.clearRect(0, 0, width, height);\n        if (mouseCol !== undefined) {\n            var x = (mouseCol - 1) * colWidth + scrollX + treeAreaWidth + resizeHandleWidth;\n            ctx.fillStyle = 'rgba(100,100,100,0.5)';\n            ctx.fillRect(x, 0, colWidth, height);\n        }\n    }, [\n        mouseCol,\n        colWidth,\n        scrollX,\n        height,\n        resizeHandleWidth,\n        treeAreaWidth,\n        width,\n    ]);\n    return (_jsx(\"canvas\", { ref: ref, width: width, height: height, style: {\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            width: width,\n            height: height,\n            zIndex: 1000,\n            pointerEvents: 'none',\n        } }, void 0));\n});\nexport default observer(function (_a) {\n    var model = _a.model;\n    var done = model.done, initialized = model.initialized, treeAreaWidth = model.treeAreaWidth, height = model.height, resizeHandleWidth = model.resizeHandleWidth, turnedOnTracks = model.turnedOnTracks;\n    return (_jsxs(\"div\", { children: [!initialized ? (_jsx(ImportForm, { model: model }, void 0)) : !done ? (_jsx(Typography, __assign({ variant: \"h4\" }, { children: \"Loading...\" }), void 0)) : (_jsxs(\"div\", { children: [_jsxs(\"div\", __assign({ style: { height: height, overflow: 'hidden' } }, { children: [_jsx(Header, { model: model }, void 0),\n                            _jsx(\"div\", { children: _jsxs(\"div\", __assign({ style: { position: 'relative' } }, { children: [_jsxs(\"div\", __assign({ style: { display: 'flex' } }, { children: [_jsx(\"div\", __assign({ style: { flexShrink: 0, width: treeAreaWidth } }, { children: _jsx(TreeRuler, { model: model }, void 0) }), void 0),\n                                                _jsx(Rubberband, { model: model, ControlComponent: _jsx(Ruler, { model: model }, void 0) }, void 0)] }), void 0),\n                                        turnedOnTracks === null || turnedOnTracks === void 0 ? void 0 : turnedOnTracks.map(function (track) { return (_jsx(Track, { model: model, track: track }, track.model.id)); }),\n                                        _jsxs(\"div\", __assign({ style: { display: 'flex' } }, { children: [_jsx(\"div\", __assign({ style: { flexShrink: 0, width: treeAreaWidth } }, { children: _jsx(TreeCanvas, { model: model }, void 0) }), void 0),\n                                                _jsx(VerticalResizeHandle, { model: model }, void 0),\n                                                _jsx(MSACanvas, { model: model }, void 0),\n                                                _jsx(MouseoverCanvas, { model: model }, void 0)] }), void 0)] }), void 0) }, void 0)] }), void 0),\n                    _jsx(HorizontalResizeHandle, { model: model }, void 0)] }, void 0)),\n            model.DialogComponent ? (_jsx(model.DialogComponent, __assign({}, (model.DialogProps || {}), { onClose: function () {\n                    model.setDialogComponent(undefined, undefined);\n                } }), void 0)) : null,\n            model.annotPos ? (_jsx(AnnotationDialog, { data: model.annotPos, model: model, onClose: function () { return model.clearAnnotPos(); } }, void 0)) : null] }, void 0));\n});\n","import { parse } from 'clustal-js';\nvar ClustalMSA = /** @class */ (function () {\n    function ClustalMSA(text) {\n        this.MSA = parse(text);\n    }\n    ClustalMSA.prototype.getMSA = function () {\n        return this.MSA;\n    };\n    ClustalMSA.prototype.getRow = function (name) {\n        var _a;\n        return (_a = this.MSA.alns.find(function (aln) { return aln.id === name; })) === null || _a === void 0 ? void 0 : _a.seq.split('');\n    };\n    ClustalMSA.prototype.getWidth = function () {\n        return this.MSA.alns[0].seq.length;\n    };\n    ClustalMSA.prototype.getDetails = function () {\n        return this.MSA.header;\n    };\n    ClustalMSA.prototype.getNames = function () {\n        return this.MSA.alns.map(function (aln) { return aln.id; });\n    };\n    ClustalMSA.prototype.getStructures = function () {\n        return {};\n    };\n    Object.defineProperty(ClustalMSA.prototype, \"alignmentNames\", {\n        get: function () {\n            return [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ClustalMSA.prototype.getTree = function () {\n        return {\n            id: 'root',\n            noTree: true,\n            branchset: this.getNames().map(function (name) { return ({ id: name, name: name }); }),\n        };\n    };\n    Object.defineProperty(ClustalMSA.prototype, \"seqConsensus\", {\n        get: function () {\n            return this.MSA.consensus;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ClustalMSA.prototype, \"secondaryStructureConsensus\", {\n        get: function () {\n            return undefined;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ClustalMSA.prototype, \"tracks\", {\n        get: function () {\n            var _a;\n            return ((_a = this.seqConsensus) === null || _a === void 0 ? void 0 : _a.trim())\n                ? [\n                    {\n                        id: 'seqConsensus',\n                        name: 'Sequence consensus',\n                        data: this.seqConsensus,\n                        customColorScheme: {\n                            '*': 'white',\n                            ':': 'grey',\n                            '.': 'darkgrey',\n                            ' ': 'black',\n                        },\n                    },\n                ]\n                : [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ClustalMSA;\n}());\nexport default ClustalMSA;\n","/**\n * Newick format parser in JavaScript.\n *\n * Copyright (c) Jason Davies 2010.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n * Example tree (from http://en.wikipedia.org/wiki/Newick_format):\n *\n * +--0.1--A\n * F-----0.2-----B            +-------0.3----C\n * +------------------0.5-----E\n *                            +---------0.4------D\n *\n * Newick format:\n * (A:0.1,B:0.2,(C:0.3,D:0.4)E:0.5)F;\n *\n * Converted to JSON:\n * {\n *   name: \"F\",\n *   branchset: [\n *     {name: \"A\", length: 0.1},\n *     {name: \"B\", length: 0.2},\n *     {\n *       name: \"E\",\n *       length: 0.5,\n *       branchset: [\n *         {name: \"C\", length: 0.3},\n *         {name: \"D\", length: 0.4}\n *       ]\n *     }\n *   ]\n * }\n *\n * Converted to JSON, but with no names or lengths:\n * {\n *   branchset: [\n *     {}, {}, {\n *       branchset: [{}, {}]\n *     }\n *   ]\n * }\n */\nexport default function parse(s) {\n    var ancestors = [];\n    var tree = {};\n    var tokens = s.split(/\\s*(;|\\(|\\)|,|:)\\s*/);\n    for (var i = 0; i < tokens.length; i++) {\n        var token = tokens[i];\n        var subtree = {};\n        switch (token) {\n            case '(': // new branchset\n                tree.branchset = [subtree];\n                ancestors.push(tree);\n                tree = subtree;\n                break;\n            case ',': // another branch\n                ancestors[ancestors.length - 1].branchset.push(subtree);\n                tree = subtree;\n                break;\n            case ')': // optional name next\n                tree = ancestors.pop();\n                break;\n            case ':': // optional length next\n                break;\n            default: {\n                var x = tokens[i - 1];\n                if (x === ')' || x === '(' || x === ',') {\n                    tree.name = token;\n                }\n                else if (x === ':') {\n                    tree.length = parseFloat(token);\n                }\n            }\n        }\n    }\n    return tree;\n}\n","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport Stockholm from 'stockholm-js';\nimport parseNewick from '../parseNewick';\nimport { generateNodeIds } from '../util';\nvar StockholmMSA = /** @class */ (function () {\n    function StockholmMSA(text, currentAlignment) {\n        var res = Stockholm.parseAll(text);\n        this.data = res;\n        this.MSA = res[currentAlignment];\n    }\n    StockholmMSA.prototype.getMSA = function () {\n        return this.MSA;\n    };\n    StockholmMSA.prototype.getRow = function (name) {\n        var _a, _b;\n        return (_b = (_a = this.MSA) === null || _a === void 0 ? void 0 : _a.seqdata[name]) === null || _b === void 0 ? void 0 : _b.split('');\n    };\n    StockholmMSA.prototype.getWidth = function () {\n        var _a;\n        var name = Object.keys((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.seqdata)[0];\n        return this.getRow(name).length;\n    };\n    Object.defineProperty(StockholmMSA.prototype, \"alignmentNames\", {\n        get: function () {\n            return this.data.map(function (aln, index) { var _a; return ((_a = aln.gf.DE) === null || _a === void 0 ? void 0 : _a[0]) || \"Alignment \" + (index + 1); });\n        },\n        enumerable: false,\n        configurable: true\n    });\n    StockholmMSA.prototype.getDetails = function () {\n        var _a, _b;\n        return {\n            General: this.MSA.gf,\n            Accessions: (_a = this.MSA.gs) === null || _a === void 0 ? void 0 : _a.AC,\n            Dbxref: (_b = this.MSA.gs) === null || _b === void 0 ? void 0 : _b.DR,\n        };\n    };\n    StockholmMSA.prototype.getRowDetails = function (rowName) {\n        var _a, _b;\n        return {\n            name: rowName,\n            accession: (_a = this.MSA.gs) === null || _a === void 0 ? void 0 : _a.AC[rowName],\n            dbxref: (_b = this.MSA.gs) === null || _b === void 0 ? void 0 : _b.DR[rowName],\n        };\n    };\n    StockholmMSA.prototype.getNames = function () {\n        return Object.keys(this.MSA.seqdata);\n    };\n    StockholmMSA.prototype.getSeqCoords = function () { };\n    StockholmMSA.prototype.getStructures = function () {\n        var _a;\n        var pdbRegex = /PDB; +(\\S+) +(\\S); ([0-9]+)-([0-9]+)/;\n        var ent = this.MSA;\n        return Object.entries(((_a = ent.gs) === null || _a === void 0 ? void 0 : _a.DR) || {})\n            .map(function (_a) {\n            var id = _a[0], dr = _a[1];\n            return [id, pdbRegex.exec(dr)];\n        })\n            .filter(function (item) { return !!item[1]; })\n            .map(function (_a) {\n            var id = _a[0], match = _a[1];\n            var pdb = match[1].toLowerCase();\n            var chain = match[2];\n            var startPos = +match[3];\n            var endPos = +match[4];\n            return { id: id, pdb: pdb, chain: chain, startPos: startPos, endPos: endPos };\n        })\n            .reduce(function (a, b) {\n            var id = b.id, rest = __rest(b, [\"id\"]);\n            if (!a[id]) {\n                a[id] = [];\n            }\n            a[id].push(rest);\n            return a;\n        }, {});\n    };\n    StockholmMSA.prototype.getTree = function () {\n        var _a, _b, _c;\n        var tree = (_c = (_b = (_a = this.MSA) === null || _a === void 0 ? void 0 : _a.gf) === null || _b === void 0 ? void 0 : _b.NH) === null || _c === void 0 ? void 0 : _c[0];\n        return tree\n            ? generateNodeIds(parseNewick(tree))\n            : {\n                id: 'root',\n                noTree: true,\n                branchset: this.getNames().map(function (name) { return ({\n                    id: name,\n                    name: name,\n                }); }),\n            };\n    };\n    Object.defineProperty(StockholmMSA.prototype, \"seqConsensus\", {\n        get: function () {\n            var _a;\n            return (_a = this.MSA.gc) === null || _a === void 0 ? void 0 : _a.seq_cons;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(StockholmMSA.prototype, \"secondaryStructureConsensus\", {\n        get: function () {\n            var _a;\n            return (_a = this.MSA.gc) === null || _a === void 0 ? void 0 : _a.SS_cons;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(StockholmMSA.prototype, \"tracks\", {\n        get: function () {\n            return [\n                {\n                    id: 'seqConsensus',\n                    name: 'Sequence consensus',\n                    data: this.seqConsensus,\n                    customColorScheme: {},\n                },\n                {\n                    id: 'secondaryStruct',\n                    name: 'Secondary-structure',\n                    data: this.secondaryStructureConsensus,\n                    customColorScheme: {\n                        '>': 'pink',\n                        '<': 'lightblue',\n                    },\n                },\n            ];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return StockholmMSA;\n}());\nexport default StockholmMSA;\n","var FastaMSA = /** @class */ (function () {\n    function FastaMSA(text) {\n        var seq = {};\n        var name = '';\n        var re = /^>(\\S+)/;\n        text.split('\\n').forEach(function (line) {\n            var match = re.exec(line);\n            if (match) {\n                seq[(name = match[1])] = '';\n            }\n            else if (name) {\n                seq[name] = seq[name] + line.replace(/[ \\t]/g, '');\n            }\n        });\n        this.MSA = { seqdata: seq };\n    }\n    FastaMSA.prototype.getMSA = function () {\n        return this.MSA;\n    };\n    FastaMSA.prototype.getNames = function () {\n        return Object.keys(this.MSA.seqdata);\n    };\n    FastaMSA.prototype.getRow = function (name) {\n        var _a, _b;\n        return (_b = (_a = this.MSA) === null || _a === void 0 ? void 0 : _a.seqdata[name]) === null || _b === void 0 ? void 0 : _b.split('');\n    };\n    FastaMSA.prototype.getWidth = function () {\n        var _a;\n        var name = Object.keys((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.seqdata)[0];\n        return this.getRow(name).length;\n    };\n    FastaMSA.prototype.getStructures = function () {\n        return {};\n    };\n    Object.defineProperty(FastaMSA.prototype, \"alignmentNames\", {\n        get: function () {\n            return [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    FastaMSA.prototype.getDetails = function () {\n        return {};\n    };\n    FastaMSA.prototype.getTree = function () {\n        return {\n            id: 'root',\n            noTree: true,\n            branchset: this.getNames().map(function (name) { return ({\n                id: name,\n                name: name,\n            }); }),\n        };\n    };\n    Object.defineProperty(FastaMSA.prototype, \"seqConsensus\", {\n        get: function () {\n            return undefined;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FastaMSA.prototype, \"secondaryStructureConsensus\", {\n        get: function () {\n            return undefined;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FastaMSA.prototype, \"tracks\", {\n        get: function () {\n            return [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return FastaMSA;\n}());\nexport default FastaMSA;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useRef, useMemo, useEffect } from 'react';\nimport { useTheme } from '@material-ui/core';\nimport { observer } from 'mobx-react';\nimport { colorContrast } from '../util';\nvar AnnotationBlock = observer(function (_a) {\n    var track = _a.track, model = _a.model, offsetX = _a.offsetX;\n    var blockSize = model.blockSize, scrollX = model.scrollX, bgColor = model.bgColor, modelColorScheme = model.colorScheme, colWidth = model.colWidth, rowHeight = model.rowHeight, highResScaleFactor = model.highResScaleFactor;\n    var _b = track.model, customColorScheme = _b.customColorScheme, data = _b.data;\n    var colorScheme = customColorScheme || modelColorScheme;\n    var theme = useTheme();\n    var ref = useRef(null);\n    var contrastScheme = useMemo(function () { return colorContrast(colorScheme, theme); }, [colorScheme, theme]);\n    useEffect(function () {\n        if (!ref.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        // this logic is very similar to MSACanvas\n        ctx.resetTransform();\n        ctx.scale(highResScaleFactor, highResScaleFactor);\n        ctx.clearRect(0, 0, blockSize, rowHeight);\n        ctx.translate(-offsetX, 0);\n        ctx.textAlign = 'center';\n        ctx.font = ctx.font.replace(/\\d+px/, Math.max(8, rowHeight - 8) + \"px\");\n        var xStart = Math.max(0, Math.floor(offsetX / colWidth));\n        var xEnd = Math.max(0, Math.ceil((offsetX + blockSize) / colWidth));\n        var str = data === null || data === void 0 ? void 0 : data.slice(xStart, xEnd);\n        for (var i = 0; str && i < str.length; i++) {\n            var letter = str[i];\n            var color = colorScheme[letter.toUpperCase()];\n            if (bgColor) {\n                var x = i * colWidth + offsetX - (offsetX % colWidth);\n                ctx.fillStyle = color || 'white';\n                ctx.fillRect(x, 0, colWidth, rowHeight);\n                if (rowHeight >= 10 && colWidth >= rowHeight / 2) {\n                    ctx.fillStyle = contrastScheme[letter.toUpperCase()] || 'black';\n                    ctx.fillText(letter, x + colWidth / 2, rowHeight / 2 + 1); //+1 to avoid cutoff at height:10\n                }\n            }\n        }\n    }, [\n        bgColor,\n        blockSize,\n        colWidth,\n        rowHeight,\n        offsetX,\n        contrastScheme,\n        colorScheme,\n        highResScaleFactor,\n        data,\n    ]);\n    return (_jsx(\"canvas\", { ref: ref, height: rowHeight * highResScaleFactor, width: blockSize * highResScaleFactor, style: {\n            position: 'absolute',\n            left: scrollX + offsetX,\n            width: blockSize,\n            height: rowHeight,\n        } }, void 0));\n});\nvar AnnotationTrack = observer(function (_a) {\n    var track = _a.track, model = _a.model;\n    var blocksX = model.blocksX, msaAreaWidth = model.msaAreaWidth, rowHeight = model.rowHeight;\n    return (_jsx(\"div\", __assign({ style: {\n            position: 'relative',\n            height: rowHeight,\n            width: msaAreaWidth,\n            overflow: 'hidden',\n        } }, { children: blocksX.map(function (bx) { return (_jsx(AnnotationBlock, { track: track, model: model, offsetX: bx }, bx)); }) }), void 0));\n});\nexport default AnnotationTrack;\n","import RBush from 'rbush';\nvar Layout = /** @class */ (function () {\n    function Layout(_a) {\n        var _b = _a === void 0 ? {} : _a, _c = _b.maxHeight, maxHeight = _c === void 0 ? 10000 : _c;\n        this.maxHeightReached = false;\n        this.rbush = new RBush();\n        this.rectangles = new Map();\n        this.maxHeight = Math.ceil(maxHeight);\n        this.pTotalHeight = 0; // total height, in units of bitmap squares (px/pitchY)\n    }\n    /**\n     * @returns top position for the rect, or Null if laying\n     *  out the rect would exceed maxHeighe\n     */\n    Layout.prototype.addRect = function (id, left, right, height, data) {\n        // add to rbush\n        var existingRecord = this.rectangles.get(id);\n        if (existingRecord) {\n            return existingRecord.minY;\n        }\n        var currHeight = 0;\n        while (this.rbush.collides({\n            minX: left,\n            minY: currHeight,\n            maxX: right,\n            maxY: currHeight + height,\n        }) &&\n            currHeight <= this.maxHeight) {\n            currHeight += 1;\n        }\n        var record = {\n            minX: left,\n            minY: currHeight,\n            maxX: right,\n            maxY: currHeight + height,\n            id: id,\n            data: data,\n        };\n        this.rbush.insert(record);\n        this.rectangles.set(id, record);\n        this.pTotalHeight = Math.max(this.pTotalHeight, currHeight);\n        return currHeight;\n    };\n    Object.defineProperty(Layout.prototype, \"totalHeight\", {\n        get: function () {\n            return this.pTotalHeight;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return Layout;\n}());\nexport default Layout;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useRef, useMemo, useEffect } from 'react';\nimport { observer } from 'mobx-react';\nimport { getSnapshot, isStateTreeNode } from 'mobx-state-tree';\nimport Layout from '../layout';\nvar AnnotationBlock = observer(function (_a) {\n    var track = _a.track, model = _a.model, offsetX = _a.offsetX;\n    var blockSize = model.blockSize, colWidth = model.colWidth, blanks = model.blanks, rowHeight = model.rowHeight, highResScaleFactor = model.highResScaleFactor, scrollX = model.scrollX;\n    var _b = track.model, height = _b.height, features = _b.features, associatedRowName = _b.associatedRowName;\n    var layout = useMemo(function () {\n        var temp = new Layout();\n        features === null || features === void 0 ? void 0 : features.forEach(function (feature, index) {\n            var start = feature.start, end = feature.end;\n            if (associatedRowName) {\n                var s = model.bpToPx(associatedRowName, start - 1);\n                var e = model.bpToPx(associatedRowName, end);\n                temp.addRect(\"\" + index, s, e, rowHeight, feature);\n            }\n            else {\n                temp.addRect(\"\" + index, start, end, rowHeight, feature);\n            }\n        });\n        return temp;\n    }, [\n        rowHeight,\n        isStateTreeNode(features) ? getSnapshot(features) : features,\n        associatedRowName,\n        model,\n        blanks,\n    ]);\n    var ref = useRef(null);\n    var labelRef = useRef(null);\n    var mouseoverRef = useRef(null);\n    useEffect(function () {\n        if (!ref.current) {\n            return;\n        }\n        var ctx = ref.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        ctx.resetTransform();\n        ctx.scale(highResScaleFactor, highResScaleFactor);\n        ctx.clearRect(0, 0, blockSize, height);\n        ctx.translate(-offsetX, 0);\n        ctx.textAlign = 'center';\n        ctx.font = ctx.font.replace(/\\d+px/, Math.max(8, rowHeight - 8) + \"px\");\n        var xStart = Math.max(0, Math.floor(offsetX / colWidth));\n        ctx.fillStyle = 'goldenrod';\n        layout.rectangles.forEach(function (value) {\n            var minX = value.minX, maxX = value.maxX, minY = value.minY, maxY = value.maxY;\n            var x1 = (minX - xStart) * colWidth + offsetX - (offsetX % colWidth);\n            var x2 = (maxX - xStart) * colWidth + offsetX - (offsetX % colWidth);\n            if (x2 - x1 > 0) {\n                ctx.fillRect(x1, minY, x2 - x1, (maxY - minY) / 2);\n            }\n        });\n    }, [\n        associatedRowName,\n        blockSize,\n        colWidth,\n        layout.rectangles,\n        model,\n        rowHeight,\n        height,\n        offsetX,\n        highResScaleFactor,\n        features,\n        blanks,\n    ]);\n    useEffect(function () {\n        if (!labelRef.current) {\n            return;\n        }\n        var ctx = labelRef.current.getContext('2d');\n        if (!ctx) {\n            return;\n        }\n        // this logic is very similar to MSACanvas\n        ctx.resetTransform();\n        ctx.scale(highResScaleFactor, highResScaleFactor);\n        ctx.clearRect(0, 0, blockSize, height);\n        ctx.translate(-offsetX, 0);\n        ctx.textAlign = 'center';\n        ctx.font = ctx.font.replace(/\\d+px/, Math.max(8, rowHeight - 8) + \"px\");\n        ctx.fillStyle = 'black';\n        ctx.textAlign = 'left';\n        layout.rectangles.forEach(function (value) {\n            var _a, _b, _c, _d;\n            var minX = value.minX, maxX = value.maxX, maxY = value.maxY, minY = value.minY;\n            var feature = value.data;\n            var x1 = minX * colWidth;\n            var x2 = maxX * colWidth;\n            if (x2 - x1 > 0) {\n                var note = (_b = (_a = feature.attributes) === null || _a === void 0 ? void 0 : _a.Note) === null || _b === void 0 ? void 0 : _b[0];\n                var name_1 = (_d = (_c = feature.attributes) === null || _c === void 0 ? void 0 : _c.Name) === null || _d === void 0 ? void 0 : _d[0];\n                var type = feature.type;\n                ctx.fillText([type, name_1, note].filter(function (f) { return !!f; }).join(' - '), Math.max(Math.min(-scrollX, x2), x1), minY + (maxY - minY));\n            }\n        });\n    }, [\n        blockSize,\n        colWidth,\n        scrollX,\n        highResScaleFactor,\n        height,\n        layout.rectangles,\n        offsetX,\n        features,\n        model,\n        rowHeight,\n        blanks,\n    ]);\n    return !features ? null : (_jsxs(_Fragment, { children: [_jsx(\"canvas\", { ref: ref, height: height * highResScaleFactor, width: blockSize * highResScaleFactor, style: {\n                    position: 'absolute',\n                    left: scrollX + offsetX,\n                    width: blockSize,\n                    height: height,\n                } }, void 0),\n            _jsx(\"canvas\", { ref: labelRef, height: height * highResScaleFactor, width: blockSize * highResScaleFactor, style: {\n                    position: 'absolute',\n                    left: scrollX + offsetX,\n                    width: blockSize,\n                    height: height,\n                } }, void 0),\n            _jsx(\"canvas\", { ref: mouseoverRef, height: height * highResScaleFactor, width: blockSize * highResScaleFactor, style: {\n                    position: 'absolute',\n                    left: scrollX + offsetX,\n                    width: blockSize,\n                    height: height,\n                } }, void 0)] }, void 0));\n});\nvar AnnotationTrack = observer(function (_a) {\n    var model = _a.model, track = _a.track;\n    var blocksX = model.blocksX, msaAreaWidth = model.msaAreaWidth;\n    var height = track.model.height;\n    return (_jsx(\"div\", __assign({ style: {\n            position: 'relative',\n            height: height,\n            width: msaAreaWidth,\n            overflow: 'hidden',\n        } }, { children: blocksX.map(function (bx) { return (_jsx(AnnotationBlock, { track: track, model: model, offsetX: bx }, bx)); }) }), void 0));\n});\nexport default AnnotationTrack;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nimport { cast, types, addDisposer } from 'mobx-state-tree';\nimport { hierarchy, cluster } from 'd3-hierarchy';\nimport { ascending, max } from 'd3-array';\nimport { FileLocation, ElementId } from '@jbrowse/core/util/types/mst';\nimport { openLocation } from '@jbrowse/core/util/io';\nimport { autorun } from 'mobx';\nimport BaseViewModel from '@jbrowse/core/pluggableElementTypes/models/BaseViewModel';\nimport Stockholm from 'stockholm-js';\nimport ClustalMSA from './parsers/ClustalMSA';\nimport StockholmMSA from './parsers/StockholmMSA';\nimport FastaMSA from './parsers/FastaMSA';\nimport parseNewick from './parseNewick';\nimport colorSchemes from './colorSchemes';\nimport gff from '@gmod/gff';\nimport { generateNodeIds } from './util';\nimport TextTrack from './components/TextTrack';\nimport BoxTrack from './components/BoxTrack';\nfunction skipBlanks(blanks, arg) {\n    var s = '';\n    var b = 0;\n    for (var j = 0; j < arg.length; j++) {\n        if (j === blanks[b]) {\n            b++;\n        }\n        else {\n            s += arg[j];\n        }\n    }\n    return s;\n}\nfunction setBrLength(d, y0, k) {\n    var _a;\n    //@ts-ignore\n    d.len = (y0 += Math.max(d.data.length || 0, 0)) * k;\n    (_a = d.children) === null || _a === void 0 ? void 0 : _a.forEach(function (d) {\n        setBrLength(d, y0, k);\n    });\n}\nfunction maxLength(d) {\n    return (d.data.length || 1) + (d.children ? max(d.children, maxLength) : 0);\n}\n// Collapse the node and all it's children, from\n// https://bl.ocks.org/d3noob/43a860bc0024792f8803bba8ca0d5ecd\nfunction collapse(d) {\n    if (d.children) {\n        //@ts-ignore\n        d._children = d.children;\n        //@ts-ignore\n        d._children.forEach(collapse);\n        //@ts-ignore\n        d.children = null;\n    }\n}\nfunction clamp(min, num, max) {\n    return Math.min(Math.max(num, min), max);\n}\nvar StructureModel = types.model({\n    id: types.identifier,\n    structure: types.model({\n        pdb: types.string,\n        startPos: types.number,\n        endPos: types.number,\n    }),\n    range: types.maybe(types.string),\n});\nvar UniprotTrack = types\n    .model({\n    id: types.string,\n    accession: types.string,\n    name: types.string,\n    associatedRowName: types.string,\n    height: types.optional(types.number, 100),\n})\n    .volatile(function () { return ({\n    error: undefined,\n    data: undefined,\n}); })\n    .actions(function (self) { return ({\n    setError: function (error) {\n        self.error = error;\n    },\n    setData: function (data) {\n        self.data = data;\n    },\n}); })\n    .actions(function (self) { return ({\n    afterCreate: function () {\n        var _this = this;\n        addDisposer(self, autorun(function () { return __awaiter(_this, void 0, void 0, function () {\n            var accession, url, response, text, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 3, , 4]);\n                        accession = self.accession;\n                        url = \"https://www.uniprot.org/uniprot/\" + accession + \".gff\";\n                        return [4 /*yield*/, fetch(url)];\n                    case 1:\n                        response = _a.sent();\n                        if (!response.ok) {\n                            throw new Error(\"HTTP \" + response.status + \" \" + response.statusText + \" fetching \" + url);\n                        }\n                        return [4 /*yield*/, response.text()];\n                    case 2:\n                        text = _a.sent();\n                        self.setData(text);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _a.sent();\n                        self.setError(e_1);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); }));\n    },\n}); })\n    .views(function (self) { return ({\n    get loading() {\n        return !self.data;\n    },\n    get features() {\n        return gff.parseStringSync(self.data).map(function (f) { return f[0]; });\n    },\n}); });\nvar MSAModel = types\n    .model('MsaView', {\n    id: ElementId,\n    type: types.literal('MsaView'),\n    height: types.optional(types.number, 550),\n    treeAreaWidth: types.optional(types.number, 400),\n    treeWidth: types.optional(types.number, 300),\n    rowHeight: 20,\n    scrollY: 0,\n    scrollX: 0,\n    resizeHandleWidth: 5,\n    blockSize: 1000,\n    mouseRow: types.maybe(types.number),\n    mouseCol: types.maybe(types.number),\n    selectedStructures: types.array(StructureModel),\n    labelsAlignRight: false,\n    colWidth: 16,\n    showBranchLen: true,\n    bgColor: true,\n    drawTree: true,\n    drawNodeBubbles: true,\n    highResScaleFactor: 2,\n    colorSchemeName: 'maeditor',\n    treeFilehandle: types.maybe(FileLocation),\n    msaFilehandle: types.maybe(FileLocation),\n    currentAlignment: 0,\n    collapsed: types.array(types.string),\n    showOnly: types.maybe(types.string),\n    boxTracks: types.array(UniprotTrack),\n    turnedOffTracks: types.map(types.boolean),\n    annotatedRegions: types.array(types.model({\n        start: types.number,\n        end: types.number,\n        attributes: types.frozen(),\n    })),\n    data: types.optional(types\n        .model({\n        tree: types.maybe(types.string),\n        msa: types.maybe(types.string),\n    })\n        .actions(function (self) { return ({\n        setTree: function (tree) {\n            self.tree = tree;\n        },\n        setMSA: function (msa) {\n            self.msa = msa;\n        },\n    }); }), { tree: '', msa: '' }),\n})\n    .volatile(function () { return ({\n    error: undefined,\n    margin: { left: 20, top: 20 },\n    //eslint-disable-next-line @typescript-eslint/no-explicit-any\n    DialogComponent: undefined,\n    //eslint-disable-next-line @typescript-eslint/no-explicit-any\n    DialogProps: undefined,\n    // annotations\n    annotPos: undefined,\n}); })\n    .actions(function (self) { return ({\n    //eslint-disable-next-line @typescript-eslint/no-explicit-any\n    setDialogComponent: function (dlg, props) {\n        self.DialogComponent = dlg;\n        self.DialogProps = props;\n    },\n    setHeight: function (height) {\n        self.height = height;\n    },\n    addStructureToSelection: function (elt) {\n        self.selectedStructures.push(elt);\n    },\n    removeStructureFromSelection: function (elt) {\n        var r = self.selectedStructures.find(function (node) { return node.id === elt.id; });\n        if (r) {\n            self.selectedStructures.remove(r);\n        }\n    },\n    toggleStructureSelection: function (elt) {\n        var r = self.selectedStructures.find(function (node) { return node.id === elt.id; });\n        if (r) {\n            self.selectedStructures.remove(r);\n        }\n        else {\n            self.selectedStructures.push(elt);\n        }\n    },\n    clearSelectedStructures: function () {\n        //@ts-ignore\n        self.selectedStructures = [];\n    },\n    setError: function (error) {\n        console.error(error);\n        self.error = error;\n    },\n    setMousePos: function (col, row) {\n        self.mouseCol = col;\n        self.mouseRow = row;\n    },\n    setRowHeight: function (n) {\n        self.rowHeight = n;\n    },\n    setColWidth: function (n) {\n        self.colWidth = n;\n    },\n    setColorSchemeName: function (name) {\n        self.colorSchemeName = name;\n    },\n    setScrollY: function (n) {\n        self.scrollY = n;\n    },\n    setScrollX: function (n) {\n        self.scrollX = n;\n    },\n    setTreeAreaWidth: function (n) {\n        self.treeAreaWidth = n;\n    },\n    setTreeWidth: function (n) {\n        self.treeWidth = n;\n    },\n    setCurrentAlignment: function (n) {\n        self.currentAlignment = n;\n    },\n    toggleLabelsAlignRight: function () {\n        self.labelsAlignRight = !self.labelsAlignRight;\n    },\n    toggleDrawTree: function () {\n        self.drawTree = !self.drawTree;\n    },\n    toggleCollapsed: function (node) {\n        if (self.collapsed.includes(node)) {\n            self.collapsed.remove(node);\n        }\n        else {\n            self.collapsed.push(node);\n        }\n    },\n    setShowOnly: function (node) {\n        self.showOnly = node;\n    },\n    toggleBranchLen: function () {\n        self.showBranchLen = !self.showBranchLen;\n    },\n    toggleBgColor: function () {\n        self.bgColor = !self.bgColor;\n    },\n    toggleNodeBubbles: function () {\n        self.drawNodeBubbles = !self.drawNodeBubbles;\n    },\n    setData: function (data) {\n        self.data = cast(data);\n    },\n    setMSAFilehandle: function (msaFilehandle) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                self.msaFilehandle = msaFilehandle;\n                return [2 /*return*/];\n            });\n        });\n    },\n    setTreeFilehandle: function (treeFilehandle) {\n        return __awaiter(this, void 0, void 0, function () {\n            var r;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!(treeFilehandle && 'blobId' in treeFilehandle)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, openLocation(treeFilehandle).readFile('utf8')];\n                    case 1:\n                        r = (_a.sent());\n                        this.setTree(r);\n                        return [3 /*break*/, 3];\n                    case 2:\n                        self.treeFilehandle = treeFilehandle;\n                        _a.label = 3;\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    },\n    setMSA: function (result) {\n        self.data.setMSA(result);\n    },\n    setTree: function (result) {\n        self.data.setTree(result);\n    },\n    afterCreate: function () {\n        var _this = this;\n        addDisposer(self, autorun(function () { return __awaiter(_this, void 0, void 0, function () {\n            var treeFilehandle, _a, e_2;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        treeFilehandle = self.treeFilehandle;\n                        if (!treeFilehandle) return [3 /*break*/, 4];\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 3, , 4]);\n                        _a = this.setTree;\n                        return [4 /*yield*/, openLocation(treeFilehandle).readFile('utf8')];\n                    case 2:\n                        _a.apply(this, [(_b.sent())]);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_2 = _b.sent();\n                        this.setError(e_2);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); }));\n        addDisposer(self, autorun(function () { return __awaiter(_this, void 0, void 0, function () {\n            var msaFilehandle, _a, e_3;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        msaFilehandle = self.msaFilehandle;\n                        if (!msaFilehandle) return [3 /*break*/, 4];\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 3, , 4]);\n                        _a = this.setMSA;\n                        return [4 /*yield*/, openLocation(msaFilehandle).readFile('utf8')];\n                    case 2:\n                        _a.apply(this, [(_b.sent())]);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_3 = _b.sent();\n                        this.setError(e_3);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); }));\n    },\n}); })\n    .views(function (self) {\n    var oldBlocksX = [];\n    var oldBlocksY = [];\n    var oldValX = 0;\n    var oldValY = 0;\n    return {\n        get initialized() {\n            return ((self.data.msa ||\n                self.data.tree ||\n                self.msaFilehandle ||\n                self.treeFilehandle) &&\n                !self.error);\n        },\n        get blocksX() {\n            var scrollX = self.scrollX, size = self.blockSize, colWidth = self.colWidth;\n            var ret = -(size * Math.floor(scrollX / size)) - size;\n            var b = [];\n            for (var i = ret; i < ret + size * 3; i += size) {\n                if (i + size > 0) {\n                    b.push(i);\n                }\n            }\n            if (JSON.stringify(b) !== JSON.stringify(oldBlocksX) ||\n                colWidth !== oldValX) {\n                oldBlocksX = b;\n                oldValX = colWidth;\n            }\n            return oldBlocksX;\n        },\n        get blocksY() {\n            var scrollY = self.scrollY, size = self.blockSize, rowHeight = self.rowHeight;\n            var ret = -(size * Math.floor(scrollY / size)) - 2 * size;\n            var b = [];\n            for (var i = ret; i < ret + size * 3; i += size) {\n                if (i + size > 0) {\n                    b.push(i);\n                }\n            }\n            if (JSON.stringify(b) !== JSON.stringify(oldBlocksY) ||\n                rowHeight !== oldValY) {\n                oldBlocksY = b;\n                oldValY = rowHeight;\n            }\n            return oldBlocksY;\n        },\n    };\n})\n    .views(function (self) { return ({\n    get blocks2d() {\n        return self.blocksY.map(function (by) { return self.blocksX.map(function (bx) { return [bx, by]; }); }).flat();\n    },\n    get done() {\n        return self.initialized && (self.data.msa || self.data.tree);\n    },\n    get colorScheme() {\n        return colorSchemes[self.colorSchemeName];\n    },\n    get alignmentDetails() {\n        var _a;\n        return ((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getDetails()) || {};\n    },\n    getRowDetails: function (name) {\n        var _a;\n        //@ts-ignore\n        var details = (_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getRowDetails(name);\n        var matches = name.match(/\\S+\\/(\\d+)-(\\d+)/);\n        return __assign(__assign({}, details), (matches && { range: { start: +matches[1], end: +matches[2] } }));\n    },\n    get currentAlignmentName() {\n        return this.alignmentNames[self.currentAlignment];\n    },\n    get alignmentNames() {\n        var _a;\n        return ((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.alignmentNames) || [];\n    },\n    get noTree() {\n        return !!this.tree.noTree;\n    },\n    get menuItems() {\n        return [];\n    },\n    get MSA() {\n        var text = self.data.msa;\n        if (text) {\n            if (Stockholm.sniff(text)) {\n                return new StockholmMSA(text, self.currentAlignment);\n            }\n            else if (text.startsWith('>')) {\n                return new FastaMSA(text);\n            }\n            else {\n                return new ClustalMSA(text);\n            }\n        }\n        return null;\n    },\n    get numColumns() {\n        var _a;\n        return ((((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getWidth()) || 0) - this.blanks.length) * self.colWidth;\n    },\n    get tree() {\n        var _a;\n        return self.data.tree\n            ? generateNodeIds(parseNewick(self.data.tree))\n            : ((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getTree()) || { noTree: true };\n    },\n    get rowNames() {\n        return this.hierarchy.leaves().map(function (node) { return node.data.name; });\n    },\n    get mouseOverRowName() {\n        return self.mouseRow !== undefined\n            ? this.rowNames[self.mouseRow]\n            : undefined;\n    },\n    getMouseOverResidue: function (rowName) {\n        return this.columns[rowName];\n    },\n    get root() {\n        var hier = hierarchy(this.tree, function (d) { return d.branchset; })\n            .sum(function (d) { return (d.branchset ? 0 : 1); })\n            .sort(function (a, b) {\n            return ascending(a.data.length || 1, b.data.length || 1);\n        });\n        if (self.showOnly) {\n            var res = hier.find(function (node) { return node.data.id === self.showOnly; });\n            if (res) {\n                hier = res;\n            }\n        }\n        if (self.collapsed.length) {\n            self.collapsed\n                .map(function (collapsedId) {\n                return hier.find(function (node) { return node.data.id === collapsedId; });\n            })\n                .filter(function (f) { return !!f; })\n                .map(function (node) { return collapse(node); });\n        }\n        return hier;\n    },\n    get structures() {\n        var _a;\n        return ((_a = this.MSA) === null || _a === void 0 ? void 0 : _a.getStructures()) || {};\n    },\n    get inverseStructures() {\n        var map = Object.entries(this.structures)\n            .map(function (_a) {\n            var key = _a[0], val = _a[1];\n            return val.map(function (pdbEntry) { return [pdbEntry.pdb, { id: key }]; });\n        })\n            .flat();\n        return Object.fromEntries(map);\n    },\n    get msaAreaWidth() {\n        //@ts-ignore\n        return self.width - self.treeAreaWidth;\n    },\n    get blanks() {\n        var _this = this;\n        var _a;\n        var blanks = [];\n        var strs = this.hierarchy\n            .leaves()\n            .map(function (_a) {\n            var _b;\n            var data = _a.data;\n            return (_b = _this.MSA) === null || _b === void 0 ? void 0 : _b.getRow(data.name);\n        })\n            .filter(function (item) { return !!item; });\n        for (var i = 0; i < ((_a = strs[0]) === null || _a === void 0 ? void 0 : _a.length); i++) {\n            var counter = 0;\n            for (var j = 0; j < strs.length; j++) {\n                if (strs[j][i] === '-') {\n                    counter++;\n                }\n            }\n            if (counter === strs.length) {\n                blanks.push(i);\n            }\n        }\n        return blanks;\n    },\n    get rows() {\n        var _this = this;\n        return this.hierarchy\n            .leaves()\n            .map(function (_a) {\n            var _b;\n            var data = _a.data;\n            return [data.name, (_b = _this.MSA) === null || _b === void 0 ? void 0 : _b.getRow(data.name)];\n        })\n            .filter(function (f) { return !!f[1]; });\n    },\n    get columns() {\n        var rows = this.rows;\n        var cols = this.columns2d;\n        return Object.fromEntries(rows.map(function (row, index) { return [row[0], cols[index]]; }));\n    },\n    get columns2d() {\n        var strs = this.rows.map(function (r) { return r[1]; });\n        var ret = [];\n        for (var i = 0; i < strs.length; i++) {\n            ret.push(skipBlanks(this.blanks, strs[i]));\n        }\n        return ret;\n    },\n    // generates a new tree that is clustered with x,y positions\n    get hierarchy() {\n        var root = this.root;\n        var clust = cluster()\n            .size([this.totalHeight, self.treeWidth])\n            .separation(function () { return 1; });\n        clust(root);\n        setBrLength(root, \n        //@ts-ignore\n        (root.data.length = 0), self.treeWidth / maxLength(root));\n        return root;\n    },\n    get totalHeight() {\n        return this.root.leaves().length * self.rowHeight;\n    },\n}); })\n    .actions(function (self) { return ({\n    addUniprotTrack: function (node) {\n        if (self.boxTracks.find(function (t) { return t.name === node.name; })) {\n            if (self.turnedOffTracks.has(node.name)) {\n                this.toggleTrack(node.name);\n            }\n        }\n        else {\n            self.boxTracks.push(__assign(__assign({}, node), { id: node.name, associatedRowName: node.name }));\n        }\n    },\n    doScrollY: function (deltaY) {\n        self.scrollY = clamp(-self.totalHeight + 10, self.scrollY + deltaY, 0);\n    },\n    doScrollX: function (deltaX) {\n        self.scrollX = clamp(-self.numColumns + (self.msaAreaWidth - 100), self.scrollX + deltaX, 0);\n    },\n    setMouseoveredColumn: function (n, chain, file) {\n        var _a;\n        var j = 0;\n        var i = 0;\n        var id = (self.inverseStructures[file.slice(0, -4)] || {}).id;\n        var row = (_a = self.MSA) === null || _a === void 0 ? void 0 : _a.getRow(id);\n        if (row) {\n            for (i = 0; i < row.length && j < n; i++) {\n                if (row[i] !== '-') {\n                    j++;\n                }\n            }\n            self.mouseCol = j + 1;\n        }\n        else {\n            self.mouseCol = undefined;\n        }\n    },\n    toggleTrack: function (id) {\n        if (self.turnedOffTracks.has(id)) {\n            self.turnedOffTracks.delete(id);\n        }\n        else {\n            self.turnedOffTracks.set(id, true);\n        }\n    },\n}); })\n    .views(function (self) { return ({\n    get secondaryStructureConsensus() {\n        var _a;\n        return (_a = self.MSA) === null || _a === void 0 ? void 0 : _a.secondaryStructureConsensus;\n    },\n    get seqConsensus() {\n        var _a;\n        return (_a = self.MSA) === null || _a === void 0 ? void 0 : _a.seqConsensus;\n    },\n    get conservation() {\n        var m = self.columns2d;\n        if (m.length) {\n            for (var i = 0; i < m[0].length; i++) {\n                var col = [];\n                for (var j = 0; j < m.length; j++) {\n                    col.push(m[j][i]);\n                }\n            }\n        }\n        return ['a'];\n    },\n    get tracks() {\n        var blanks = self.blanks;\n        var adapterTracks = self.MSA\n            ? self.MSA.tracks.map(function (track) {\n                var data = track.data;\n                return {\n                    model: __assign(__assign({}, track), { data: data ? skipBlanks(blanks, data) : undefined, height: self.rowHeight }),\n                    ReactComponent: TextTrack,\n                };\n            })\n            : [];\n        var boxTracks = self.boxTracks\n            // filter out tracks that are associated with hidden rows\n            .filter(function (track) { return !!self.rows.find(function (row) { return row[0] === track.name; }); })\n            .map(function (track) { return ({\n            model: track,\n            ReactComponent: BoxTrack,\n        }); });\n        var annotationTracks = self.annotatedRegions.length > 0\n            ? [\n                {\n                    model: {\n                        features: self.annotatedRegions,\n                        height: 100,\n                        id: 'annotations',\n                        name: 'User-created annotations',\n                        data: self.annotatedRegions\n                            .map(function (region) {\n                            var _a;\n                            var attrs = region.attributes\n                                ? (_a = Object.entries(region.attributes)) === null || _a === void 0 ? void 0 : _a.map(function (_a) {\n                                    var key = _a[0], val = _a[1];\n                                    return key + \"=\" + val.join(',');\n                                }).join(';')\n                                : '.';\n                            return [\n                                'MSA_refcoord',\n                                '.',\n                                '.',\n                                region.start,\n                                region.end,\n                                '.',\n                                '.',\n                                '.',\n                                attrs,\n                            ].join('\\t');\n                        })\n                            .join('\\n'),\n                    },\n                    ReactComponent: BoxTrack,\n                },\n            ]\n            : [];\n        return __spreadArray(__spreadArray(__spreadArray([], adapterTracks), boxTracks), annotationTracks);\n    },\n    get turnedOnTracks() {\n        return this.tracks.filter(function (f) { return !self.turnedOffTracks.has(f.model.id); });\n    },\n    pxToBp: function (coord) {\n        return Math.floor((coord - self.scrollX) / self.colWidth);\n    },\n    bpToPx: function (rowName, position) {\n        var _a;\n        var rowNames = self.rowNames, rows = self.rows, blanks = self.blanks;\n        var index = rowNames.indexOf(rowName);\n        var _b = rows[index], row = _b[1];\n        var details = self.getRowDetails(rowName);\n        var offset = ((_a = details.range) === null || _a === void 0 ? void 0 : _a.start) || 0;\n        var current = position - offset;\n        if (current < 0) {\n            return 0;\n        }\n        var j = 0;\n        var i = 0;\n        for (; i < row.length; i++) {\n            if (row[i] !== '-' && j++ === current) {\n                break;\n            }\n        }\n        var count = 0;\n        for (var k = 0; k < row.length; k++) {\n            if (blanks.indexOf(k) !== -1 && k < i + 1) {\n                count++;\n            }\n        }\n        return i - count;\n    },\n}); })\n    .actions(function (self) { return ({\n    addRelativeAnnotation: function (start, end, attributes) {\n        self.annotatedRegions.push({\n            start: this.getRealPos(start),\n            end: this.getRealPos(end),\n            attributes: attributes,\n        });\n    },\n    getRealPos: function (pos) {\n        var j = 0;\n        for (var i = 0, k = 0; i < pos; i++, j++) {\n            while (j === self.blanks[k]) {\n                k++;\n                j++;\n            }\n        }\n        return j;\n    },\n    setOffsets: function (left, right) {\n        self.annotPos = {\n            left: left,\n            right: right,\n        };\n    },\n    clearAnnotPos: function () {\n        self.annotPos = undefined;\n    },\n}); });\nvar model = types.snapshotProcessor(types.compose(BaseViewModel, MSAModel), {\n    postProcessor: function (result) {\n        var _a = result.data, tree = _a.tree, msa = _a.msa, rest = __rest(result\n        // remove the MSA/tree data from the tree if the filehandle available in\n        // which case it can be reloaded on refresh\n        , [\"data\"]);\n        // remove the MSA/tree data from the tree if the filehandle available in\n        // which case it can be reloaded on refresh\n        return __assign({ data: __assign(__assign({}, (!result.treeFilehandle && { tree: tree })), (!result.msaFilehandle && { msa: msa })) }, rest);\n    },\n});\nexport default model;\n","import { MSAModel } from \"react-msaview\";\nimport { types, Instance } from \"mobx-state-tree\";\n\nconst App = types\n  .model({\n    msaview: MSAModel,\n    nglSelection: types.optional(types.string, \"\"),\n  })\n  .actions((self) => ({\n    setNGLSelection(sel: any) {\n      self.nglSelection = sel;\n    },\n  }));\n\nexport default App;\nexport type AppModel = Instance<typeof App>;\n","import React, { useCallback, useState, useEffect } from \"react\";\nimport { observer } from \"mobx-react\";\nimport { Button, Select, MenuItem, TextField } from \"@material-ui/core\";\nimport { Stage, StaticDatasource, DatasourceRegistry } from \"ngl\";\n\nDatasourceRegistry.add(\n  \"data\",\n  new StaticDatasource(\"https://files.rcsb.org/download/\")\n);\n\nexport const ProteinPanel = observer(({ model }) => {\n  const [type, setType] = useState(\"cartoon\");\n  const [res, setRes] = useState([]);\n  const [annotation, setAnnotation] = useState();\n  const [stage, setStage] = useState();\n  const [isMouseHovering, setMouseHovering] = useState(false);\n  const { msaview, nglSelection } = model;\n  const { selectedStructures, mouseCol } = msaview;\n\n  const stageElementRef = useCallback((element) => {\n    if (element) {\n      const currentStage = new Stage(element);\n      setStage(currentStage);\n    }\n  }, []);\n\n  useEffect(() => {\n    return () => {\n      if (stage) {\n        stage.dispose();\n      }\n    };\n  }, [stage]);\n\n  useEffect(() => {\n    if (!selectedStructures.length || !stage) {\n      return;\n    }\n    (async () => {\n      // Handle window resizing\n      window.addEventListener(\"resize\", () => {\n        stage.handleResize();\n      });\n\n      const res = await Promise.all(\n        selectedStructures.map((selection) => {\n          return stage.loadFile(`data://${selection.structure.pdb}.pdb`);\n        })\n      );\n      setRes(res);\n\n      stage.signals.hovered.add((pickingProxy) => {\n        if (pickingProxy && (pickingProxy.atom || pickingProxy.bond)) {\n          const atom = pickingProxy.atom || pickingProxy.closestBondAtom;\n          msaview.setMouseoveredColumn(\n            atom.resno - selectedStructures[0].structure.startPos,\n            atom.chainname,\n            pickingProxy.picker.structure.name\n          );\n        }\n      });\n    })();\n  }, [JSON.stringify(selectedStructures), stage]);\n\n  useEffect(() => {\n    if (stage) {\n      res.forEach((elt) => {\n        elt.removeAllRepresentations();\n        elt.addRepresentation(type, { sele: nglSelection });\n      });\n      stage.autoView();\n    }\n  }, [type, res, stage, nglSelection]);\n\n  useEffect(() => {\n    if (!isMouseHovering) {\n      const annots = [];\n      res.forEach((elt, index) => {\n        if (annotation) {\n          elt.removeAnnotation(annotation[index]);\n        }\n        if (mouseCol !== undefined) {\n          const { startPos } = selectedStructures[0].structure;\n\n          let k;\n          const rn = elt.structure.residueStore.count;\n          const rp = elt.structure.getResidueProxy();\n          for (let i = 0; i < rn; ++i) {\n            rp.index = i;\n            if (rp.resno === mouseCol + startPos - 1) {\n              k = rp;\n              break;\n            }\n          }\n\n          if (k) {\n            const ap = elt.structure.getAtomProxy();\n            ap.index = k.atomOffset;\n\n            annots.push(\n              elt.addAnnotation(ap.positionToVector3(), k.qualifiedName())\n            );\n          }\n        }\n        stage.viewer.requestRender();\n      });\n      setAnnotation(annots);\n    }\n  }, [model, mouseCol, isMouseHovering]);\n\n  return selectedStructures.length ? (\n    <div style={{ padding: 20 }}>\n      <div style={{ display: \"flex\", alignItems: \"center\" }}>\n        <Button onClick={() => msaview.clearSelection()} variant=\"contained\">\n          Clear\n        </Button>\n\n        <div style={{ width: 20 }} />\n        <Select value={type} onChange={(event) => setType(event.target.value)}>\n          <MenuItem value={\"cartoon\"}>cartoon</MenuItem>\n          <MenuItem value={\"ball+stick\"}>ball+stick</MenuItem>\n        </Select>\n        <div style={{ width: 20 }} />\n        <TextField\n          variant=\"outlined\"\n          label=\"Selection\"\n          value={nglSelection}\n          onChange={(event) => model.setNGLSelection(event.target.value)}\n        />\n      </div>\n\n      <div\n        ref={stageElementRef}\n        style={{ width: 600, height: 400 }}\n        onMouseEnter={() => setMouseHovering(true)}\n        onMouseLeave={() => setMouseHovering(false)}\n      />\n    </div>\n  ) : null;\n});\n","import React from \"react\";\nimport { observer } from \"mobx-react\";\nimport { onSnapshot } from \"mobx-state-tree\";\nimport { MSAView } from \"react-msaview\";\nimport { createJBrowseTheme } from \"@jbrowse/core/ui/theme\";\nimport { ThemeProvider } from \"@material-ui/core/styles\";\nimport { throttle } from \"lodash\";\nimport AppGlobal, { AppModel } from \"./model\";\n\nimport { ProteinPanel } from \"./ProteinPanel\";\n\nconst urlParams = new URLSearchParams(window.location.search);\nconst val = urlParams.get(\"data\");\n\nconst mymodel = AppGlobal.create(\n  val ? JSON.parse(val) : { msaview: { type: \"MsaView\" } }\n);\n\nmymodel.msaview.setWidth(window.innerWidth);\n\nonSnapshot(\n  mymodel,\n  throttle((snap) => {\n    const url = new URL(window.document.URL);\n    url.searchParams.set(\"data\", JSON.stringify(snap));\n    window.history.replaceState(null, \"\", url.toString());\n  }, 500)\n);\n\n// Handle window resizing\nwindow.addEventListener(\"resize\", () => {\n  mymodel.msaview.setWidth(window.innerWidth);\n});\n\nconst App = observer(({ model }: { model: AppModel }) => {\n  const { msaview } = model;\n  return (\n    <div>\n      <div style={{ border: \"1px solid black\", margin: 20 }}>\n        <MSAView model={msaview} />\n      </div>\n      <ProteinPanel model={model} />\n    </div>\n  );\n});\n\nconst MainApp = () => {\n  const theme = createJBrowseTheme();\n  return (\n    <ThemeProvider theme={theme}>\n      <App model={mymodel} />\n    </ThemeProvider>\n  );\n};\n\nexport default MainApp;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}