{"version":3,"file":"svgcanvas-UhQEjq4K.js","sources":["../../../node_modules/svgcanvas/dist/svgcanvas.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nfunction toString(obj) {\n    if (!obj) {\n        return obj\n    }\n    if (typeof obj === 'string') {\n        return obj\n    }\n    return obj + '';\n}\n\nclass ImageUtils {\n\n    /**\n     * Convert svg dataurl to canvas element\n     * \n     * @private\n     */\n    async svg2canvas(svgDataURL, width, height) {\n        const svgImage = await new Promise((resolve) => {\n            var svgImage = new Image();\n            svgImage.onload = function() {\n                resolve(svgImage);\n            };\n            svgImage.src = svgDataURL;\n        });\n        var canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        const ctx = canvas.getContext('2d');\n        ctx.drawImage(svgImage, 0, 0);\n        return canvas;\n    }\n    \n    toDataURL(svgNode, width, height, type, encoderOptions, options) {\n        var xml = new XMLSerializer().serializeToString(svgNode);\n    \n        // documentMode is an IE-only property\n        // http://msdn.microsoft.com/en-us/library/ie/cc196988(v=vs.85).aspx\n        // http://stackoverflow.com/questions/10964966/detect-ie-version-prior-to-v9-in-javascript\n        var isIE = document.documentMode;\n    \n        if (isIE) {\n            // This is patch from canvas2svg\n            // IE search for a duplicate xmnls because they didn't implement setAttributeNS correctly\n            var xmlns = /xmlns=\"http:\\/\\/www\\.w3\\.org\\/2000\\/svg\".+xmlns=\"http:\\/\\/www\\.w3\\.org\\/2000\\/svg/gi;\n            if(xmlns.test(xml)) {\n                xml = xml.replace('xmlns=\"http://www.w3.org/2000/svg','xmlns:xlink=\"http://www.w3.org/1999/xlink');\n            }\n        }\n\n        if (!options) {\n            options = {};\n        }\n    \n        var SVGDataURL = \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(xml);\n        if (type === \"image/svg+xml\" || !type) {\n            if (options.async) {\n                return Promise.resolve(SVGDataURL)\n            }\n            return SVGDataURL;\n        }\n        if (type === \"image/jpeg\" || type === \"image/png\") {\n            if (!options.async) {\n                throw new Error('svgcanvas: options.async must be set to true if type is image/jpeg | image/png')\n            }\n            return (async () => {\n                const canvas = await this.svg2canvas(SVGDataURL, width, height);\n                const dataUrl = canvas.toDataURL(type, encoderOptions);\n                canvas.remove();\n                return dataUrl;\n            })()\n        }\n        throw new Error('svgcanvas: Unknown type for toDataURL, please use image/jpeg | image/png | image/svg+xml.');\n    }\n\n    getImageData(svgNode, width, height, sx, sy, sw, sh, options) {\n        if (!options) {\n            options = {};\n        }\n        if (!options.async) {\n            throw new Error('svgcanvas: options.async must be set to true for getImageData')\n        }\n        const svgDataURL = this.toDataURL(svgNode, width, height, 'image/svg+xml');\n        return (async () => {\n            const canvas = await this.svg2canvas(svgDataURL, width, height);\n            const ctx = canvas.getContext('2d');\n            const imageData = ctx.getImageData(sx, sy, sw, sh);\n            canvas.remove();\n            return imageData;\n        })()\n    }\n}\n\nconst utils = new ImageUtils();\n\n/*!!\n *  SVGCanvas v2.0.3\n *  Draw on SVG using Canvas's 2D Context API.\n *\n *  Licensed under the MIT license:\n *  http://www.opensource.org/licenses/mit-license.php\n *\n *  Author:\n *  Kerry Liu\n *  Zeno Zeng\n *\n *  Copyright (c) 2014 Gliffy Inc.\n *  Copyright (c) 2021 Zeno Zeng\n */\n\nvar Context = (function () {\n\n    var STYLES, Context, CanvasGradient, CanvasPattern, namedEntities;\n\n    //helper function to format a string\n    function format(str, args) {\n        var keys = Object.keys(args), i;\n        for (i=0; i<keys.length; i++) {\n            str = str.replace(new RegExp(\"\\\\{\" + keys[i] + \"\\\\}\", \"gi\"), args[keys[i]]);\n        }\n        return str;\n    }\n\n    //helper function that generates a random string\n    function randomString(holder) {\n        var chars, randomstring, i;\n        if (!holder) {\n            throw new Error(\"cannot create a random attribute name for an undefined object\");\n        }\n        chars = \"ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz\";\n        randomstring = \"\";\n        do {\n            randomstring = \"\";\n            for (i = 0; i < 12; i++) {\n                randomstring += chars[Math.floor(Math.random() * chars.length)];\n            }\n        } while (holder[randomstring]);\n        return randomstring;\n    }\n\n    //helper function to map named to numbered entities\n    function createNamedToNumberedLookup(items, radix) {\n        var i, entity, lookup = {}, base10;\n        items = items.split(',');\n        radix = radix || 10;\n        // Map from named to numbered entities.\n        for (i = 0; i < items.length; i += 2) {\n            entity = '&' + items[i + 1] + ';';\n            base10 = parseInt(items[i], radix);\n            lookup[entity] = '&#'+base10+';';\n        }\n        //FF and IE need to create a regex from hex values ie &nbsp; == \\xa0\n        lookup[\"\\\\xa0\"] = '&#160;';\n        return lookup;\n    }\n\n    //helper function to map canvas-textAlign to svg-textAnchor\n    function getTextAnchor(textAlign) {\n        //TODO: support rtl languages\n        var mapping = {\"left\":\"start\", \"right\":\"end\", \"center\":\"middle\", \"start\":\"start\", \"end\":\"end\"};\n        return mapping[textAlign] || mapping.start;\n    }\n\n    //helper function to map canvas-textBaseline to svg-dominantBaseline\n    function getDominantBaseline(textBaseline) {\n        //INFO: not supported in all browsers\n        var mapping = {\"alphabetic\": \"alphabetic\", \"hanging\": \"hanging\", \"top\":\"text-before-edge\", \"bottom\":\"text-after-edge\", \"middle\":\"central\"};\n        return mapping[textBaseline] || mapping.alphabetic;\n    }\n\n    // Unpack entities lookup where the numbers are in radix 32 to reduce the size\n    // entity mapping courtesy of tinymce\n    namedEntities = createNamedToNumberedLookup(\n        '50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,' +\n            '5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,' +\n            '5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,' +\n            '5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,' +\n            '68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,' +\n            '6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,' +\n            '6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,' +\n            '75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,' +\n            '7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,' +\n            '7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,' +\n            'sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,' +\n            'st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,' +\n            't9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,' +\n            'tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,' +\n            'u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,' +\n            '81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,' +\n            '8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,' +\n            '8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,' +\n            '8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,' +\n            '8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,' +\n            'nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,' +\n            'rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,' +\n            'Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,' +\n            '80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,' +\n            '811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro', 32);\n\n\n    //Some basic mappings for attributes and default values.\n    STYLES = {\n        \"strokeStyle\":{\n            svgAttr : \"stroke\", //corresponding svg attribute\n            canvas : \"#000000\", //canvas default\n            svg : \"none\",       //svg default\n            apply : \"stroke\"    //apply on stroke() or fill()\n        },\n        \"fillStyle\":{\n            svgAttr : \"fill\",\n            canvas : \"#000000\",\n            svg : null, //svg default is black, but we need to special case this to handle canvas stroke without fill\n            apply : \"fill\"\n        },\n        \"lineCap\":{\n            svgAttr : \"stroke-linecap\",\n            canvas : \"butt\",\n            svg : \"butt\",\n            apply : \"stroke\"\n        },\n        \"lineJoin\":{\n            svgAttr : \"stroke-linejoin\",\n            canvas : \"miter\",\n            svg : \"miter\",\n            apply : \"stroke\"\n        },\n        \"miterLimit\":{\n            svgAttr : \"stroke-miterlimit\",\n            canvas : 10,\n            svg : 4,\n            apply : \"stroke\"\n        },\n        \"lineWidth\":{\n            svgAttr : \"stroke-width\",\n            canvas : 1,\n            svg : 1,\n            apply : \"stroke\"\n        },\n        \"globalAlpha\": {\n            svgAttr : \"opacity\",\n            canvas : 1,\n            svg : 1,\n            apply :  \"fill stroke\"\n        },\n        \"font\":{\n            //font converts to multiple svg attributes, there is custom logic for this\n            canvas : \"10px sans-serif\"\n        },\n        \"shadowColor\":{\n            canvas : \"#000000\"\n        },\n        \"shadowOffsetX\":{\n            canvas : 0\n        },\n        \"shadowOffsetY\":{\n            canvas : 0\n        },\n        \"shadowBlur\":{\n            canvas : 0\n        },\n        \"textAlign\":{\n            canvas : \"start\"\n        },\n        \"textBaseline\":{\n            canvas : \"alphabetic\"\n        },\n        \"lineDash\" : {\n            svgAttr : \"stroke-dasharray\",\n            canvas : [],\n            svg : null,\n            apply : \"stroke\"\n        }\n    };\n\n    /**\n     *\n     * @param gradientNode - reference to the gradient\n     * @constructor\n     */\n    CanvasGradient = function (gradientNode, ctx) {\n        this.__root = gradientNode;\n        this.__ctx = ctx;\n    };\n\n    /**\n     * Adds a color stop to the gradient root\n     */\n    CanvasGradient.prototype.addColorStop = function (offset, color) {\n        var stop = this.__ctx.__createElement(\"stop\"), regex, matches;\n        stop.setAttribute(\"offset\", offset);\n        if (toString(color).indexOf(\"rgba\") !== -1) {\n            //separate alpha value, since webkit can't handle it\n            regex = /rgba\\(\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d?\\.?\\d*)\\s*\\)/gi;\n            matches = regex.exec(color);\n            stop.setAttribute(\"stop-color\", format(\"rgb({r},{g},{b})\", {r:matches[1], g:matches[2], b:matches[3]}));\n            stop.setAttribute(\"stop-opacity\", matches[4]);\n        } else {\n            stop.setAttribute(\"stop-color\", toString(color));\n        }\n        this.__root.appendChild(stop);\n    };\n\n    CanvasPattern = function (pattern, ctx) {\n        this.__root = pattern;\n        this.__ctx = ctx;\n    };\n\n    /**\n     * The mock canvas context\n     * @param o - options include:\n     * ctx - existing Context2D to wrap around\n     * width - width of your canvas (defaults to 500)\n     * height - height of your canvas (defaults to 500)\n     * enableMirroring - enables canvas mirroring (get image data) (defaults to false)\n     * document - the document object (defaults to the current document)\n     */\n    Context = function (o) {\n\n        var defaultOptions = { width:500, height:500, enableMirroring : false}, options;\n\n        // keep support for this way of calling Context: new Context(width, height)\n        if (arguments.length > 1) {\n            options = defaultOptions;\n            options.width = arguments[0];\n            options.height = arguments[1];\n        } else if ( !o ) {\n            options = defaultOptions;\n        } else {\n            options = o;\n        }\n\n        if (!(this instanceof Context)) {\n            //did someone call this without new?\n            return new Context(options);\n        }\n\n        //setup options\n        this.width = options.width || defaultOptions.width;\n        this.height = options.height || defaultOptions.height;\n        this.enableMirroring = options.enableMirroring !== undefined ? options.enableMirroring : defaultOptions.enableMirroring;\n\n        this.canvas = this;   ///point back to this instance!\n        this.__document = options.document || document;\n\n        // allow passing in an existing context to wrap around\n        // if a context is passed in, we know a canvas already exist\n        if (options.ctx) {\n            this.__ctx = options.ctx;\n        } else {\n            this.__canvas = this.__document.createElement(\"canvas\");\n            this.__ctx = this.__canvas.getContext(\"2d\");\n        }\n\n        this.__setDefaultStyles();\n        this.__styleStack = [this.__getStyleState()];\n        this.__groupStack = [];\n\n        //the root svg element\n        this.__root = this.__document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n        this.__root.setAttribute(\"version\", 1.1);\n        this.__root.setAttribute(\"xmlns\", \"http://www.w3.org/2000/svg\");\n        this.__root.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n        this.__root.setAttribute(\"width\", this.width);\n        this.__root.setAttribute(\"height\", this.height);\n\n        //make sure we don't generate the same ids in defs\n        this.__ids = {};\n\n        //defs tag\n        this.__defs = this.__document.createElementNS(\"http://www.w3.org/2000/svg\", \"defs\");\n        this.__root.appendChild(this.__defs);\n\n        //also add a group child. the svg element can't use the transform attribute\n        this.__currentElement = this.__document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n        this.__root.appendChild(this.__currentElement);\n\n        // init transformation matrix\n        this.resetTransform();\n\n        this.__options = options;\n        this.__id = Math.random().toString(16).substring(2, 8);\n        this.__debug(`new`, o);\n    };\n\n    /**\n     * Log\n     *\n     * @private\n     */\n    Context.prototype.__debug = function(...data) {\n        if (!this.__options.debug) {\n            return\n        }\n        console.debug(`svgcanvas#${this.__id}:`, ...data);\n    };\n\n    /**\n     * Creates the specified svg element\n     * @private\n     */\n    Context.prototype.__createElement = function (elementName, properties, resetFill) {\n        if (typeof properties === \"undefined\") {\n            properties = {};\n        }\n\n        var element = this.__document.createElementNS(\"http://www.w3.org/2000/svg\", elementName),\n            keys = Object.keys(properties), i, key;\n        if (resetFill) {\n            //if fill or stroke is not specified, the svg element should not display. By default SVG's fill is black.\n            element.setAttribute(\"fill\", \"none\");\n            element.setAttribute(\"stroke\", \"none\");\n        }\n        for (i=0; i<keys.length; i++) {\n            key = keys[i];\n            element.setAttribute(key, properties[key]);\n        }\n        return element;\n    };\n\n    /**\n     * Applies default canvas styles to the context\n     * @private\n     */\n    Context.prototype.__setDefaultStyles = function () {\n        //default 2d canvas context properties see:http://www.w3.org/TR/2dcontext/\n        var keys = Object.keys(STYLES), i, key;\n        for (i=0; i<keys.length; i++) {\n            key = keys[i];\n            this[key] = STYLES[key].canvas;\n        }\n    };\n\n    /**\n     * Applies styles on restore\n     * @param styleState\n     * @private\n     */\n    Context.prototype.__applyStyleState = function (styleState) {\n        var keys = Object.keys(styleState), i, key;\n        for (i=0; i<keys.length; i++) {\n            key = keys[i];\n            this[key] = styleState[key];\n        }\n    };\n\n    /**\n     * Gets the current style state\n     * @return {Object}\n     * @private\n     */\n    Context.prototype.__getStyleState = function () {\n        var i, styleState = {}, keys = Object.keys(STYLES), key;\n        for (i=0; i<keys.length; i++) {\n            key = keys[i];\n            styleState[key] = this[key];\n        }\n        return styleState;\n    };\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/transform\n     */\n    Context.prototype.__applyTransformation = function (element, matrix) {\n        const {a, b, c, d, e, f} = matrix || this.getTransform();\n        element.setAttribute('transform', `matrix(${a} ${b} ${c} ${d} ${e} ${f})`);\n    };\n\n    /**\n     * Apples the current styles to the current SVG element. On \"ctx.fill\" or \"ctx.stroke\"\n     * @param type\n     * @private\n     */\n    Context.prototype.__applyStyleToCurrentElement = function (type) {\n        var currentElement = this.__currentElement;\n        var currentStyleGroup = this.__currentElementsToStyle;\n        if (currentStyleGroup) {\n            currentElement.setAttribute(type, \"\");\n            currentElement = currentStyleGroup.element;\n            currentStyleGroup.children.forEach(function (node) {\n                node.setAttribute(type, \"\");\n            });\n        }\n\n        var keys = Object.keys(STYLES), i, style, value, regex, matches, id, nodeIndex, node;\n        for (i = 0; i < keys.length; i++) {\n            style = STYLES[keys[i]];\n            value = this[keys[i]];\n            if (style.apply) {\n                //is this a gradient or pattern?\n                if (value instanceof CanvasPattern) {\n                    //pattern\n                    if (value.__ctx) {\n                        //copy over defs\n                        for(nodeIndex = 0; nodeIndex < value.__ctx.__defs.childNodes.length; nodeIndex++){\n                          node = value.__ctx.__defs.childNodes[nodeIndex];\n                          id = node.getAttribute(\"id\");\n                          this.__ids[id] = id;\n                          this.__defs.appendChild(node);\n                        }\n                    }\n                    currentElement.setAttribute(style.apply, format(\"url(#{id})\", {id:value.__root.getAttribute(\"id\")}));\n                }\n                else if (value instanceof CanvasGradient) {\n                    //gradient\n                    currentElement.setAttribute(style.apply, format(\"url(#{id})\", {id:value.__root.getAttribute(\"id\")}));\n                } else if (style.apply.indexOf(type)!==-1 && style.svg !== value) {\n                    if ((style.svgAttr === \"stroke\" || style.svgAttr === \"fill\") && value.indexOf(\"rgba\") !== -1) {\n                        //separate alpha value, since illustrator can't handle it\n                        regex = /rgba\\(\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d?\\.?\\d*)\\s*\\)/gi;\n                        matches = regex.exec(value);\n                        currentElement.setAttribute(style.svgAttr, format(\"rgb({r},{g},{b})\", {r:matches[1], g:matches[2], b:matches[3]}));\n                        //should take globalAlpha here\n                        var opacity = matches[4];\n                        var globalAlpha = this.globalAlpha;\n                        if (globalAlpha != null) {\n                            opacity *= globalAlpha;\n                        }\n                        currentElement.setAttribute(style.svgAttr+\"-opacity\", opacity);\n                    } else {\n                        var attr = style.svgAttr;\n                        if (keys[i] === 'globalAlpha') {\n                            attr = type+'-'+style.svgAttr;\n                            if (currentElement.getAttribute(attr)) {\n                                 //fill-opacity or stroke-opacity has already been set by stroke or fill.\n                                continue;\n                            }\n                        } else if (keys[i] === 'lineWidth') {\n                            var scale = this.__getTransformScale();\n                            value = value * Math.max(scale.x, scale.y);\n                        }\n                        //otherwise only update attribute if right type, and not svg default\n                        currentElement.setAttribute(attr, value);\n                    }\n                }\n            }\n        }\n    };\n\n    /**\n     * Will return the closest group or svg node. May return the current element.\n     * @private\n     */\n    Context.prototype.__closestGroupOrSvg = function (node) {\n        node = node || this.__currentElement;\n        if (node.nodeName === \"g\" || node.nodeName === \"svg\") {\n            return node;\n        } else {\n            return this.__closestGroupOrSvg(node.parentNode);\n        }\n    };\n\n    /**\n     * Returns the serialized value of the svg so far\n     * @param fixNamedEntities - Standalone SVG doesn't support named entities, which document.createTextNode encodes.\n     *                           If true, we attempt to find all named entities and encode it as a numeric entity.\n     * @return serialized svg\n     */\n    Context.prototype.getSerializedSvg = function (fixNamedEntities) {\n        var serialized = new XMLSerializer().serializeToString(this.__root),\n            keys, i, key, value, regexp, xmlns;\n\n        //IE search for a duplicate xmnls because they didn't implement setAttributeNS correctly\n        xmlns = /xmlns=\"http:\\/\\/www\\.w3\\.org\\/2000\\/svg\".+xmlns=\"http:\\/\\/www\\.w3\\.org\\/2000\\/svg/gi;\n        if (xmlns.test(serialized)) {\n            serialized = serialized.replace('xmlns=\"http://www.w3.org/2000/svg','xmlns:xlink=\"http://www.w3.org/1999/xlink');\n        }\n\n        if (fixNamedEntities) {\n            keys = Object.keys(namedEntities);\n            //loop over each named entity and replace with the proper equivalent.\n            for (i=0; i<keys.length; i++) {\n                key = keys[i];\n                value = namedEntities[key];\n                regexp = new RegExp(key, \"gi\");\n                if (regexp.test(serialized)) {\n                    serialized = serialized.replace(regexp, value);\n                }\n            }\n        }\n\n        return serialized;\n    };\n\n\n    /**\n     * Returns the root svg\n     * @return\n     */\n    Context.prototype.getSvg = function () {\n        return this.__root;\n    };\n\n    /**\n     * Will generate a group tag.\n     */\n    Context.prototype.save = function () {\n        var group = this.__createElement(\"g\");\n        var parent = this.__closestGroupOrSvg();\n        this.__groupStack.push(parent);\n        parent.appendChild(group);\n        this.__currentElement = group;\n        const style = this.__getStyleState();\n\n        this.__debug('save style', style);\n        this.__styleStack.push(style);\n        if (!this.__transformMatrixStack) {\n            this.__transformMatrixStack = [];\n        }\n        this.__transformMatrixStack.push(this.getTransform());\n    };\n\n    /**\n     * Sets current element to parent, or just root if already root\n     */\n    Context.prototype.restore = function () {\n        this.__currentElement = this.__groupStack.pop();\n        this.__currentElementsToStyle = null;\n        //Clearing canvas will make the poped group invalid, currentElement is set to the root group node.\n        if (!this.__currentElement) {\n            this.__currentElement = this.__root.childNodes[1];\n        }\n        var state = this.__styleStack.pop();\n        this.__debug('restore style', state);\n        this.__applyStyleState(state);\n        if (this.__transformMatrixStack && this.__transformMatrixStack.length > 0) {\n            this.setTransform(this.__transformMatrixStack.pop());\n        }\n\n    };\n\n    /**\n     * Create a new Path Element\n     */\n    Context.prototype.beginPath = function () {\n        var path, parent;\n\n        // Note that there is only one current default path, it is not part of the drawing state.\n        // See also: https://html.spec.whatwg.org/multipage/scripting.html#current-default-path\n        this.__currentDefaultPath = \"\";\n        this.__currentPosition = {};\n\n        path = this.__createElement(\"path\", {}, true);\n        parent = this.__closestGroupOrSvg();\n        parent.appendChild(path);\n        this.__currentElement = path;\n    };\n\n    /**\n     * Helper function to apply currentDefaultPath to current path element\n     * @private\n     */\n    Context.prototype.__applyCurrentDefaultPath = function () {\n        var currentElement = this.__currentElement;\n        if (currentElement.nodeName === \"path\") {\n            currentElement.setAttribute(\"d\", this.__currentDefaultPath);\n        } else {\n            console.error(\"Attempted to apply path command to node\", currentElement.nodeName);\n        }\n    };\n\n    /**\n     * Helper function to add path command\n     * @private\n     */\n    Context.prototype.__addPathCommand = function (command) {\n        this.__currentDefaultPath += \" \";\n        this.__currentDefaultPath += command;\n    };\n\n    /**\n     * Adds the move command to the current path element,\n     * if the currentPathElement is not empty create a new path element\n     */\n    Context.prototype.moveTo = function (x,y) {\n        if (this.__currentElement.nodeName !== \"path\") {\n            this.beginPath();\n        }\n\n        // creates a new subpath with the given point\n        this.__currentPosition = {x: x, y: y};\n        this.__addPathCommand(format(\"M {x} {y}\", {\n            x: this.__matrixTransform(x, y).x,\n            y: this.__matrixTransform(x, y).y\n        }));\n    };\n\n    /**\n     * Closes the current path\n     */\n    Context.prototype.closePath = function () {\n        if (this.__currentDefaultPath) {\n            this.__addPathCommand(\"Z\");\n        }\n    };\n\n    /**\n     * Adds a line to command\n     */\n    Context.prototype.lineTo = function (x, y) {\n        this.__currentPosition = {x: x, y: y};\n        if (this.__currentDefaultPath.indexOf('M') > -1) {\n            this.__addPathCommand(format(\"L {x} {y}\", {\n                x: this.__matrixTransform(x, y).x,\n                y: this.__matrixTransform(x, y).y\n            }));\n        } else {\n            this.__addPathCommand(format(\"M {x} {y}\", {\n                x: this.__matrixTransform(x, y).x,\n                y: this.__matrixTransform(x, y).y\n            }));\n        }\n    };\n\n    /**\n     * Add a bezier command\n     */\n    Context.prototype.bezierCurveTo = function (cp1x, cp1y, cp2x, cp2y, x, y) {\n        this.__currentPosition = {x: x, y: y};\n        this.__addPathCommand(format(\"C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}\",\n            {\n                cp1x: this.__matrixTransform(cp1x, cp1y).x,\n                cp1y: this.__matrixTransform(cp1x, cp1y).y,\n                cp2x: this.__matrixTransform(cp2x, cp2y).x,\n                cp2y: this.__matrixTransform(cp2x, cp2y).y,\n                x: this.__matrixTransform(x, y).x,\n                y: this.__matrixTransform(x, y).y\n            }));\n    };\n\n    /**\n     * Adds a quadratic curve to command\n     */\n    Context.prototype.quadraticCurveTo = function (cpx, cpy, x, y) {\n        this.__currentPosition = {x: x, y: y};\n        this.__addPathCommand(format(\"Q {cpx} {cpy} {x} {y}\", {\n            cpx: this.__matrixTransform(cpx, cpy).x,\n            cpy: this.__matrixTransform(cpx, cpy).y,\n            x: this.__matrixTransform(x, y).x,\n            y: this.__matrixTransform(x, y).y\n        }));\n    };\n\n\n    /**\n     * Return a new normalized vector of given vector\n     */\n    var normalize = function (vector) {\n        var len = Math.sqrt(vector[0] * vector[0] + vector[1] * vector[1]);\n        return [vector[0] / len, vector[1] / len];\n    };\n\n    /**\n     * Adds the arcTo to the current path\n     *\n     * @see http://www.w3.org/TR/2015/WD-2dcontext-20150514/#dom-context-2d-arcto\n     */\n    Context.prototype.arcTo = function (x1, y1, x2, y2, radius) {\n        // Let the point (x0, y0) be the last point in the subpath.\n        var x0 = this.__currentPosition && this.__currentPosition.x;\n        var y0 = this.__currentPosition && this.__currentPosition.y;\n\n        // First ensure there is a subpath for (x1, y1).\n        if (typeof x0 == \"undefined\" || typeof y0 == \"undefined\") {\n            return;\n        }\n\n        // Negative values for radius must cause the implementation to throw an IndexSizeError exception.\n        if (radius < 0) {\n            throw new Error(\"IndexSizeError: The radius provided (\" + radius + \") is negative.\");\n        }\n\n        // If the point (x0, y0) is equal to the point (x1, y1),\n        // or if the point (x1, y1) is equal to the point (x2, y2),\n        // or if the radius radius is zero,\n        // then the method must add the point (x1, y1) to the subpath,\n        // and connect that point to the previous point (x0, y0) by a straight line.\n        if (((x0 === x1) && (y0 === y1))\n            || ((x1 === x2) && (y1 === y2))\n            || (radius === 0)) {\n            this.lineTo(x1, y1);\n            return;\n        }\n\n        // Otherwise, if the points (x0, y0), (x1, y1), and (x2, y2) all lie on a single straight line,\n        // then the method must add the point (x1, y1) to the subpath,\n        // and connect that point to the previous point (x0, y0) by a straight line.\n        var unit_vec_p1_p0 = normalize([x0 - x1, y0 - y1]);\n        var unit_vec_p1_p2 = normalize([x2 - x1, y2 - y1]);\n        if (unit_vec_p1_p0[0] * unit_vec_p1_p2[1] === unit_vec_p1_p0[1] * unit_vec_p1_p2[0]) {\n            this.lineTo(x1, y1);\n            return;\n        }\n\n        // Otherwise, let The Arc be the shortest arc given by circumference of the circle that has radius radius,\n        // and that has one point tangent to the half-infinite line that crosses the point (x0, y0) and ends at the point (x1, y1),\n        // and that has a different point tangent to the half-infinite line that ends at the point (x1, y1), and crosses the point (x2, y2).\n        // The points at which this circle touches these two lines are called the start and end tangent points respectively.\n\n        // note that both vectors are unit vectors, so the length is 1\n        var cos = (unit_vec_p1_p0[0] * unit_vec_p1_p2[0] + unit_vec_p1_p0[1] * unit_vec_p1_p2[1]);\n        var theta = Math.acos(Math.abs(cos));\n\n        // Calculate origin\n        var unit_vec_p1_origin = normalize([\n            unit_vec_p1_p0[0] + unit_vec_p1_p2[0],\n            unit_vec_p1_p0[1] + unit_vec_p1_p2[1]\n        ]);\n        var len_p1_origin = radius / Math.sin(theta / 2);\n        var x = x1 + len_p1_origin * unit_vec_p1_origin[0];\n        var y = y1 + len_p1_origin * unit_vec_p1_origin[1];\n\n        // Calculate start angle and end angle\n        // rotate 90deg clockwise (note that y axis points to its down)\n        var unit_vec_origin_start_tangent = [\n            -unit_vec_p1_p0[1],\n            unit_vec_p1_p0[0]\n        ];\n        // rotate 90deg counter clockwise (note that y axis points to its down)\n        var unit_vec_origin_end_tangent = [\n            unit_vec_p1_p2[1],\n            -unit_vec_p1_p2[0]\n        ];\n        var getAngle = function (vector) {\n            // get angle (clockwise) between vector and (1, 0)\n            var x = vector[0];\n            var y = vector[1];\n            if (y >= 0) { // note that y axis points to its down\n                return Math.acos(x);\n            } else {\n                return -Math.acos(x);\n            }\n        };\n        var startAngle = getAngle(unit_vec_origin_start_tangent);\n        var endAngle = getAngle(unit_vec_origin_end_tangent);\n\n        // Connect the point (x0, y0) to the start tangent point by a straight line\n        this.lineTo(x + unit_vec_origin_start_tangent[0] * radius,\n                    y + unit_vec_origin_start_tangent[1] * radius);\n\n        // Connect the start tangent point to the end tangent point by arc\n        // and adding the end tangent point to the subpath.\n        this.arc(x, y, radius, startAngle, endAngle);\n    };\n\n    /**\n     * Sets the stroke property on the current element\n     */\n    Context.prototype.stroke = function () {\n        if (this.__currentElement.nodeName === \"path\") {\n            this.__currentElement.setAttribute(\"paint-order\", \"fill stroke markers\");\n        }\n        this.__applyCurrentDefaultPath();\n        this.__applyStyleToCurrentElement(\"stroke\");\n    };\n\n    /**\n     * Sets fill properties on the current element\n     */\n    Context.prototype.fill = function () {\n        if (this.__currentElement.nodeName === \"path\") {\n            this.__currentElement.setAttribute(\"paint-order\", \"stroke fill markers\");\n        }\n        this.__applyCurrentDefaultPath();\n        this.__applyStyleToCurrentElement(\"fill\");\n    };\n\n    /**\n     *  Adds a rectangle to the path.\n     */\n    Context.prototype.rect = function (x, y, width, height) {\n        if (this.__currentElement.nodeName !== \"path\") {\n            this.beginPath();\n        }\n        this.moveTo(x, y);\n        this.lineTo(x+width, y);\n        this.lineTo(x+width, y+height);\n        this.lineTo(x, y+height);\n        this.lineTo(x, y);\n        this.closePath();\n    };\n\n\n    /**\n     * adds a rectangle element\n     */\n    Context.prototype.fillRect = function (x, y, width, height) {\n        let {a, b, c, d, e, f} = this.getTransform();\n        if (JSON.stringify([a, b, c, d, e, f]) === JSON.stringify([1, 0, 0, 1, 0, 0])) {\n            //clear entire canvas\n            if (x === 0 && y === 0 && width === this.width && height === this.height) {\n                this.__clearCanvas();\n            }\n        }\n        var rect, parent;\n        rect = this.__createElement(\"rect\", {\n            x : x,\n            y : y,\n            width : width,\n            height : height\n        }, true);\n        parent = this.__closestGroupOrSvg();\n        parent.appendChild(rect);\n        this.__currentElement = rect;\n        this.__applyTransformation(rect);\n        this.__applyStyleToCurrentElement(\"fill\");\n    };\n\n    /**\n     * Draws a rectangle with no fill\n     * @param x\n     * @param y\n     * @param width\n     * @param height\n     */\n    Context.prototype.strokeRect = function (x, y, width, height) {\n        var rect, parent;\n        rect = this.__createElement(\"rect\", {\n            x : x,\n            y : y,\n            width : width,\n            height : height\n        }, true);\n        parent = this.__closestGroupOrSvg();\n        parent.appendChild(rect);\n        this.__currentElement = rect;\n        this.__applyTransformation(rect);\n        this.__applyStyleToCurrentElement(\"stroke\");\n    };\n\n\n    /**\n     * Clear entire canvas:\n     * 1. save current transforms\n     * 2. remove all the childNodes of the root g element\n     */\n    Context.prototype.__clearCanvas = function () {\n        var rootGroup = this.__root.childNodes[1];\n        this.__root.removeChild(rootGroup);\n        this.__currentElement = this.__document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n        this.__root.appendChild(this.__currentElement);\n        //reset __groupStack as all the child group nodes are all removed.\n        this.__groupStack = [];\n    };\n\n    /**\n     * \"Clears\" a canvas by just drawing a white rectangle in the current group.\n     */\n    Context.prototype.clearRect = function (x, y, width, height) {\n        let {a, b, c, d, e, f} = this.getTransform();\n        if (JSON.stringify([a, b, c, d, e, f]) === JSON.stringify([1, 0, 0, 1, 0, 0])) {\n            //clear entire canvas\n            if (x === 0 && y === 0 && width === this.width && height === this.height) {\n                this.__clearCanvas();\n                return;\n            }\n        }\n        var rect, parent = this.__closestGroupOrSvg();\n        rect = this.__createElement(\"rect\", {\n            x : x,\n            y : y,\n            width : width,\n            height : height,\n            fill : \"#FFFFFF\"\n        }, true);\n        this.__applyTransformation(rect);\n        parent.appendChild(rect);\n    };\n\n    /**\n     * Adds a linear gradient to a defs tag.\n     * Returns a canvas gradient object that has a reference to it's parent def\n     */\n    Context.prototype.createLinearGradient = function (x1, y1, x2, y2) {\n        var grad = this.__createElement(\"linearGradient\", {\n            id : randomString(this.__ids),\n            x1 : x1+\"px\",\n            x2 : x2+\"px\",\n            y1 : y1+\"px\",\n            y2 : y2+\"px\",\n            \"gradientUnits\" : \"userSpaceOnUse\"\n        }, false);\n        this.__defs.appendChild(grad);\n        return new CanvasGradient(grad, this);\n    };\n\n    /**\n     * Adds a radial gradient to a defs tag.\n     * Returns a canvas gradient object that has a reference to it's parent def\n     */\n    Context.prototype.createRadialGradient = function (x0, y0, r0, x1, y1, r1) {\n        var grad = this.__createElement(\"radialGradient\", {\n            id : randomString(this.__ids),\n            cx : x1+\"px\",\n            cy : y1+\"px\",\n            r  : r1+\"px\",\n            fx : x0+\"px\",\n            fy : y0+\"px\",\n            \"gradientUnits\" : \"userSpaceOnUse\"\n        }, false);\n        this.__defs.appendChild(grad);\n        return new CanvasGradient(grad, this);\n\n    };\n\n    /**\n     * Fills or strokes text\n     * @param text\n     * @param x\n     * @param y\n     * @param action - stroke or fill\n     * @private\n     */\n    Context.prototype.__applyText = function (text, x, y, action) {\n        var el = document.createElement(\"span\");\n        el.setAttribute(\"style\", 'font:' + this.font);\n\n        var style = el.style, // CSSStyleDeclaration object\n            parent = this.__closestGroupOrSvg(),\n            textElement = this.__createElement(\"text\", {\n                \"font-family\": style.fontFamily,\n                \"font-size\": style.fontSize,\n                \"font-style\": style.fontStyle,\n                \"font-weight\": style.fontWeight,\n\n                // canvas doesn't support underline natively, but we do :)\n                \"text-decoration\": this.__fontUnderline,\n                \"x\": x,\n                \"y\": y,\n                \"text-anchor\": getTextAnchor(this.textAlign),\n                \"dominant-baseline\": getDominantBaseline(this.textBaseline)\n            }, true);\n\n        textElement.appendChild(this.__document.createTextNode(text));\n        this.__currentElement = textElement;\n        this.__applyTransformation(textElement);\n        this.__applyStyleToCurrentElement(action);\n\n        if (this.__fontHref) {\n            var a = this.__createElement(\"a\");\n            // canvas doesn't natively support linking, but we do :)\n            a.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"xlink:href\", this.__fontHref);\n            a.appendChild(textElement);\n            textElement = a;\n        }\n\n        parent.appendChild(textElement);\n    };\n\n    /**\n     * Creates a text element\n     * @param text\n     * @param x\n     * @param y\n     */\n    Context.prototype.fillText = function (text, x, y) {\n        this.__applyText(text, x, y, \"fill\");\n    };\n\n    /**\n     * Strokes text\n     * @param text\n     * @param x\n     * @param y\n     */\n    Context.prototype.strokeText = function (text, x, y) {\n        this.__applyText(text, x, y, \"stroke\");\n    };\n\n    /**\n     * No need to implement this for svg.\n     * @param text\n     * @return {TextMetrics}\n     */\n    Context.prototype.measureText = function (text) {\n        this.__ctx.font = this.font;\n        return this.__ctx.measureText(text);\n    };\n\n    /**\n     *  Arc command!\n     */\n    Context.prototype.arc = function (x, y, radius, startAngle, endAngle, counterClockwise) {\n        // in canvas no circle is drawn if no angle is provided.\n        if (startAngle === endAngle) {\n            return;\n        }\n        startAngle = startAngle % (2*Math.PI);\n        endAngle = endAngle % (2*Math.PI);\n        if (startAngle === endAngle) {\n            //circle time! subtract some of the angle so svg is happy (svg elliptical arc can't draw a full circle)\n            endAngle = ((endAngle + (2*Math.PI)) - 0.001 * (counterClockwise ? -1 : 1)) % (2*Math.PI);\n        }\n        var endX = x+radius*Math.cos(endAngle),\n            endY = y+radius*Math.sin(endAngle),\n            startX = x+radius*Math.cos(startAngle),\n            startY = y+radius*Math.sin(startAngle),\n            sweepFlag = counterClockwise ? 0 : 1,\n            largeArcFlag = 0,\n            diff = endAngle - startAngle;\n\n        // https://github.com/gliffy/canvas2svg/issues/4\n        if (diff < 0) {\n            diff += 2*Math.PI;\n        }\n\n        if (counterClockwise) {\n            largeArcFlag = diff > Math.PI ? 0 : 1;\n        } else {\n            largeArcFlag = diff > Math.PI ? 1 : 0;\n        }\n\n        var scaleX = Math.hypot(this.__transformMatrix.a, this.__transformMatrix.b);\n        var scaleY = Math.hypot(this.__transformMatrix.c, this.__transformMatrix.d);\n\n        this.lineTo(startX, startY);\n        this.__addPathCommand(format(\"A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}\",\n            {\n                rx:radius * scaleX,\n                ry:radius * scaleY,\n                xAxisRotation:0,\n                largeArcFlag:largeArcFlag,\n                sweepFlag:sweepFlag,\n                endX: this.__matrixTransform(endX, endY).x,\n                endY: this.__matrixTransform(endX, endY).y\n            }));\n\n        this.__currentPosition = {x: endX, y: endY};\n    };\n\n    /**\n     *  Ellipse command!\n     */\n     Context.prototype.ellipse = function(x, y, radiusX, radiusY, rotation, startAngle, endAngle, counterClockwise) {\n        if (startAngle === endAngle) {\n            return;\n        }\n\n        var transformedCenter = this.__matrixTransform(x, y);\n        x = transformedCenter.x;\n        y = transformedCenter.y;\n        var scale = this.__getTransformScale();\n        radiusX = radiusX * scale.x;\n        radiusY = radiusY * scale.y;\n        rotation = rotation + this.__getTransformRotation();\n\n        startAngle = startAngle % (2*Math.PI);\n        endAngle = endAngle % (2*Math.PI);\n        if(startAngle === endAngle) {\n            endAngle = ((endAngle + (2*Math.PI)) - 0.001 * (counterClockwise ? -1 : 1)) % (2*Math.PI);\n        }\n        var endX = x + Math.cos(-rotation) * radiusX * Math.cos(endAngle)\n                     + Math.sin(-rotation) * radiusY * Math.sin(endAngle),\n            endY = y - Math.sin(-rotation) * radiusX * Math.cos(endAngle)\n                     + Math.cos(-rotation) * radiusY * Math.sin(endAngle),\n            startX = x + Math.cos(-rotation) * radiusX * Math.cos(startAngle)\n                       + Math.sin(-rotation) * radiusY * Math.sin(startAngle),\n            startY = y - Math.sin(-rotation) * radiusX * Math.cos(startAngle)\n                       + Math.cos(-rotation) * radiusY * Math.sin(startAngle),\n            sweepFlag = counterClockwise ? 0 : 1,\n            largeArcFlag = 0,\n            diff = endAngle - startAngle;\n\n        if(diff < 0) {\n            diff += 2*Math.PI;\n        }\n\n        if(counterClockwise) {\n            largeArcFlag = diff > Math.PI ? 0 : 1;\n        } else {\n            largeArcFlag = diff > Math.PI ? 1 : 0;\n        }\n\n        // Transform is already applied, so temporarily remove since lineTo\n        // will apply it again.\n        var currentTransform = this.__transformMatrix;\n        this.resetTransform();\n        this.lineTo(startX, startY);\n        this.__transformMatrix = currentTransform;\n\n        this.__addPathCommand(format(\"A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}\",\n            {\n                rx:radiusX, \n                ry:radiusY, \n                xAxisRotation:rotation*(180/Math.PI), \n                largeArcFlag:largeArcFlag, \n                sweepFlag:sweepFlag, \n                endX:endX,\n                endY:endY\n            }));\n\n        this.__currentPosition = {x: endX, y: endY};\n    };\n\n    /**\n     * Generates a ClipPath from the clip command.\n     */\n    Context.prototype.clip = function () {\n        var group = this.__closestGroupOrSvg(),\n            clipPath = this.__createElement(\"clipPath\"),\n            id =  randomString(this.__ids),\n            newGroup = this.__createElement(\"g\");\n\n        this.__applyCurrentDefaultPath();\n        group.removeChild(this.__currentElement);\n        clipPath.setAttribute(\"id\", id);\n        clipPath.appendChild(this.__currentElement);\n\n        this.__defs.appendChild(clipPath);\n\n        //set the clip path to this group\n        group.setAttribute(\"clip-path\", format(\"url(#{id})\", {id:id}));\n\n        //clip paths can be scaled and transformed, we need to add another wrapper group to avoid later transformations\n        // to this path\n        group.appendChild(newGroup);\n\n        this.__currentElement = newGroup;\n\n    };\n\n    /**\n     * Draws a canvas, image or mock context to this canvas.\n     * Note that all svg dom manipulation uses node.childNodes rather than node.children for IE support.\n     * http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage\n     */\n    Context.prototype.drawImage = function () {\n        //convert arguments to a real array\n        var args = Array.prototype.slice.call(arguments),\n            image=args[0],\n            dx, dy, dw, dh, sx=0, sy=0, sw, sh, parent, svg, defs, group,\n            svgImage, canvas, context, id;\n\n        if (args.length === 3) {\n            dx = args[1];\n            dy = args[2];\n            sw = image.width;\n            sh = image.height;\n            dw = sw;\n            dh = sh;\n        } else if (args.length === 5) {\n            dx = args[1];\n            dy = args[2];\n            dw = args[3];\n            dh = args[4];\n            sw = image.width;\n            sh = image.height;\n        } else if (args.length === 9) {\n            sx = args[1];\n            sy = args[2];\n            sw = args[3];\n            sh = args[4];\n            dx = args[5];\n            dy = args[6];\n            dw = args[7];\n            dh = args[8];\n        } else {\n            throw new Error(\"Invalid number of arguments passed to drawImage: \" + arguments.length);\n        }\n\n        parent = this.__closestGroupOrSvg();\n        const matrix = this.getTransform().translate(dx, dy);\n        if (image instanceof Context) {\n            //canvas2svg mock canvas context. In the future we may want to clone nodes instead.\n            //also I'm currently ignoring dw, dh, sw, sh, sx, sy for a mock context.\n            svg = image.getSvg().cloneNode(true);\n            if (svg.childNodes && svg.childNodes.length > 1) {\n                defs = svg.childNodes[0];\n                while(defs.childNodes.length) {\n                    id = defs.childNodes[0].getAttribute(\"id\");\n                    this.__ids[id] = id;\n                    this.__defs.appendChild(defs.childNodes[0]);\n                }\n                group = svg.childNodes[1];\n                if (group) {\n                    this.__applyTransformation(group, matrix);\n                    parent.appendChild(group);\n                }\n            }\n        } else if (image.nodeName === \"CANVAS\" || image.nodeName === \"IMG\") {\n            //canvas or image\n            svgImage = this.__createElement(\"image\");\n            svgImage.setAttribute(\"width\", dw);\n            svgImage.setAttribute(\"height\", dh);\n            svgImage.setAttribute(\"preserveAspectRatio\", \"none\");\n\n            if (sx || sy || sw !== image.width || sh !== image.height) {\n                //crop the image using a temporary canvas\n                canvas = this.__document.createElement(\"canvas\");\n                canvas.width = dw;\n                canvas.height = dh;\n                context = canvas.getContext(\"2d\");\n                context.drawImage(image, sx, sy, sw, sh, 0, 0, dw, dh);\n                image = canvas;\n            }\n            this.__applyTransformation(svgImage, matrix);\n            svgImage.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"xlink:href\",\n                image.nodeName === \"CANVAS\" ? image.toDataURL() : image.getAttribute(\"src\"));\n            parent.appendChild(svgImage);\n        }\n    };\n\n    /**\n     * Generates a pattern tag\n     */\n    Context.prototype.createPattern = function (image, repetition) {\n        var pattern = this.__document.createElementNS(\"http://www.w3.org/2000/svg\", \"pattern\"), id = randomString(this.__ids),\n            img;\n        pattern.setAttribute(\"id\", id);\n        pattern.setAttribute(\"width\", image.width);\n        pattern.setAttribute(\"height\", image.height);\n        // We want the pattern sizing to be absolute, and not relative\n        // https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Patterns\n        // https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/patternUnits\n        pattern.setAttribute(\"patternUnits\", \"userSpaceOnUse\");\n\n        if (image.nodeName === \"CANVAS\" || image.nodeName === \"IMG\") {\n            img = this.__document.createElementNS(\"http://www.w3.org/2000/svg\", \"image\");\n            img.setAttribute(\"width\", image.width);\n            img.setAttribute(\"height\", image.height);\n            img.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"xlink:href\",\n                image.nodeName === \"CANVAS\" ? image.toDataURL() : image.getAttribute(\"src\"));\n            pattern.appendChild(img);\n            this.__defs.appendChild(pattern);\n        } else if (image instanceof Context) {\n            pattern.appendChild(image.__root.childNodes[1]);\n            this.__defs.appendChild(pattern);\n        }\n        return new CanvasPattern(pattern, this);\n    };\n\n    Context.prototype.setLineDash = function (dashArray) {\n        if (dashArray && dashArray.length > 0) {\n            this.lineDash = dashArray.join(\",\");\n        } else {\n            this.lineDash = null;\n        }\n    };\n\n    /**\n     * SetTransform changes the current transformation matrix to\n     * the matrix given by the arguments as described below.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setTransform\n     */\n    Context.prototype.setTransform = function (a, b, c, d, e, f) {\n        if (a instanceof DOMMatrix) {\n            this.__transformMatrix = new DOMMatrix([a.a, a.b, a.c, a.d, a.e, a.f]);\n        } else {\n            this.__transformMatrix = new DOMMatrix([a, b, c, d, e, f]);\n        }\n    };\n\n    /**\n     * GetTransform Returns a copy of the current transformation matrix,\n     * as a newly created DOMMAtrix Object\n     *\n     * @returns A DOMMatrix Object\n     */\n    Context.prototype.getTransform = function () {\n        let {a, b, c, d, e, f} = this.__transformMatrix;\n        return new DOMMatrix([a, b, c, d, e, f]);\n    };\n\n    /**\n     * ResetTransform resets the current transformation matrix to the identity matrix\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/resetTransform\n     */\n    Context.prototype.resetTransform = function () {\n        this.setTransform(1, 0, 0, 1, 0, 0);\n    };\n\n    /**\n     * Add the scaling transformation described by the arguments to the current transformation matrix.\n     *\n     * @param x The x argument represents the scale factor in the horizontal direction\n     * @param y The y argument represents the scale factor in the vertical direction.\n     * @see https://html.spec.whatwg.org/multipage/canvas.html#dom-context-2d-scale\n     */\n    Context.prototype.scale = function (x, y) {\n        if (y === undefined) {\n            y = x;\n        }\n        // If either of the arguments are infinite or NaN, then return.\n        if (isNaN(x) || isNaN(y) || !isFinite(x) || !isFinite(y)) {\n            return\n        }\n        let matrix = this.getTransform().scale(x, y);\n        this.setTransform(matrix);\n    };\n\n    /**\n     * Rotate adds a rotation to the transformation matrix.\n     *\n     * @param angle The rotation angle, clockwise in radians. You can use degree * Math.PI / 180 to calculate a radian from a degree.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/rotate\n     * @see https://www.w3.org/TR/css-transforms-1\n     */\n    Context.prototype.rotate = function (angle) {\n        let matrix = this.getTransform().multiply(new DOMMatrix([\n            Math.cos(angle),\n            Math.sin(angle),\n            -Math.sin(angle),\n            Math.cos(angle),\n            0,\n            0\n        ]));\n        this.setTransform(matrix);\n    };\n\n    /**\n     * Translate adds a translation transformation to the current matrix.\n     *\n     * @param x Distance to move in the horizontal direction. Positive values are to the right, and negative to the left.\n     * @param y Distance to move in the vertical direction. Positive values are down, and negative are up.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/translate\n     */\n    Context.prototype.translate = function (x, y) {\n        const matrix = this.getTransform().translate(x, y);\n        this.setTransform(matrix);\n    };\n\n    /**\n     * Transform multiplies the current transformation with the matrix described by the arguments of this method.\n     * This lets you scale, rotate, translate (move), and skew the context.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/transform\n     */\n    Context.prototype.transform = function (a, b, c, d, e, f) {\n        const matrix = this.getTransform().multiply(new DOMMatrix([a, b, c, d, e, f]));\n        this.setTransform(matrix);\n    };\n\n    Context.prototype.__matrixTransform = function(x, y) {\n        return new DOMPoint(x, y).matrixTransform(this.__transformMatrix)\n    };\n\n    /**\n     * \n     * @returns The scale component of the transform matrix as {x,y}.\n     */\n    Context.prototype.__getTransformScale = function() {\n        return {\n            x: Math.hypot(this.__transformMatrix.a, this.__transformMatrix.b),\n            y: Math.hypot(this.__transformMatrix.c, this.__transformMatrix.d)\n        };\n    };\n\n    /**\n     * \n     * @returns The rotation component of the transform matrix in radians.\n     */\n    Context.prototype.__getTransformRotation = function() {\n        return Math.atan2(this.__transformMatrix.b, this.__transformMatrix.a);\n    };\n\n    /**\n     *\n     * @param {*} sx The x-axis coordinate of the top-left corner of the rectangle from which the ImageData will be extracted.\n     * @param {*} sy The y-axis coordinate of the top-left corner of the rectangle from which the ImageData will be extracted.\n     * @param {*} sw The width of the rectangle from which the ImageData will be extracted. Positive values are to the right, and negative to the left.\n     * @param {*} sh The height of the rectangle from which the ImageData will be extracted. Positive values are down, and negative are up.\n     * @param {Boolean} options.async Will return a Promise<ImageData> if true, must be set to true\n     * @returns An ImageData object containing the image data for the rectangle of the canvas specified. The coordinates of the rectangle's top-left corner are (sx, sy), while the coordinates of the bottom corner are (sx + sw, sy + sh).\n     */\n    Context.prototype.getImageData = function(sx, sy, sw, sh, options) {\n        return utils.getImageData(this.getSvg(), this.width, this.height, sx, sy, sw, sh, options);\n    };\n\n    /**\n     * Not yet implemented\n     */\n    Context.prototype.drawFocusRing = function () {};\n    Context.prototype.createImageData = function () {};\n    Context.prototype.putImageData = function () {};\n    Context.prototype.globalCompositeOperation = function () {};\n\n    return Context;\n}());\n\nfunction SVGCanvasElement(options) {\n\n    this.ctx = new Context(options);\n    this.svg = this.ctx.__root;\n\n    // sync attributes to svg\n    var svg = this.svg;\n    var _this = this;\n\n    var wrapper = document.createElement('div');\n    wrapper.style.display = 'inline-block';\n    wrapper.appendChild(svg);\n    this.wrapper = wrapper;\n\n    Object.defineProperty(this, 'className', {\n        get: function() {\n            return wrapper.getAttribute('class') || '';\n        },\n        set: function(val) {\n            return wrapper.setAttribute('class', val);\n        }\n    });\n\n    Object.defineProperty(this, 'tagName', {\n        get: function() {\n            return \"CANVAS\";\n        },\n        set: function() {} // no-op\n    });\n\n    [\"width\", \"height\"].forEach(function(prop) {\n        Object.defineProperty(_this, prop, {\n            get: function() {\n                return svg.getAttribute(prop) | 0;\n            },\n            set: function(val) {\n                if (isNaN(val) || (typeof val === \"undefined\")) {\n                    return;\n                }\n                _this.ctx[prop] = val;\n                svg.setAttribute(prop, val);\n                return wrapper[prop] = val;\n            }\n        });\n    });\n\n    [\"style\", \"id\"].forEach(function(prop) {\n        Object.defineProperty(_this, prop, {\n            get: function() {\n                return wrapper[prop];\n            },\n            set: function(val) {\n                if (typeof val !== \"undefined\") {\n                    return wrapper[prop] = val;\n                }\n            }\n        });\n    });\n\n    [\"getBoundingClientRect\"].forEach(function(fn) {\n        _this[fn] = function() {\n            return svg[fn]();\n        };\n    });\n}\n\nSVGCanvasElement.prototype.getContext = function(type) {\n    if (type !== '2d') {\n        throw new Error('Unsupported type of context for SVGCanvas');\n    }\n\n    return this.ctx;\n};\n\n// you should always use URL.revokeObjectURL after your work done\nSVGCanvasElement.prototype.toObjectURL = function() {\n    var data = new XMLSerializer().serializeToString(this.svg);\n    var svg = new Blob([data], {type: 'image/svg+xml;charset=utf-8'});\n    return URL.createObjectURL(svg);\n};\n\n/**\n * toDataURL returns a data URI containing a representation of the image in the format specified by the type parameter.\n * \n * @param {String} type A DOMString indicating the image format. The default type is image/svg+xml; this image format will be also used if the specified type is not supported.\n * @param {Number} encoderOptions A Number between 0 and 1 indicating the image quality to be used when creating images using file formats that support lossy compression (such as image/jpeg or image/webp). A user agent will use its default quality value if this option is not specified, or if the number is outside the allowed range.\n * @param {Boolean} options.async Will return a Promise<String> if true, must be set to true if type is not image/svg+xml\n */\nSVGCanvasElement.prototype.toDataURL = function(type, encoderOptions, options) {\n    return utils.toDataURL(this.svg, this.width, this.height, type, encoderOptions, options)\n};\n\nSVGCanvasElement.prototype.addEventListener = function() {\n    return this.svg.addEventListener.apply(this.svg, arguments);\n};\n\n// will return wrapper element: <div><svg></svg></div>\nSVGCanvasElement.prototype.getElement = function() {\n    return this.wrapper;\n};\n\nSVGCanvasElement.prototype.getAttribute = function(prop) {\n    return this.wrapper.getAttribute(prop);\n};\n\nSVGCanvasElement.prototype.setAttribute = function(prop, val) {\n    this.wrapper.setAttribute(prop, val);\n};\n\nexports.Context = Context;\nexports.Element = SVGCanvasElement;\n"],"names":["svgcanvas","toString","obj","ImageUtils","svgDataURL","width","height","svgImage","resolve","canvas","svgNode","type","encoderOptions","options","xml","isIE","xmlns","SVGDataURL","dataUrl","sx","sy","sw","sh","imageData","utils","Context","STYLES","CanvasGradient","CanvasPattern","namedEntities","format","str","args","keys","randomString","holder","chars","randomstring","createNamedToNumberedLookup","items","radix","i","entity","lookup","base10","getTextAnchor","textAlign","mapping","getDominantBaseline","textBaseline","gradientNode","ctx","offset","color","stop","regex","matches","pattern","o","defaultOptions","data","elementName","properties","resetFill","element","key","styleState","matrix","a","b","c","d","e","f","currentElement","currentStyleGroup","node","style","value","id","nodeIndex","opacity","globalAlpha","attr","scale","fixNamedEntities","serialized","regexp","group","parent","state","path","command","x","y","cp1x","cp1y","cp2x","cp2y","cpx","cpy","normalize","vector","len","x1","y1","x2","y2","radius","x0","y0","unit_vec_p1_p0","unit_vec_p1_p2","cos","theta","unit_vec_p1_origin","len_p1_origin","unit_vec_origin_start_tangent","unit_vec_origin_end_tangent","getAngle","startAngle","endAngle","rect","rootGroup","grad","r0","r1","text","action","el","textElement","counterClockwise","endX","endY","startX","startY","sweepFlag","largeArcFlag","diff","scaleX","scaleY","radiusX","radiusY","rotation","transformedCenter","currentTransform","clipPath","newGroup","image","dx","dy","dw","dh","svg","defs","context","repetition","img","dashArray","angle","SVGCanvasElement","_this","wrapper","val","prop","fn","Context_1","Element"],"mappings":"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","x_google_ignoreList":[0]}