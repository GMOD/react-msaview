{"version":3,"mappings":"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","names":["MinimapSVG","observer","model","scrollX","W","H","colWidth","numColumns","BAR_HEIGHT","H2","unit","left","right","s","e","fill","React","renderToSvg","opts","when","width","height","scrollY","exportType","theme","includeMinimap","render","offsetX","offsetY","Context","__vitePreload","n","Wrapper","MinimapWrapper","NullWrapper","renderToStaticMarkup","SvgWrapper","CoreRendering","createRoot","clipId","treeAreaWidth","colorScheme","contrastScheme","colorContrast","ctx1","ctx2","renderTreeCanvas","renderMSABlock","children","minimapHeight"],"ignoreList":[],"sources":["../../../lib/dist/components/MinimapSVG.js","../../../lib/dist/renderToSvg.js"],"sourcesContent":["import React from 'react';\nimport { observer } from 'mobx-react';\nconst MinimapSVG = observer(function ({ model }) {\n    const { scrollX, msaAreaWidth: W, minimapHeight: H, colWidth, numColumns, } = model;\n    const BAR_HEIGHT = 12;\n    const H2 = H - 12;\n    const unit = W / numColumns / colWidth;\n    const left = -scrollX;\n    const right = left + W;\n    const s = left * unit;\n    const e = right * unit;\n    const fill = 'rgba(66, 119, 127, 0.3)';\n    return (React.createElement(React.Fragment, null,\n        React.createElement(\"rect\", { x: 0, y: 0, width: W, height: BAR_HEIGHT, stroke: \"#555\", fill: \"none\" }),\n        React.createElement(\"rect\", { x: Math.max(0, s), y: 0, width: e - s, height: BAR_HEIGHT, fill: fill, stroke: \"#555\" }),\n        React.createElement(\"g\", { transform: `translate(0 ${BAR_HEIGHT})` },\n            React.createElement(\"polygon\", { fill: fill, points: [\n                    [e, 0],\n                    [s, 0],\n                    [0, H2],\n                    [W, H2],\n                ].toString() }))));\n});\nexport default MinimapSVG;\n//# sourceMappingURL=MinimapSVG.js.map","import React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport { when } from 'mobx';\nimport { renderToStaticMarkup } from '@jbrowse/core/util';\nimport { renderTreeCanvas } from './components/TreePanel/renderTreeCanvas';\nimport { renderMSABlock } from './components/MSAPanel/renderMSABlock';\nimport { colorContrast } from './util';\nimport MinimapSVG from './components/MinimapSVG';\nexport async function renderToSvg(model, opts) {\n    await when(() => !!model.initialized);\n    const { width, height, scrollX, scrollY } = model;\n    const { exportType, theme, includeMinimap } = opts;\n    if (exportType === 'entire') {\n        return render({\n            width: model.totalWidth + model.treeAreaWidth,\n            height: model.totalHeight,\n            theme,\n            model,\n            offsetY: 0,\n            offsetX: 0,\n            includeMinimap,\n        });\n    }\n    else if (exportType === 'viewport') {\n        return render({\n            width,\n            height,\n            theme,\n            model,\n            offsetY: scrollY,\n            offsetX: -scrollX,\n            includeMinimap,\n        });\n    }\n    else {\n        throw new Error('unknown export type');\n    }\n}\nasync function render({ width, height, offsetX, offsetY, theme, model, includeMinimap, }) {\n    const { Context } = await import('svgcanvas');\n    const Wrapper = includeMinimap ? MinimapWrapper : NullWrapper;\n    return renderToStaticMarkup(React.createElement(SvgWrapper, { width: width, height: height },\n        React.createElement(Wrapper, { model: model },\n            React.createElement(CoreRendering, { Context: Context, model: model, theme: theme, offsetX: offsetX, offsetY: offsetY, width: width, height: height }))), createRoot);\n}\n// function renderMultiline({ model }: { model: MsaViewModel }) {\n//   const { treeAreaWidth, height } = model\n//   const clipId = 'tree'\n//   return (\n//     <Wrapper model={model}>\n//       <defs>\n//         <clipPath id={clipId}>\n//           <rect x={0} y={0} width={treeAreaWidth} height={height} />\n//         </clipPath>\n//       </defs>\n//       <g\n//         clipPath={`url(#${clipId})`}\n//         /* eslint-disable-next-line react/no-danger */\n//         dangerouslySetInnerHTML={{ __html: ctx1.getSvg().innerHTML }}\n//       />\n//       <g\n//         transform={`translate(${treeAreaWidth} 0)`}\n//         /* eslint-disable-next-line react/no-danger */\n//         dangerouslySetInnerHTML={{ __html: ctx2.getSvg().innerHTML }}\n//       />\n//     </Wrapper>\n//   )\n// }\nfunction CoreRendering({ model, theme, width, height, offsetX, offsetY, Context, }) {\n    const clipId = 'tree';\n    const { treeAreaWidth, colorScheme } = model;\n    const contrastScheme = colorContrast(colorScheme, theme);\n    const ctx1 = Context(width, height);\n    const ctx2 = Context(width, height);\n    renderTreeCanvas({\n        model,\n        offsetY,\n        ctx: ctx1,\n        theme,\n        blockSizeYOverride: height,\n        highResScaleFactorOverride: 1,\n    });\n    renderMSABlock({\n        model,\n        theme,\n        offsetY,\n        offsetX,\n        contrastScheme,\n        ctx: ctx2,\n        blockSizeXOverride: width - treeAreaWidth,\n        blockSizeYOverride: height,\n        highResScaleFactorOverride: 1,\n    });\n    return (React.createElement(React.Fragment, null,\n        React.createElement(\"defs\", null,\n            React.createElement(\"clipPath\", { id: clipId },\n                React.createElement(\"rect\", { x: 0, y: 0, width: treeAreaWidth, height: height }))),\n        React.createElement(\"g\", { clipPath: `url(#${clipId})`, \n            /* eslint-disable-next-line react/no-danger */\n            dangerouslySetInnerHTML: { __html: ctx1.getSvg().innerHTML } }),\n        React.createElement(\"g\", { transform: `translate(${treeAreaWidth} 0)`, \n            /* eslint-disable-next-line react/no-danger */\n            dangerouslySetInnerHTML: { __html: ctx2.getSvg().innerHTML } })));\n}\nfunction MinimapWrapper({ model, children, }) {\n    const { minimapHeight, treeAreaWidth } = model;\n    return (React.createElement(React.Fragment, null,\n        React.createElement(\"g\", { transform: `translate(${treeAreaWidth} 0)` },\n            React.createElement(MinimapSVG, { model: model })),\n        React.createElement(\"g\", { transform: `translate(0 ${minimapHeight})` }, children)));\n}\nfunction SvgWrapper({ width, height, children, }) {\n    return (React.createElement(\"svg\", { width: width, height: height, xmlns: \"http://www.w3.org/2000/svg\", xmlnsXlink: \"http://www.w3.org/1999/xlink\", viewBox: [0, 0, width, height].toString() }, children));\n}\nfunction NullWrapper({ children }) {\n    return React.createElement(React.Fragment, null, children);\n}\n//# sourceMappingURL=renderToSvg.js.map"],"file":"assets/renderToSvg-DHm7-n57.js"}